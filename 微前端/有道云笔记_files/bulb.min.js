!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("BulbEditor",[],e):"object"==typeof exports?exports.BulbEditor=e():t.BulbEditor=e()}(window,function(){return function(t){function e(e){for(var o,a,s=e[0],l=e[1],c=e[2],d=0,p=[];d<s.length;d++)a=s[d],i[a]&&p.push(i[a][0]),i[a]=0;for(o in l)Object.prototype.hasOwnProperty.call(l,o)&&(t[o]=l[o]);for(u&&u(e);p.length;)p.shift()();return r.push.apply(r,c||[]),n()}function n(){for(var t,e=0;e<r.length;e++){for(var n=r[e],o=!0,s=1;s<n.length;s++){var l=n[s];0!==i[l]&&(o=!1)}o&&(r.splice(e--,1),t=a(a.s=n[0]))}return t}var o={},i={0:0},r=[];function a(e){if(o[e])return o[e].exports;var n=o[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=t,a.c=o,a.d=function(t,e,n){a.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},a.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)a.d(n,o,function(e){return t[e]}.bind(null,o));return n},a.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="./bulbeditor/";var s=window.webpackJsonpBulbEditor=window.webpackJsonpBulbEditor||[],l=s.push.bind(s);s.push=e,s=s.slice();for(var c=0;c<s.length;c++)e(s[c]);var u=l;return r.push([316,1]),n()}([,function(t,e,n){var o=n(11),i=n(45),r=n(35),a=n(36),s=n(46),l=function(t,e,n){var c,u,d,p,h=t&l.F,f=t&l.G,g=t&l.S,m=t&l.P,y=t&l.B,v=f?o:g?o[e]||(o[e]={}):(o[e]||{}).prototype,_=f?i:i[e]||(i[e]={}),b=_.prototype||(_.prototype={});for(c in f&&(n=e),n)d=((u=!h&&v&&void 0!==v[c])?v:n)[c],p=y&&u?s(d,o):m&&"function"==typeof d?s(Function.call,d):d,v&&a(v,c,d,t&l.U),_[c]!=d&&r(_,c,p),m&&b[c]!=d&&(b[c]=d)};o.core=i,l.F=1,l.G=2,l.S=4,l.P=8,l.B=16,l.W=32,l.U=64,l.R=128,t.exports=l},function(t,e,n){(function(o){var i;void 0===(i=function(e,o){"use strict";void 0===(i=function(t){for(var e,o=n(204),i=this&&this.DEBUG?this:window,r=i.DEBUG||null!=i.logLevel,a=i.console,s={},l=function(){},c="log warn error time timeEnd profile profileEnd".split(" "),u=c.length;--u>=0;)e=c[u],r&&a[e]?s[e]=a[e].bind(a):s[e]=l;return r&&i.alert?s.debugAlert=function(t){i.alert(t)}:s.debugAlert=s.error,r&&(s.log=function(){o.log("Log: ",Array.prototype.slice.call(arguments),"white","#CCCCCC")},s.warn=function(){o.warn(Array.prototype.slice.call(arguments))},s.error=function(){o.error(Array.prototype.slice.call(arguments))},s.DEBUG=r),s}.call(o,n,o,t))||(t.exports=i)}.apply(e,[n,e]))||(t.exports=i)}).call(this,n(67))},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t,e){return function(){function t(){}return t.getAllBlockTypes=function(){return[t.ATTACHMENT,t.BLOCK,t.CATALOGUE,t.HANDWRITE,t.HEADING,t.HR,t.IMAGE,t.LIST_ITEM,t.PARAGRAPH,t.TABLE,t.TODO,t.QUOTE,t.CODE,t.UNKNOWN]},t.getType=function(t){if(t)return t.getType()},t.isParagraph=function(e){return t.getType(e)===t.PARAGRAPH},t.isParagraphCluster=function(e){return this.isParagraphClusterType(t.getType(e))},t.isParagraphClusterType=function(e){return e===t.PARAGRAPH||e===t.LIST_ITEM||e===t.HEADING||e===t.CATALOGUE||e===t.TODO||e===t.QUOTE||e===t.CODE},t.isListItem=function(e){return t.getType(e)===t.LIST_ITEM},t.isAttachment=function(e){return t.getType(e)===t.ATTACHMENT},t.isHeaderFooter=function(t){return this.getType(t)===this.HEADER_FOOTER},t.isTable=function(e){return t.getType(e)===t.TABLE},t.isImage=function(e){return t.getType(e)===t.IMAGE},t.isHr=function(e){return t.getType(e)===t.HR},t.isUnknown=function(e){return this.getType(e)===t.UNKNOWN},t.isHeading=function(e){return t.getType(e)===t.HEADING},t.isCatalogue=function(e){return t.getType(e)===t.CATALOGUE},t.isTodo=function(e){return t.getType(e)===t.TODO},t.isQuote=function(e){return t.getType(e)===t.QUOTE},t.isCode=function(e){return t.getType(e)===t.CODE},t.isTextBlock=function(e,n){return(!n||!n.selectWholeBlock)&&t.isParagraphCluster(e)},t.isTextOrTableBlock=function(e){return t.isTextBlock(e)||t.isTable(e)},t.isHandWrite=function(e){return t.getType(e)===t.HANDWRITE},t.ATTACHMENT="attachment",t.BLOCK="block",t.CATALOGUE="catalogue",t.HANDWRITE="handwrite",t.HEADER_FOOTER="header-footer",t.HEADING="heading",t.HR="horizontal-line",t.IMAGE="image",t.LIST_ITEM="list-item",t.PARAGRAPH="paragraph",t.QUOTE="quote",t.TABLE="table",t.TODO="todo",t.CODE="code",t.UNKNOWN="unknown",t}()}.apply(i,[n,i]))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t,e){return function(){function t(){}return t.isCollabCommand=function(t){var e=!1;return null!=t&&null!=t.collabProperties&&(e=t.collabProperties.isCollabCmd),e},t.isGUID=function(t){return!!t&&/^[\w\-]+$/.test(t)},t.isInlineStateSetCommand=function(t){return null!=t.isInlineStateSet&&!0===t.isInlineStateSet()},t.newGUID=function(){var t="";return t+=(Math.floor(100*Math.random())+"00").substr(0,2),t+=(Math.floor(100*Math.random())+"00").substr(0,2),t+="-",t+=Date.now().toString()},t}()}.apply(i,[n,i]))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(2),o=n(0);return{_map:{},add:function(t){var n=t.prototype.name,o=this._map;n?o[n]?e.error("Command class ["+n+"] exists!"):o[n]=t:e.error("The Command class has no name!",t)},get:function(t){var n=this._map[t];return n||e.error("Command class ["+t+"] does not exist!"),n},getAllNames:function(){return o.keys(this._map)}}}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(27),o=n(2),i=n(0),r=n(302),a={_keyHandlerMap:{},_parseKey:function(t){return t=(t=(t+="").replace(/[\s\uFEFF\xA0]/g,"")).toLowerCase()},_makeMapKey:function(t,e){return(t=t||"main")+"-"+e},getHandler:function(t,e){return this._keyHandlerMap[this._makeMapKey(t,e)]},register:function(t){if(t&&t.name&&t.key&&t.action){var e,n,r,a=this._keyHandlerMap;(n=i.defaults({},t,{scope:"main",read:!1,preventDefault:!0})).key=e=this._parseKey(t.key),e?a[r=this._makeMapKey(n.scope,n.name)]||i.some(a,function(t){return t.key===e&&t.scope===n.scope})?o.error("The key handler is conflict with other",n):a[r]=n:o.warn("The key is not valid!",t)}else o.warn("The param is not valid!",t)},exec:function(t,e,n,i){var r=this._makeMapKey(t,e),a=this._keyHandlerMap[r];a?n.isReadOnly&&n.isReadOnly()&&!a.read?i&&i.preventDefault&&i.preventDefault():(a.preventDefault&&i&&i.preventDefault&&i.preventDefault(),this.disableExec(a,n,i,e)||a.action.apply(a,[n,i,e])):o.warn("No key handler for scope/name: ",t,e)},disableExec:function(t,e,n,o){var i,a,s,l,c,u=r.ACTION_HIDE,d=r.ACTION_DISABLE;return!!e.getNoteRange&&(i=e.getNoteRange().getStartBlockRange().block.getType().toUpperCase(),a=o.replace("insert",""),s=r["RANGE_"+i],l=r.EDITOR_BUTTON_STATE_MAP[a.toLowerCase()],!!(a&&s&&l)&&((c=l.find(function(t){return t.on===s}))&&(c.action===u||c.action===d)))},matchKey:function(t,e){if(e){var n,r=this._keyHandlerMap;if(n=i.find(r,function(n){return n.key===e&&n.scope===t}))return n.name;o.warn("Can not find the key handler with key: "+e)}},getAllHandlerNamesOfScope:function(t){var e=[];return i.each(this._keyHandlerMap,function(n){n.scope===t&&e.push(n.name)}),e}};return e.extend({initialize:function(t){t=i.defaults(t||{},{scope:"main"}),this._scope=t.scope,this._customMap={},delete this.options},getKey:function(t){return(this._customMap[t]||a.getHandler(this._scope,t)||{}).key},bind:function(t){var e=this.getKey(t);e&&this.trigger("bind-key",e)},unbind:function(t){var e=this.getKey(t);e&&this.trigger("unbind-key",e)},updateKey:function(t,e){if(t&&e){a.getHandler(this._scope,t)&&(this.unbind(t),this._customMap[t]={key:e},this.bind(t))}},hasHandler:function(t){return!!a.getHandler(this._scope,t)},execWithKey:function(t,e,n){var r;i.some(this._customMap,function(e,n){if(e.key===t)return r=n,!0}),r||(r=a.matchKey(this._scope,t)),r?a.exec(this._scope,r,e,n):o.warn("no handler for scope/key ",this._scope,t)},execWithName:function(t,e,n){a.exec(this._scope,t,e,n)},getAvailableHandlerNames:function(){return a.getAllHandlerNamesOfScope(this._scope)}},{register:function(t){a.register(t)}})}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t,e){return{COMPAT:"compat",DEFAULT_BACKGROUND:"NoBackground",INTERM:"interm",INDENT_WIDTH:28,MAX_LIST_ITEM_LEVEL:9,LINE_BREAK:/Windows/.test(window.navigator.userAgent)?"\r\n":"\n",IS_MAC:/Mac|iPod|iPhone|iPad/.test(window.navigator.platform),QUOTE_PADDING:"0 10px 0 17px",QUOTE_BORDER_LEFT:"3px solid #e8e8e8",QUOTE_MARGIN:"0 5px",PLATFORM_LINE_HEIGHT:1.75,PAGE_TYPE_A4:"A4",PAGE_TYPE_B5:"B5",PAGE_TYPE_NONE:"NONE",PAGE_TYPE_TEST:"TEST",PAGE_HEIGHT_A4:1123,PAGE_HEIGHT_B5:945,PAGE_HEIGHT_NONE:Number.MAX_VALUE,PAGE_HEIGHT_TEST:100,PAGE_WIDTH_A4:792,PAGE_WIDTH_B5:663,PAGE_WIDTH_NONE:Number.MAX_VALUE,PAGE_WIDTH_TEST:792,PAGE_SPLIT_BLANK_HEIGHT:70,PAGE_SPLIT_MIDDLE_HEIGHT:10,TOLERABLE_HEIGHT_CHANGE:3,PAGE_CLASS_A4:"page-A4",PAGE_CLASS_B5:"page-B5",PAGE_CLASS_TEST:"page-TEST",WSClientStatusCode:{Connecting:0,Open:1,Closing:2,Closed:3,Ready:5,Disabled:10,Intializing:11},WSEVENTID_HOST_CLOSE:4500,MAX_MESSAGE_SIZE:5e3,MAX_UNDO_STACK_SIZE:20,MAX_CMD_DELAY_MILLIS:4e3,MAX_INIT_DELAY_MILLIS:2e3,MAX_LOCAL_CMD_COUNT_PER_SEC:20,REGULAR_CMD_SENT_MILLIS:2e3,LATENCY_TO_SHOW_SET_CONTENT_PROGRESS:2e3,CJSON_ACTION:"action",CJSON_COMMANDID:"cmdId",CJSON_COMMANDOWNER:"cmdOwner",CJSON_COLLABCOMMANDS:"collabCmds",CJSON_COLLAB_NOTE_READY:"collabNoteReady",CJSON_COLLAB_VERSION:"collabVersion",CJSON_DATA_CMD_ERROR:"dataCmdError",CJSON_ENDVERSION:"endVersion",CJSON_ERROR_TO_CLOSE:"errToClose",CJSON_FINALVERSION:"finalVersion",CJSON_INITIALIZE_COLLABSTARTED:"collabStarted",CJSON_INITIALIZE_DONE:"done",CJSON_INITIALIZE_RESULT:"initResult",CJSON_IS_HISTORY_SAVE:"isHistorySave",CJSON_IS_SERVER_CMD:"isServerCmd",CJSON_LOCKCOLOR:"lockColor",CJSON_LOCK_BLOCK_ID:"lockedBlkId",CJSON_MODIFIERS:"modifiers",CJSON_NICKNAME:"nickname",CJSON_NONDATACOMMANDS:"nondataCmds",CJSON_NOTEVERSIONUPDATE:"versionUpdate",CJSON_PORTRAIT:"portraitUrl",CJSON_READONLY:"readOnly",CJSON_SESSIONID:"sessionId",CJSON_SESSIONPROPERTY:"sessionProp",CJSON_STARTVERSION:"startVersion",NONDATACMD_BLOCKSELECTION:"nb_BlkSelection",NONDATACMD_CLINTPONG:"nb_clientPong",NONDATACMD_COLLABCLOSE:"nb_CollabClose",NONDATACMD_COLLABINFO:"nb_CollabInfo",NONDATACMD_DATACMDFAILED:"nb_dataCmdFailed",NONDATACMD_GETMODIFIERS:"nb_getModifiers",NONDATACMD_NOTESAVE:"nb_noteSave",NONDATACMD_LOCKRELEASE:"nb_lockRelease",NONDATACMD_SESSIONINITIALIZED:"nb_sessionInitialized",NONDATACMD_SEVERPING:"nb_serverPing",OPTIONS_COLLABID:"collabId",OPTIONS_NICKNAME:"nickname",OPTIONS_NOTEVERSION:"noteVersion",OPTIONS_PORTRAIT:"portraitUrl",OPTIONS_SESSIONTYPE:"sessionType",OPTIONS_SESSIONID:"sessionId",OPTIONS_USERID:"userId",OPTIONS_BUILDVERSION:"buildVersion",OPTIONS_RECONNECT:"reconn",ERRORID_FAILED_RECEIVE_COLLAB_CMD:4001,ERRORID_FAILED_SEND_LOCAL_CMD:4002,ERRORID_COLLAB_ENGINE_NULL:4003,CONNECTION_FAILED_SEND:"发送协同命令失败：",CONNECTION_NO_CONNECTED:"当前没有与协同服务器连接",CONNECTION_REFUSED:"协同服务器连接被拒绝",CONNECTION_SERVER_CLOSED:"协同服务器已经关闭",ERROR_CODE:"错误编码：",ERROR_CONFLICT_EXECUTION:"编辑区域冲突",ERROR_FAILED_SEND_LOCAL_CMD:"发送本地已执行命令失败",ERROR_FAILED_RECEIVE_COLLAB_CMD:"接收协同命令超时",ERROR_EXCEPTION:"未知错误：",ERROR_REASON:"原因：",ERROR_UNMATCHED_VERSION:"本地笔记版本与服务器端不匹配，本地/服务器：",INVALIDACTION_BLANK_NOTE:"笔记还没有加载",INVALIDACTION_BLOCKS_DIRTY:"目标段落已经被人修改过",INVALIDACTION_COLLAB_NOT_READY:"笔记内容不满足协同的要求",INVALIDACTION_EDIT_READ_ONLY:"只读模式下不可以编辑",INVALIDACTION_EDIT_NOT_READY:"笔记还没有进入编辑状态，如果此状态持续数秒，请刷新页面",INVALIDACTION_FINALVERSION_NOTREADY:"被撤销命令正在同步中，请稍后再试",INVALIDACTION_EMPTY_CMDJSON:"空协同操作指令，将被忽略",INVALIDACTION_EMPTY_LOCALCMD:"空本地操作指令，将被忽略",INVALIDACTION_INVALID_LOCALCMD:"无效的本地命令",INVALIDACTION_FAILED_COLLABCMD:"协同命令执行失败",INVALIDACTION_FAILED_LOCALCMD:"本地命令执行失败",INVALIDACTION_INVALID_CMD_VERSION:"被撤销命令版本无效，丢弃此命令",INVALIDACTION_INVALID_RANGE:"命令所操作区域已经被删除或者无效",INVALIDACTION_TOO_MANY_CMD:"命令操作过快，请稍候，等待处理命令个数：",INVALIDACTION_TOO_LARGE_MESSAGE:"操作所含数据过多，请减少操作数据：",INVALIDACTION_UNSUPPORTED_CMD:"不支持的操作指令：",INVALIDACTION_WORK_ON_LOCKED_BLOCK:"当前或相邻的段落或目标段落被锁定或删除，请稍后操作",LOADING_IMAGE_PATH:"http://note.youdao.com/editor/collab/loading.gif?47",INSERT_BLANK_CATALOGUE_TEXT:"目录为空，请插入标题（字体左侧）后点击刷新按钮"}}.apply(i,[n,i]))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},,function(t,e,n){var o=n(15);t.exports=function(t){if(!o(t))throw TypeError(t+" is not an object!");return t}},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(209),o=n(0),i=n(2),r=new RegExp("^/yws/res/|^https?://"+e.getNamespace()+"/yws/res"),a=new RegExp("^/yws/api/group|^https?://"+e.getNamespace()+"/yws/api/group"),s={UNKNOWN:-1,WEB_NOTE:1,WEB_GROUP:2,PC:3,IPHONE:4,ANDROID:5,MAC:6},l=window.YNE_PLATFORM||s.UNKNOWN,c=o.keys(s),u={};return s.name=l,o.each(c,function(t){var e=t.toLowerCase(),n=l[t];s["IS_"+t]=l===n||l===e}),l.IS_UNKNOWN&&i.error("The platform is unknown!"),u.isFromWebNote=function(t){return r.test(t)},u.isFromWebGroup=function(t){return a.test(t)},o.extend(s,u),s}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e){var n=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";var a,s=this&&this.__extends||(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});o=[n,r,n(0),n(111),n(27),n(210),n(7),n(2),n(567),n(207),n(32),n(277),n(278)],void 0===(i=function(t,e,n,o,i,r,a,l,c,u,d,p,h){return function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.create=function(t,n){return new e({keepLineBreak:!1!==n,text:t})},e.createBlank=function(t){return e.create("",t)},e.fromCollabJSON=function(t){if(!t||!t.text)return e.createBlank(!0);var o=e.create(t.text,t.keepLineBreak);return n.each(t.inlineStyles,function(t,e){n.each(t,function(t){d.isSupport(e)?o.setStyle(t.from,t.to,e,t.value):o.setUnknownStyle(t.from,t.to,e,t.value)})}),o},e.fromJSON=function(t){if(t&&t.isRichText&&t.data){var o,i=[];return n.each(t.data,function(t){var e=c.fromJSON(t);e&&i.push(e)}),(o=new e({keepLineBreak:t.keepLineBreak,text:""})).appendRichChars(i),o}},e.fromXml=function(t){var n=this,o=$(t),i=new e({text:o.find("text").text()});return o.find("inline-styles").children().each(function(t,e){var n,o,r=e.nodeName.toLowerCase(),s=$(e),l=parseInt(s.find("from").text(),10),c=parseInt(s.find("to").text(),10),p=s.find("value");0!==p.length&&(n=p.text(),d.isSupport(r)?i.setStyle(l,c,r,n):(o=s.attr(a.COMPAT),u.isCompatible(o)&&(h.add(r),n=o+"|"+n,i.setUnknownStyle(l,c,r,n))))}),o.find("entities").children().each(function(t,e){var r=$(e),a={},s=r.find("type").text(),l=parseInt(r.find("start").text(),10);a.type=s,a.start=l,a.inlineStyles=n.getEntityStyles("inline-styles",o),i.appendEntity(a)}),i},e.getEntityStyles=function(t,e){var n={};return $(e).find("entities").children().find(t).children().each(function(t,e){var o=e.nodeName,i=$(e).text();n[o]=i}),n},e.CLONE_DATA=function(t){var e,n=t.length,o=new Array(n);for(e=0;e<n;++e)o[e]=t[e].clone();return o},e.EXTRACT_UNKNOWN_VALUE=function(t){var e=t.indexOf("|");return-1===e?{value:t}:{compat:t.substring(0,e),value:t.substring(e+1)}},e.prototype.append=function(t){t&&t.getClonedData||l.warn("no richText"),this.appendRichChars(t.getClonedData())},e.prototype.appendRichChars=function(t){t&&0!==t.length&&(this.isKeepLineBreak()||(t=this._removeLineBreak(t)),this.richTextProps.data=this.richTextProps.data.concat(t))},e.prototype.clone=function(){var t=new e({keepLineBreak:this.isKeepLineBreak(),text:""});return t.appendRichChars(this.getClonedData()),t},e.prototype.getClonedData=function(){return e.CLONE_DATA(this.richTextProps.data)},e.prototype.getCommonStyle=function(t,e,n,o,i){var r,s,c=this.richTextProps.data,u=null;if(this.isEmpty())return d.getDefault(n);if(t<0)l.warn("start should not be less than 0",t);else if(t>e)l.warn("start should not greater than end",t,e);else{if(!(e>c.length)){if(t===e)0===t&&c[0]?u=c[0].getStyle(n,!1,o):c[t-1]&&(u=c[t-1].getStyle(n,!1,o));else for(r=t;r<e;++r)if(c&&c[r]){if(s=c[r].getStyle(n,!1,o),null===u)u=s;else if(u!==s)return i?null:a.INTERM}else l.warn("unexpected undefine in data",c);return!i||u!==a.INTERM&&u!==d.getDefault(n)?u:null}l.warn("end should not geater than data.length",e,c)}},e.prototype.getCommonStyles=function(t,e,o){var i=this,r={},a=d.getAllConfig();return n.each(a,function(n,a){var s=i.getCommonStyle(t,e,a,o);null!=s&&(r[a]=s)}),r},e.prototype.setEntities=function(t){this.richTextProps.entities=t},e.prototype.getEntities=function(){return this.richTextProps.entities},e.prototype.removeEntitiy=function(t){var e=this;n.each(t,function(t,o){var i=n.findLastIndex(e.richTextProps.entities,{type:o});e.richTextProps.entities.splice(i,1)})},e.prototype.getLength=function(t){var e,n=this.richTextProps.data,o=n.length;if(t)for(e=0;e<n.length;e++)$.trim(n[e].toString())||o--;return o},e.prototype.getReadOnlyData=function(){return this.richTextProps.data},e.prototype.getReadOnlyStylesList=function(t,e,o){var i=this,r=this.richTextProps.data,a=[],s=d.getAllConfig();return t=!1!==t,n.each(r,function(r){var l={};n.each(s,function(n,a){var s;s=o&&!r.getStyle(a,!1)&&i.merStyle(o,a)?i.merStyle(o,a):r.getStyle(a,t,e),(t||!t&&null!=s)&&(l[a]=s)}),a.push(l)}),a},e.prototype.merStyle=function(t,e){var o;return n.each(t,function(t,n){e===n&&(o=t)}),o},e.prototype.getStyle=function(t,e,n,i){var r,a,s,c=this.richTextProps.data;if(o(t>=0),o(t<=e),o(e<=c.length),void 0===t||t<0||void 0===e||t>e||e>c.length)return l.error("unexpected params:",t,e,c.length),null;for(s=new Array(e-t),r=t;r<e;++r)a=c[r].getStyle(n,!1,i),s[r-t]=a;return s},e.prototype.getStyleRanges=function(t,e){if(t){if(e=!0===e,d.isSupport(t))e=!1;else if(!e)return;var o,i,r,a,s=this.richTextProps.data,l=s.length,c=[],u=!1;for(o=0;o<l;o++)i=s[o],(r=e?i.getUnknownStyle(t):i.getStyle(t,!1))?(a=n.last(c),!u&&a&&a.value===r?a.to=o+1:c.push({from:o,to:o+1,value:r}),u=!1):u=!0;return c}},e.prototype.getStylesAtIndex=function(t,e){var n=this.richTextProps.data,o=n.length;if(!(t<0||t>=o))return n[t].getStyles(e);l.warn("invlid index of the text",t,n)},e.prototype.indexOf=function(t,e,n){var o,i,r,a,s,l=t.getReadOnlyData(),c=l.length,u=this.getReadOnlyData(),d=u.length;if(c>d)return-1;for(i=e;i<d;i++){for(o=!0,r=0;r<c;r++){if(a=u[i+r],s=l[r],!a){o=!1;break}if((!0!==n||a.char.toLowerCase()!==s.char.toLowerCase())&&a.char!==s.char){o=!1;break}}if(o)return i}return-1},e.prototype.insert=function(t,e){if(t&&t.getClonedData){var n=this.richTextProps.data,o=n.splice(e),i=t.getClonedData();!1===this.isKeepLineBreak()&&!0===t.isKeepLineBreak()&&(i=this._removeLineBreak(i)),this.richTextProps.data=n.concat(i,o)}},e.prototype.isEmpty=function(){return this.getLength(!1)<=0},e.prototype.isKeepLineBreak=function(){return this.richTextProps.keepLineBreak},e.prototype.removeLineBreak=function(){this.richTextProps.data=this._removeLineBreak(this.richTextProps.data)},e.prototype.removeStyles=function(){var t,e=this.richTextProps.data,n=e.length;for(t=0;t<n;++t)e[t].removeStyles()},e.prototype.appendEntity=function(t){this.richTextProps.entities.push(t)},e.prototype.setKeepLineBreak=function(t){(t=!!t)!==this.richTextProps.keepLineBreak&&(this.richTextProps.keepLineBreak=t,!1===this.richTextProps.keepLineBreak&&this.removeLineBreak())},e.prototype.setStyle=function(t,e,o,i,r){if(o&&null!=i){var a,s=this.richTextProps.data,l=n.isArray(i);for(e=Math.min(e,s.length),a=t;a<e;++a)s[a].setStyle(o,l?i[a-t]:i,r)}},e.prototype.setEntity=function(t){var o=this,i=n.sortBy(o.getEntities(),function(t){return t.start}),r=0;i.forEach(function(n){var i=n.type,a=n.start,s=n.inlineStyles,l=new e({text:t[i]});l.setStyles(0,l.getLength(),s),o.insert(l,a+r),r+=l.getLength()}),o.removeEntitiy(t)},e.prototype.setStyles=function(t,e,o){var i=this;o&&n.each(o,function(n,o){i.setStyle(t,e,o,n)})},e.prototype.setUnknownStyle=function(t,e,o,i){var r,a=this.richTextProps.data,s=n.isArray(i);for(e=Math.min(e,a.length),r=t;r<e;++r)a[r].setUnknownStyle(o,s?i[r-t]:i)},e.prototype.slice=function(t,n,o){var i=this.richTextProps.data.slice(t,n),r=new e({});return!1!==o&&(i=e.CLONE_DATA(i)),r.appendRichChars(i),r},e.prototype.toCollabJSON=function(){return this.toJSON(!0)},e.prototype.toJSON=function(t){return!0===t?this._toSimplifyJSON():{data:n.map(this.richTextProps.data,function(t){return t.toJSON()}),isRichText:!0,keepLineBreak:this.isKeepLineBreak()}},e.prototype.toString=function(){for(var t="",e=this.richTextProps.data,n=0,o=e.length;n<o;n++)t+=e[n];return t},e.prototype.toXml=function(t){var e,o=this,i=t.createElement("inline-styles"),r=d.getAllConfig();return n.each(r,function(e,n){var r=o.getStyleRanges(n,!1);o._handleStyleRangesForXML(t,i,n,r,!1)}),e=h.get(),n.each(e,function(e){var n=o.getStyleRanges(e,!0);o._handleStyleRangesForXML(t,i,e,n,!0)}),i},e.prototype.initialize=function(t){var e=this;this.richTextProps=n.clone(t),this.richTextProps=n.defaults(this.richTextProps||{},{keepLineBreak:!0,text:""}),this.richTextProps.data=[],this.richTextProps.entities=[],this.richTextProps.text=r.clear(this.richTextProps.text),this.richTextProps.keepLineBreak||(this.richTextProps.text=this.richTextProps.text.replace(/[\r\n]/g,"")),n.each(p(this.richTextProps.text),function(t){e.richTextProps.data.push(new c(t))})},e.prototype._handleStyleRangesForXML=function(t,o,i,r,s){r&&r.length&&n.each(r,function(n){if(n&&n.value){var r,l,c,u=t.createElement(i),d=t.createElement("from"),p=t.createElement("to"),h=t.createElement("value");d.appendChild(t.createTextNode(n.from)),u.appendChild(d),p.appendChild(t.createTextNode(n.to)),u.appendChild(p),s?((c=(r=e.EXTRACT_UNKNOWN_VALUE(n.value)).compat)&&u.setAttribute(a.COMPAT,c),l=r.value):l=n.value,h.appendChild(t.createTextNode(l)),u.appendChild(h),o.appendChild(u)}})},e.prototype._handleStyleRangesForJSON=function(t,o,i,r){i&&i.length&&n.each(i,function(n){if(n&&n.value){var i,a=t[o];a||(a=t[o]=[]),i=r?e.EXTRACT_UNKNOWN_VALUE(n.value).value:n.value,a.push({from:n.from,to:n.to,value:i})}})},e.prototype._removeLineBreak=function(t){return t&&0!==t.length?t=n.filter(t,function(t){return!1===t.isLineBreak()}):[]},e.prototype._toSimplifyJSON=function(){var t,e,o=this,i={},r=d.getAllConfig();return n.each(r,function(t,e){var n=o.getStyleRanges(e,!1);o._handleStyleRangesForJSON(i,e,n,!1)}),t=h.get(),n.each(t,function(t){var e=o.getStyleRanges(t,!0);o._handleStyleRangesForJSON(i,t,e,!0)}),e={keepLineBreak:o.isKeepLineBreak(),text:o.toString()},n.isEmpty(i)||(e.inlineStyles=i),e},e}(i)}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e,o=n(0),i=n(297),r=n(4),a=n(2),s=n(21),l=n(101),c=n(3);return e=i.extend({name:"UnknownCompositeCommand",_args:null,_cmds:null,_affectedBlockIds:null,_note:null,isSimple:!1,startingRange:null,endingRange:null,effected:!1,isLocalExecutedCmd:null,finalNoteVersion:null,originalNoteVersion:null,skipBlockLocking:!1,isOriginalCmd:!1,sendingToCollabServerMillis:null,isReadyToApply:null,initialize:function(){var t;this._args=this.options.args||{},this._args.collabProperties=this._args.collabProperties||{},t=this._args.collabProperties,this._cmds=[],this._affectedBlockIds=[],e.__super__.initialize.apply(this),!0===t.isCollabEnabled&&(t.isCollabCmd&&(this.finalNoteVersion=t.finalNoteVersion),this._initializeAffectedBlocks(),this.rangeIsRequired=!0,this.isReadyToApply=!0,this._args.isOriginalCmd&&(this.isOriginalCmd=!0))},finilize:function(){},_applyCommandToComposite:function(t,e){var n,o=this._cmds;o||(o=this._cmds=[]),n=t.apply(),t.isSimple?this.effected=!1!==n:(this.effected=this.effected||t.effected,this._affectedBlockIds||a.error("_affectedBlockIds cannot be null. please check the cmd("+this.name+") initialize has invoked its parent method")),e?this.setEndingRange(e):!t.isSimple&&t.getEndingRange()&&this.setEndingRange(t.getEndingRange()),o.push(t)},apply:function(){throw"Method not implemented."},doReapply:function(t){var e,n,o=this._cmds;if(a.log("doReapply(): `"+this.name+"`"),r.isCollabCommand(t))return this._reapplyCollabCmd(t);if(!o||!o.length)return a.warn("doReapply(): the composite command `"+this.name+"`no _cmds"),!0;for(e=o.length,n=0;n<e;++n)o[n].doReapply(t);return!0},doUnapply:function(t){var e,n=this._cmds;if(r.isCollabCommand(t))return this._unapplyCollabCmd(t);if(!n||!n.length)return a.warn("doUnapply(): the composite command `"+this.name+"`no _cmds"),!0;for(e=n.length-1;e>=0;--e)n[e].doUnapply(t);return!0},setStartingRange:function(t){s.isNoteRange(t)?(this.startingRange=t,this.options.args.range=this.startingRange):a.warn("noteRange is not a NoteRange",t)},setEndingRange:function(t){var e;s.isNoteRange(t)?(this.endingRange=t,e=this._getAffectedBlockIdsFromRange(this.options.note,this.endingRange),this.pushAffectedBlockIds(e)):a.warn("noteRange is not a NoteRange",t)},getStartingRange:function(){return this.startingRange},getEndingRange:function(){return this.endingRange},canBeMerged:function(t){return!!o.contains(["comp.KeyTextInput"],this.name)&&(!this.isCollabUndo&&!this.isCollabRedo&&t.name===this.name&&t.getCmdId()!==this.getCmdId()&&t.isLocalExecutedCmd===this.isLocalExecutedCmd)},executeAtomicCommand:function(t,e){this._applyCommandToComposite(t,e)},fromCollabJSON:function(){var t=this.options.args,n=t.collabProperties.cmdJSON,o=t.collabProperties.coreEditor;e.__super__.fromCollabJSON.apply(this),n&&(n.startNoteRange&&(t.range=l.buildNoteRangeFromJSON(n.startNoteRange,o),t.range?this.setStartingRange(t.range):a.warn("Failed to re-build the startNoteRange",n.startNoteRange)),n.endNoteRange&&(t.endRange=l.buildNoteRangeFromJSON(n.endNoteRange,o),t.endRange&&this.setEndingRange(t.endRange)),n.cmdNoteVersion&&(this.originalNoteVersion=n.cmdNoteVersion),this.skipBlockLocking=n.skipBlockLocking)},getAffectedBlockIds:function(){return o.clone(this._affectedBlockIds)},getCmdFinalNoteVersion:function(){return this.finalNoteVersion},getCmdOriginalNoteVersion:function(){return this.originalNoteVersion},getCollabProps:function(){return this._args.collabProperties},getLockedBlockIds:function(){var t=[],e=this.endingRange;return this.isCollabUndo?e=this.startingRange:this.skipBlockLocking&&(e=null),s.isNoteRange(e)?t.push(e.getEndBlockRange().getBlockId()):e&&a.error("locked targetRange should be a NOTE range",e),t},getIgnoreUndoRedo:function(){return this._args.ignoreUndoRedo},isSingleBlockAffected:function(){var t=!0;return this._args.range?s.isNoteRange(this._args.range)&&this._args.range.isInMultiBlock()&&(t=!1):t=!1,t},isValidStartNoteRange:function(){return!0},mergeLocalCmd:function(t){a.log("targetCmd:",t)},pushAffectedBlockIds:function(t){t&&(this._affectedBlockIds=o.union(this._affectedBlockIds,t))},resetAffectedBlockIds:function(t){this._affectedBlockIds=[],this.pushAffectedBlockIds(t)},setCmdFinalNoteVersion:function(t){this.finalNoteVersion=t},setCmdOriginalNoteVersion:function(t){this.originalNoteVersion=t},setIgnoreUndoRedo:function(t){this._args.ignoreUndoRedo=t},toCollabJSON:function(){var t,n=this,i=e.__super__.toCollabJSON.apply(n),l=[],c=n.getStartingRange(),u=!1;if(n.isOriginalCmd)if(s.isNoteRange(c))i.startNoteRange=c.toCollabJSON();else if(n.rangeIsRequired)return a.error("startingRange should be noteRange",c),null;if(n.isCollabUndo&&(i.isCollabUndo=n.isCollabUndo),n.isCollabRedo&&(i.isCollabRedo=n.isCollabRedo),n.originalNoteVersion&&(i.cmdNoteVersion=n.originalNoteVersion),n.isCollabUndo||n.isCollabRedo){if(n.cmdId=r.newGUID(),i.cmdId=n.cmdId,n.isOriginalCmd)if(s.isNoteRange(n.endingRange))i.endNoteRange=n.endingRange.toCollabJSON();else if(n.rangeIsRequired)return a.error("endingRange should be a noteRange:",n.endingRange),null;o.each(n._cmds,function(e){u||(e.rangeIsRequired=!1,n.isCollabUndo?(e.setCollabRedo(!1),e.setCollabUndo(!0)):(e.setCollabRedo(!0),e.setCollabUndo(!1)),(t=e.toCollabJSON())?l.push(t):(u=!0,a.error("Failed to get cmdJSON",e)))}),i.affectedBlockIds=n._affectedBlockIds.join(",")}return u?null:(l.length>0&&(i.innerCmds=l),n.isLocalExecutedCmd&&(i.isLocalExecutedCmd=!0),i.skipBlockLocking=n.skipBlockLocking,i)},_getAffectedBlockIdsFromRange:function(t,e){var n=[],i=[];if(t&&e){switch(e.getType()){case s.TYPE:n=t.getInterBlocks(e.getStartBlockRange().block,e.getEndBlockRange().block,!0);break;case c.PARAGRAPH:e.block&&n.push(e.block);break;default:a.error("pending supported range type:"+e.getType())}n&&n.length>0&&o.each(n,function(t){i.push(t.getId())})}return i},_initializeAffectedBlocks:function(){var t=[],e=this.options.note,n=this._args.range;n&&(t=this._getAffectedBlockIdsFromRange(e,n),this.pushAffectedBlockIds(t))},_reapplyCollabCmd:function(t){var e=t.collabProperties.cmdJSON;if(e&&e.innerCmds){var n,o=e.innerCmds,i=o.length;for(n=0;n<i;++n){var r=t.collabProperties.coreEditor.buildInnerCommandFromJSON(o[n],t);r&&(r.doReapply(r._args),r.isSimple&&(t.collabProperties.redoUndoEffected=!0))}}},_unapplyCollabCmd:function(t){var e=t.collabProperties.cmdJSON;if(e&&e.innerCmds){var n,o=e.innerCmds;for(n=o.length-1;n>=0;--n){var i=t.collabProperties.coreEditor.buildInnerCommandFromJSON(o[n],t);i&&(i.doUnapply(i._args),i.isSimple&&(t.collabProperties.redoUndoEffected=!0))}}}})}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,e){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(101),o=n(44),i=n(3),r=n(164),a=n(32),s=n(208),l=n(0),c=n(12),u=n(2),d=n(28),p=n(63),h=n(128),f=n(97),g=n(80),m=n(165),y=n(82),v=n(83),_=n(169),b=n(34),C=n(33),k=n(102),w=n(226),S=n(227),x=n(298),E=n(171),I=n(228),T=n(7),O=n(21),A=n(118),N=n(73);return{createNewListItem:function(t,e,n){var o=new p({id:e,level:t.getLevel(),list:t.getOwnerList(),text:n});return o.setBlockStyles(t.getBlockStyles()),o},createNewParagraph:function(t,e,n,o){var r=new d({blockId:e,text:o?new c({text:n.toString()}):n});return!t||i.isHeading(t)||i.isCatalogue(t)?t&&(r.setBlockStyle("back-color",t.getBlockStyle("back-color")),r.setBlockStyle("padding",t.getBlockStyle("padding"))):r.setBlockStyles(t.getBlockStyles()),r},createNewTodo:function(t,e){var n=new g(e);return t&&n.setBlockStyles(t.getBlockStyles()),n},createNewCode:function(t,e){var n=new y(e);return t&&n.setBlockStyles(t.getBlockStyles()),n},convertCodeToPara:function(t){var e=this,n=t;return i.isCode(t)&&(n=t.toCodeLines().map(function(n){return e.createNewParagraph(t,null,n)})).forEach(function(e){e.setBlockStyles(t.getBlockStyles())}),n},createNewQuote:function(t,e){var n=new m(e);return t&&n.setBlockStyles(t.getBlockStyles()),n},createNewHeading:function(t,e,n,o,r){var a,l;return n.getLength&&!r&&(l=n.getLength(),i.isHeading(t)&&"b"===t.getLevel()&&(n=this._clearHeadingInlineStyle("color",t,n)),n.setStyles(0,l,s.headingInlineStyles[o])),(a=new h({id:e,text:n,level:o})).setBlockStyles(t.getBlockStyles()),s.headingBlockStyles[o]&&!r&&a.setBlockStyles(s.headingBlockStyles[o]),a},_clearHeadingInlineStyle:function(t,e,n){var o,i=e.getLevel(),r=s.headingInlineStyles[i][t];for(o=0;o<n.getLength();o++)r===n.getStylesAtIndex(o)[t]&&delete n.richTextProps.data[o].styles[t];return n},createNewCatalogue:function(t,e){var n=new f(e);return!e.ownerList&&i.isCatalogue(t)&&(e.ownerList=t.getOwnerList()),n=new f(e),t&&n.setBlockStyles(t.getBlockStyles()),n},isForCatalogueBlock:function(t){return i.isHeading(t)&&t.getLevel()<4&&!t.isEmpty()&&t.getText().toString().trim()},deleteSelectedContent:function(t,e,n){var o,r,a,s,l;O.isNoteRange(n)?(o=n.getStartBlockRange(),a=n.getEndBlockRange(),r=o.block,s=a.block,i.isTextBlock(r)&&(i.isCode(r)?o.selectWholeBlock?t.executeAtomicCommand(new b({note:e,blocks:[r]})):t.executeAtomicCommand(new _({block:r,startBlockRange:o,endBlockRange:a})):t.executeAtomicCommand(new v({block:r,start:o.start,end:o.end}))),n.isInMultiBlock()&&((l=e.getInterBlocks(r,s))&&l.length>0&&t.executeAtomicCommand(new b({note:e,blocks:l})),i.isTextBlock(s)&&(i.isCode(s)?t.executeAtomicCommand(new _({block:s,startBlockRange:o,endBlockRange:a})):t.executeAtomicCommand(new v({block:s,start:a.start,end:a.end}))))):u.error("deleteSelectedContent: selectedNoteRange should be a NoteRange",n)},getBackwardBlockRange:function(t,e){var n=t.getPreBlock(e);if(n)return o.createRangeByBlock({block:n,allContent:!1,collapseToStart:!1})},getForwardBlockRange:function(t,e){var n=t.getNextBlock(e);if(n)return o.createRangeByBlock({block:n,allContent:!1,collapseToStart:!0})},getNoteView:function(t){return t._cmdArgs.collabProperties.coreEditor.noteView},insertTabChar:function(t,e,n,o){var i;(i=new c({text:"\t"})).setStyles(0,i.getLength(),o),t.executeAtomicCommand(new k({block:e,start:n,text:i}))},isInSameList:function(t){var e,n=!1;return i.isListItem(t[0])?n=l.every(t,function(t,n){if(i.isListItem(t)){if(0===n)return e=t.getOwnerList(),!0;if(t.getOwnerList()===e)return!0}return!1}):n},recogLink:function(t,e,n,o){var i,a,s={color:"#003884",underline:!0};i=e.getText().toString().slice(n,o);for(var l=o-1;l>=n;l--)if(e.getTextStyle("href",l,l+1)[0]){n=l;break}i=i.slice(n,o),(a=r.matchEnd(i))&&a.result&&(s.href=a.fullURI,t.executeAtomicCommand(new w({blocks:[e],styleNameValues:s,start:n+a.result.index,end:o})))},replaceBlockWithListItem:function(t,e,n,o,i,r){var a,s=o.getId();return t.executeAtomicCommand(new b({note:e,blocks:[o]})),a=this.createNewListItem(n,s,i),t.executeAtomicCommand(new C({note:e,newBlks:[a],preBlk:r})),a},replaceBlockWithParagraph:function(t,e,n,o,i,r){var a,s=n.getId(),l=e.getPreBlock(n);return(a=this.createNewParagraph(n,s,o,r)).setInlineStylesForEmpty(i),t.executeAtomicCommand(new b({note:e,blocks:[n]})),t.executeAtomicCommand(new C({note:e,newBlks:[a],preBlk:l})),a},replaceBlockWithHeading:function(t,e,n,o,i){var r,a=n.getId(),s=e.getPreBlock(n);return r=this.createNewHeading(n,a,o,i),t.executeAtomicCommand(new b({note:e,blocks:[n]})),t.executeAtomicCommand(new C({note:e,newBlks:[r],preBlk:s})),r},deleteHref:function(t,e,n,o){t.executeAtomicCommand(new w({blocks:[e],styleNameValues:{href:"",color:"#393939",underline:!1},start:n,end:o}))},resetAllStyles:function(t,e,n,o,i,r){this.setStylesOnNoteRange(t,e,n,o,i,r)},setNonTextBlockAsEndingRange:function(t,n){var o=e.buildNoteRangeFromNonTextBlock(n);t.setEndingRange(o)},setBlockStyle:function(t,e){t&&t.setInlineStylesForEmpty&&t.isEmpty()&&t.setInlineStylesForEmpty(e)},setResourceBlockStyleByPreBlock:function(t,e){t&&e&&(t.setBlockStyle("back-color",e.getBlockStyle("back-color")),t.setBlockStyle("padding",e.getBlockStyle("padding")))},setStylesOnNoteRange:function(t,e,n,o,r,s){var c,u=this,d=n.getStartBlockRange(),p=d.block,h=n.getEndBlockRange(),f=h.block,g=[],m=[],y=[],v=[],_=!!s&&s.resetAllStyles,b=!!s&&s.isRemoveFormat;return(void 0===o&&void 0===r||_)&&(c=!0,r||(r=a.getAllDefault(["href"]))),o=o||{},r=r||{},u._isFullSelected(d)?m.push(p):(c&&(o=p.getDefaultBlockStyles()),b||u._setBlocksBlockStyles(t,[p],o)),n.isInMultiBlock()&&(g=e.getInterBlocks(p,f),m=l.union(m,g),u._isFullSelected(h)?m.push(f):(c&&(o=f.getDefaultBlockStyles()),b||u._setBlocksBlockStyles(t,[f],o))),l.each(m,function(e){c&&(o=e.getDefaultBlockStyles()),u._setBlocksBlockStyles(t,[e],o),i.isTextBlock(e)&&y.push(e),i.isTable(e)&&v.push(e)}),l.isEmpty(r)||(i.isTextBlock(p)&&!u._isFullSelected(d)&&t.executeAtomicCommand(new w({blocks:[p],styleNameValues:c&&i.isHeading(p)?p.getDefaultInlineStyles():r,start:d.start,end:d.end})),n.isInMultiBlock()&&i.isTextBlock(f)&&!u._isFullSelected(h)&&t.executeAtomicCommand(new w({blocks:[f],styleNameValues:c&&i.isHeading(f)?f.getDefaultInlineStyles():r,start:h.start,end:h.end})),m.length>0&&(y=u._filterHeadingBlock(t,y,r,c),t.executeAtomicCommand(new w({blocks:y,styleNameValues:r,fullText:!0})))),this._filterTableBlocks({isStyleReset:c,startBlockRange:d,endBlockRange:h,noteRange:n,fullSelectedTableBlocks:v,inlineStyles:r,blockStyles:o,targetCmd:t})},_filterHeadingBlock:function(t,e,n,o){if(!o)return e;var r=e.filter(function(t){if(!i.isHeading(t))return t}),a=e.filter(function(t){if(i.isHeading(t))return t});return a.length>0&&a.forEach(function(e){t.executeAtomicCommand(new w({blocks:[e],styleNameValues:e.getDefaultInlineStyles(),fullText:!0}))}),r},_filterTableBlocks:function(t){var e=this,n=t.startBlockRange,o=t.endBlockRange,r=t.noteRange,a=t.fullSelectedTableBlocks,s=t.inlineStyles,c=t.blockStyles,u=t.targetCmd,d=n.block,p=o.block;n.isOnCellEdit&&n.isOnCellEdit()||e._adaptTableStylesInlineToBlock(s,c,t.isStyleReset),l.isEmpty(s)||(i.isTable(d)&&e._setTableCellInlineStyles({table:d,range:n,styles:s,cmd:u}),r.isInMultiBlock()&&i.isTable(p)&&e._setTableCellInlineStyles({table:p,range:o,styles:s,cmd:u}),a.forEach(function(t){e._setTableCellInlineStyles({table:t,styles:s,isAll:!0,cmd:u})})),l.isEmpty(c)||(i.isTable(d)&&e._setTableCellBlockStyles({table:d,range:n,styles:c,cmd:u}),r.isInMultiBlock()&&i.isTable(p)&&e._setTableCellBlockStyles({table:p,range:o,styles:c,cmd:u}),a.forEach(function(t){e._setTableCellBlockStyles({table:t,isAll:!0,styles:c,cmd:u})}))},_adaptTableStylesInlineToBlock:function(t,e,n){!l.isEmpty(t)&&t["back-color"]&&(e.backColor=t["back-color"],n||delete t["back-color"])},_setTableCellInlineStyles:function(t){var e,n,o=t.isAll,i=t.range,r=t.cmd,a=o?N.TYPES.ALL:N.TYPES.NORMAL;i?e=i.getAsRectRange():a===N.TYPES.ALL&&(e=(i=N.create({block:t.table,type:N.TYPES.ALL})).getAsRectRange()),n=e?e.getRect():null,r.executeAtomicCommand(new x({table:t.table,styles:t.styles,type:a,rect:n}))},_setTableCellBlockStyles:function(t){var e=t.isAll,n=t.range?t.range:N.create({block:t.table,type:N.TYPES.ALL}),o=t.cmd,i=n.getAsRectRange(),r=e?N.ALL:N.NORMAL,a=n&&i?i.getRect():null;o.executeAtomicCommand(new E({table:t.table,styles:t.styles,type:r,rect:a}))},setTextBlockAsEndingRange:function(t,n,o,i){var r=e.buildNoteRangeFromParagraph(n,o,i);t.setEndingRange(r)},setCodeBlockAsEndingRange:function(t,e,n,o){var i=A.createNewRange({preCodeRange:e,charOffset:n,lineOffset:o}),r=O.create({endRange:i,startRange:i});t.setEndingRange(r)},expandCodeRange:function(t,e,n,o){var i=A.createNewRange({preCodeRange:e,charOffset:n,lineOffset:o,needCollapse:!1}),r=O.create({endRange:i,startRange:i});return t.setEndingRange(r),i},updateBlocksIndentLevel:function(t,e,n){var o,i,r={},a={};l.each(e,function(t){o=t.getBlockStyle("indent"),!l.isNumber(o)||0===o&&n<0||(i=parseInt(t.getBlockStyle("text-indent"),10)||0,o=o<0?0:o+n,o=Math.min(o,T.MAX_LIST_ITEM_LEVEL-i),r[o]||(r[o]=[]),r[o].push(t))}),l.each(r,function(e,n){a.indent=n,t.executeAtomicCommand(new S({blocks:e,styleNameValues:a}))})},updateBlockTextIndentLevel:function(t,e,n){var o,i,r;o=e.getBlockStyle("text-indent"),r=parseInt(e.getBlockStyle("indent"),10)||0,o||(o=0),i=o+n,(i=Math.min(i,T.MAX_LIST_ITEM_LEVEL-r))>=0&&t.executeAtomicCommand(new S({blocks:[e],styleNameValues:{"text-indent":i}}))},_isFullSelected:function(t){var e=t.block;return i.isTextBlock(e)?0===t.start&&t.end===e.getLength()||void 0:!i.isTable(e)||t.isFullSelected()},_setBlocksBlockStyles:function(t,e,n){l.isEmpty(n)||t.executeAtomicCommand(new S({blocks:e,styleNameValues:n}))},fixMergeCellBeforeRowColChange:function(t){t.isCol?this._fixMergeCellColChange(t):this._fixMergeCellRowChange(t)},_fixMergeCellRowChange:function(t){var e,n,o,i,r=t.table,a=t.isCol,s=t.insertData,l=t.isDelete,c=t.index,d=r.getCells();if(d[c])for(n=0;n<d[c].length;n++)if((e=r.getCell(c,n))&&(e.isMergePoint()&&l&&(i=this._fixMergePointCellWhenDel({cell:e,row:c,col:n,table:r,isCol:a,cmd:t.cmd})),e.isMergedCell())){if((o=this._findMergePointCell({cell:e,row:c,col:n,table:r})).row===c)continue;if((i=this._fixMergePointWithMergeCell({pointCellInfo:o,table:r,isCol:a,isDelete:l,insertData:s,cmd:t.cmd,cellInfo:{row:c,col:n}})).col<n)return void u.error("New index should more then i");n=i.col}},_fixMergeCellColChange:function(t){var e,n,o,i,r=t.table,a=t.isCol,s=t.insertData,l=t.isDelete,c=t.index,d=r.getCells();for(n=0;n<d.length;n++)if((e=r.getCell(n,c))&&(e.isMergePoint()&&l&&(n=(i=this._fixMergePointCellWhenDel({cell:e,row:n,col:c,table:r,isCol:a,cmd:t.cmd})).row),e.isMergedCell())){if((o=this._findMergePointCell({cell:e,row:n,col:c,table:r})).col===c)continue;if((i=this._fixMergePointWithMergeCell({pointCellInfo:o,table:r,isCol:a,isDelete:l,insertData:s,cmd:t.cmd,cellInfo:{row:n,col:c}})).row<n)return void u.error("New index should more then i");n=i.row}},_findMergePointCell:function(t){var e=t.row,n=t.col;return t.table.getCell(e,n,{findMergePointIfNeeded:!0,withPosition:!0})},_fixMergePointWithMergeCell:function(t){var e,n,o,i=t.table,r=t.pointCellInfo,a=t.cellInfo,s=t.isDelete,l=t.isCol,c=t.cmd,u=t.insertData,d=r.cell,p=r.row,h=r.col,f=d.getMergePointAttr(),g=a.row,m=a.col,y=0,v=0;for(s?l?y=-1:v=-1:l?y=1:v=1,c.executeAtomicCommand(new I({table:i,type:I.TYPES.POINT,value:{width:f.width+y,height:f.height+v,fireChange:!1},rect:{row:p,col:h}})),e=g;e<p+f.height;e++)for(n=m;n<h+f.width;n++)o=i.getCell(e,n).getMergedCellAttr(),n===m&&!s&&l&&u[e]&&u[e].setMergedCellAttr(o.dx,o.dy),e!==g||s||l||!u[n]||u[n].setMergedCellAttr(o.dx,o.dy),c.executeAtomicCommand(new I({table:i,type:I.TYPES.CELL,value:{dx:o.dx+y,dy:o.dy+v,fireChange:!1},rect:{row:e,col:n}}));return{row:p+f.height-1,col:h+f.width-1}},_fixMergePointCellWhenDel:function(t){var e,n,o,i,r=t.cell,a=t.row,s=t.col,l=t.table,c=t.isCol,u=t.cmd,d=r.getMergePointAttr(),p=0,h=0;for(c?h=1:p=1,e=a+p;e<a+d.height;e++)for(n=s+h;n<s+d.width;n++)(o=l.getCell(e,n))&&(e!==a+p||n!==s+h?(i=o.getMergedCellAttr(),u.executeAtomicCommand(new I({table:l,type:I.TYPES.CELL,value:{dx:i.dx-h,dy:i.dy-p},rect:{row:e,col:n}}))):u.executeAtomicCommand(new I({table:l,type:I.TYPES.POINT,value:{width:d.width-h,height:d.height-p},rect:{row:e,col:n}})));return{row:a+d.height-1,col:s+d.width-1}}}}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o=n(123)("wks"),i=n(86),r=n(11).Symbol,a="function"==typeof r;(t.exports=function(t){return o[t]||(o[t]=a&&r[t]||(a?r:i)("Symbol."+t))}).store=o},function(t,e,n){var o=n(48),i=Math.min;t.exports=function(t){return t>0?i(o(t),9007199254740991):0}},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";o=[n,r,n(2)],void 0===(i=function(t,e,n){return function(){function t(){}return t.getTemplate=function(t,e){var o=t+"/"+e,i=(this&&this.JST?this:window).JST[o];if(!i){if(n.DEBUG)throw new Error("JST has no template: "+o);n.error("JST has no template: "+o)}return i},t.render=function(t,e,o){var i=this.getTemplate(t,e);if(i)return i(o);n.error("no tempalte: "+t+"/"+e+".jst","template/jst.js")},t.trimTempalte=function(t){if(t=t||""){var e,n,o=t.split(/[\r\n]/),i=o.length;for(e=0;e<i;e++)n=(n=o[e]||"").trim(),o[e]=n;return o.join("")}},t}()}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";var a,s=this&&this.__extends||(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});o=[n,r,n(0),n(26),n(2),n(7)],void 0===(i=function(t,e,n,o,i,r){return function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.prototype.checkStatus=function(t,o){this.resetStatus(),!1===this.queryAction(t,o)&&(this.isDisabled=this.isHidden=!0),this.isHidden||this.type===e.TYPE.SUBMENU&&(n.invoke(this.items,"checkStatus",t,o),this.isDisabled=0===this.items.filter(function(t){return!t.isHidden&&!t.isDisabled}).length)},e.prototype.onSelected=function(){this.keyHandlerName?this.editor.getController().execKeyHandler(this.keyHandlerName):this.selectAction()},e.prototype.queryAction=function(t,e){i.error("The queryAction() of "+this.name+" should be implemented by options!")},e.prototype.reset=function(){this.resetStatus()},e.prototype.select=function(){this.onSelected()},e.prototype.selectAction=function(){i.error("The selectAction() of "+this.name+" should be implemented by options!")},e.prototype.simplify=function(){var t={index:this.index,type:this.type,isDisabled:this.isDisabled,isHidden:this.isHidden,isDefault:this.isDefault,label:this.label,key:this._getKey()};return this.items&&this.items.length&&(t.items=n.map(this.items,function(t){if(t&&t.simplify)return t.simplify()})),t},e.prototype.initialize=function(t){t=t||{},this.name=t.name,this.label=t.label,this.type=t.type||e.TYPE.ITEM,this.isDefault=!!t.isDefault,this.isDisabled=!!t.isDisabled,this.isHidden=!!t.isHidden,this.key=t.key||"",this.keyHandlerName=t.keyHandlerName||"",this.items=t.items,null!=t.queryAction&&(this.queryAction=t.queryAction),null!=t.selectAction&&(this.selectAction=t.selectAction)},e.prototype.resetStatus=function(){this.isDefault=!1,this.isDisabled=!1,this.isHidden=!1},e.prototype._getKey=function(){var t=this.key||"",o=this.editor.getController().keyHandlerManager;return this.keyHandlerName&&o&&(t=o.getKey(this.keyHandlerName)),t?(t=t.replace(/[\s\uFEFF\xA0]/g,""))?(t=(t=t.toLowerCase()).replace(/mod/,e.MOD),r.IS_MAC&&n.each({meta:"⌘",ctrl:"⌃",alt:"⌥",shift:"⇧"},function(e,n){t=t.replace(n,e)}),t=(t=t.replace(/^([a-z])/g,function(t,e){return e.toUpperCase()})).replace(/\+([a-z])/g,function(t,e){return"+"+e.toUpperCase()})):"":(i.warn("no key for ContextMenuItem: "+this.name),"")},e.TYPE={ITEM:0,SUBMENU:1,SPLIT:2},e.MOD=r.IS_MAC?"meta":"ctrl",e}(o)}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";var a,s=this&&this.__extends||(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});o=[n,r,n(0),n(28),n(166),n(64),n(10),n(26),n(2),n(7),n(3),n(606)],void 0===(i=function(t,e,n,o,i,r,a,l,c,u,d,p){return function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.create=function(t){if(t&&t.startRange&&t.endRange)return new e(t);c.warn("options is unvalid!")},e.createForHeaderFooter=function(t){return new e({blockRanges:[new i({block:t})]})},e.createMock=function(){var t={},n=new o({}),i=new r({block:n,end:0,start:0});return t.startRange=i,t.endRange=t.startRange,new e(t)},e.fromCollabJSON=function(t,n){var o=null;if(t){var i=t.startBlockRange,r=t.endBlockRange,a={};a.startRange=n.buildBlockRangeFromJSON(i),t.isInSingleBlock?a.endRange=a.startRange:a.endRange=n.buildBlockRangeFromJSON(r),a.startRange&&a.endRange&&(o=e.create(a))}return o},e.fromNativeRange=function(t,o){if(t){if(t instanceof e)return t;var i=o.parseNativeRange(t);if(i&&i.length)return new e({endRange:n.last(i),startRange:n.first(i)});c.warn("Failed to parse native range to note range!")}else c.warn("no range")},e.isNoteRange=function(t){var n=!1;return t&&t.type===e.TYPE&&t.getStartBlockRange()&&t.getEndBlockRange()&&(n=!0),n},e.isValidType=function(t){return t===e.DATA_TYPES.JSON||t===e.DATA_TYPES.HTML||t===e.DATA_TYPES.PLAIN},e._getMethodName=function(t){var n="";switch(t){case e.DATA_TYPES.JSON:n="JSON";break;case e.DATA_TYPES.HTML:n="Html";break;case e.DATA_TYPES.PLAIN:n="Plain"}return n},e.getBlockRangeMethodName=function(t){var n=e._getMethodName(t);if(n)return"getDataAs"+n},e.prototype.canDrawedByNative=function(){return!this.isInSingleBlock()||this.getStartBlockRange().canDrawedByNative()},e.prototype.clone=function(t){var n,o;return!1===t?(n=this.startRange,o=this.endRange):(n=this.startRange.clone(),o=this.isInSingleBlock()?n:this.endRange.clone()),e.create({startRange:n,endRange:o})},e.prototype.collapse=function(t){var e=!1===t?this.getEndBlockRange():this.getStartBlockRange();e&&e.collapse?(e.collapse(t),this.startRange=e,this.endRange=e):c.warn("There is no blockRange or blockRange has no `collapse` method")},e.prototype.createWalker=function(t,e){return p.create(this,t,e)},e.prototype.getStartBlockRange=function(){return this.startRange},e.prototype.getEndBlockRange=function(){return this.endRange},e.prototype.getDataAsHtml=function(t){var e=this.startRange;return this._isSingleNotFullSelectedLI()?e.block.toHtml(e.start,e.end):t.toHtml(this)},e.prototype.getDataAsJSON=function(t,n){var o=this._getDataWithType(t,e.DATA_TYPES.JSON,n);return o=o||[],JSON.stringify(o)},e.prototype.getDataAsPlain=function(t,n){var o=this._getDataWithType(t,e.DATA_TYPES.PLAIN,n),i="";return o&&o.length&&(i=o.join(u.LINE_BREAK)),i},e.prototype.getDataWithType=function(t,e,n){return this._getDataWithType(t,e,n)},e.prototype.getType=function(){return this.type},e.prototype.isCollapsed=function(){return!(!this.startRange||!this.isInSingleBlock())&&this.startRange.isCollapsed()},e.prototype.isInSingleBlock=function(){return this.startRange===this.endRange},e.prototype.isInMultiBlock=function(){return!this.isInSingleBlock()},e.prototype.isMatchBlockTypes=function(t,e){if(!t)return c.warn("The param note does not exist!"),!1;var n,o,i,r=this.startRange.block,a=this.endRange.block,s=t.getBlockIndex(r),l=t.getBlockIndex(a);if(-1===s||-1===l)return c.warn("startIndex or endIndex is -1!"),!1;for(n=t.getAllBlocks(),o=s;o<=l;o++)if(i=d.getType(n[o]),-1===e.indexOf(i))return!1;return!0},e.prototype.isSingleTableSelected=function(){var t=this.startRange;return!(!this.isInSingleBlock()||!d.isTable(t.block))},e.prototype.setBlockRanges=function(t){this.startRange=n.first(t),this.endRange=n.last(t),this._checkValid()},e.prototype.toCollabJSON=function(t){var e={};return e.startBlockRange=this.startRange.toCollabJSON(t),this.isInSingleBlock()?e.isInSingleBlock=!0:(e.isInSingleBlock=!1,e.endBlockRange=this.endRange.toCollabJSON(t)),e},e.prototype.toNativeRange=function(t){var e,n,o;if(this.canDrawedByNative())if(e=this.getStartBlockRange().toNativeRange(t)){if(this.isInSingleBlock())return e;if(n=this.getEndBlockRange().toNativeRange(t))return(o=document.createRange()).setStart(e.startContainer,e.startOffset),o.setEnd(n.endContainer,n.endOffset),o;c.warn("no native range for end block!")}else c.warn("no native range for start block!")},e.prototype.initialize=function(t){t=t||{},delete this.options,this.type="note",t.startRange||t.endRange||!t.blockRanges?this.setBlockRanges([t.startRange,t.endRange]):this.setBlockRanges(t.blockRanges)},e.prototype._checkValid=function(){var t=this.startRange,e=this.endRange;if(!t||!e)throw new Error("starRange or endRange is not valid!");if(!t.block||!e.block)throw new Error("starRange.block or endRange.block is not valid!");if(t.block===e.block&&t!==e)throw new Error("startRange and endRange should be the same object when startRange.block === endRange.block")},e.prototype._getDataWithType=function(t,n,o){if(t&&t.getBlockAt){if(e.isValidType(n)){o=o||function(){return!0};var i,r,s,l,u=[],p=this.startRange,h=e.getBlockRangeMethodName(n);if(e.DATA_TYPES.PLAIN===n&&this._isSingleNotFullSelectedLI())return i=p.block.toPlain(p.start,p.end),u.push(i),u;if(!(l=this.createWalker(t,function(t){return o(t.block)})))return[];for(s=l.next();s;)null!=(i=s[h]())?Array.isArray(i)?u=u.concat(i):(r=s.block,(a.IS_WEB_NOTE||a.IS_WEB_GROUP)&&d.isAttachment(r)&&i.resource&&!/^http/i.test(i.resource)&&(i.resource=location.protocol+"//"+location.hostname+i.resource),u.push(i)):c.warn("data is null!"),s=l.next();return u}c.warn("type is unvalid!")}else c.warn("note is unvalid!")},e.prototype._isSingleNotFullSelectedLI=function(){var t=this.startRange,e=!1;return this.isInSingleBlock()&&d.isListItem(t.block)&&(0!==t.start||t.end!==t.block.getLength())&&(e=!0),e},e.TYPE="note",e.DATA_TYPES={JSON:1,HTML:2,PLAIN:3},e}(l)}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e,o=n(297),i=n(2);return e=o.extend({name:"UnknownSimpleCommand",isSimple:!0,initialize:function(){e.__super__.initialize.apply(this)},apply:function(){throw"Method not implemented."},doReapply:function(t){return i.log("doReapply(): `"+this.name+"`"),this.apply(t)},doUnapply:function(){throw i.log("doReapply(): `"+this.name+"`"),"Method not implemented."},isCollabCommand:function(){var t=this.options.args;return null!=t&&null!=t.collabProperties&&!0===t.collabProperties.isCollabCmd}})}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){t.exports=!n(14)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(t,e,n){var o=n(9),i=n(234),r=n(57),a=Object.defineProperty;e.f=n(23)?Object.defineProperty:function(t,e,n){if(o(t),e=r(e,!0),o(n),i)try{return a(t,e,n)}catch(t){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(t[e]=n.value),t}},function(t,e,n){var o=n(58);t.exports=function(t){return Object(o(t))}},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";o=[n,r,n(0),n(29)],void 0===(i=function(t,e,n,o){return function(){function t(t){(t=t||{}).enableEvent&&(this.eventInst={},n.extend(this.eventInst,o.Events)),this.options=n.extend({},t),this.initialize.apply(this,[t])}return t.extend=function(t,e){var o,i,r=this;return o=t&&n.has(t,"constructor")?t.constructor:function(){return r.apply(this,arguments)},n.extend(o,r,e),(i=function(){this.constructor=o}).prototype=r.prototype,o.prototype=new i,t&&n.extend(o.prototype,t),o.__super__=r.prototype,o},t}()}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";var a,s=this&&this.__extends||(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});o=[n,r,n(26)],void 0===(i=function(t,e,n){return function(t){function e(e){return(e=e||{}).enableEvent=!0,t.call(this,e)||this}return s(e,t),e.prototype.on=function(t,e,n){return this.eventInst.on(t,e,n)},e.prototype.off=function(t,e,n){return this.eventInst.off(t,e,n)},e.prototype.trigger=function(t){for(var e,n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];return(e=this.eventInst).trigger.apply(e,[t].concat(n))},e.prototype.bind=function(t,e,n){return this.eventInst.bind(t,e,n)},e.prototype.unbind=function(t,e,n){return this.eventInst.unbind(t,e,n)},e.prototype.once=function(t,e,n){return this.eventInst.once(t,e,n)},e.prototype.listenTo=function(t,e,n){return this.eventInst.listenTo(t,e,n)},e.prototype.listenToOnce=function(t,e,n){return this.eventInst.listenToOnce(t,e,n)},e.prototype.stopListening=function(t,e,n){return this.eventInst.stopListening(t,e,n)},e}(n)}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";var a,s=this&&this.__extends||(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});o=[n,r,n(0),n(70),n(52),n(273),n(2),n(7),n(156),n(38),n(3),n(53),n(12),n(129),n(32)],void 0===(i=function(t,e,n,o,i,r,a,l,c,u,d,p,h,f,g){return function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.createBlank=function(t){var n=new e({});return!0===t&&l.PLATFORM_LINE_HEIGHT&&l.PLATFORM_LINE_HEIGHT!==f.getDefault("line-height",d.PARAGRAPH)&&n.setBlockStyle("line-height",l.PLATFORM_LINE_HEIGHT),n},e.fromJSON=function(t,e){return this.generalFromJSON(t,!1,e)},e.fromCollabJSON=function(t){return this.generalFromJSON(t,!0)},e.fromXml=function(t){var e=this.createBlank();return e.parseIdFromXml(t),e.setText(h.fromXml(t)),$(t).children().each(function(t,n){switch(n.nodeName){case u.TAG_ID_NAME:case u.LEGACY_TAG_ID_NAME:case"text":case"inline-styles":case"language":case"theme":case"entities":break;case"styles":o.fromXml(e,n);break;default:i.appendToTree(e.unknownTree,n)}}),e},e.generalFromJSON=function(t,e,o){if(t){if(t.type=t.type||t.blockType,d.isParagraphClusterType(t.type)&&(t.text||t.richText)){var i,r=this.createBlank();return i=e?h.fromCollabJSON(t.richText):h.fromJSON(t.richText||t.text),r.setText(i),o||n.each(t.styles,function(t,e){r.setBlockStyle(e,t)}),t.blockId&&r.setId(t.blockId),r}a.warn("invalid type or text.")}else a.warn("jsonObj should not be null!")},e.prototype.append=function(t){this.richText.append(t)},e.prototype.countWords=function(t){var e,n=0,o=this.richText;return l.IS_MOBILE||!t?n=r(o):(e=this.getRangeText(t))&&(n=r(e)),n},e.prototype.deleteText=function(t,e,o){n.isObject(t)&&!n.isUndefined(t.start)&&(e=t.end,t=t.start);var i,r=this.richText,a=r.slice(0,t),s=h.createBlank();e>=0&&(i=r.slice(e)),s.append(a),s.append(i),this.setText(s,o)},e.prototype.getBlockBackColor=function(){var t=this.richText.getStyle(0,this.richText.getLength(),"back-color");return d.isParagraph(this)&&t.length&&n.all(t,function(e){return e===t[0]})?t[0]:""},e.prototype.getCommonInlineStyle=function(t,e){var n,o;return e?(n=e.start,o=e.end):(n=this.getStartOffset(),o=this.getEndOffset()),this.richText.getCommonStyle(n,o,t)},e.prototype.getCommonInlineStyles=function(t){var e,n,o=this.richText;return t?(e=t.start,n=t.end):(e=this.getStartOffset(),n=this.getEndOffset()),o.getCommonStyles(e,n)},e.prototype.getDefaultInlineStyles=function(){return g.getAllDefault()},e.prototype.getStartOffset=function(){return 0},e.prototype.getEndOffset=function(){return this.getLength()},e.prototype.getHighlight=function(t,e){if(t&&t.length){var o=this.richText,i=[];return n.each(t,function(t){for(var n=t.getLength(),r=o.indexOf(t,0,e.ignoreCase);-1!==r;)i[r]={end:r+n,start:r},r=o.indexOf(t,r+n,e.ignoreCase)}),(i=n.compact(i)).length?i:null}},e.prototype.getInlineStyleForEmpty=function(t,e){return(this.getInlineStylesForEmpty(e)||{})[t]},e.prototype.getInlineStylesForEmpty=function(t){var e=this.inlineStylesForEmpty;return t&&(e=e||g.getAllDefault()),e=n.clone(e)},e.prototype.getLength=function(t){return this.richText.getLength(t)},e.prototype.getReadOnlyText=function(){return this.richText},e.prototype.getRangeText=function(t){if(t&&null!=t.start)return this.sliceText(t.start,t.end)},e.prototype.getStyleRanges=function(t,e){return this.richText.getStyleRanges(t,e)},e.prototype.getText=function(){return this.richText.slice(0)},e.prototype.getTextStyle=function(t,e,o){var i=this.richText;return n.isObject(e)&&null!=e.start&&(o=e.end,e=e.start),i.getStyle(e,o,t)},e.prototype.getTextStylesAtIndex=function(t){return this.richText.getStylesAtIndex(t)},e.prototype.setEntity=function(t){this.richText.setEntity(t),this.trigger("content-change")},e.prototype.insertText=function(t,e){return this.richText.insert(e,t),this.trigger("content-change"),!0},e.prototype.isEmpty=function(){return this.richText.isEmpty()},e.prototype.isEmptyContent=function(){return 0===this.getLength(!1)},e.prototype.removeAllStyles=function(){t.prototype.removeAllStyles.call(this),this.richText.removeStyles(),this.trigger("content-change",this)},e.prototype.setInlineStylesForEmpty=function(t){this.inlineStylesForEmpty=t},e.prototype.setText=function(t,e){t instanceof h||(n.isString(t)||(t=String(t)),t=new h({text:t})),this.richText=t,this.trigger("content-change",e)},e.prototype.setTextStyle=function(t,e,o,i){var r,a=this.richText;d.isQuote(this)&&(r=this.getDefaultSetFont()),n.isObject(o)&&null!=o.start&&(i=o.end,o=o.start),a.setStyle(o,i,t,e,r),this.trigger("content-change")},e.prototype.sliceText=function(t,e,n){return this.richText.slice(t,e,n)},e.prototype.toCollabJSON=function(){var e=t.prototype.toCollabJSON.call(this);return e.richText=this.richText.toCollabJSON(),e},e.prototype.toHtml=function(t,e,n){var o,i,r,a=document.createElement("div"),s=$(a);return n=!0===n,s.attr("yne-bulb-block","paragraph").css("white-space","pre-wrap"),this.applyBlockStylesOnElement(s),t=t||0,e=null==e?this.getEndOffset():e,o=this.sliceText(t,e,!1),i=p.rich2html(o,{withDefault:n}),s.html(i),r=a.outerHTML,a=s=null,r},e.prototype.toPlain=function(t,e){var n;return t=t||0,n=this.sliceText(t,e,!1).toString(),n=c(n)},e.prototype.toJSON=function(e,n){e=e||0;var o=this.sliceText(e,n,!1),i=t.prototype.toJSON.call(this);return i.richText=o.toJSON(),i},e.prototype.toXml=function(e){var n,r,a=t.prototype.toXml.apply(this,[e]),s=e.createElement("text"),l=this.richText.toString(),c=e.createTextNode(l);return s.appendChild(c),a.appendChild(s),(r=this.richText.toXml(e))&&a.appendChild(r),n=e.createElement("styles"),o.toXml(this,n,e),a.appendChild(n),i.appendToXml(this.unknownTree,a),a},e.prototype.initialize=function(e){t.prototype.initialize.call(this,e),this.type=d.PARAGRAPH,null!=e.text?this.setText(e.text):this.setText("")},e.prototype.applyBlockStylesOnElement=function(t,e){var o,i=this,r=i.getBlockStyles(),s={};n.each(r,function(t,n){switch(n){case"align":s["text-align"]=t;break;case"indent":case"text-indent":e?(t=i.getBlockStyle("indent")+i.getBlockStyle("text-indent"),o="text-indent"):(t=t>0?t:0,o="indent"===n?"margin-left":"text-indent"),s[o]=t*l.INDENT_WIDTH||"";break;case"line-height":t>0&&(s["line-height"]=String(t));break;case"back-color":s["background-color"]=String(t);break;case"padding":s.padding=String(t);break;default:a.warn("unknown block style: "+n)}}),s["line-height"]||(o=f.getDefault("line-height",d.PARAGRAPH),s["line-height"]=o),o=p.getDefaultForHtml("font-size"),s["font-size"]=o,t.css(s)},e}(u)}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},,function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(){var t=navigator.userAgent.toLowerCase();return{isSafari:function(){return t&&t.indexOf("applewebkit")>-1&&t.indexOf("chrome")<=-1},isEdge:function(){return t&&t.indexOf("applewebkit")>-1&&t.indexOf("edge")>-1}}}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";o=[n,r,n(0),n(276)],void 0===(i=function(t,e,n,o){return function(){function t(){}return t.getAllConfig=function(e){var o=t.getStyleNames(e),i={};return n.each(o,function(e){i[e]=t.getConfig(e)}),i},t.getAllDefault=function(e){var o=t.getStyleNames(e),i={};return n.each(o,function(e){i[e]=t.getDefault(e)}),i},t.getConfig=function(e){var i=o[e],r=t.overrideDefaults[e];return i&&r&&((i=n.clone(i)).default=r),i},t.getDefault=function(e){var n=t.overrideDefaults[e];return null!=n?n:(n=o[e])?n.default:void 0},t.getStyleNames=function(t){var e=n.keys(o);return t&&t.length?n.difference(e,t):e},t.isSupport=function(t){return null!=o[t]},t.reset=function(){t.overrideDefaults={}},t.setDefault=function(e,n){var o=t.getDefault(e);null!=n&&n!==o&&(t.overrideDefaults[e]=n)},t.overrideDefaults={},t}()}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e,o=n(22),i=n(5),r=n(0),a=n(170),s=n(4);return e=o.extend({name:"atom.InsertBlocks",_note:null,_newBlks:null,_newBlkIds:null,_preBlkId:null,initialize:function(){var t=this,n=t.options.args;s.isCollabCommand(n)||(t._note=t.options.note,t._newBlks=t.options.newBlks,t.options.preBlk&&(t._preBlkId=t.options.preBlk.getId()),t._newBlkIds=[],r.each(t._newBlks,function(e){t._newBlkIds.push(e.getId())})),e.__super__.initialize.apply(t)},apply:function(){var t,e,n,o=this,i=0;if(o._preBlkId){if(n=o._note.getBlockIndexById(o._preBlkId),t=o._note.getBlockById(o._preBlkId),e=t.getBlockStyles(),-1===n)return!1;i=n+1}return r.each(o._newBlks,function(t){e&&e["back-color"]&&t.setBlockStyle("back-color",e["back-color"]),o._note.insert(i,t),i++}),!0},doUnapply:function(){var t=this;r.each(t._newBlkIds,function(e){t._note.remove(t._note.getBlockIndexById(e))})},fromCollabJSON:function(){var t=this,n=t.options.args.collabProperties,o=n.cmdJSON;e.__super__.fromCollabJSON.apply(t),t._note=n.coreEditor.getNote(),o.preBlockId&&(t._preBlkId=o.preBlockId),n.isCollabUndo?t._newBlkIds=o.insertedBlocks:n.isCollabRedo&&(t._newBlks=[],r.each(o.insertedBlocks,function(e){t._newBlks.push(a.buildBlockFromJSON(e,n.coreEditor))}))},toCollabJSON:function(){var t=e.__super__.toCollabJSON.apply(this),n=[];return this.isCollabUndo?r.each(this._newBlks,function(t){n.push(t.getId())}):this.isCollabRedo&&r.each(this._newBlks,function(t){n.push(t.toCollabJSON())}),t.insertedBlocks=n,this._preBlkId&&(t.preBlockId=this._preBlkId),t}}),i.add(e),e}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e,o=n(22),i=n(5),r=n(2),a=n(0),s=n(170),l=n(81),c=n(4);return e=o.extend({name:"atom.DeleteBlocks",_note:null,_deletedBlocks:null,_deletedBlockIds:null,_preBlockId:null,initialize:function(){var t=this,n=t.options.args;c.isCollabCommand(n)||(t._note=t.options.note,t._deletedBlocks=a.sortBy(t.options.blocks,function(e){return t._note.getBlockIndex(e)}),t._deletedBlockIds=[],a.each(t._deletedBlocks,function(e){t._deletedBlockIds.push(e.getId())})),e.__super__.initialize.apply(t)},apply:function(){var t,e,n=this;return n._deletedBlockIds&&0!==n._deletedBlockIds.length?((e=n._note.getBlockById(n._deletedBlockIds[0]))&&e instanceof l&&e.hideImageTitle(),t=n._note.getPreBlock(e),n._preBlockId=t?t.getId():0,a.each(n._deletedBlockIds,function(t,e){n._note.removeBlockById(t,n._deletedBlockIds.length===e+1)}),!0):(r.error("没有指定要删除的段落"),!1)},doUnapply:function(){var t=this,e=0;t._preBlockId&&(e=t._note.getBlockIndexById(t._preBlockId)+1),a.each(t._deletedBlocks,function(n){t._note.insert(e,n),e++})},fromCollabJSON:function(){var t=this,n=t.options.args.collabProperties,o=n.cmdJSON;e.__super__.fromCollabJSON.apply(t),t._note=n.coreEditor.getNote(),o&&o.preBlockId&&(t._preBlockId=o.preBlockId),n.isCollabUndo?(t._deletedBlocks=[],a.each(o.deletedBlocks,function(e){t._deletedBlocks.push(s.buildBlockFromJSON(e,n.coreEditor))})):n.isCollabRedo&&(t._deletedBlockIds=[],a.each(o.deletedBlocks,function(e){t._deletedBlockIds.push(e)}))},toCollabJSON:function(){var t=e.__super__.toCollabJSON.apply(this),n=[];return this.isCollabUndo?a.each(this._deletedBlocks,function(t){n.push(t.toCollabJSON())}):this.isCollabRedo&&a.each(this._deletedBlockIds,function(t){n.push(t)}),t.preBlockId=this._preBlockId,t.deletedBlocks=n,t}}),i.add(e),e}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o=n(24),i=n(85);t.exports=n(23)?function(t,e,n){return o.f(t,e,i(1,n))}:function(t,e,n){return t[e]=n,t}},function(t,e,n){var o=n(11),i=n(35),r=n(39),a=n(86)("src"),s=n(320),l=(""+s).split("toString");n(45).inspectSource=function(t){return s.call(t)},(t.exports=function(t,e,n,s){var c="function"==typeof n;c&&(r(n,"name")||i(n,"name",e)),t[e]!==n&&(c&&(r(n,a)||i(n,a,t[e]?""+t[e]:l.join(String(e)))),t===o?t[e]=n:s?t[e]?t[e]=n:i(t,e,n):(delete t[e],i(t,e,n)))})(Function.prototype,"toString",function(){return"function"==typeof this&&this[a]||s.call(this)})},function(t,e,n){var o=n(1),i=n(14),r=n(58),a=/"/g,s=function(t,e,n,o){var i=String(r(t)),s="<"+e;return""!==n&&(s+=" "+n+'="'+String(o).replace(a,"&quot;")+'"'),s+">"+i+"</"+e+">"};t.exports=function(t,e){var n={};n[t]=e(s),o(o.P+o.F*i(function(){var e=""[t]('"');return e!==e.toLowerCase()||e.split('"').length>3}),"String",n)}},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";var a,s=this&&this.__extends||(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});o=[n,r,n(0),n(4),n(10),n(27),n(2),n(129)],void 0===(i=function(t,e,n,o,i,r,a,l){return function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.fromXml=function(t){throw new Error("The fromXml should be implemented by subclass!")},e.parseResourceList=function(t){var e=[];return $(t).find(">resource-list>resource-mono>res-id").each(function(t,n){var o=$(n).text();(o=$.trim(o))&&e.push(o)}),e},e.prototype.isSupportedBlockStyle=function(t){return l.isSupport(t,this.type)},e.prototype.isEmptyContent=function(){return!1},e.prototype.isEmpty=function(){return!1},e.prototype.setBlockStyle=function(t,e){var o=l.getConfig(t,this.type),i=/^-?\d+%$/;o&&("Enum"===o.type?o.possible[e]||(e=o.default):"Number"!==o.type||n.isNumber(e)?"Boolean"!==o.type||n.isBoolean(e)?n["is"+o.type]&&e&&!n["is"+o.type](e)&&(e=e.default):e="true"===e:(e=null===e||""===e?NaN:i.test(e)?e:Number(e),i.test(e)||!isNaN(e)&&e||(e=o.default)),e=e||o.default,this.styles[t]=e,this.trigger("style-change",t,e))},e.prototype.setBlockStyles=function(t){var e=this;t&&n.each(t,function(t,n){e.setBlockStyle(n,t)})},e.prototype.getBlockStyles=function(){return n.clone(this.styles)},e.prototype.getBlockStyle=function(t,e){var n=l.getConfig(t,this.type);return n?!0===e?this.styles[t]:this.styles[t]||n.default:null},e.prototype.getDefaultBlockStyles=function(){return l.getDefaultsOfBlock(this.type)},e.prototype.removeBlockStyles=function(){this.styles={},this.trigger("styles-reset")},e.prototype.removeAllStyles=function(){this.removeBlockStyles()},e.prototype.toXml=function(t){var n,o,i,r=this.getId();if(null!=r)return n=t.createElement(this.xmlNodeName),o=t.createElement(e.TAG_ID_NAME),i=t.createTextNode(r),o.appendChild(i),n.appendChild(o),n;a.debugAlert("The block has NO id",this)},e.prototype.getType=function(){return this.type},e.prototype.parseIdFromXml=function(t){var n,o;(n=this._getChildByTagName(t,e.TAG_ID_NAME))&&(o=n.textContent),o||i.IS_ANDROID||(n=this._getChildByTagName(t,e.LEGACY_TAG_ID_NAME))&&(o=n.textContent),null==o?this.validForCollab=!1:this.blockId=o},e.prototype.toJSON=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return{blockId:this.getId(),blockType:this.type,styles:this.getBlockStyles(),type:this.type}},e.prototype.toHtml=function(t,e,n){throw new Error("toHtml() should be implemented by subclass!")},e.prototype.toPlain=function(t,e){throw new Error("toPlain() should be implemented by subclass!")},e.prototype.countWords=function(t){throw new Error("countWords() should be implemented by subclass!")},e.prototype.setResourceIds=function(t){t&&t.length&&(this.resourceIds=t)},e.prototype.getResourceIds=function(){return this.resourceIds},e.prototype.getExtraInfo=function(t){var e;return this.trigger("get-extra-info",t,function(t){e=t}),e},e.prototype.getDefaultSetFont=function(){var t;return this.trigger("get-default-set-font",function(e){t=e}),t},e.prototype.highlight=function(t,e,n){this.trigger("high-light",t,e,n)},e.prototype.getId=function(){var t=this.blockId;return null==t&&a.debugAlert("The blockId should NOT be null"),t},e.prototype.setId=function(t){null!=t?this.blockId=t:a.debugAlert("The param blockId should NOT be null")},e.prototype.setLocked=function(t,e){this.locked===t&&e&&!e.lockUpdated||(this.locked=t,this.trigger("locked-change",e))},e.prototype.isLocked=function(){return this.locked},e.prototype.getUnknownTree=function(){return this.unknownTree},e.prototype.isValidForCollab=function(){return this.validForCollab},e.prototype.resetLockState=function(){this.locked=!1},e.prototype.toCollabJSON=function(){return this.toJSON()},e.prototype.setReadOnly=function(t){this.readOnly=!!t},e.prototype.isReadOnly=function(){return this.readOnly},e.prototype.initialize=function(t){t=t||{},this.styles={},this.validForCollab=!0,null==this.blockId&&(null!=t.blockId||null!=t.id?this.blockId=t.blockId||t.id:this.blockId=o.newGUID()),this.unknownTree={}},e.prototype._getChildByTagName=function(t,e){if(t)for(var n=t.childNodes[0];n;){if(n.nodeName&&n.nodeName===e)return n;n=n.nextSibling}},e.TAG_ID_NAME="coId",e.LEGACY_TAG_ID_NAME="id",e}(r)}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e){var n={}.hasOwnProperty;t.exports=function(t,e){return n.call(t,e)}},function(t,e,n){var o=n(124),i=n(58);t.exports=function(t){return o(i(t))}},function(t,e,n){var o=n(125),i=n(85),r=n(40),a=n(57),s=n(39),l=n(234),c=Object.getOwnPropertyDescriptor;e.f=n(23)?c:function(t,e){if(t=r(t),e=a(e,!0),l)try{return c(t,e)}catch(t){}if(s(t,e))return i(!o.f.call(t,e),t[e])}},function(t,e,n){var o=n(39),i=n(25),r=n(179)("IE_PROTO"),a=Object.prototype;t.exports=Object.getPrototypeOf||function(t){return t=i(t),o(t,r)?t[r]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?a:null}},function(t,e,n){var o;!function(){function i(t,e){if(e=e||{},(t=t||"")instanceof i)return t;if(!(this instanceof i))return new i(t,e);var n=function(t){var e={r:0,g:0,b:0},n=1,o=!1,i=!1;return"string"==typeof t&&(t=function(t){t=t.replace(T,"").replace(O,"").toLowerCase();var e,n=!1;if(H[t])t=H[t],n=!0;else if("transparent"==t)return{r:0,g:0,b:0,a:0,format:"name"};return(e=V.rgb.exec(t))?{r:e[1],g:e[2],b:e[3]}:(e=V.rgba.exec(t))?{r:e[1],g:e[2],b:e[3],a:e[4]}:(e=V.hsl.exec(t))?{h:e[1],s:e[2],l:e[3]}:(e=V.hsla.exec(t))?{h:e[1],s:e[2],l:e[3],a:e[4]}:(e=V.hsv.exec(t))?{h:e[1],s:e[2],v:e[3]}:(e=V.hsva.exec(t))?{h:e[1],s:e[2],v:e[3],a:e[4]}:(e=V.hex8.exec(t))?{a:(o=e[1],x(o)/255),r:x(e[2]),g:x(e[3]),b:x(e[4]),format:n?"name":"hex8"}:(e=V.hex6.exec(t))?{r:x(e[1]),g:x(e[2]),b:x(e[3]),format:n?"name":"hex"}:!!(e=V.hex3.exec(t))&&{r:x(e[1]+""+e[1]),g:x(e[2]+""+e[2]),b:x(e[3]+""+e[3]),format:n?"name":"hex"};var o}(t)),"object"==typeof t&&(t.hasOwnProperty("r")&&t.hasOwnProperty("g")&&t.hasOwnProperty("b")?(r=t.r,a=t.g,s=t.b,e={r:255*w(r,255),g:255*w(a,255),b:255*w(s,255)},o=!0,i="%"===String(t.r).substr(-1)?"prgb":"rgb"):t.hasOwnProperty("h")&&t.hasOwnProperty("s")&&t.hasOwnProperty("v")?(t.s=I(t.s),t.v=I(t.v),e=function(t,e,n){t=6*w(t,360),e=w(e,100),n=w(n,100);var o=N.floor(t),i=t-o,r=n*(1-e),a=n*(1-i*e),s=n*(1-(1-i)*e),l=o%6;return{r:255*[n,a,r,r,s,n][l],g:255*[s,n,n,a,r,r][l],b:255*[r,r,s,n,n,a][l]}}(t.h,t.s,t.v),o=!0,i="hsv"):t.hasOwnProperty("h")&&t.hasOwnProperty("s")&&t.hasOwnProperty("l")&&(t.s=I(t.s),t.l=I(t.l),e=function(t,e,n){function o(t,e,n){return 0>n&&(n+=1),n>1&&(n-=1),1/6>n?t+6*(e-t)*n:.5>n?e:2/3>n?t+6*(e-t)*(2/3-n):t}var i,r,a;if(t=w(t,360),e=w(e,100),n=w(n,100),0===e)i=r=a=n;else{var s=.5>n?n*(1+e):n+e-n*e,l=2*n-s;i=o(l,s,t+1/3),r=o(l,s,t),a=o(l,s,t-1/3)}return{r:255*i,g:255*r,b:255*a}}(t.h,t.s,t.l),o=!0,i="hsl"),t.hasOwnProperty("a")&&(n=t.a)),n=k(n),{ok:o,format:t.format||i,r:B(255,R(e.r,0)),g:B(255,R(e.g,0)),b:B(255,R(e.b,0)),a:n};var r,a,s}(t);this._originalInput=t,this._r=n.r,this._g=n.g,this._b=n.b,this._a=n.a,this._roundA=D(100*this._a)/100,this._format=e.format||n.format,this._gradientType=e.gradientType,this._r<1&&(this._r=D(this._r)),this._g<1&&(this._g=D(this._g)),this._b<1&&(this._b=D(this._b)),this._ok=n.ok,this._tc_id=A++}function r(t,e,n){t=w(t,255),e=w(e,255),n=w(n,255);var o,i,r=R(t,e,n),a=B(t,e,n),s=(r+a)/2;if(r==a)o=i=0;else{var l=r-a;switch(i=s>.5?l/(2-r-a):l/(r+a),r){case t:o=(e-n)/l+(n>e?6:0);break;case e:o=(n-t)/l+2;break;case n:o=(t-e)/l+4}o/=6}return{h:o,s:i,l:s}}function a(t,e,n){t=w(t,255),e=w(e,255),n=w(n,255);var o,i,r=R(t,e,n),a=B(t,e,n),s=r,l=r-a;if(i=0===r?0:l/r,r==a)o=0;else{switch(r){case t:o=(e-n)/l+(n>e?6:0);break;case e:o=(n-t)/l+2;break;case n:o=(t-e)/l+4}o/=6}return{h:o,s:i,v:s}}function s(t,e,n,o){var i=[E(D(t).toString(16)),E(D(e).toString(16)),E(D(n).toString(16))];return o&&i[0].charAt(0)==i[0].charAt(1)&&i[1].charAt(0)==i[1].charAt(1)&&i[2].charAt(0)==i[2].charAt(1)?i[0].charAt(0)+i[1].charAt(0)+i[2].charAt(0):i.join("")}function l(t,e,n,o){var i;return[E((i=o,Math.round(255*parseFloat(i)).toString(16))),E(D(t).toString(16)),E(D(e).toString(16)),E(D(n).toString(16))].join("")}function c(t,e){e=0===e?0:e||10;var n=i(t).toHsl();return n.s-=e/100,n.s=S(n.s),i(n)}function u(t,e){e=0===e?0:e||10;var n=i(t).toHsl();return n.s+=e/100,n.s=S(n.s),i(n)}function d(t){return i(t).desaturate(100)}function p(t,e){e=0===e?0:e||10;var n=i(t).toHsl();return n.l+=e/100,n.l=S(n.l),i(n)}function h(t,e){e=0===e?0:e||10;var n=i(t).toRgb();return n.r=R(0,B(255,n.r-D(-e/100*255))),n.g=R(0,B(255,n.g-D(-e/100*255))),n.b=R(0,B(255,n.b-D(-e/100*255))),i(n)}function f(t,e){e=0===e?0:e||10;var n=i(t).toHsl();return n.l-=e/100,n.l=S(n.l),i(n)}function g(t,e){var n=i(t).toHsl(),o=(D(n.h)+e)%360;return n.h=0>o?360+o:o,i(n)}function m(t){var e=i(t).toHsl();return e.h=(e.h+180)%360,i(e)}function y(t){var e=i(t).toHsl(),n=e.h;return[i(t),i({h:(n+120)%360,s:e.s,l:e.l}),i({h:(n+240)%360,s:e.s,l:e.l})]}function v(t){var e=i(t).toHsl(),n=e.h;return[i(t),i({h:(n+90)%360,s:e.s,l:e.l}),i({h:(n+180)%360,s:e.s,l:e.l}),i({h:(n+270)%360,s:e.s,l:e.l})]}function _(t){var e=i(t).toHsl(),n=e.h;return[i(t),i({h:(n+72)%360,s:e.s,l:e.l}),i({h:(n+216)%360,s:e.s,l:e.l})]}function b(t,e,n){e=e||6,n=n||30;var o=i(t).toHsl(),r=360/n,a=[i(t)];for(o.h=(o.h-(r*e>>1)+720)%360;--e;)o.h=(o.h+r)%360,a.push(i(o));return a}function C(t,e){e=e||6;for(var n=i(t).toHsv(),o=n.h,r=n.s,a=n.v,s=[],l=1/e;e--;)s.push(i({h:o,s:r,v:a})),a=(a+l)%1;return s}function k(t){return t=parseFloat(t),(isNaN(t)||0>t||t>1)&&(t=1),t}function w(t,e){(function(t){return"string"==typeof t&&-1!=t.indexOf(".")&&1===parseFloat(t)})(t)&&(t="100%");var n=function(t){return"string"==typeof t&&-1!=t.indexOf("%")}(t);return t=B(e,R(0,parseFloat(t))),n&&(t=parseInt(t*e,10)/100),N.abs(t-e)<1e-6?1:t%e/parseFloat(e)}function S(t){return B(1,R(0,t))}function x(t){return parseInt(t,16)}function E(t){return 1==t.length?"0"+t:""+t}function I(t){return 1>=t&&(t=100*t+"%"),t}var T=/^\s+/,O=/\s+$/,A=0,N=Math,D=N.round,B=N.min,R=N.max,L=N.random;i.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var t=this.toRgb();return(299*t.r+587*t.g+114*t.b)/1e3},getLuminance:function(){var t,e,n,o=this.toRgb();return t=o.r/255,e=o.g/255,n=o.b/255,.2126*(.03928>=t?t/12.92:Math.pow((t+.055)/1.055,2.4))+.7152*(.03928>=e?e/12.92:Math.pow((e+.055)/1.055,2.4))+.0722*(.03928>=n?n/12.92:Math.pow((n+.055)/1.055,2.4))},setAlpha:function(t){return this._a=k(t),this._roundA=D(100*this._a)/100,this},toHsv:function(){var t=a(this._r,this._g,this._b);return{h:360*t.h,s:t.s,v:t.v,a:this._a}},toHsvString:function(){var t=a(this._r,this._g,this._b),e=D(360*t.h),n=D(100*t.s),o=D(100*t.v);return 1==this._a?"hsv("+e+", "+n+"%, "+o+"%)":"hsva("+e+", "+n+"%, "+o+"%, "+this._roundA+")"},toHsl:function(){var t=r(this._r,this._g,this._b);return{h:360*t.h,s:t.s,l:t.l,a:this._a}},toHslString:function(){var t=r(this._r,this._g,this._b),e=D(360*t.h),n=D(100*t.s),o=D(100*t.l);return 1==this._a?"hsl("+e+", "+n+"%, "+o+"%)":"hsla("+e+", "+n+"%, "+o+"%, "+this._roundA+")"},toHex:function(t){return s(this._r,this._g,this._b,t)},toHexString:function(t){return"#"+this.toHex(t)},toHex8:function(){return l(this._r,this._g,this._b,this._a)},toHex8String:function(){return"#"+this.toHex8()},toRgb:function(){return{r:D(this._r),g:D(this._g),b:D(this._b),a:this._a}},toRgbString:function(){return 1==this._a?"rgb("+D(this._r)+", "+D(this._g)+", "+D(this._b)+")":"rgba("+D(this._r)+", "+D(this._g)+", "+D(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:D(100*w(this._r,255))+"%",g:D(100*w(this._g,255))+"%",b:D(100*w(this._b,255))+"%",a:this._a}},toPercentageRgbString:function(){return 1==this._a?"rgb("+D(100*w(this._r,255))+"%, "+D(100*w(this._g,255))+"%, "+D(100*w(this._b,255))+"%)":"rgba("+D(100*w(this._r,255))+"%, "+D(100*w(this._g,255))+"%, "+D(100*w(this._b,255))+"%, "+this._roundA+")"},toName:function(){return 0===this._a?"transparent":!(this._a<1)&&(j[s(this._r,this._g,this._b,!0)]||!1)},toFilter:function(t){var e="#"+l(this._r,this._g,this._b,this._a),n=e,o=this._gradientType?"GradientType = 1, ":"";t&&(n=i(t).toHex8String());return"progid:DXImageTransform.Microsoft.gradient("+o+"startColorstr="+e+",endColorstr="+n+")"},toString:function(t){var e=!!t;t=t||this._format;var n=!1,o=this._a<1&&this._a>=0;return!e&&o&&("hex"===t||"hex6"===t||"hex3"===t||"name"===t)?"name"===t&&0===this._a?this.toName():this.toRgbString():("rgb"===t&&(n=this.toRgbString()),"prgb"===t&&(n=this.toPercentageRgbString()),("hex"===t||"hex6"===t)&&(n=this.toHexString()),"hex3"===t&&(n=this.toHexString(!0)),"hex8"===t&&(n=this.toHex8String()),"name"===t&&(n=this.toName()),"hsl"===t&&(n=this.toHslString()),"hsv"===t&&(n=this.toHsvString()),n||this.toHexString())},clone:function(){return i(this.toString())},_applyModification:function(t,e){var n=t.apply(null,[this].concat([].slice.call(e)));return this._r=n._r,this._g=n._g,this._b=n._b,this.setAlpha(n._a),this},lighten:function(){return this._applyModification(p,arguments)},brighten:function(){return this._applyModification(h,arguments)},darken:function(){return this._applyModification(f,arguments)},desaturate:function(){return this._applyModification(c,arguments)},saturate:function(){return this._applyModification(u,arguments)},greyscale:function(){return this._applyModification(d,arguments)},spin:function(){return this._applyModification(g,arguments)},_applyCombination:function(t,e){return t.apply(null,[this].concat([].slice.call(e)))},analogous:function(){return this._applyCombination(b,arguments)},complement:function(){return this._applyCombination(m,arguments)},monochromatic:function(){return this._applyCombination(C,arguments)},splitcomplement:function(){return this._applyCombination(_,arguments)},triad:function(){return this._applyCombination(y,arguments)},tetrad:function(){return this._applyCombination(v,arguments)}},i.fromRatio=function(t,e){if("object"==typeof t){var n={};for(var o in t)t.hasOwnProperty(o)&&(n[o]="a"===o?t[o]:I(t[o]));t=n}return i(t,e)},i.equals=function(t,e){return!(!t||!e)&&i(t).toRgbString()==i(e).toRgbString()},i.random=function(){return i.fromRatio({r:L(),g:L(),b:L()})},i.mix=function(t,e,n){n=0===n?0:n||50;var o,r=i(t).toRgb(),a=i(e).toRgb(),s=n/100,l=2*s-1,c=a.a-r.a,u=1-(o=((o=-1==l*c?l:(l+c)/(1+l*c))+1)/2);return i({r:a.r*o+r.r*u,g:a.g*o+r.g*u,b:a.b*o+r.b*u,a:a.a*s+r.a*(1-s)})},i.readability=function(t,e){var n=i(t),o=i(e);return(Math.max(n.getLuminance(),o.getLuminance())+.05)/(Math.min(n.getLuminance(),o.getLuminance())+.05)},i.isReadable=function(t,e,n){var o,r,a,s,l,c=i.readability(t,e);switch(r=!1,"AA"!==(s=((a=(a=n)||{level:"AA",size:"small"}).level||"AA").toUpperCase())&&"AAA"!==s&&(s="AA"),"small"!==(l=(a.size||"small").toLowerCase())&&"large"!==l&&(l="small"),(o={level:s,size:l}).level+o.size){case"AAsmall":case"AAAlarge":r=c>=4.5;break;case"AAlarge":r=c>=3;break;case"AAAsmall":r=c>=7}return r},i.mostReadable=function(t,e,n){var o,r,a,s,l=null,c=0;r=(n=n||{}).includeFallbackColors,a=n.level,s=n.size;for(var u=0;u<e.length;u++)(o=i.readability(t,e[u]))>c&&(c=o,l=i(e[u]));return i.isReadable(t,l,{level:a,size:s})||!r?l:(n.includeFallbackColors=!1,i.mostReadable(t,["#fff","#000"],n))};var P,M,F,H=i.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},j=i.hexNames=function(t){var e={};for(var n in t)t.hasOwnProperty(n)&&(e[t[n]]=n);return e}(H),V=(M="[\\s|\\(]+("+(P="(?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?)")+")[,|\\s]+("+P+")[,|\\s]+("+P+")\\s*\\)?",F="[\\s|\\(]+("+P+")[,|\\s]+("+P+")[,|\\s]+("+P+")[,|\\s]+("+P+")\\s*\\)?",{rgb:new RegExp("rgb"+M),rgba:new RegExp("rgba"+F),hsl:new RegExp("hsl"+M),hsla:new RegExp("hsla"+F),hsv:new RegExp("hsv"+M),hsva:new RegExp("hsva"+F),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/});t.exports?t.exports=i:void 0===(o=function(){return i}.call(e,n,e,t))||(t.exports=o)}()},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";var a=this&&this.__assign||Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t};o=[n,r,n(0),n(3),n(166),n(2),n(167),n(221),n(222),n(168),n(64),n(73),n(224),n(118)],void 0===(i=function(t,e,n,o,i,r,s,l,c,u,d,p,h,f){return function(){function t(){}return t.createRangeByBlock=function(t){if(t&&t.block){var e,n=t.block,g=n.getType(),m=0,y=0;switch(null!=t.start&&null!=t.end?(m=t.start,y=t.end):(null==t.allContent&&null==t.collapseToStart||!0===t.allContent)&&null!=n.getEndOffset?(m=0,y=n.getEndOffset()):t.collapseToStart||null==n.getEndOffset?(m=0,y=0):y=m=n.getEndOffset(),g){case o.QUOTE:case o.TODO:case o.PARAGRAPH:case o.LIST_ITEM:case o.CATALOGUE:case o.HEADING:e=new d({block:n,end:y,start:m});break;case o.IMAGE:e=new u({block:n});break;case o.ATTACHMENT:e=new s({block:n});break;case o.TABLE:t.allContent&&(t.type=p.TYPES.ALL,delete t.allContent),t.type||t.rect||r.warn("Bad tableRange options will select first table cell",t),e=new p({block:n,rect:t.rect,type:t.type});break;case o.HR:e=new c({block:n});break;case o.UNKNOWN:e=new h({block:n});break;case o.HEADER_FOOTER:e=new i({block:n});break;case o.HANDWRITE:e=new l({block:n});break;case o.CODE:e=t.hasOwnProperty("selectWholeBlock")?new f(a({block:n},t)):new f({block:n,selectWholeBlock:!0});break;default:r.error("block.type ["+g+"] is not valid!")}return e}r.warn("arguments is not valid!")},t.isBlockRange=function(t){return null!=t&&null!=t.getType&&null!=t.getType()&&n.contains(o.getAllBlockTypes(),t.getType())},t}()}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e){var n=t.exports={version:"2.6.5"};"number"==typeof __e&&(__e=n)},function(t,e,n){var o=n(31);t.exports=function(t,e,n){if(o(t),void 0===e)return t;switch(n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,o){return t.call(e,n,o)};case 3:return function(n,o,i){return t.call(e,n,o,i)}}return function(){return t.apply(e,arguments)}}},function(t,e){var n={}.toString;t.exports=function(t){return n.call(t).slice(8,-1)}},function(t,e){var n=Math.ceil,o=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?o:n)(t)}},function(t,e,n){"use strict";var o=n(14);t.exports=function(t,e){return!!t&&o(function(){e?t.call(null,function(){},1):t.call(null)})}},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(2),o=n(0);return{bubble:function(t,n,i,r){if(t&&n&&i){var a=o.isArray(t);o.each(t,function(t,e){t&&(a?e=t:!0===t&&(t=e),!0===r&&n.off(e),n.on(e,i.trigger.bind(i,t)))})}else e.log("arguments are not valid",arguments)},addListeners:function(t,n,i,r){t&&n&&i?o.each(t,function(t,e){!0===r&&n.off(e),n.on(e,i[t].bind(i))}):e.log("arguments are not valid",arguments)}}}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";o=[n,r,n(0),n(2),n(272)],void 0===(i=function(t,e,n,o,i){return function(){function t(){}return t.getAllValueByFont=function(e){var n=t.getFont(e);if(n)return t.FONT_MAP[n].join(",");o.warn("Font does not exit in Font Maps: "+e)},t.getFontMap=function(){return t.FONT_MAP},t.getFont=function(e){var o,i;if((e=(e||"").toLowerCase())&&(i=t.splitFontFamily(e)))return n.some(i,function(e){if(n.some(t.FONT_MAP,function(n,i){if(i.toLowerCase()===e||t.CONTAIN_IGNORE_CASE(n,e))return o=i,!0}),o)return!0}),o},t.getFontFirstValue=function(e){var n,o=t.getFont(e);if(n=t.FONT_MAP[o])return n[0]},t.getItems=function(){var e=[];return n.each(t.FONT_MAP,function(t,n){e.push({fullValue:t.join(","),name:n,singleValue:t[0]})}),e},t.getNames=function(){return n.keys(t.FONT_MAP)},t.splitFontFamily=function(t){var e,o=[];return(t=$.trim(t||""))?(e=t.split(","),n.each(e,function(t){t=t||"",(t=$.trim(t.replace(/["']/g,"")))&&o.push(t)}),o):[]},t.CONTAIN_IGNORE_CASE=function(t,e){return n.some(t,function(t){return(t+"").toLowerCase()===e})},t.DEFAULT_FONT=i.DEFAULT_FONT,t.FONT_MAP={"微软雅黑":[i.DEFAULT_FONT,"STXihei"],"宋体":["SimSun","STSong"],"新宋体":["NSimSun"],"仿宋":["FangSong_GB2312","FangSong","STFangsong"],"楷体":["KaiTi_GB2312","KaiTi","STKaiti"],"黑体":["SimHei","STHeiti"],Arial:["Arial"],"Arial Black":["Arial Black"],"Times New Roman":["Times New Roman"],"Courier New":["Courier New"],Tahoma:["Tahoma"],Verdana:["Verdana"]},t}()}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";o=[n,r,n(0),n(7),n(207),n(2)],void 0===(i=function(t,e,n,o,i,r){return function(){function t(){}return t.appendToTree=function(t,e){if(t&&e){var n=$(e).attr(o.COMPAT);i.isCompatible(n)&&(t.unknown||(t.unknown=[]),t.unknown.push(e.cloneNode(!0)))}else r.error("arguments are not valid!")},t.appendToXml=function(t,e){t&&e?t.unknown&&t.unknown.length&&n.each(t.unknown,function(t){var n;t&&t.cloneNode&&(n=t.nodeName,$(e).find(">"+n).length>0?r.error("unknown node <"+n+"> has already exist!"):e.appendChild(t.cloneNode(!0)))}):r.error("arguments are not valid!")},t}()}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";o=[n,r,n(0),n(110),n(274),n(12),n(32)],void 0===(i=function(t,e,n,o,i,r,a){return function(){function t(){}return t.getCssRule=function(e){return t.globalInlineStyleRules[e]},t.getDefaultForHtml=function(e){var n,o,i,r=t.inlineStyleDefaultForHtml[e];return null==r&&(n=t.getCssRule(e),o=a.getDefault(e),n?((i={})[e]=o,r=n(i)):r=o,t.inlineStyleDefaultForHtml[e]=r),r},t.html2rich=function(t){return new r({text:$(t).text()})},t.rich2html=function(e,o){var r,a,s,l,c,u,d,p=e.getReadOnlyData(),h=e.getEntities(),f=p.length,g=[],m="";if(o=n.defaults(o||{},{customDefaultStyles:null,styleRules:null,withDefault:!0,styles:null}),0===f)return"<br>";for(r=e.getReadOnlyStylesList(o.withDefault,o.customDefaultStyles,o.styles),o.styleRules?(d=n.clone(o.styleRules),n.defaults(d,t.globalInlineStyleRules)):d=t.globalInlineStyleRules,d=i.getRules(d),h&&h.length&&(l=n.pluck(h,"start")),a=0;a<f;++a)s=p[a],u=r[a],t.isEqualStyles(c,u)||(t.handleEndStyles(g),m!==u.href&&(t.handleEndHref(g),t.handleStartHref(g,u.href)),t.handleStartStyles(g,u,d)),g.push(n.escape(s.toString())),l&&n.contains(l,a)&&g.push('<span class = "loading" ></span>'),c=u,m=u.href;return t.handleEndStyles(g),t.handleEndHref(g),g.join("")},t.resetCssRules=function(){t.globalInlineStyleRules={},t.resetInlineStyleDefaultForHtml()},t.resetInlineStyleDefaultForHtml=function(e){e?(e+="",delete t.inlineStyleDefaultForHtml[e]):t.inlineStyleDefaultForHtml={}},t.setCssRules=function(e){n.each(e,function(e,o){n.isFunction(e)&&(t.globalInlineStyleRules[o]=e,t.resetInlineStyleDefaultForHtml(o))})},t.anchorEndTag=function(){return"</a>"},t.anchorStartTag=function(t){return t+="",'<a href="'+o.safeHref(t)+'">'},t.handleEndHref=function(e){e.push(t.anchorEndTag())},t.handleEndStyles=function(e){e.push(t.spanEndTag())},t.handleStartHref=function(e,n){n&&e.push(t.anchorStartTag(n))},t.handleStartStyles=function(e,o,i){n.isEmpty(o)||e.push(t.spanStartTag(o,i))},t.isEqualStyles=function(e,n){if(!e||!n)return!1;var o,i=t.supportedInlineStyleNames.length;for(o=0;o<i;o++)if(e[t.supportedInlineStyleNames[o]]!==n[t.supportedInlineStyleNames[o]])return!1;return!0},t.spanEndTag=function(){return"</span>"},t.spanStartTag=function(t,e){var o=document.createElement("span");return n.each(e,function(e,n){var i=e(t);(i||0===i)&&(o.style[n]=i)}),o.outerHTML.replace(/<\/span>$/i,"")},t.globalInlineStyleRules={},t.inlineStyleDefaultForHtml={},t.supportedInlineStyleNames=a.getStyleNames(),t}()}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(){this.listeners=[],this.maxListeners=null}return t.prototype.addListener=function(t,e){return this.on(t,e)},t.prototype.emit=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var o=this._filterMatchedEvent(this.listeners,t);return o.length>0&&(this._invokeListeners.apply(this,[o].concat(e)),this.listeners=this._filterNotMatchedEvent(this.listeners,t,!0)),o.length>0},t.prototype.getMaxListeners=function(){return null===this.maxListeners?t.defaultMaxListeners:this.maxListeners},t.prototype.listenerCount=function(t){return this._filterMatchedEvent(this.listeners,t).length},t.prototype.on=function(t,e){return this._register({event:t,listener:e,once:!1}),this},t.prototype.off=function(t,e){return this._unregister({event:t,listener:e}),this},t.prototype.once=function(t,e){return this._register({event:t,listener:e,once:!0}),this},t.prototype.removeAllListeners=function(t){return this.listeners=null!=t?this._filterNotMatchedEvent(this.listeners,t):[],this},t.prototype.removeListener=function(t,e){return this.listeners=this._filterNotMatchedEvent(this.listeners,t,null,e),this},t.prototype.setMaxListeners=function(t){return this.maxListeners=t,this},t.prototype._invokeListeners=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];t.map(function(t){return t.listener.apply(t,e)})},t.prototype._register=function(t){if(this._checkListenerLimitReached(t.event))throw new Error("Listner Limit Reached:"+this.maxListeners);this.listeners.unshift(t)},t.prototype._unregister=function(t){this.listeners=this._filterNotMatchedEvent(this.listeners,t.event,null,t.listener)},t.prototype._returnListenerLimit=function(){return null===this.maxListeners?t.defaultMaxListeners:this.maxListeners},t.prototype._checkListenerLimitReached=function(t){return this.listenerCount(t)===this._returnListenerLimit()},t.prototype._filterMatchedEvent=function(t,e,n){return t.filter(function(t,o,i){return null==n?t.event===e:t.event===e&&t.once===n},this)},t.prototype._filterNotMatchedEvent=function(t,e,n,o){return t.filter(function(t,i,r){var a=t.event!==e;return!1===a&&null!=n&&(a=t.once!==n),!1===a&&null!=o&&(a=t.listener!==o),a},this)},t.defaultMaxListeners=10,t}();e.YEvent=n}.apply(i,[n,i]))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";o=[n,r,n(2),n(71)],void 0===(i=function(t,e,n,o){return function(){function t(){}return t.getRange=function(e){var o,i=t.getSelection(e);return i?i.rangeCount>0?o=i.getRangeAt(0):n.warn("The selection has no range!"):n.warn("The selection is null!"),o},t.getSelection=function(t){return(t=t||window).getSelection()},t.isNodeInRange=function(e,o){if(!e)return n.warn("The param node is unvalid!"),!1;var i,r=e.ownerDocument||document,a=r.defaultView,s=a.Range;return o=o||t.getRange(a),(i=r.createRange()).selectNode(e),o.compareBoundaryPoints(s.START_TO_START,i)<1&&o.compareBoundaryPoints(s.END_TO_END,i)>-1},t.isRangeInNode=function(e,o){if(!e)return n.warn("The param node is unvalid!"),!1;var i,r=(e.ownerDocument||document).defaultView;if(!(o=o||t.getRange(r)))return n.warn("The native range is null!"),!1;for(i=o.commonAncestorContainer;i;){if(i===e)return!0;i=i.parentNode}return!1},t.isRangeInSelector=function(e,n){if(!e)return!1;var i;if(i=(n=n||t.getRange()).commonAncestorContainer,!n||!i)return!1;for(o.isText(i)&&(i=i.parentElement||i.parentNode);i&&i.webkitMatchesSelector;){if(i.webkitMatchesSelector(e))return!0;i=i.parentNode}return!1},t.removeAllRanges=function(e){var n=t.getSelection(e);n&&n.removeAllRanges()},t.setRange=function(e,o){var i=t.getSelection(o);i&&e?(i.removeAllRanges(),i.addRange(e)):n.warn("The selection or range is null!")},t}()}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(0),o=n(8),i=n(19),r=n(10),a=n(231),s=n(122),l=n(30);return s.extend({className:"toolbar-item toolbar-button",events:{click:"onClick",mousedown:"onMouseDown",mouseup:"onMouseUp"},name:"unknown",label:"unknown",defaultState:!1,state:!1,templateName:"toolbar-button-template",editorEvents:{"yne-editing-state-change":"onEditingStateChange","yne-selection-change":"onSelectionChange"},shortcut:null,onEditingStateChange:function(){},onSelectionChange:a,initialize:function(t){this.editor=t.editor,this.render(),this.setState(this.defaultState),this.bindEditorEvents(),this.bindEvents()},render:function(){var t,e=this.$el,n=this.label;e.addClass("button-"+this.name),t=i.render("web",this.templateName,{name:this.name,label:this.label,defaultState:this.defaultState}),e.html(t),null==this.shortcut||""===this.shortcut||l.isSafari()&&!r.IS_MAC||(n="<div><span>"+this.label+'</span><span class="split"></span><span>'+this.shortcut+"</span><div>"),e.find(".button").tooltipster({animation:"",animationDuration:0,theme:["tooltipster-borderless","tooltipster-borderless-customized"],side:"bottom",delay:[800,300],content:n,contentAsHTML:!0}),this.isVisible||this.hide()},bindEvents:function(){},bindEditorEvents:function(){var t=this,n=t.editor,o=t.editorEvents;o&&e.each(o,function(e,o){n.on(o,t[e].bind(t))})},onMouseUp:function(){var t=o(window);t.is(":focus")||t.focus()},onMouseDown:function(t){t.preventDefault()},onClick:function(){},setState:function(t){var e=this.$el;t=!0===t,this.state=t,t?e.find(".button").addClass("active"):e.find(".button").removeClass("active")},reset:function(){this.setState(this.defaultState)}})}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o=n(15);t.exports=function(t,e){if(!o(t))return t;var n,i;if(e&&"function"==typeof(n=t.toString)&&!o(i=n.call(t)))return i;if("function"==typeof(n=t.valueOf)&&!o(i=n.call(t)))return i;if(!e&&"function"==typeof(n=t.toString)&&!o(i=n.call(t)))return i;throw TypeError("Can't convert object to primitive value")}},function(t,e){t.exports=function(t){if(null==t)throw TypeError("Can't call method on  "+t);return t}},function(t,e,n){var o=n(1),i=n(45),r=n(14);t.exports=function(t,e){var n=(i.Object||{})[t]||Object[t],a={};a[t]=e(n),o(o.S+o.F*r(function(){n(1)}),"Object",a)}},function(t,e,n){var o=n(46),i=n(124),r=n(25),a=n(18),s=n(195);t.exports=function(t,e){var n=1==t,l=2==t,c=3==t,u=4==t,d=6==t,p=5==t||d,h=e||s;return function(e,s,f){for(var g,m,y=r(e),v=i(y),_=o(s,f,3),b=a(v.length),C=0,k=n?h(e,b):l?h(e,0):void 0;b>C;C++)if((p||C in v)&&(m=_(g=v[C],C,y),t))if(n)k[C]=m;else if(m)switch(t){case 3:return!0;case 5:return g;case 6:return C;case 2:k.push(g)}else if(u)return!1;return d?-1:c||u?u:k}}},,function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";var a,s=this&&this.__extends||(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});o=[n,r,n(0),n(111),n(27),n(2)],void 0===(i=function(t,e,n,o,i,r){return function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.fromCollabJSON=function(t){return new e({listId:t.id,type:t.type})},e.fromXml=function(t){var o=$(t),i=new e({listId:o.attr("id"),type:o.attr("type")});return n.each(t.attributes,function(t){switch(t.nodeName){case"id":case"type":break;default:i.unknownAttrs.push(t.cloneNode(!0))}}),i},e.prototype.addItem=function(t){t&&(this.listItems.push(t),this.updateIndexes())},e.prototype.getId=function(){return this.listProps.listId},e.prototype.getItems=function(){return this.listItems},e.prototype.getLength=function(){return this.listItems.length},e.prototype.getType=function(){return this.listProps.type},e.prototype.insertAfter=function(t,e){var n=this.listItems,o=e?n.indexOf(e):-1;this.insertItem(o+1,t)},e.prototype.insertItem=function(t,e){var n=this.listItems;return o(t>0||t<=n.length),o(!(e in n)),n.splice(t,0,e),this.updateIndexes(),t},e.prototype.isOrdered=function(){return this.listProps.type===e.ORDERED},e.prototype.isUnordered=function(){return this.listProps.type===e.UNORDERED},e.prototype.removeItem=function(t){var e=this.listItems,n=e.indexOf(t);return n>=0&&(e.splice(n,1),this.updateIndexes()),n},e.prototype.setType=function(t){o(t===e.ORDERED||t===e.UNORDERED),t!==this.listProps.type&&(this.listProps.type=t,this.updateIndexes(!0),this.trigger("type-change"))},e.prototype.toCollabJSON=function(){var t={};return t.id=this.listProps.listId,t.type=this.listProps.type,t},e.prototype.updateIndexes=function(t){var e,n,o,i=this.listItems,r=i.length,a=0,s={};for(e=0;e<r;++e)(o=(n=i[e]).getLevel())>a?s[o]=1:s[o]?s[o]++:s[o]=1,a=o,n.setIndex(s[o]),t&&n.updateListType()},e.prototype.initialize=function(t){this.listProps=n.clone(t),this.listItems=[],this.unknownAttrs=[],this.listProps.type!==e.ORDERED&&this.listProps.type!==e.UNORDERED&&(r.error("type should be ORDERED or UNORDERED",this.listProps.type),this.listProps.type=e.UNORDERED)},e.ORDERED="ordered",e.UNORDERED="unordered",e}(i)}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";var a,s=this&&this.__extends||(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});o=[n,r,n(0),n(4),n(70),n(62),n(52),n(111),n(2),n(7),n(156),n(38),n(3),n(217),n(28),n(53),n(12)],void 0===(i=function(t,e,n,o,i,r,a,l,c,u,d,p,h,f,g,m,y){return function(t){function e(e){return t.call(this,e)||this}return s(e,t),e.createBlank=function(){return new e({})},e.fromCollabJSON=function(t){return this.generalFromJSON(t,!0)},e.fromJSON=function(t){return this.generalFromJSON(t,!1)},e.fromXml=function(t){var n,o=$(t),r=parseInt(o.attr("level"),10)||1;return(n=new e({level:r})).setText(y.fromXml(t)),n.parseIdFromXml(t),$(t).children().each(function(t,e){switch(e.nodeName){case p.TAG_ID_NAME:case p.LEGACY_TAG_ID_NAME:case"text":case"inline-styles":break;case"styles":i.fromXml(n,e);break;default:a.appendToTree(n.unknownTree,e)}}),n},e.getOrCreateListById=function(t,e,n){var i,a,s=null,l=e;for(a=t.length-1;a>=0;--a)i=t[a],h.isListItem(i)&&i.getOwnerList()&&i.getOwnerList().getId()===e&&(i.getOwnerList().getType()===n?s=i.getOwnerList():l=o.newGUID());return s||(s=new r({listId:l,type:n})),s},e.generalFromJSON=function(e,n){var o=t.generalFromJSON.call(this,e,n);return o&&(e.listId&&o.setListId(e.listId),e.listType&&o.setListType(e.listType),e.level&&o.setLevel(e.level),e.index&&o.setIndex(e.index)),o},e.prototype.getIndex=function(){return this.index},e.prototype.getListId=function(){return this.ownerList?this.ownerList.getId():this.listItemProps.listId},e.prototype.getListType=function(){return this.ownerList?this.ownerList.getType():this.listItemProps.listType},e.prototype.getLevel=function(){return this.listItemProps.level},e.prototype.getOwnerList=function(){return this.ownerList},e.prototype.isOrdered=function(){return this.ownerList.isOrdered()},e.prototype.setIndex=function(t){n.isNumber(t)&&t>0&&(this.index=t,this.trigger("index-change",t))},e.prototype.setLevel=function(t){n.isNumber(t)&&(t=Math.max(t,1),t=Math.min(t,u.MAX_LIST_ITEM_LEVEL),this.listItemProps.level=t,this.ownerList&&this.ownerList.updateIndexes(),this.trigger("level-change",t))},e.prototype.setListId=function(t){this.listItemProps.listId?c.error("should not override existing listId"):this.listItemProps.listId=t},e.prototype.setListType=function(t){this.listItemProps.listType?c.error("should not override existing listType"):this.listItemProps.listType=t},e.prototype.setOwnerList=function(t){this.ownerList=t,this.ownerList&&(this.listItemProps.listId=this.ownerList.getId(),this.listItemProps.listType=this.ownerList.getType())},e.prototype.toCollabJSON=function(){return this._generalToJSON(null,null,!0)},e.prototype.toHtml=function(t,e,n){var o,i,r,a=document.createElement("li"),s=$(a);return n=!0===n,this.applyBlockStylesOnElement(s),s.css("list-style-position","inside").css("white-space","pre-wrap").css("word-break","break-word"),(r=f.makeHtmlMarker(this))&&r.listStyleType&&s.css("list-style-type",r.listStyleType),r&&r.markerStyles&&s.css(r.markerStyles),t=t||0,o=this.sliceText(t,e,!1),i=m.rich2html(o,{withDefault:n}),a.innerHTML=i,a.outerHTML},e.prototype.toJSON=function(t,e){return this._generalToJSON(t,e,!1)},e.prototype.toPlain=function(t,e){var n;return t=t||0,n=this.sliceText(t,e,!1).toString(),n=d(n)},e.prototype.toXml=function(e){var n,o=this.getOwnerList();if(o)return(n=t.prototype.toXml.apply(this,[e])).setAttribute("level",this.getLevel().toString()),n.setAttribute("list-id",this.listItemProps.listId),{listId:this.listItemProps.listId,listItem:n,listType:o.getType(),ownerList:o};c.error("The list item has no owner list!")},e.prototype.updateListType=function(){this.ownerList&&(this.listItemProps.listType=this.ownerList.getType())},e.prototype.initialize=function(e){var o=e.level||1;t.prototype.initialize.call(this,e),this.type=h.LIST_ITEM,this.listItemProps=n.clone(e),this.setLevel(o),this.setIndex(1),e.list&&(this.ownerList=e.list,this.listItemProps.listId=this.ownerList.getId(),this.listItemProps.listType=this.ownerList.getType()),!this.listItemProps.listId&&e.listId&&(this.listItemProps.listId=e.listId),!this.listItemProps.listType&&e.listType&&(this.listItemProps.listType=e.listType),e.id&&this.setId(e.id),e.text&&this.setText(e.text),this.on("attached",this._onAttached.bind(this)),this.on("detached",this._onDetached.bind(this))},e.prototype._onAttached=function(t){var n,o,i=this.getOwnerList(),r=t.getAllBlocks(),a=t.getBlockIndex(this),s=null;if(l(a>=0,"Block not attached yet.",a,this),!i&&this.getListId()&&(i=e.getOrCreateListById(r,this.getListId(),this.getListType()),this.setOwnerList(i)),0===i.getLength())i.insertAfter(this,null);else{for(n=a-1;n>=0;--n)if(o=r[n],h.isListItem(o)&&o.getOwnerList()===i){s=o;break}i.insertAfter(this,s)}},e.prototype._onDetached=function(){this.getOwnerList().removeItem(this)},e.prototype._generalToJSON=function(e,n,o){var i;return(i=o?t.prototype.toCollabJSON.call(this):t.prototype.toJSON.call(this,e,n)).level=this.getLevel(),i.index=this.getIndex(),this.listItemProps.listId&&(i.listId=this.listItemProps.listId),this.listItemProps.listType&&(i.listType=this.listItemProps.listType),i},e}(g)}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";var a,s=this&&this.__extends||(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});o=[n,r,n(3),n(2),n(72)],void 0===(i=function(t,e,n,o,i){return function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.create=function(t){return new e(t)},e.fromCollabJSON=function(t,r){var a=t.rangeType;if(a===n.PARAGRAPH){var s=i.getBlockById(t.blockId,r);if(s){var l={block:s,end:t.endPosition,start:t.startPosition};return e.create(l)}}else o.error("wrong block range type:",a)},e.prototype.isCollapsed=function(){return this.start===this.end},e.prototype.clone=function(){return e.create({block:this.block,end:this.end,start:this.start})},e.prototype.collapse=function(t){void 0===t&&(t=!0),t?this.end=this.start:this.start=this.end},e.prototype.expandToStart=function(){this.start=this.block.getStartOffset()},e.prototype.expandToEnd=function(){this.end=this.block.getEndOffset()},e.prototype.getDataAsJSON=function(){return this.block.toJSON(this.start,this.end)},e.prototype.getDataAsHtml=function(t){return this.block.toHtml(this.start,this.end,t)},e.prototype.getDataAsPlain=function(){return this.block.toPlain(this.start,this.end)},e.prototype.getContent=function(){return this.block.sliceText(this.start,this.end)},e.prototype.canDrawedByNative=function(){return!0},e.prototype.toCollabJSON=function(){var e=t.prototype.toCollabJSON.call(this);return e.startPosition=this.start,e.endPosition=this.end,e},e.prototype.initialize=function(t){this.type=n.PARAGRAPH,this.start=t.start||0,this.end=t.end||0,this.block=t.block},e}(i)}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(){}return t.setUnderscore=function(t){e.underscoreInst=t},t.setLogger=function(t){e.loggerInst=t},t}();e.ExternalLibs=n}.apply(i,[n,i]))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(29),o=n(8),i=n(0),r=n(7),a=n(3),s=n(2),l=n(204),c=n(792),u=o('<div class="collab-editing-view-wrapper"><div class="collab-session-view"></div></div>');return e.View.extend({className:"block-view unknown-block-view",_isReadOnly:!1,_pageInfo:null,_$pageBreakContainer:null,PAGE_HEIGHT:null,_viewHeightInlastPaging:null,block:null,_getSelector:function(){var t=this.tagName,e=this.className.split(/\s+/),n=this.id,o=this.cid,r=".note-view ";return r+=t,n&&(r+="#"+n),i.each(e,function(t){t&&(r+="."+t)}),r+='[data-yne-cid="'+o+'"]'},initialize:function(t){this.block=t.block,this._isReadOnly=t.isReadOnly,i.bindAll(this,"_onLockedChange"),this.block.on("locked-change",this._onLockedChange),t.inlineStyleViewMapper&&(this._inlineStyleViewMapper=t.inlineStyleViewMapper),this._pageInfo={},this.PAGE_HEIGHT=t.pageSize.height,i.isNumber(this.PAGE_HEIGHT)||(s.debugAlert("invalid PAGE_HEIGHT:"+this.PAGE_HEIGHT),this.PAGE_HEIGHT=r.PAGE_TYPE_NONE_HEIGHT),this._$pageBreakContainer=t.pageBreakContainer,this.noteView=t.noteView},render:function(){this.$el.attr("data-yne-cid",this.cid),this._updateLockState(this.isLocked()),a.isListItem(this.block)||this.trigger("view-height-changed",this.cid)},convertToNativeRange:function(){s.error("convertToNativeRange() should be implemented by subclass!")},parseNativeRange:function(){s.error("parseNativeRange() should be implemented by subclass!")},bindSelectionEvents:function(){i.bindAll(this,"onDrawRange"),this.on("draw-range",this.onDrawRange)},onDrawRange:function(){throw"Method not implemented."},_onLockedChange:function(t){this._updateLockState(this.isLocked()),this._updateLockIndicator(this.block.isLocked(),t),this.trigger("locked-change"),this.trigger("view-height-changed",this.cid)},isCollabLocked:function(){var t=this.block,e=!1;return t&&(e=t.isLocked()),e},isLocked:function(){var t=this.block,e=this._isReadOnly;return t&&(e=t.isLocked()||this._isReadOnly),e},_updateLockIndicator:function(t,e){var n,o,i=e&&e.lockColor,r=e&&e.nickname;null!=(n=this.$el.find(".collab-editing-view-wrapper"))&&0!==n.length||(n=u.clone(),this.$el.prepend(n)),o=n.find(".collab-session-view"),t?(this.$el.addClass("collab-editing-view"),null!=r&&o.text(r),null!=i&&o.css("background-color",i)):(this.$el.removeClass("collab-editing-view"),this.$el.find(".collab-editing-view-wrapper").remove())},_updateLockState:function(t){t?this.$el.addClass("collab-locked"):this.$el.removeClass("collab-locked")},onDestroy:function(){l.warn("onDestroy() was not implemented by "+this.block.type+" view")},clearHighlight:function(){},clearPageBreaks:function(){var t=this;i.each(t._pageInfo,function(e){e&&e.pageBreak&&t._removePageBreak(e.pageBreak)}),t._pageInfo={}},coincideAllPageBreaks:function(){var t=this;t._pageInfo?i.each(t._pageInfo,function(e){e&&e.pageBreak&&t._coincidePageBreak(e.pageBreak)}):s.debugAlert("pageInfo should not be null when coincideAllPageBreaks")},disablePageMode:function(){this.clearPageBreaks(),this.PAGE_HEIGHT=r.PAGE_HEIGHT_NONE},enablePageMode:function(t){this.clearPageBreaks(),t===r.PAGE_TYPE_A4?this.PAGE_HEIGHT=r.PAGE_HEIGHT_A4:t===r.PAGE_TYPE_B5?this.PAGE_HEIGHT=r.PAGE_HEIGHT_B5:t===r.PAGE_TYPE_TEST?this.PAGE_HEIGHT=r.PAGE_HEIGHT_TEST:this.PAGE_HEIGHT=r.PAGE_HEIGHT_NONE},getBottomPosInPage:function(t){var e;return this._pageInfo[t]?this._pageInfo[t].pageBreak?e=-1:(e=this._pageInfo[t].topPosInPage+this._getHeightInPage(t))>this.PAGE_HEIGHT&&s.warn("Unsplitted Block whose Height is more than PAGE_HEIGHT",this._pageInfo[t].topPosInPage,e,this.PAGE_HEIGHT):(s.debugAlert("should NOT invoke the getBottomPosInPage when the view is NOT on the page"),e=0),e},getFirstTransPageIndex:function(){var t={};return this._pageInfo?(i.each(this._pageInfo,function(e){e&&(null==t.pageIndex?t=e:e.pageIndex<t.pageIndex&&(t=e))}),t.pageIndex):(s.debugAlert("pageInfo should not be null when getFirstTransPageIndex"),null)},getLastTransPageIndex:function(){var t={};return this._pageInfo?(i.each(this._pageInfo,function(e){e&&(null==t.pageIndex?t=e:e.pageIndex>t.pageIndex&&(t=e))}),t.pageIndex):(s.debugAlert("pageInfo should not be null when getLastTransPageIndex"),null)},isOnFloat:function(){return"none"!==(this.$el.css("float")||"none").toLowerCase()},resetPageInfo:function(t,e){var n,o,r,a=!1;return this._pageInfo?i.isNumber(e)?null==t?(s.debugAlert("pageIndex should NOT be null"),a):null==this._$pageBreakContainer?(s.debugAlert("pageBreakContainer should not be null"),a):(this._pageInfo[t]&&(n=this._pageInfo[t].topPosInPage),e=Math.ceil(e),this.clearPageBreaks(),this._updatePageInfo(t,e),this.$el.css("height","auto"),o=this.$el.find(".page-break-placeholder"),this.$el.hasClass("quote-view")&&o.length&&this.$el.find(".para-text").css("display","inline-block"),r=this.$el.outerHeight(!0),e!==n?a=!0:this._isViewHeightChanged(r)?a=!0:this._isPagingContinue()&&(a=!0),a&&(this._viewHeightInlastPaging=r),a):(s.debugAlert("topPosInPage should be a number:"+e),a):(s.debugAlert("pageInfo should not be null when resetPageInfo"),a)},_coincidePageBreak:function(t){t.coincide(),this.trigger("pageBreak-positionChanged",t.getPageBreak().attr("data-page-id")),this._showPageBreakInfo(t)},_createPageBreak:function(t,e,n,o){return new c({pageIndex:t,topBlankHeight:e,bottomBlankHeight:n,container:this._$pageBreakContainer,noteView:this.noteView,placeholder:o})},_getContentContainer:function(){return this.$el},_getContentContainerBottomInView:function(){return this._getOffsetTopPos(this._getContentContainer())+this._getContentContainer().outerHeight()-this._getOffsetTopPos(this.$el)},_getOffsetTopPos:function(t){return t.offset().top},_getHeightInPage:function(t){var e,n,o=this._pageInfo[t-1],i=this._pageInfo[t];return i?o&&!o.pageBreak?(s.debugAlert("previous pageBreak should NOT be null"),0):o&&0===o.pageBreak.getPlaceholder().next().length?0:a.isTable(this.block)&&0===this._getContentContainer().find("tbody").children().length?0:"none"!==this.$el.css("float")?0:o&&o.pageBreak&&i&&i.pageBreak?(s.debugAlert("_getHeightInPage: should NOT there when crossing previous/current page"),this.PAGE_HEIGHT):(e=o?this._getPageBreakBottomPosInView(t-1):0,i&&i.pageBreak?(s.debugAlert("_getHeightInPage: shoud not be there when current pageBreak ready"),n=this._getPageBreakTopPosInView(t)):n=this._getContentContainerBottomInView(),Math.ceil(n-e)):(s.debugAlert("should NOT invoke the method when not on the page"),0)},_getPageBreakBottomPosInView:function(t){var e,n;return(e=this._pageInfo[t])&&e.pageBreak?(n=e.pageBreak.getPlaceholder(),this._getOffsetTopPos(n)+n.height()-this._getOffsetTopPos(this.$el)):0},_getPageBreakTopPosInView:function(t){var e;return e=this._pageInfo[t].pageBreak.getPlaceholder(),this._getOffsetTopPos(e)-this._getOffsetTopPos(this.$el)},_getTopPosInPage:function(t){var e=0;return this._pageInfo[t-1]&&this._pageInfo[t-1].pageBreak?e=0:this._pageInfo[t]?e=this._pageInfo[t].topPosInPage:s.debugAlert("should NOT invoke the _getTopPosInPage when the view is NOT on the page"),e},_handlePageOverflow:function(t,e){var n,o,i=this._getHeightInPage(t),r=this._pageInfo[t-1];return o=this.PAGE_HEIGHT-e,r&&r.pageBreak&&0!==e?(s.debugAlert("toPosInPage should be 0 when crossing the previous page"),!1):(o<0&&(o=0),0===e||this.isOnFloat()||o>i?(this._setViewMaxHeight(t),n=!1):(this._insertPageBreak(t,o),n=!0),n)},_insertPageBreak:function(t,e){var n;(n=this._createPageBreak(t,e)).getPlaceholder().prependTo(this.$el),this._pageInfo[t].pageBreak=n,this.trigger("pageBreak-inserted",n.getPageBreak().attr("data-page-id")),this._coincidePageBreak(n)},_isInPageMode:function(){return this.PAGE_HEIGHT!==r.PAGE_HEIGHT_NONE},_isPagingContinue:function(){return!1},_isViewHeightChanged:function(t){var e=!1;return(!this._viewHeightInlastPaging||Math.round(Math.abs(t-this._viewHeightInlastPaging))>r.TOLERABLE_HEIGHT_CHANGE)&&(e=!0),e},_removePageBreak:function(t){t.destroy()},_setViewMaxHeight:function(){},_showPageBreakInfo:function(t){var e,n,o,i,r,a,l=t.getPageBreak();s.DEBUG&&((e=l.find(".bottomSpan")).css("border-bottom","2px dashed #b6b9b6"),(n=l.find(".topSpan")).css("border-top","2px dashed #b6b9b6"),r=l.attr("data-page-id"),o=this._getOffsetTopPos(l),i=this._getOffsetTopPos(t.getPlaceholder()),a="Page:"+r+" OffsetTop(mark/placeholder):("+Math.round(o)+"/"+Math.round(i)+") TopBlank:"+n.outerHeight(),n.text(a),r*=1,a="TopOnPage:"+this._pageInfo[r].pageIndex+" BottomBlank:"+e.outerHeight(),e.text(a))},_updatePageInfo:function(t,e){this._pageInfo[t]={pageIndex:t,topPosInPage:e},this._handlePageOverflow(t,e)&&this._updatePageInfo(t+1,0)}})}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){"use strict";if(n(23)){var o=n(76),i=n(11),r=n(14),a=n(1),s=n(151),l=n(203),c=n(46),u=n(92),d=n(85),p=n(35),h=n(94),f=n(48),g=n(18),m=n(262),y=n(88),v=n(57),_=n(39),b=n(106),C=n(15),k=n(25),w=n(192),S=n(89),x=n(42),E=n(90).f,I=n(194),T=n(86),O=n(17),A=n(60),N=n(141),D=n(127),B=n(197),R=n(108),L=n(146),P=n(91),M=n(196),F=n(251),H=n(24),j=n(41),V=H.f,U=j.f,z=i.RangeError,G=i.TypeError,J=i.Uint8Array,W=Array.prototype,$=l.ArrayBuffer,K=l.DataView,Y=A(0),X=A(2),q=A(3),Q=A(4),Z=A(5),tt=A(6),et=N(!0),nt=N(!1),ot=B.values,it=B.keys,rt=B.entries,at=W.lastIndexOf,st=W.reduce,lt=W.reduceRight,ct=W.join,ut=W.sort,dt=W.slice,pt=W.toString,ht=W.toLocaleString,ft=O("iterator"),gt=O("toStringTag"),mt=T("typed_constructor"),yt=T("def_constructor"),vt=s.CONSTR,_t=s.TYPED,bt=s.VIEW,Ct=A(1,function(t,e){return Et(D(t,t[yt]),e)}),kt=r(function(){return 1===new J(new Uint16Array([1]).buffer)[0]}),wt=!!J&&!!J.prototype.set&&r(function(){new J(1).set({})}),St=function(t,e){var n=f(t);if(n<0||n%e)throw z("Wrong offset!");return n},xt=function(t){if(C(t)&&_t in t)return t;throw G(t+" is not a typed array!")},Et=function(t,e){if(!(C(t)&&mt in t))throw G("It is not a typed array constructor!");return new t(e)},It=function(t,e){return Tt(D(t,t[yt]),e)},Tt=function(t,e){for(var n=0,o=e.length,i=Et(t,o);o>n;)i[n]=e[n++];return i},Ot=function(t,e,n){V(t,e,{get:function(){return this._d[n]}})},At=function(t){var e,n,o,i,r,a,s=k(t),l=arguments.length,u=l>1?arguments[1]:void 0,d=void 0!==u,p=I(s);if(null!=p&&!w(p)){for(a=p.call(s),o=[],e=0;!(r=a.next()).done;e++)o.push(r.value);s=o}for(d&&l>2&&(u=c(u,arguments[2],2)),e=0,n=g(s.length),i=Et(this,n);n>e;e++)i[e]=d?u(s[e],e):s[e];return i},Nt=function(){for(var t=0,e=arguments.length,n=Et(this,e);e>t;)n[t]=arguments[t++];return n},Dt=!!J&&r(function(){ht.call(new J(1))}),Bt=function(){return ht.apply(Dt?dt.call(xt(this)):xt(this),arguments)},Rt={copyWithin:function(t,e){return F.call(xt(this),t,e,arguments.length>2?arguments[2]:void 0)},every:function(t){return Q(xt(this),t,arguments.length>1?arguments[1]:void 0)},fill:function(t){return M.apply(xt(this),arguments)},filter:function(t){return It(this,X(xt(this),t,arguments.length>1?arguments[1]:void 0))},find:function(t){return Z(xt(this),t,arguments.length>1?arguments[1]:void 0)},findIndex:function(t){return tt(xt(this),t,arguments.length>1?arguments[1]:void 0)},forEach:function(t){Y(xt(this),t,arguments.length>1?arguments[1]:void 0)},indexOf:function(t){return nt(xt(this),t,arguments.length>1?arguments[1]:void 0)},includes:function(t){return et(xt(this),t,arguments.length>1?arguments[1]:void 0)},join:function(t){return ct.apply(xt(this),arguments)},lastIndexOf:function(t){return at.apply(xt(this),arguments)},map:function(t){return Ct(xt(this),t,arguments.length>1?arguments[1]:void 0)},reduce:function(t){return st.apply(xt(this),arguments)},reduceRight:function(t){return lt.apply(xt(this),arguments)},reverse:function(){for(var t,e=xt(this).length,n=Math.floor(e/2),o=0;o<n;)t=this[o],this[o++]=this[--e],this[e]=t;return this},some:function(t){return q(xt(this),t,arguments.length>1?arguments[1]:void 0)},sort:function(t){return ut.call(xt(this),t)},subarray:function(t,e){var n=xt(this),o=n.length,i=y(t,o);return new(D(n,n[yt]))(n.buffer,n.byteOffset+i*n.BYTES_PER_ELEMENT,g((void 0===e?o:y(e,o))-i))}},Lt=function(t,e){return It(this,dt.call(xt(this),t,e))},Pt=function(t){xt(this);var e=St(arguments[1],1),n=this.length,o=k(t),i=g(o.length),r=0;if(i+e>n)throw z("Wrong length!");for(;r<i;)this[e+r]=o[r++]},Mt={entries:function(){return rt.call(xt(this))},keys:function(){return it.call(xt(this))},values:function(){return ot.call(xt(this))}},Ft=function(t,e){return C(t)&&t[_t]&&"symbol"!=typeof e&&e in t&&String(+e)==String(e)},Ht=function(t,e){return Ft(t,e=v(e,!0))?d(2,t[e]):U(t,e)},jt=function(t,e,n){return!(Ft(t,e=v(e,!0))&&C(n)&&_(n,"value"))||_(n,"get")||_(n,"set")||n.configurable||_(n,"writable")&&!n.writable||_(n,"enumerable")&&!n.enumerable?V(t,e,n):(t[e]=n.value,t)};vt||(j.f=Ht,H.f=jt),a(a.S+a.F*!vt,"Object",{getOwnPropertyDescriptor:Ht,defineProperty:jt}),r(function(){pt.call({})})&&(pt=ht=function(){return ct.call(this)});var Vt=h({},Rt);h(Vt,Mt),p(Vt,ft,Mt.values),h(Vt,{slice:Lt,set:Pt,constructor:function(){},toString:pt,toLocaleString:Bt}),Ot(Vt,"buffer","b"),Ot(Vt,"byteOffset","o"),Ot(Vt,"byteLength","l"),Ot(Vt,"length","e"),V(Vt,gt,{get:function(){return this[_t]}}),t.exports=function(t,e,n,l){var c=t+((l=!!l)?"Clamped":"")+"Array",d="get"+t,h="set"+t,f=i[c],y=f||{},v=f&&x(f),_=!f||!s.ABV,k={},w=f&&f.prototype,I=function(t,n){V(t,n,{get:function(){return function(t,n){var o=t._d;return o.v[d](n*e+o.o,kt)}(this,n)},set:function(t){return function(t,n,o){var i=t._d;l&&(o=(o=Math.round(o))<0?0:o>255?255:255&o),i.v[h](n*e+i.o,o,kt)}(this,n,t)},enumerable:!0})};_?(f=n(function(t,n,o,i){u(t,f,c,"_d");var r,a,s,l,d=0,h=0;if(C(n)){if(!(n instanceof $||"ArrayBuffer"==(l=b(n))||"SharedArrayBuffer"==l))return _t in n?Tt(f,n):At.call(f,n);r=n,h=St(o,e);var y=n.byteLength;if(void 0===i){if(y%e)throw z("Wrong length!");if((a=y-h)<0)throw z("Wrong length!")}else if((a=g(i)*e)+h>y)throw z("Wrong length!");s=a/e}else s=m(n),r=new $(a=s*e);for(p(t,"_d",{b:r,o:h,l:a,e:s,v:new K(r)});d<s;)I(t,d++)}),w=f.prototype=S(Vt),p(w,"constructor",f)):r(function(){f(1)})&&r(function(){new f(-1)})&&L(function(t){new f,new f(null),new f(1.5),new f(t)},!0)||(f=n(function(t,n,o,i){var r;return u(t,f,c),C(n)?n instanceof $||"ArrayBuffer"==(r=b(n))||"SharedArrayBuffer"==r?void 0!==i?new y(n,St(o,e),i):void 0!==o?new y(n,St(o,e)):new y(n):_t in n?Tt(f,n):At.call(f,n):new y(m(n))}),Y(v!==Function.prototype?E(y).concat(E(v)):E(y),function(t){t in f||p(f,t,y[t])}),f.prototype=w,o||(w.constructor=f));var T=w[ft],O=!!T&&("values"==T.name||null==T.name),A=Mt.values;p(f,mt,!0),p(w,_t,c),p(w,bt,!0),p(w,yt,f),(l?new f(1)[gt]==c:gt in w)||V(w,gt,{get:function(){return c}}),k[c]=f,a(a.G+a.W+a.F*(f!=y),k),a(a.S,c,{BYTES_PER_ELEMENT:e}),a(a.S+a.F*r(function(){y.of.call(f,1)}),c,{from:At,of:Nt}),"BYTES_PER_ELEMENT"in w||p(w,"BYTES_PER_ELEMENT",e),a(a.P,c,Rt),P(c),a(a.P+a.F*wt,c,{set:Pt}),a(a.P+a.F*!O,c,Mt),o||w.toString==pt||(w.toString=pt),a(a.P+a.F*r(function(){new f(1).slice()}),c,{slice:Lt}),a(a.P+a.F*(r(function(){return[1,2].toLocaleString()!=new f([1,2]).toLocaleString()})||!r(function(){w.toLocaleString.call([1,2])})),c,{toLocaleString:Bt}),R[c]=O?T:A,o||O||p(w,ft,A)}}else t.exports=function(){}},function(t,e,n){var o=n(257),i=n(1),r=n(123)("metadata"),a=r.store||(r.store=new(n(260))),s=function(t,e,n){var i=a.get(t);if(!i){if(!n)return;a.set(t,i=new o)}var r=i.get(e);if(!r){if(!n)return;i.set(e,r=new o)}return r};t.exports={store:a,map:s,has:function(t,e,n){var o=s(e,n,!1);return void 0!==o&&o.has(t)},get:function(t,e,n){var o=s(e,n,!1);return void 0===o?void 0:o.get(t)},set:function(t,e,n,o){s(n,o,!0).set(t,e)},keys:function(t,e){var n=s(t,e,!1),o=[];return n&&n.forEach(function(t,e){o.push(e)}),o},key:function(t){return void 0===t||"symbol"==typeof t?t:String(t)},exp:function(t){i(i.S,"Reflect",t)}}},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";o=[n,r,n(0),n(129),n(52)],void 0===(i=function(t,e,n,o,i){return function(){function t(){}return t.toXml=function(t,e,r){var a=t.getBlockStyles(),s=t.getType(),l=o.getStyleNamesOfBlock(s);n.each(l,function(t){var n=a[t],i=o.getConfig(t,s,!1);if(null!=n&&n!==i.default){var l=r.createElement(t),c=r.createTextNode(n);l.appendChild(c),e.appendChild(l)}});var c=t.getUnknownTree();c&&c.styles&&i.appendToXml(c.styles,e)},t.fromXml=function(t,e){var r=t.getUnknownTree(),a=t.getType(),s=o.getStyleNamesOfBlock(a),l=[];$(e).children().each(function(e,n){var o,a=n.nodeName;t.isSupportedBlockStyle(a)?(o=$(n).text(),t.setBlockStyle(a,o),l.push(a)):(r.styles||(r.styles={}),i.appendToTree(r.styles,n))}),n.each(s,function(e){var n;-1===l.indexOf(e)&&(n=o.getConfig(e,a,!1),t.setBlockStyle(e,n.default))})},t}()}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(0);return{ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,CDATA_SECTION_NODE:4,ENTITY_REFERENCE_NODE:5,ENTITY_NODE:6,PROCESSING_INSTRUCTION_NODE:7,COMMENT_NODE:8,DOCUMENT_NODE:9,DOCUMENT_TYPE_NODE:10,DOCUMENT_FRAGMENT_NODE:11,NOTATION_NODE:12,getType:function(t){if(t&&t.nodeType)return t.nodeType},isNode:function(t){var n=this.getType(t);return e.isNumber(n)&&n>=this.ELEMENT_NODE&&n<=this.NOTATION_NODE},isElement:function(t){return this.getType(t)===this.ELEMENT_NODE},isAttribute:function(t){return this.getType(t)===this.ATTRIBUTE_NODE},isText:function(t){return this.getType(t)===this.TEXT_NODE},isCDataSection:function(t){return this.getType(t)===this.CDATA_SECTION_NODE},isEntityReference:function(t){return this.getType(t)===this.ENTITY_REFERENCE_NODE},isEntity:function(t){return this.getType(t)===this.ENTITY_NODE},isProcessingInstruction:function(t){return this.getType(t)===this.PROCESSING_INSTRUCTION_NODE},isComment:function(t){return this.getType(t)===this.COMMENT_NODE},isDocument:function(t){return this.getType(t)===this.DOCUMENT_NODE},isDocumentType:function(t){return this.getType(t)===this.DOCUMENT_TYPE_NODE},isDocumentFragment:function(t){return this.getType(t)===this.DOCUMENT_TYPE_NODE},isNotation:function(t){return this.getType(t)===this.NOTATION_NODE}}}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";var a,s=this&&this.__extends||(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});o=[n,r,n(26),n(2)],void 0===(i=function(t,e,n,o){return function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.getBlockById=function(t,e){var n=e.getBlockById(t);return n||o.warn("Failed to find block",t),n},e.fromCollabJSON=function(t,n){var o=e.getBlockById(t.blockId,n);return o?new e({block:o}):null},e.prototype.isCollapsed=function(){throw new Error("isCollapsed () should be implemented by subclass")},e.prototype.getType=function(){return this.type},e.prototype.clone=function(t){throw new Error("Every subclass of BlockRange should implement the `clone` method")},e.prototype.collapse=function(t){throw new Error("Every subclass of BlockRange should implement the `collapse` method")},e.prototype.expandToStart=function(){},e.prototype.expandToEnd=function(){},e.prototype.getDataAsJSON=function(){throw new Error("toJSON() should be implemented by subclass!")},e.prototype.getDataAsHtml=function(t){throw new Error("toHtml() should be implemented by subclass!")},e.prototype.getDataAsPlain=function(){throw new Error("toPlain() should be implemented by subclass!")},e.prototype.canDrawedByNative=function(){throw new Error("canDrawedByNative() should be implemented by subclass!")},e.prototype.toNativeRange=function(t){if(t&&t.getBlockViewByBlock){var e=t.getBlockViewByBlock(this.block);if(e)return e.convertToNativeRange(this);o.warn("No blockView")}else o.error("note view is unvalid!")},e.prototype.extendToBlockEnd=function(){o.warn('Show sub block range do! "extendToBlockEnd"')},e.prototype.extendToBlockStart=function(){o.warn('Show sub block range do! "extendToBlockStart"')},e.prototype.getBlockId=function(){return this.block?this.block.getId():null},e.prototype.toCollabJSON=function(t){return{blockId:this.block.getId(),rangeType:this.type}},e.prototype.initialize=function(t){t=t||{block:null},this.type="block",this.block=t.block},e}(n)}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";var a,s=this&&this.__extends||(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});o=[n,r,n(0),n(3),n(607),n(2),n(72)],void 0===(i=function(t,e,n,o,i,r,a){var l="1",c="2",u="3",d="4",p="5";return function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.create=function(t){if(t&&t.block&&t.type){if(t.type!==l||e._isValidRect(t.rect))return new e(t);r.error("Failed to create TableRange, rect is NOT valid",t)}else r.error("Failed to create TableRange",t)},e.fromCollabJSON=function(t,n){var i=t.rangeType;if(i===o.TABLE){var s=a.getBlockById(t.blockId,n);return s?e.create({block:s,type:t.simpleValue2,rect:t.simpleValue1}):void 0}r.error("wrong block type:",i)},e._isValidRect=function(t){return t&&t.left>=0&&t.top>=0&&t.width>=1&&t.height>=1},e.prototype.getType=function(){return this.type},e.prototype.getAsRectRange=function(){var t,e=this.type,n=this.block;switch(e){case u:case d:t=i.create({table:n,width:1,height:1,top:e===u?0:n.getRowCount()-1,left:e===u?0:n.getColumnCount()-1});break;case c:t=i.create({table:n,top:0,left:0,width:n.getColumnCount(),height:n.getRowCount()});break;case l:if(!this.rect)return void r.warn("Bad range, please check code, range:",this);t=i.create({table:n,top:this.rect.top,left:this.rect.left,width:this.rect.width,height:this.rect.height});break;case p:return null;default:r.error("Failed to create RectRange",e)}return t},e.prototype.isCollapsed=function(){return this.type===p},e.prototype.isFullSelected=function(){return this.type===c},e.prototype.isOnCellEdit=function(){var t;return this.block.trigger("get-block-view",this.block,function(e){t=e}),t&&t.isOnCellEdit()},e.prototype.isInBlank=function(){return this.type===p},e.prototype.clone=function(){return e.create({block:this.block,type:this.type,rect:this.rect})},e.prototype.collapse=function(){},e.prototype.getDataAsJSON=function(t){var e=this.getAsRectRange();return e?e.getDataAsJSON(t):null},e.prototype.getDataAsHtml=function(){var t=this.getAsRectRange();return t?t.getDataAsHtml():null},e.prototype.getDataAsPlain=function(){var t=this.getAsRectRange();return t?t.getDataAsPlain():null},e.prototype.canDrawedByNative=function(){return!1},e.prototype.toCollabJSON=function(){var e=t.prototype.toCollabJSON.call(this);return e.simpleValue1=this.getAsRectRange()||null,e.simpleValue2=this.getType()||null,e},e.prototype.initialize=function(i){t.prototype.initialize.call(this,i),i=n.defaults(i||{},{type:u,rect:null}),this.block=i.block,this.type=i.type||o.TABLE,this.type===l&&(e._isValidRect(i.rect)?this.rect=i.rect:this.type=u)},e.TYPES={NORMAL:"1",ALL:"2",FIRST_CELL:"3",LAST_CELL:"4",BLANK:"5"},e}(a)}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(){return{LEFT:1,RIGHT:2,UP:3,DOWN:4}}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(0),o=n(2);function i(t){this.name=t.name,this.value=t.value,this.isNative=!0===t.isNative,this.tryNativeIfNeeded=!1!==t.tryNativeIfNeeded,this.stopSelectionChange=!0===t.stopSelectionChange,this.callback=e.isFunction(t.callback)?t.callback:null}return i.prototype.isCmdBall=!0,i.prototype.clone=function(){return new i(this)},i.create=function(t){return t&&t.isCmdBall?t:t&&t.name?new i(t):void o.warn("Failed to create cmdBall",t)},i}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e){t.exports=!1},function(t,e,n){var o=n(86)("meta"),i=n(15),r=n(39),a=n(24).f,s=0,l=Object.isExtensible||function(){return!0},c=!n(14)(function(){return l(Object.preventExtensions({}))}),u=function(t){a(t,o,{value:{i:"O"+ ++s,w:{}}})},d=t.exports={KEY:o,NEED:!1,fastKey:function(t,e){if(!i(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!r(t,o)){if(!l(t))return"F";if(!e)return"E";u(t)}return t[o].i},getWeak:function(t,e){if(!r(t,o)){if(!l(t))return!0;if(!e)return!1;u(t)}return t[o].w},onFreeze:function(t){return c&&d.NEED&&l(t)&&!r(t,o)&&u(t),t}}},function(t,e,n){var o=n(17)("unscopables"),i=Array.prototype;null==i[o]&&n(35)(i,o,{}),t.exports=function(t){i[o][t]=!0}},,function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";var a,s=this&&this.__extends||(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});o=[n,r,n(0),n(70),n(52),n(156),n(38),n(3),n(28),n(53),n(12)],void 0===(i=function(t,e,n,o,i,r,a,l,c,u,d){return function(t){function e(e){return t.call(this,e)||this}return s(e,t),e.createBlank=function(){return new e({})},e.fromCollabJSON=function(t){return e.generalFromJSON(t,!0)},e.fromJSON=function(t){return e.generalFromJSON(t,!1)},e.fromXml=function(t){var n=$(t),r=new e({checked:"true"===n.find("> checked:first").text()});return r.setText(d.fromXml(t)),r.parseIdFromXml(t),n.children().each(function(t,e){switch(e.nodeName){case a.TAG_ID_NAME:case a.LEGACY_TAG_ID_NAME:case"checked":case"text":case"inline-styles":break;case"styles":o.fromXml(r,e);break;default:i.appendToTree(r.unknownTree,e)}}),r},e.getMarker=function(t){if(!t)return"";var n=t.getChecked()?e.CHECKED_MARKER:e.UNCHEKED_MARKER;return n+=" "},e.generalFromJSON=function(e,n){var o=t.generalFromJSON.call(this,e,n);return o&&o.setChecked(!!e.checked),o},e.prototype.countWords=function(){return this.richText.getLength()},e.prototype.getChecked=function(){return this.todoProps.checked},e.prototype.getLegacyResId=function(){return this.todoProps.legacyResId},e.prototype.isFromOldTodo=function(){return!!this.todoProps.legacyResId},e.prototype.setChecked=function(t){t!==this.todoProps.checked&&(this.todoProps.checked=t,this.trigger("checked-change",t))},e.prototype.toCollabJSON=function(){var e=t.prototype.toCollabJSON.call(this);return e.checked=this.getChecked(),e},e.prototype.toHtml=function(t,e,n){var o,i=document.createElement("div"),r=$(document.createElement("div")),a=$(document.createElement("div")),s=this.getChecked(),l=$(i);return l.attr("yne-bulb-block","todo").attr("yne-bulb-checked",s.toString()).attr("id",this.getId()).css("display","table"),r.css({border:"1px solid #bbb",display:"inline-flex",height:"1em","line-height":"1",position:"relative",width:"1em"}),s&&(r.css({"background-repeat":"no-repeat","background-position":"center","background-size":"100%","background-image":"url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+Cjxzdmcgdmlld0JveD0iMCAwIDUwIDUwIiBzdHlsZT0iaGVpZ2h0OiAxMDAlO3dpZHRoOiAxMDAlO3N0cm9rZS13aWR0aDogMjtzdHJva2U6IGJsYWNrO3RvcDogMDtsZWZ0OiAwO3Bvc2l0aW9uOiBhYnNvbHV0ZTsiICB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHhtbG5zOnNrZXRjaD0iaHR0cDovL3d3dy5ib2hlbWlhbmNvZGluZy5jb20vc2tldGNoL25zIj4KICAgIDxwYXRoIGZpbGw9Im5vbmUiIGQ9Ik0xNC4xIDI3LjJsNy4xIDcuMiAxNi43LTE2LjgiPjwvcGF0aD4KPC9zdmc+)"}),l.css("text-decoration","line-through")),this.applyBlockStylesOnElement(l),t=t||0,e=null==e?this.getEndOffset():e,o=this.sliceText(t,e,!1),a.html(u.rich2html(o,{withDefault:n})),a.attr("yne-bulb-todo-content","").css({display:"table-cell","word-break":"break-word","padding-left":"8px",width:"100%"}),l.append(r),l.append(a),i.outerHTML},e.prototype.toJSON=function(e,n){var o=t.prototype.toJSON.call(this,e,n);return o.checked=this.getChecked(),o},e.prototype.toPlain=function(t,e){t=t||0;var n=this.sliceText(t,e,!1);return r(n.toString())},e.prototype.toXml=function(e){var n,o;return o=t.prototype.toXml.call(this,e),(n=e.createElement("checked")).appendChild(e.createTextNode(this.getChecked().toString())),o.appendChild(n),i.appendToXml(this.unknownTree,o),o.setAttribute("compat","true"),o},e.prototype.initialize=function(e){t.prototype.initialize.call(this,e),this.todoProps=n.clone(e),this.type=l.TODO},e.CHECKED_MARKER="✔",e.UNCHEKED_MARKER="☐",e}(c)}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";var a,s=this&&this.__extends||(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});o=[n,r,n(0),n(70),n(12),n(52),n(114),n(289),n(10),n(2),n(98),n(160),n(38),n(3)],void 0===(i=function(t,e,n,o,i,r,a,l,c,u,d,p,h,f){return function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.fromJSON=function(t){if(t&&t.type&&t.type===f.IMAGE&&t.source){var n=new e({source:t.source,title:t.title});return t.styles&&n.setStyles(t.styles),t.blockId&&n.setId(t.blockId),n}u.warn("jsonObj or jsonObj.source does NOT exist!")},e.fromXml=function(t){var n=$(t),i=new e({source:$.trim(n.find("> source:first").text()),title:$.trim(n.find("> text:first").text())});return i.parseIdFromXml(t),n.children().each(function(t,e){switch(e.nodeName){case h.TAG_ID_NAME:case h.LEGACY_TAG_ID_NAME:case"source":case"text":break;case"styles":o.fromXml(i,e);break;default:r.appendToTree(i.unknownTree,e)}}),i},e.prototype.countWords=function(){return 0},e.prototype.getFakeLoading=function(){return this.imageProps.fakeLoading},e.prototype.getHighlight=function(t,e){var o=this,r=[];if(null!=e.images&&e.images.length>0&&n.some(e.images,function(t){return t.resID===o.getSource()&&(r.push({imageInfo:t}),!0)}),null!=t&&t.length>0){var a=i.create(this.imageProps.title);n.each(t,function(t){for(var e=t.getLength(),n=a.indexOf(t,0,!0);-1!==n;)r.push({end:n+e,start:n}),n=a.indexOf(t,n+e,!0)})}return r.length?r:null},e.prototype.getImageInfo=function(){return this.imageInfo},e.prototype.getResId=function(){return this.imageProps.resId},e.prototype.getSource=function(t){var e,n=this.imageProps.source;return!0===t&&(e=this.getExtraInfo("pcResMap"))&&e[n]&&(n=e[n]),n},e.prototype.getStyles=function(t){return t?this.getBlockStyle(t):this.getBlockStyles()},e.prototype.getTitle=function(){return this.imageProps.title},e.prototype.setFakeLoading=function(t){this.imageProps.fakeLoading=t},e.prototype.setImageInfo=function(t){t&&t.resId&&"number"==typeof t.rawWide?this.imageInfo=t:u.error("The imageInfo is not valid in image: "+this.imageProps.resId)},e.prototype.setSource=function(t){return!(!t||t===this.imageProps.source)&&(this.imageProps.source=t+"",this.trigger("content-change"),!0)},e.prototype.setStyles=function(t,e){return n.isString(t)?this.setBlockStyle(t,e):n.isObject(t)&&this.setBlockStyles(t),!0},e.prototype.setTitle=function(t){return t!==this.imageProps.title&&(this.imageProps.title=t+"",this.trigger("content-change"),!0)},e.prototype.hideImageTitle=function(){this.trigger("hide-image-title")},e.prototype.toJSON=function(){var e=t.prototype.toJSON.call(this);return e.source=this.getSource(),e.title=this.getTitle(),e},e.prototype.toHtml=function(t,e,o){var i,r,s=d("",document,!0,!0).ownerDocument,u=this.getStyles(),p=s.createElement("div"),h=$(p),f=$(s.createElement("img"));if(h.attr("yne-bulb-block","image"),n.each(u,function(t,e){switch(e){case"align":h.css("text-align",t);break;case"width":null==t?f.css("width",""):f.css("width",t);break;case"float":h.css("float",t);break;case"back-color":h.css("background-color",t);break;case"padding":h.css("padding",t),"0px"===h.css("padding-top")&&h.css({"padding-top":"4px","padding-bottom":"4px"})}}),i=this.getSource(!0===o),r=this.getTitle(),c.IS_PC&&(i=a(i)),f.attr({alt:r,"data-media-type":"image",src:i}),!c.IS_PC){var g=l.imgToBase64(document.querySelector('img[src^="'+i+'"'));f.attr({src:g||i})}return h.append(f),p.outerHTML},e.prototype.toPlain=function(){return""},e.prototype.toXml=function(e){var n,i,a,s,l,c,u=this.getSource(),d=this.getTitle()||"";if(u)return n=t.prototype.toXml.apply(this,[e]),i=e.createElement("source"),a=e.createTextNode(u),i.appendChild(a),n.appendChild(i),s=e.createElement("text"),l=e.createTextNode(d),s.appendChild(l),n.appendChild(s),c=e.createElement("styles"),o.toXml(this,c,e),n.appendChild(c),r.appendToXml(this.unknownTree,n),n},e.prototype.initialize=function(e){t.prototype.initialize.call(this,e),this.type=f.IMAGE,this.imageProps={source:e.source,title:e.title},this.imageProps.fakeLoading=e.fakeLoading||!1,this.imageProps.resId=p.parseImgSource(this.imageProps.source).resId},e}(h)}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";var a,s=this&&this.__extends||(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});o=[n,r,n(156),n(110),n(3),n(28),n(38),n(12)],void 0===(i=function(t,e,n,o,i,r,a,l){var c,u="javascript",d="default";return(c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.createBlank=function(){return new e({})},e.fromJSON=function(t){var e=r.fromJSON.apply(this,[t]);return e.language=t.language,e.theme=t.theme,e.isSelectedBlock=t.isSelectedBlock,e},e.fromXml=function(t){var e=r.fromXml.apply(this,[t]),n=this.prototype._getChildByTagName(t,"language").textContent,o=this.prototype._getChildByTagName(t,"theme").textContent;return e.setTheme(o),e.setLanguage(n),e},e.prototype.getLanguage=function(){return this.language},e.prototype.setLanguage=function(t){this.language=t,u=t,this.trigger("content-change")},e.prototype.getTheme=function(){return this.theme},e.prototype.setTheme=function(t){this.theme=t,d=t,this.trigger("content-change")},e.prototype.getLength=function(t){return this.richText.toString().replace(e.LINE_BREAK,"").length},e.prototype.getTextStyle=function(){return[]},e.prototype.getTextStylesAtIndex=function(){return{}},e.prototype.getLineInfo=function(t){if(--t<0)return null;var n=this.richText.toString().split(e.LINE_BREAK)[t],o=n.replace(n.trimLeft(),"").length,i=n.length;return{lineStartSpacesNum:o,lineLength:i,lineText:n,lineEndChar:n[i-1]}},e.prototype.pushNewLineText=function(t){"string"==typeof t&&(t=new l({text:l})),this.richText.append(t);var n=t.toString();(n&&n[n.length-1]!==e.LINE_BREAK||""===n)&&this.richText.append(new l({text:e.LINE_BREAK})),this.trigger("content-change")},e.prototype.getCharIndex=function(t,n){for(var o=0,i=this.richText.toString();o<i.length&&t>1;)i[o]===e.LINE_BREAK&&t--,o++;return o+n},e.prototype.insertText=function(t,e,n){var o=this.richText.clone(),i=this.getCharIndex(t,e);this.richText.insert(n,i);var r=this.richText.clone();return this.trigger("content-change",{preRichText:o,newRichText:r}),!0},e.prototype.deleteText=function(e,n,o,i){var r=this.richText.clone(),a=this.getCharIndex(e,n),s=this.getCharIndex(o,i);t.prototype.deleteText.apply(this,[a,s]);var l=this.richText.clone();this.trigger("content-change",{preRichText:r,newRichText:l})},e.prototype.setText=function(t){this.richText=t},e.prototype.sliceText=function(e,n,o,i){var r=this.getCharIndex(e,n),a=this.getCharIndex(o,i);return t.prototype.sliceText.apply(this,[r,a])},e.prototype.tokenizeText=function(t){var e,n,o=this.tokenizer.tokenize(t,this.tokenizer.languages[this.language]);return e=[],n=function(t,o){Array.isArray(t.content)?t.content.forEach(function(t){n(t,!0)}):"string"==typeof t&&o?e.push({type:"tag",content:t}):e.push(t)},o.map(function(t){return n(t)}),e},e.prototype.toPlain=function(t,e,o,i){var r;return r=(t&&o?this.sliceText(t,e,o,i):this.richText).toString(),r=n(r)},e.prototype.toJSON=function(t,e,n,o){var i;i=t&&n?this.sliceText(t,e,n,o):this.richText;var r=a.prototype.toJSON.apply(this);return r.richText=i.toJSON(),r.isSelectedBlock=this.isSelectedBlock,r.theme=this.theme,r.language=this.language,r},e.prototype.code2html=function(){var t=this;return this.toCodeLines().map(function(e){return t.tokenizeText(e)}).map(function(e,n){return t.codeLineToHtml(n+1,e)}).join("")},e.prototype.toHtml=function(t,e,n){var i='<div yne-bulb-block="code" id="'+this.blockId+'" data-theme="'+this.theme+'" data-language="'+this.language+'" style="white-space: pre-wrap;">'+o.escapeHtml(this.richText.toString())+"</div>";return n&&(i='<div class="block-view code-view yne-code-theme-'+this.theme+'">\n                            <div class="para-text">\n                            '+this.code2html()+"\n                            </div>\n                          </div>"),i},e.prototype.getRichTexts=function(){var t,e,n=this.richText.getReadOnlyData(),o=[],i=n.length,r=0;for(t=0;t<i;++t)n[t].char.replace(/\n/g,"")||(e=t,o.push(this.richText.slice(r,e)),r=e+1);return o},e.prototype.toCodeLines=function(t){var n=(void 0===t?this.richText.toString():t).split(e.LINE_BREAK);return""===n[n.length-1]&&1!==n.length&&n.pop(),n},e.prototype.codeLineToHtml=function(t,n){var i=this,r=this.toCodeLines();if(t>r.length)return null;n||(n=this.tokenizeText(r[t-1]));var a=this.YNE_HEAD_CLASS+"-token",s=function(t,e){return'<span class="'+(e?a+" ":"")+(i.YNE_HEAD_CLASS+"-"+t)+'">'},l=function(t){return"<pre>"+t+"</pre>"};return n.length<=1&&""===n[0]?l('<span class="place-holder">'+e.EMPTY_LINE_TAG+"</span>"):l(n.reduce(function(t,e){if("string"==typeof e){var n=o.escapeHtml(e);return t+s(i.PLAIN_STRING_CLASS,!1)+n+"</span>"}n=o.escapeHtml(e.content);return t+s(e.type,!0)+n+"</span>"},""))},e.prototype.injectTokenizer=function(t){t.languages&&t.tokenize&&(this.tokenizer=t)},e.prototype.injectRenderParams=function(t){var e=t.YNE_HEAD_CLASS,n=t.PLAIN_STRING_CLASS;this.YNE_HEAD_CLASS=e,this.PLAIN_STRING_CLASS=n},e.prototype.toXml=function(e){var n=t.prototype.toXml.apply(this,[e]),o=function(t,o){var i=e.createElement(t),r=e.createTextNode(o);i.appendChild(r),n.appendChild(i)};return o("language",this.language),o("theme",this.theme),n},e.prototype.initialize=function(e){t.prototype.initialize.call(this,e),this.type=i.CODE,this.language=e.language||u,this.theme=e.theme||d,this.richText=e.text||new l({text:""}),this.isSelectedBlock=e.isSelectedBlock},e}(r)).LINE_BREAK="\n",c.EMPTY_LINE_TAG="&#8203;",c}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e,o=n(22),i=n(5),r=n(12),a=n(4);return e=o.extend({name:"atom.DeleteBlockText",_textBlock:null,_start:null,_end:null,_deletedText:null,_inlineStyles:null,initialize:function(){var t=this.options.args;a.isCollabCommand(t)||(this._textBlock=this.options.block,this._start=this.options.start,this._end=this.options.end,this._inlineStyles=this.options.inlineStyles),e.__super__.initialize.apply(this)},apply:function(){var t=this._textBlock,e=t.sliceText(this._start,this._end);return!!e&&(this._deletedText=e,t.deleteText(this._start,this._end,this._inlineStyles),!0)},doUnapply:function(){var t=this._deletedText;this._textBlock&&this._deletedText&&this._textBlock.insertText(this._start,t)},fromCollabJSON:function(){var t=this.options.args,n=t.collabProperties.cmdJSON;e.__super__.fromCollabJSON.apply(this),n&&(this._deletedText=r.fromCollabJSON(n.richText),this._textBlock=t.collabProperties.coreEditor.getBlockById(n.blockId),this._start=n.startPosition,this._end=n.endPosition)},toCollabJSON:function(){var t=e.__super__.toCollabJSON.apply(this);return t.blockId=this._textBlock.getId(),t.richText=this._deletedText.toCollabJSON(),t.startPosition=this._start,t.endPosition=this._end,t}}),i.add(e),e}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(122),o=n(231);return e.extend({className:"toolbar-item toolbar-split",initialize:o,render:o,enable:o,disable:o,reset:o})}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},function(t,e){var n=0,o=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++n+o).toString(36))}},function(t,e,n){var o=n(236),i=n(180);t.exports=Object.keys||function(t){return o(t,i)}},function(t,e,n){var o=n(48),i=Math.max,r=Math.min;t.exports=function(t,e){return(t=o(t))<0?i(t+e,0):r(t,e)}},function(t,e,n){var o=n(9),i=n(237),r=n(180),a=n(179)("IE_PROTO"),s=function(){},l=function(){var t,e=n(177)("iframe"),o=r.length;for(e.style.display="none",n(181).appendChild(e),e.src="javascript:",(t=e.contentWindow.document).open(),t.write("<script>document.F=Object<\/script>"),t.close(),l=t.F;o--;)delete l.prototype[r[o]];return l()};t.exports=Object.create||function(t,e){var n;return null!==t?(s.prototype=o(t),n=new s,s.prototype=null,n[a]=t):n=l(),void 0===e?n:i(n,e)}},function(t,e,n){var o=n(236),i=n(180).concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return o(t,i)}},function(t,e,n){"use strict";var o=n(11),i=n(24),r=n(23),a=n(17)("species");t.exports=function(t){var e=o[t];r&&e&&!e[a]&&i.f(e,a,{configurable:!0,get:function(){return this}})}},function(t,e){t.exports=function(t,e,n,o){if(!(t instanceof e)||void 0!==o&&o in t)throw TypeError(n+": incorrect invocation!");return t}},function(t,e,n){var o=n(46),i=n(249),r=n(192),a=n(9),s=n(18),l=n(194),c={},u={};(e=t.exports=function(t,e,n,d,p){var h,f,g,m,y=p?function(){return t}:l(t),v=o(n,d,e?2:1),_=0;if("function"!=typeof y)throw TypeError(t+" is not iterable!");if(r(y)){for(h=s(t.length);h>_;_++)if((m=e?v(a(f=t[_])[0],f[1]):v(t[_]))===c||m===u)return m}else for(g=y.call(t);!(f=g.next()).done;)if((m=i(g,v,f.value,e))===c||m===u)return m}).BREAK=c,e.RETURN=u},function(t,e,n){var o=n(36);t.exports=function(t,e,n){for(var i in e)o(t,i,e[i],n);return t}},function(t,e,n){var o=n(15);t.exports=function(t,e){if(!o(t)||t._t!==e)throw TypeError("Incompatible receiver, "+e+" required!");return t}},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e,o=n(26),i=n(0),r=n(2),a=n(564),s=n(206);return e=o.extend({inheritStyleHandlers:null,uninheritStyleHandlers:null,tagHandler:null,el:null,parent:null,children:null,styles:null,parser:null,options:null,constructor:function(t,e,n,o,i){this.el=t,this.children=[],this.parent=e,this.internalStylesParser=n,this.parent&&this.parent.children&&this.parent.children.push(this),this._computeStyles(),this.computeBulbStyles(),this.parser=o,this.options=i},computeBulbStyles:function(){},_findStyleHandler:function(t,n){var o,a=(t?this.inheritStyleHandlers:this.uninheritStyleHandlers)[n];if(i.isFunction(a))return{action:a};if(i.isObject(a)&&a.action)return a;if(!0===a&&(o=e.styleHandlers[n])&&o.action){if(o.inheritable===t)return o;r.error("The inheritable value of "+n+" is unvalid!")}},_computeStyles:function(){var t=this.el,n={},o=this.tagHandler||e.tagHandlers[t.tagName.toLowerCase()];o&&o(n,t),this.styles={},this._computeInheritStyles(n),this._computeUninheritStyles(n)},_computeStyle:function(t,e){var n,o,r,a=this,s=null!=a.inheritStyleHandlers[e],l=a.parent,c=a.el;null==a.styles[e]&&(s&&!l||(n=a._findStyleHandler(s,e))&&n.action&&(n.requireValues&&n.requireValues.length&&i.each(n.requireValues,function(e){a._computeStyle(t,e)}),s?(o=(l.styles||{})[e],(r=n.action(c,a.styles,o))||!1===r||(r=t[e]),r||!1===r||(r=o)):(r=n.action(c,a.styles))||!1===r||(r=t[e]),(r||!1===r)&&(a.styles[e]=r)))},_computeInheritStyles:function(t){var e=this;e.inheritStyleHandlers&&i.each(e.inheritStyleHandlers,function(n,o){n&&e._computeStyle(t,o)})},_computeUninheritStyles:function(t){var e=this;e.uninheritStyleHandlers&&i.each(e.uninheritStyleHandlers,function(n,o){n&&e._computeStyle(t,o)})},setup:function(){},capture:function(){r.warn("Function capture should be implemented by SubClass")},finish:function(){},handleChildrenBySelf:function(){return!1},emit:function(t){this.parent&&this.parent.capture(t)},getRoot:function(){if(this.parent)return this.parent.getRoot()}},{tagHandlers:a,styleHandlers:s})}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";var a,s=this&&this.__extends||(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});o=[n,r,n(4),n(70),n(52),n(2),n(3),n(28),n(53),n(12),n(112),n(0)],void 0===(i=function(t,e,n,o,i,r,a,l,c,u,d,p){return function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.createBlank=function(){return new e({})},e.fromCollabJSON=function(t){var n=e.generalFromJSON(t,!0);return t.ownerId&&(n.oldOwnerId=t.ownerId),n},e.fromJSON=function(t){return e.generalFromJSON(t,!1)},e.fromXml=function(t){var n,r=new e({});return r.parseIdFromXml(t),r.setText(u.fromXml(t)),$(t).children().each(function(t,e){switch(e.nodeName){case l.TAG_ID_NAME:case l.LEGACY_TAG_ID_NAME:case"text":case"inline-styles":break;case"styles":o.fromXml(r,e);break;case"href":n=$(e).find("value").text(),r.setHref(n);break;default:i.appendToTree(r.unknownTree,e)}}),r},e.generalFromJSON=function(e,n){var o=t.generalFromJSON.call(this,e,n);return o&&e.href&&o.setHref(e.href),o},e.prototype.blur=function(){this.trigger("blur")},e.prototype.findAndSetOwnerList=function(t){var e,n=t.getPreBlock(this),o=t.getNextBlock(this),i=this.oldOwnerId;return i?a.isCatalogue(o)&&i===o.getOwnerId()?(e=o.getOwnerList(),this.setOwnerList(e),e.insertBefore(this,o)):a.isCatalogue(n)&&i===n.getOwnerId()?(e=n.getOwnerList(),this.setOwnerList(e),e.insertAfter(this,n)):(e=new d({id:i}),this.setOwnerList(e),e.insertAfter(this,null)):r.error("No oldOwnerId!")},e.prototype.focus=function(){this.trigger("focus")},e.prototype.getHref=function(){return this.href},e.prototype.getHtmlHref=function(){return n.isGUID(this.href)?"#"+this.href:this.href||"#"},e.prototype.getOwnerId=function(){return this.getOwnerList().getId()},e.prototype.getOwnerList=function(){return this.ownerList||r.warn('No ownerList! check have "setOwnerList"'),this.ownerList},e.prototype.getViewHref=function(){return n.isGUID(this.href)?null:this.href},e.prototype.isFirst=function(){return this.isFirstProp},e.prototype.isLast=function(){return this.isLastProp},e.prototype.removeSorting=function(){var t=!1;this.isFirstProp&&(t=!0,this.isFirstProp=null),this.isLastProp&&(t=!0,this.isLastProp=null),t&&this.trigger("sorting-change")},e.prototype.setOwnerList=function(t){this.ownerList=t},e.prototype.setFirst=function(){this.isFirstProp||(this.isFirstProp=!0,this.trigger("sorting-change"))},e.prototype.setHref=function(t){this.href=t||null,this.trigger("style-change","href",t)},e.prototype.setIndent=function(t){t>0&&this.setBlockStyle("indent",t)},e.prototype.setLast=function(){this.isLastProp||(this.isLastProp=!0,this.trigger("sorting-change"))},e.prototype.toCollabJSON=function(){var e=t.prototype.toCollabJSON.call(this);return e.href=this.getHref(),e.ownerId=this.getOwnerId(),e},e.prototype.toJSON=function(e,n){var o=this.sliceText(e,n,!1),i=t.prototype.toJSON.call(this);return i.text=o.toJSON(),i.href=this.getHref(),i.ownerId=this.getOwnerId(),i},e.prototype.toHtml=function(t,e,n){var o,i,r=document.createElement("div"),a=this.getBlockStyles(),s=$("<a></a>"),l=$(r),u="";return n=!0===n,l.attr("yne-bulb-block","catalogue").css("white-space","pre-wrap"),this.isFirst()&&(u="first"),this.isLast()&&(u+="last"),l.attr("yne-bulb-order",u),this.applyBlockStylesOnElement(l,!0),p.each(a,function(t,e){switch(e){case"back-color":l.css("background-color","rgba(255, 255, 255, 0.7)");break;case"padding":l.css("padding",t),l.css("margin",t)}}),t=t||0,e=null==e?this.getEndOffset():e,o=this.sliceText(t,e,!1),i=c.rich2html(o,{withDefault:n}),s.attr("href",this.getHtmlHref()).html(i),l.html(s[0].outerHTML),r.outerHTML},e.prototype.toXml=function(e){var n,o,i=t.prototype.toXml.apply(this,[e]);return this.getHref()&&(n=e.createElement("href"),o=e.createElement("value"),$(o).text(this.getHref()),n.appendChild(o),i.appendChild(n)),$(i).attr("catalogue-id",this.getOwnerId()),$(i).attr("compat","true"),i},e.prototype.initialize=function(e){t.prototype.initialize.call(this,e),this.type=a.CATALOGUE,this.setHref(e.href),this.setIndent(e.indent),this.options&&this.options.ownerList&&this.setOwnerList(this.options.ownerList),this.on("attached",this._onAttached.bind(this)),this.on("detached",this._onDetached.bind(this)),this.on("select",this._onSelect.bind(this)),this.on("remove-select",this._onRemoveSelect.bind(this))},e.prototype._onAttached=function(t){var e=this.getOwnerList(),n=t.getPreBlock(this),o=t.getNextBlock(this);if(!e)return this.findAndSetOwnerList(t);n&&a.isCatalogue(n)&&n.getOwnerId()===this.getOwnerId()?e.insertAfter(this,n):o&&a.isCatalogue(o)&&o.getOwnerId()===this.getOwnerId()?e.insertBefore(this,o):e.insertAfter(this,null)},e.prototype._onDetached=function(){this.getOwnerList().removeItem(this)},e.prototype._onRemoveSelect=function(){this.getOwnerList().removeSelect()},e.prototype._onSelect=function(){this.getOwnerList().select()},e}(l)}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(){return function(t,e,n,o){if(o=!0===o,t||o){var i,r,a,s,l=function(t,e){var n,o,i;if(e.implementation&&e.implementation.createHTMLDocument)return(n=e.implementation.createHTMLDocument("title")).body.innerHTML=t,n;if((i=e.defaultView||window).DOMParser){o=new i.DOMParser;try{n=o.parseFromString("","text/html")}catch(t){}if(n)return n.body.innerHTML=t,n}}(t,e=e||document);if(l){if(!1!==n)return l.body;for(i=(a=l.body.childNodes).length,s=[],r=0;r<i;r++)s.push(a[r]);return s}}}}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t,e){return{ATTACHMENT:"attachment",IMAGE:"image",TEXT:"text"}}.apply(i,[n,i]))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(){}return t.WS_OPENED="WS_OPENED",t.WS_MESSAGE="WS_MESSAGE",t.WS_CLOSED="WS_CLOSED",t.SESSION_CHNAGED="SESSION_CHNAGED",t.SESSION_JOINED="SESSION_JOINED",t.SESSION_QUIT="SESSION_QUIT",t.SESSION_PROP_UPDATE="SESSION_PROP_UPDATE",t.SESSION_LOCK_UPDATE="SESSION_LOCK_UPDATE",t.SESSION_INIT_DONE="SESSION_INIT_DONE",t.SESSION_INIT_BUILT="SESSION_INIT_BUILT",t.NONDATACMD_MODIFIERS_RESULT="NONDATACMD_MODIFIERS_RESULT",t.LOCK_RELEASED="LOCK_RELEASED",t.LOCK_LOCKED="LOCK_LOCKED",t.LOCK_PROP_UPDATE="LOCK_PROP_UPDATE",t.CONFLICT_LOCKED_BY_ME="CONFLICT_LOCKED_BY_ME",t.CONFLICT_LOCKED_BY_OTHERS="CONFLICT_LOCKED_BY_OTHERS",t.CONFLICT_BLOCK_CHANGED="CONFLICT_BLOCK_CHANGED",t.DATACMD_FAILURE="DATACMD_FAILURE",t.DATACMD_NO_PENDING="DATACMD_NO_PENDING",t.DATACMD_SUCCESS="DATACMD_SUCCESS",t.ENGINE_EXCEPTION="ENGINE_EXCEPTION",t}();e.default=n}.apply(i,[n,i]))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";o=[n,r,n(3),n(21),n(73),n(44)],void 0===(i=function(t,e,n,o,i,r){return function(){function t(){}return t.buildNoteRangeFromJSON=function(t,e){return o.fromCollabJSON(t,e)},t.buildNoteRangeFromNonTextBlock=function(t){var e,a={};return a.block=t,n.isTable(t)&&(a.type=i.TYPES.ALL),e=r.createRangeByBlock(a),o.create({endRange:e,startRange:e})},t.buildNoteRangeFromParagraph=function(t,e,n){var i=r.createRangeByBlock({block:t,start:e,end:n});return o.create({endRange:i,startRange:i})},t}()}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e,o=n(22),i=n(5),r=n(12),a=n(4);return e=o.extend({name:"atom.InsertBlockText",_textBlock:null,_start:null,_insertedText:null,initialize:function(){var t=this.options.args;a.isCollabCommand(t)||(this._textBlock=this.options.block,this._start=this.options.start,this._insertedText=this.options.text),e.__super__.initialize.apply(this)},apply:function(){return!!this._insertedText&&(this._textBlock.insertText(this._start,this._insertedText),!0)},doUnapply:function(){this._textBlock&&this._insertedText&&this._textBlock.deleteText(this._start,this._start+this._insertedText.getLength())},fromCollabJSON:function(){var t=this.options.args,n=t.collabProperties.cmdJSON;e.__super__.fromCollabJSON.apply(this),n&&(this._insertedText=r.fromCollabJSON(n.richText),this._textBlock=t.collabProperties.coreEditor.getBlockById(n.blockId),this._start=n.startPosition)},toCollabJSON:function(){var t=e.__super__.toCollabJSON.apply(this);return t.blockId=this._textBlock.getId(),t.richText=this._insertedText.toCollabJSON(),t.startPosition=this._start,t}}),i.add(e),e}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(56),o=n(231);return e.extend({editorEvents:{"yne-editing-state-change":"onEditingStateChange","yne-selection-change":"onSelectionChange"},onEditingStateChange:function(){},onSelectionChange:o})}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(0),o=n(8),i=n(43),r=n(66),a=n(64),s=n(12),l=n(71),c=n(3),u=n(7),d=n(2),p=n(19),h=n(53),f=n(277),g=n(121),m=n(32),y=n(51),v=n(219);return r.extend({className:"block-view paragraph-view",_template:p.getTemplate("common","paragraph_view"),_tempPlaceholder:null,_selectToStartTimer:null,initialize:function(){r.prototype.initialize.apply(this,arguments);var t=this.block;e.bindAll(this,"_onContentChange","_onStyleChange","_onHighlight"),t.on("content-change",this._onContentChange),t.on("style-change",this._onStyleChange),t.on("high-light",this._onHighlight),this._tempPlaceholder=o("<div></div>"),this._tempPlaceholder.height(0),this._tempPlaceholder.width(this.$el.width()),this._tempPlaceholder.css("display","inline-block")},render:function(){this._renderTemplate(),this._renderText(),this._renderStyles(),r.prototype.render.apply(this,arguments)},_renderTemplate:function(){this.$el.html(this._template())},convertToNativeRange:function(t){if(t){var e,n;if(n=this._getCharacterInfo(t.start)){if((e=document.createRange()).setStart(n.node,n.offset),n=this._getCharacterInfo(t.end))return e.setEnd(n.node,n.offset),e;d.error("_getCharacterInfo blockRange.end error!")}else d.error("_getCharacterInfo blockRange.start error!")}else d.warn("block range is unvalid!")},parseNativeRange:function(t,e,n){var o,i,r;return clearTimeout(this._selectToStartTimer),n?new a({start:0,end:e.getEndOffset(),block:e}):((r=this.el.querySelector(".place-holder"))&&" "===r.innerText?(o=i=0,t.collapsed&&(this._selectToStartTimer=setTimeout(function(){t.setStart(t.startContainer,o),t.setEnd(t.endContainer,i)},150))):(o=this._getCharacterIndex(t.startContainer,t.startOffset,!0),-1===(i=this._getCharacterIndex(t.endContainer,t.endOffset,!1))&&(i=e.getEndOffset())),new a({start:o,end:i,block:e}))},_getCharacterInfo:function(t){var e,n=this.$el.find(".para-text").get(0),i=document.createNodeIterator(n,NodeFilter.SHOW_TEXT),r=i.nextNode(),a=0,s=0;if(0===t||!r)return o(n).children().first().hasClass("page-break-placeholder")&&(s=1),{node:r||n,offset:s};for(;r;){if((e=f(r.nodeValue)).length>0&&a<t&&a+e.length>=t)return{node:r,offset:e.slice(0,t-a).reduce(function(t,e){return t+e.length},0)};a+=e.length,r=i.nextNode()}},_getTextOfNode:function(t){if(l.isText(t))return t.nodeValue;var e,n=document.createNodeIterator(t,NodeFilter.SHOW_TEXT),o="";if(!n)return"";for(e=n.nextNode();e;)o+=e.nodeValue,e=n.nextNode();return o},_charArrayLengthOfNode:function(t){var e=this._getTextOfNode(t);return f(e).length},_charArrayOffset:function(t,e){var n,o=f(t);for(n=0;n<o.length&&e>0;n++)e-=o[n].length;return n},_getCharacterIndex:function(t,e,n){var i,r,a=this.$el.find(".para-text").get(0),s=0;if(!o.contains(a,t)&&t!==a)return n?0:-1;for(l.isText(t)?s+=this._charArrayOffset(t.nodeValue,e):l.isElement(t)&&e>0&&(s+=this._charArrayLengthOfNode(t)),i=t;i!==a;){for(r=i.previousSibling;r;)"page-break"!==r.className&&"page-break-placeholder"!==r.className&&(s+=this._charArrayLengthOfNode(r)),r=r.previousSibling;i=i.parentNode}return s},_createHtmlForBlankLine:function(t){var n,o,i,r=new s({text:" "}),a=document.createElement("span"),l={},c=function(t,e){["bold","italic","font-family","font-size"].indexOf(e)>-1&&(l[e]=t)};return t?e.each(t,c):e.each(this.block.getInlineStylesForEmpty(),c),n=h.rich2html(r),a.innerHTML=n,(o=a.getElementsByTagName("span"))&&o.length?1===o.length?((i=o[0]).setAttribute("class","place-holder"),n=i.outerHTML):(d.error("_createHtmlForBlankLine error",a),n='<span class="place-holder">&nbsp;</span>'):(a.setAttribute("class","place-holder"),n=a.outerHTML),n},_renderText:function(t){var n,r,s=this,l=s.block,c=l.getReadOnlyText(),u=c.getEntities(),d=s._inlineStyleViewMapper,p=s.$el.find(".para-text");if(n=c.isEmpty()?this._createHtmlForBlankLine(t):h.rich2html(c,{styleRules:{color:function(t){var e=t.color;return t.href!==m.getDefault("href")&&i.equals(t.color,"blue")?"#003884":null!=e&&d?d.valueToView("color",e):void 0},"font-family":function(t){var e,n=t["font-family"];return null!=n&&d&&(e=d.valueToView("font-family",n)),n!==e?e:y.getAllValueByFont(n)||n}}}),p.html(n),u&&u.length){var f=e.pluck(u,"type");setTimeout(function(){s.trigger("get-entity",l.blockId,f)})}r=l.getStyleRanges("href"),e.each(r,function(t){var e,n,i;e=new a({start:t.from,end:t.to,block:l}),n=s.convertToNativeRange(e),(i=s._findLinkNode(n.endContainer))&&(("file://"===i.origin||i.href.match(/calculator:\/\/.*/))&&o(i).click(function(){return!1}),o(i).off("hover"),o(i).hover(function(){g.isNoteLinkUrl(i.href)||s.isCollabLocked()||s.trigger("link-menu-show",{linkNode:i,range:e,block:l})},function(){s.trigger("link-menu-hide")}))})},_findLinkNode:function(t){for(var e=t;e&&"A"!==e.tagName;)e=e.parentNode;return e},_renderStyles:function(){var t=this,n=t.block.getBlockStyles();e.each(n,function(e,n){t._setStyle(n,e)}),t._renderStylesFix()},_renderStylesFix:function(){this.$el.find(".para-text").css("fontSize",h.getDefaultForHtml("font-size"))},_setStyle:function(t,e){var n=this.$el,o=n.find(".para-text");switch(t){case"align":o.css("text-align",e);break;case"line-height":e>0?o.css("line-height",String(e)):o.css("line-height","normal");break;case"indent":e=e>0?e:0,n.css("padding-left",e*u.INDENT_WIDTH||"");break;case"text-indent":e=e>0?e:0,o.css("text-indent",e*u.INDENT_WIDTH||"");break;case"back-color":(c.isParagraph(this.block)||c.isHeading(this.block))&&o.parent().css("background-color",e);break;case"padding":(c.isParagraph(this.block)||c.isHeading(this.block))&&o.css("padding",e);break;default:d.warn("unknown block style: "+t)}},_onContentChange:function(){var t,n=!1,o=this.block;e.some(this._pageInfo,function(t){return t&&t.pageBreak&&(n=!0),n}),n&&this.$el.css("height",this.$el.height()),c.isQuote(o)&&(t=v.getQuoteDefaultStyles()),c.isCode(o)||this._renderText(t),this.trigger("view-height-changed",this.cid),n&&this.$el.css("height","auto")},_onStyleChange:function(t,e){this._setStyle(t,e),this.trigger("view-height-changed",this.cid)},_convertToData:function(t,n){var o,i=this,r=i.block;e.each(t,function(t){o=new a({block:r,start:t.start,end:t.end}),n(i.convertToNativeRange(o))})},_onHighlight:function(t,e,n){var o=this.block.getHighlight(t,e);o&&this._convertToData(o,n)},_findOverflowSpan:function(t,e){var n,o,i,r,a,s=this._pageInfo[t-1];for(s?(o=s.pageBreak.isAtViewBeginning()?this.$el.find(".para-text").children().first():s.pageBreak.getPlaceholder().next(),r=this._getOffsetTopPos(s.pageBreak.getPlaceholder())+s.pageBreak.getPlaceholder().height()):(o=this.$el.find(".para-text").children().first(),r=this._getOffsetTopPos(this.$el)),o.is("span")||o.is("pre")||(o=o.find("span").first()),n=o,i=o;n.length>0&&(n.after(this._tempPlaceholder),a=this._getOffsetTopPos(this._tempPlaceholder)-r-e,n.outerHeight(!0)>0&&(i=n),!(a>0));)n=this._tempPlaceholder.next();return this._tempPlaceholder.remove(),{textSpan:i,overflowHeight:a,isFirstSpan:o===i}},_getContentContainer:function(){return this.$el.find(".para-text")},_handlePageOverflow:function(t,e){var n,o=this._getHeightInPage(t);return!((n=this.PAGE_HEIGHT-e)>o)&&(this._insertPageBreak(t,n),!0)},_insertPageBreak:function(t,e){var n,o,i,r,a,s;this.block.isEmpty()||e<=0||this._forcePageBreakBegin?n=this._insertPageBreakAtViewBeginning(t,0):(o=this._findOverflowSpan(t,e)).overflowHeight<=0?(n=this._createPageBreak(t,Math.abs(o.overflowHeight)),0===o.textSpan.height()?o.textSpan.before(n.getPlaceholder()):o.textSpan.parent().parent().after(n.getPlaceholder())):this._isSplitAvailable(o.textSpan,o.overflowHeight)?(r=o.textSpan.height()-o.overflowHeight,i=this._splitTextSpan(o.textSpan,r),n=this._createPageBreak(t,r-i[0].height()),i[0].after(n.getPlaceholder())):o.isFirstSpan?n=this._insertPageBreakAtViewBeginning(t,e):((s=(a=this._pageInfo[t-1])&&a.pageBreak?e-(this._getOffsetTopPos(o.textSpan)-this._getOffsetTopPos(a.pageBreak.getPlaceholder())-a.pageBreak.getPlaceholder().height()):e-(this._getOffsetTopPos(o.textSpan)-this._getOffsetTopPos(this.$el)))<0&&(s=0),n=this._createPageBreak(t,s),o.textSpan.before(n.getPlaceholder())),this._coincidePageBreak(n),this._pageInfo[t].pageBreak=n},_insertPageBreakAtViewBeginning:function(t,e){var n;return(n=this._createPageBreak(t,e)).setAtViewBeginning(!0),this.$el.prepend(n.getPlaceholder()),n},_isSplitAvailable:function(t,e){var n,o,i;if(0===t.length||""===t.text())return!1;for(o=t.height()-e,n=document.createRange(),i=t[0].firstChild;null!=i&&("#text"!==i.nodeName.toLowerCase()||0===i.textContent.length);)i=i.nextSibling;return null!=i&&(n.setStart(i,0),n.setEnd(i,1),!(n.getBoundingClientRect().height>o)&&(n.setEnd(i,i.textContent.length),!(n.getBoundingClientRect().height<o)))},_splitTextSpan:function(t,e){var n,o,i,r=t[0].firstChild,a=0,s=t.text().length,l=[];for((n=document.createRange()).setStart(r,0);s-a>1&&(i=Math.ceil((s+a)/2),n.setEnd(r,i),(o=n.getBoundingClientRect().height)!==e);)o>e?s=i:a=i;if(o<=e){for(;i<t.text().length&&o<=e;)i++,n.setEnd(r,i),o=n.getBoundingClientRect().height;i-=1}else for(;i>0&&o>e;)i--,n.setEnd(r,i),o=n.getBoundingClientRect().height;return l[0]=t.clone(),l[1]=t.clone(),l[0].text(t.text().substr(0,i)),l[1].text(t.text().substr(i)),t.before(l[0]),t.before(l[1]),t.remove(),l}})}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o=n(24).f,i=n(39),r=n(17)("toStringTag");t.exports=function(t,e,n){t&&!i(t=n?t:t.prototype,r)&&o(t,r,{configurable:!0,value:e})}},function(t,e,n){var o=n(47),i=n(17)("toStringTag"),r="Arguments"==o(function(){return arguments}());t.exports=function(t){var e,n,a;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=function(t,e){try{return t[e]}catch(t){}}(e=Object(t),i))?n:r?o(e):"Object"==(a=o(e))&&"function"==typeof e.callee?"Arguments":a}},function(t,e,n){var o=n(1),i=n(58),r=n(14),a=n(183),s="["+a+"]",l=RegExp("^"+s+s+"*"),c=RegExp(s+s+"*$"),u=function(t,e,n){var i={},s=r(function(){return!!a[t]()||"​"!="​"[t]()}),l=i[t]=s?e(d):a[t];n&&(i[n]=l),o(o.P+o.F*s,"String",i)},d=u.trim=function(t,e){return t=String(i(t)),1&e&&(t=t.replace(l,"")),2&e&&(t=t.replace(c,"")),t};t.exports=u},function(t,e){t.exports={}},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";o=[n,r,n(0)],void 0===(i=function(t,e,n){var o=function(t){var e=n.keys(t);return n.each(e,function(e){var n=t[e];"object"==typeof n&&null!==n&&o(n)}),Object.freeze(t)};return function(t,e){return t&&"object"==typeof t?(e=!1!==e,Object.freeze?e?o(t):Object.freeze(t):t):t}}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(){var t=/</g,e=/>/g,n=/"/g,o=/&quot;/g,i=/&#([a-zA-Z0-9]*);?/gim,r=/&colon;?/gim,a=/&newline;?/gim,s=/((j\s*a\s*v\s*a|v\s*b|l\s*i\s*v\s*e)\s*s\s*c\s*r\s*i\s*p\s*t\s*|m\s*o\s*c\s*h\s*a)\:/gi,l=/e\s*x\s*p\s*r\s*e\s*s\s*s\s*i\s*o\s*n\s*\(.*/gi,c=/u\s*r\s*l\s*\(.*/gi,u=/<!--[\s\S]*?-->/g;function d(n){return n.replace(t,"&lt;").replace(e,"&gt;")}function p(t){return t.replace(n,"&quot;")}function h(t){return t.replace(o,'"')}function f(t){return t.replace(i,function(t,e){return"x"===e[0]||"X"===e[0]?String.fromCharCode(parseInt(e.substr(1),16)):String.fromCharCode(parseInt(e,10))})}function g(t){return t.replace(r,":").replace(a," ")}function m(t){for(var e="",n=0,o=t.length;n<o;n++)e+=t.charCodeAt(n)<32?" ":t.charAt(n);return e.trim()}function y(t){return t=m(t=g(t=f(t=h(t))))}function v(t){return t=d(t=p(t))}var _={safeAttrValue:function(t,e){if(e=y(e),"href"===t||"src"===t){if("#"===(e=e.trim(e)))return"#";if("http://"!==e.substr(0,7)&&"https://"!==e.substr(0,8)&&"mailto:"!==e.substr(0,7)&&"#"!==e[0]&&"/"!==e[0])return""}else if("background"===t){if(s.lastIndex=0,s.test(e))return""}else if("style"===t){if(l.lastIndex=0,l.test(e))return"";if(c.lastIndex=0,c.test(e)&&(s.lastIndex=0,s.test(e)))return""}return e=v(e)},safeHref:function(t){return t=y(t),s.lastIndex=0,s.test(t)?"":t=v(t)}};return _.escapeHtml=d,_.escapeQuote=p,_.unescapeQuote=h,_.escapeHtmlEntities=f,_.escapeDangerHtml5Entities=g,_.clearNonPrintableCharacter=m,_.friendlyAttrValue=y,_.escapeAttrValue=v,_.onIgnoreTagStripAll=function(){return""},_.StripTagBody=function(t,e){"function"!=typeof e&&(e=function(){});var n=!Array.isArray(t),o=[],i=!1;return{onIgnoreTag:function(r,a,s){if(function(e){return!!n||-1!==t.indexOf(e)}(r)){if(s.isClosing){var l="[/removed]",c=s.position+l.length;return o.push([!1!==i?i:s.position,c]),i=!1,l}return i||(i=s.position),"[removed]"}return e(r,a,s)},remove:function(t){var e="",n=0;return o.forEach(function(o){e+=t.slice(n,o[0]),n=o[1]}),e+=t.slice(n)}}},_.stripCommentTag=function(t){return t.replace(u,"")},_.stripBlankChar=function(t){var e=t.split("");return(e=e.filter(function(t){var e=t.charCodeAt(0);return!(127===e||e<=31&&10!==e&&13!==e)})).join("")},_}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){(function(o){var i;void 0===(i=function(e,o){"use strict";void 0===(i=function(t,e){var n=this.DEBUG,o=this.console,i=function(){};return n&&o.assert&&(i=o.assert.bind(o)),i}.apply(o,[n,o]))||(t.exports=i)}.apply(e,[n,e]))||(t.exports=i)}).call(this,n(67))},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";var a,s=this&&this.__extends||(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});o=[n,r,n(0),n(4),n(111),n(27)],void 0===(i=function(t,e,n,o,i,r){return function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.fromXml=function(t){var o=new e({id:$(t).attr("id")});return n.each(t.attributes,function(t){switch(t.nodeName){case"id":case"type":break;default:o.unknownAttrs.push(t.cloneNode(!0))}}),o},e.prototype.getId=function(){return this.id},e.prototype.getItems=function(){return this.items},e.prototype.getLength=function(){return this.items.length},e.prototype.insertAfter=function(t,e){var n=this.items,o=e?n.indexOf(e):-1;this.insertItem(o+1,t)},e.prototype.insertBefore=function(t,e){var n=this.items,o=e?n.indexOf(e):0;this.insertItem(o,t)},e.prototype.insertItem=function(t,e){var n=this.items;return i(t>0||t<=n.length),n.splice(t,0,e),this.updateIndexes(),t},e.prototype.isLock=function(){return!!this.state},e.prototype.removeItem=function(t){var e=this.items,n=e.indexOf(t);return n>=0&&(e.splice(n,1),this.updateIndexes()),n},e.prototype.removeSelect=function(){var t=this.items;t[0]&&t[0].blur()},e.prototype.select=function(){var t=this.items;this.isLock()||t[0]&&t[0].focus()},e.prototype.updateIndexes=function(){var t=this.items;t.forEach(function(e,n){e.removeSorting(),0===n&&e.setFirst(),n===t.length-1&&e.setLast()})},e.prototype.updateLockState=function(t){this.state=t,this.state&&this.removeSelect()},e.prototype.initialize=function(t){this.id=t.id||o.newGUID(),this.items=[],this.unknownAttrs=[]},e}(r)}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},,function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(){return function(t){if(!t||/^http/i.test(t))return t;var e,n=t.lastIndexOf("\\");return-1===n?t:(e=t.substring(n+1),t.substring(0,n+1)+encodeURIComponent(e))}}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";var a,s=this&&this.__extends||(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});o=[n,r,n(0),n(7),n(70),n(12),n(132),n(99),n(582),n(133),n(52),n(273),n(584),n(2),n(71),n(38),n(3),n(135),n(585),n(163),n(134),n(586)],void 0===(i=function(t,e,n,o,i,r,a,l,c,u,d,p,h,f,g,m,y,v,_,b,C,k){return function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.createBlankTable=function(t,n,o,i){var r,s,l,c=new e({}),u=[],d=[],p=[];for(o?c.setId(o):o=c.getId(),i&&(l=i/t),r=0;r<n;r++)for(p.push(v.DEFAULT_ROW_HEIGHT),u[r]=u[r]||[],s=0;s<t;s++)0===r&&d.push(l||v.DEFAULT_COL_WIDTH),u[r].push(C.create({cellId:C.makeCellId(o,r,s),content:a.createBlank()}));return c.setContentData(u,p,d),c},e.fromJSON=function(t,n){if(t&&t.type&&t.type===y.TABLE){var o=t.data,i=new e({colWidths:o.widths,rowHeights:o.heights,tableCells:u.cellsFromJSON({cellsJson:o.cells,height:o.heights.length,isUpdateCellId:n,resourceList:t.resourceList,width:o.widths.length})});return t.styles&&i.setBlockStyles(t.styles),t.blockId&&i.setId(t.blockId),i}f.warn("jsonObj is not valid!")},e.fromXml=function(t){var n,o,r,a,s,l=$(t),c=l.children("content:first").eq(0),u=$.trim(c.text()),p=e._resourceMapFromXml(l.children("resource-list:first").get(0)),h=new e({resourceMap:p});h.parseIdFromXml(t);try{n=JSON.parse(u)}catch(t){return void f.error(t,u)}return r=n.cells,a=e.validateRowHeights(n.heights),s=e.validateRowHeights(n.widths),o=e._tableCellsFromXml(r,a,s,{resourceMap:p,tableBlockId:h.getId()}),h.setContentData(o,a,s),l.children().each(function(t,e){switch(e.nodeName){case m.TAG_ID_NAME:case m.LEGACY_TAG_ID_NAME:case"content":case"resource-list":break;case"styles":i.fromXml(h,e);break;default:d.appendToTree(h.unknownTree,e)}}),h},e.validateRowHeights=function(t){return e._validateDimensionArray(t,v.DEFAULT_ROW_HEIGHT)},e.validColWidths=function(t){return e._validateDimensionArray(t,v.DEFAULT_COL_WIDTH)},e._resourceMapFromXml=function(t){var e={};return t?($(t).children("resource-mono").each(function(t,o){var i=$(o),r=i.find("res-id").text();r?n.some(_,function(t,n){var a,s=i.children(n+":first").get(0);if(s&&t&&t.fromXml&&(a=t.fromXml(r,s,o)),a)return e[r]=a,!0}):f.error("<resource-mono/> node has no res-id",o)}),e):e},e._tableCellsFromXml=function(t,e,n,o){var i,r,a,s=n.length,l=e.length,c=[];for(i=0;i<l;i++)for(c[i]=[],r=0;r<s;r++)a=i*s+r,c[i][r]=C.fromXml({cellRawData:t[a],colIndex:r,resourceMap:o.resourceMap,rowIndex:i,tableBlockId:o.tableBlockId});return c},e._validateDimensionArray=function(t,e){return t?n.map(t,function(t){return t>0?t:e}):[e]},e.prototype.clearCellAttr=function(t,e){if(!this.isLocked()){var n=this._getCellAt(t,e);n&&(n.clearMergePointAttr(),n.clearMergedCellAttr(),this.trigger("attribute-changed"))}},e.prototype.countWords=function(){var t=this.toPlain({filter:function(t){return t&&t.getType()===l.TEXT},returnString:!1,withLineBreak:!1}),e=0;return n.each(t,function(t){n.each(t,function(t){e+=p(t)})}),e},e.prototype.createCell=function(t){var e,n=(t=t||{}).content||a.createBlank(),o=t.styles;return e=C.create({content:n}),o&&e.setBlockStyles(o),e},e.prototype.creatRowData=function(){var t,e=this.getColumnCount(),n=[];for(t=0;t<e;t++)n.push(this.createCell());return n},e.prototype.deleteCols=function(t,e){if(!this.isLocked()){var n,o,i=[];if(!this.isLocked())return e=e||1,this.tableCells.forEach(function(n){for(o=0;o<e;o++)i[o]=i[o]||[],i[o].push(n.splice(t,1)[0])}),n=this.colWidths.splice(t,e),this.trigger("col-deleted",t,e),{colsData:i,widths:n}}},e.prototype.deleteRows=function(t,e){if(!this.isLocked()){var n,o,i=[];if(!this.isLocked()){for(e=e||1,o=0;o<e;o++)i[o]=this.tableCells.splice(t,1)[0];return n=this.rowHeights.splice(t,e),this.trigger("row-deleted",t,e),{heights:n,rowsData:i}}}},e.prototype.forEach=function(t,e){var n=this;n.forEachRow(function(o){return n.forEachColumn(function(e){return t(o,e)},e)},e)},e.prototype.forEachCell=function(t,e){var n=this,o={};n.forEach(function(e,i){var r,a=n.getCell(e,i,{findMergePointIfNeeded:!0,withPosition:!0});if(a&&(r=a.row+"-"+a.col,!0!==o[r]))return o[r]=!0,t(a.cell,a.row,a.col)},e)},e.prototype.forEachColumn=function(t,e){var n,o=this.getColumnCount();for(n=0;n<o;n++)if(!1===t(e?0+o-n:0+n))return!1},e.prototype.forEachRow=function(t,e){var n,o=this.getRowCount();for(n=0;n<o;n++)if(!1===t(e?0+o-n:0+n))return!1},e.prototype.getAllResourceInfo=function(){var t,e,n,o,i,r=this,a=[];return r.forEach(function(s,l){var c=r.getCell(s,l),u=r.getExtraInfo("pcResMap");c&&c.isImageCell()&&(t=c.getContent(),e=t.getSource(),n=t.getSource(u),e&&n&&a.push({blockId:r.getId(),extraSource:n,source:e})),c&&c.isAttachmentCell()&&(t=c.getContent(),e=t.getSource(),n=t.getSource(u),o=t.getResource(),i=t.getResource(u),e&&n&&o&&i&&a.push({extraResource:i,extraSource:n,resource:o,source:e}))}),a},e.prototype.getCell=function(t,e,o){var i,r;if(!(o=n.defaults(o||{},{findMergePointIfNeeded:!1,withPosition:!1})).findMergePointIfNeeded){if(!(r=this._getCellAt(t,e)))return;return!0===o.withPosition?{cell:r,col:e,row:t}:r}return i=this._findMergePoint(t,e),o.withPosition?i:i&&i.cell?i.cell:null},e.prototype.getCells=function(){return this.tableCells},e.prototype.getCellBlockStyles=function(t){var e,o=t.row,i=t.col,r=t.names,a=this._getCellAt(o,i);return!a.isMergedCell()&&(e=a.getBlockStyles(),r&&r.length>0?n.pick(e,r):e)},e.prototype.getCellById=function(t){if(g.isElement(t)&&(t=$(t).data("cellId")),t){var e,n,o,i=this.getRowCount(),r=this.getColumnCount();for(e=0;e<i;e++)for(n=0;n<r;n++)if((o=this.getCell(e,n))&&o.getCellId()===t)return{cell:o,col:n,row:e}}},e.prototype.getCellInlineStyles=function(t){var e=t.row,n=t.col,o=this._getCellAt(e,n);return o.isTextNoEmptyCell()?o.getInlineStyles(t.names):o.getStylesForEmpty(t.names)},e.prototype.getCellSize=function(t,e){var n=this.getCell(t,e,{findMergePointIfNeeded:!0,withPosition:!0});if(n&&n.cell)return this._getCellSize(n.cell,n.row,n.col)},e.prototype.getCellSizeById=function(t){var e=this.getCellById(t);if(e&&e.cell)return this._getCellSize(e.cell,e.row,e.col)},e.prototype.getColumnCount=function(){var t=(this.colWidths||[]).length;return Math.max(v.MIN_COL_COUNT,t)},e.prototype.getColumnWidth=function(t){return this.colWidths[t]||v.DEFAULT_COL_WIDTH},e.prototype.getCommonBlockStyle=function(t,e){var n;return e&&e.getAsRectRange&&(e=e.getAsRectRange()),e&&e.forEachCell?(e.forEachCell(function(e){var i=e.getBlockStylesAsBulb()||{};if(null==n)n=i[t];else if(n!==i[t])return n=o.INTERM,!1},!1),n===o.INTERM?null:n):(f.warn("Unvalid parameter",e),null)},e.prototype.getCommonInlineStyle=function(t,e){var n;return e&&e.getAsRectRange&&(e=e.getAsRectRange()),e&&e.forEachCell?(e.forEachCell(function(e){var i=e.getCommonInlineStyle(t);if(null==n)n=i;else if(n!==i)return n=o.INTERM,!1},!1),n===o.INTERM?null:n):(f.warn("Unvalid parameter",e),null)},e.prototype.getContentAt=function(t,e){var n=this.getCell(t,e);if(n)return{content:n.getContent(),type:n.getType()}},e.prototype.getMergedCellAttrAt=function(t,e){var n=this._getCellAt(t,e);return n?n.getMergedCellAttr():{}},e.prototype.getMergePointAttrAt=function(t,e){var n=this._getCellAt(t,e);return n?n.getMergePointAttr():{}},e.prototype.getPosition=function(t){if(t){var e,n,o=this.getRowCount(),i=this.getColumnCount();for(e=0;e<o;e++)for(n=0;n<i;n++)if(this.getCell(e,n)===t)return{col:n,row:e}}},e.prototype.getRowCount=function(){var t=(this.rowHeights||[]).length;return Math.max(v.MIN_ROW_COUNT,t)},e.prototype.highlight=function(t,e,n){this.trigger("high-light",t,e,n)},e.prototype.isEmptyContent=function(){var t=!0;return this.forEachCell(function(e){if(!e.isEmpty())return t=!1,!1}),t},e.prototype.getRowHeight=function(t){return this.rowHeights[t]||v.DEFAULT_ROW_HEIGHT},e.prototype.isMergedCell=function(t,e){var n=this.getCell(t,e);return n&&n.isMergedCell&&n.isMergedCell()},e.prototype.isMergePoint=function(t,e){var n=this.getCell(t,e);return n&&n.isMergePoint&&n.isMergePoint()},e.prototype.isMergeRect=function(t){var e;return!!this.isMergePoint(t.top,t.left)&&((e=this.getMergePointAttrAt(t.top,t.left)).width>=t.width&&e.height>=t.height)},e.prototype.insertCols=function(t,e,n){if(!this.isLocked()){var o=this,i=o.tableCells,r=t;n=n||[],e.forEach(function(t,e){i.forEach(function(e,n){e&&e.splice(r,0,t[n])}),o.colWidths.splice(r,0,n[e]||v.DEFAULT_COL_WIDTH),r+=1}),o.trigger("col-inserted",t)}},e.prototype.insertRows=function(t,e,o){if(!this.isLocked()){var i=this,r=t;o=o||[],n.forEach(e,function(t,e){i.tableCells.splice(r,0,t),i.rowHeights.splice(r,0,o[e]||v.DEFAULT_ROW_HEIGHT),r+=1}),i.trigger("row-inserted",t)}},e.prototype.setCellBlockStyles=function(t){if(!this.isLocked()){var e,o=t.row,i=t.col,r=t.styles,a=this._getCellAt(o,i);return!a.isMergedCell()&&(r&&!n.isEmpty(r)||a.clearStyles(),b.bulbStyles2TableStyles(r),a.setBlockStyles(r),e=a.getBlockStyles(),this.trigger("cell-block-style-change",o,i,r,e),!0)}},e.prototype.setCellContent=function(t,e,o){var i,s;if(!this.isLocked())if(null!=o){if(i=this.getCell(t,e))return n.isString(o)&&(o=r.create(o)),o instanceof r&&(o=a.create({richText:o})),(s=i.setContent(o))&&this.trigger("cell-content-change",i.getCellId()),s;f.warn("no cell at row/col",t,e)}else f.warn("content is not valid",o)},e.prototype.setCellInlineStyles=function(t){if(t&&t.styles&&!this.isLocked()){var e=t.row,n=t.col,o=t.styles,i=this._getCellAt(e,n);return i&&i.isTextNoEmptyCell()?(i.setInlineStyles(o),this.trigger("cell-inline-style-change",e,n)):i.setStylesForEmpty(o),!0}},e.prototype.setContentData=function(t,e,n){var o=this;t&&t.length&&e&&e.length&&n&&n.length&&(this.tableCells=t,this.rowHeights=e,this.colWidths=n,setTimeout(function(){o._checkAndFixTableData()}))},e.prototype.setColumnWidth=function(t,e){this.isLocked()||(this.colWidths[t]=e,this.trigger("col-width-set",t,e))},e.prototype.setMergedCellAttrAt=function(t,e,n,o){if(!this.isLocked()){var i=this._getCellAt(t,e);i&&(i.setMergedCellAttr(n,o),this.trigger("attribute-changed"))}},e.prototype.setMergePointAttrAt=function(t,e,n,o){if(!this.isLocked()){var i=this._getCellAt(t,e);i&&(i.setMergePointAttr(n,o),this.trigger("attribute-changed"))}},e.prototype.setRowHeight=function(t,e){this.isLocked()||(this.rowHeights[t]=e,this.trigger("row-height-set",t,e))},e.prototype.toHtml=function(t,e,o){var i=o?this.getExtraInfo("pcResMap"):null,r=c.renderTable(this,null,i),a=document.createElement("div"),s=$(a),l=this.getBlockStyles();return n.each(l,function(t,e){switch(e){case"back-color":s.css("background-color",t);break;case"padding":s.css("padding",t)}}),s.attr("yne-bulb-block","table").css({overflow:"auto"}).append(r),a.outerHTML.replace(/style="(.*?)"/g,function(t){if(t)return t.replace(/\&quot;/g,"")})},e.prototype.toJSON=function(e){var n=this,o=[].concat(n.colWidths),i=[].concat(n.rowHeights),r=[],a={},s={},l=t.prototype.toJSON.call(this);return n.forEach(function(t,o){var i,l=n.getCell(t,o);l&&l.isAttachmentCell()&&!e&&(i=l.getContent(),a[i.getResId()]=i.getInfo()),l&&l.isImageCell()&&!e&&(i=l.getContent(),s[i.getResId()]=i.getInfo()),r.push(l?l.toJSON(e):null)}),e?{cells:r,heights:i,widths:o}:(l.data={cells:r,heights:i,widths:o},l.resourceList={attachMap:a,imageMap:s},l)},e.prototype.toPlain=function(t){var e=this,o=[];return t=n.defaults(t||{},{filter:function(){return!0},returnString:!0,withLineBreak:!1}),e.forEach(function(n,i){var r=o[n],a=e.getCell(n,i),s="";r||(r=o[n]=[]),t.filter(a,n,i)&&(s=a?a.toPlain(t.withLineBreak):""),r.push(s)}),t.returnString?n.map(o,function(t){return t.join(" ")}).join("\n"):o},e.prototype.toXml=function(e){var o,r,a,s=this,l=t.prototype.toXml.call(this,e),c=e.createElement("resource-list"),u=e.createElement("content"),p={},h=[];return s.forEach(function(t,o){var i=s.getCell(t,o),r=i?i.toXml(e,c,p):{},a=n.keys(r);1===a.length&&"value"===a[0]&&""===r.value&&(r={}),h.push(r)}),l.appendChild(c),r={cells:h,heights:[].concat(s.rowHeights),widths:[].concat(s.colWidths)},a=JSON.stringify(r),u.appendChild(e.createTextNode(a)),l.appendChild(u),o=e.createElement("styles"),i.toXml(s,o,e),l.appendChild(o),d.appendToXml(s.unknownTree,l),l},e.prototype.initialize=function(e){t.prototype.initialize.call(this,e),this.type=y.TABLE,this.setContentData(e.tableCells,e.rowHeights,e.colWidths),this.resourceMap=e.resourceMap,delete this.options,n.bindAll(this,"_onDetached","_onAttached","_onLockedChange"),this.on("detached",this._onDetached),this.on("attached",this._onAttached),this.on("locked-change",this._onLockedChange)},e.prototype._checkAndFixTableData=function(){var t,e,n=this.toJSON();try{(t=k(n.data)).errors.length&&(window.console.warn("Table data fix errors:  \n"+t.errors.join("\n")),f.log(n),e=t.fixedData,this.tableCells=u.cellsFromJSON({cellsJson:e.cells,height:e.heights.length,resourceList:n.resourceList,width:e.widths.length}),this.rowHeights=e.heights,this.colWidths=e.widths,this.trigger("content-change"))}catch(t){f.error("Table data fix failed",t)}},e.prototype._getCellAt=function(t,e){var n,o=this.tableCells;return o[t]&&o[t][e]&&(n=o[t][e]),n||f.warn("Failed to get cell at row/col",t,e),n},e.prototype._findMergePoint=function(t,e){var n,o=this._getCellAt(t,e);if(o&&o.isMergedCell()&&(t-=(n=o.getMergedCellAttr()).dy,e-=n.dx,o=this._getCellAt(t,e)),o)return{cell:o,col:e,row:t};f.warn("Failed to find merge point row/col",t,e)},e.prototype._getCellSize=function(t,e,o){if(t&&!t.isMergedCell()){var i,r,a=this,s=function(t,e){return t+e};if(t&&!t.isMergedCell())return t.isMergePoint()?(i=t.getMergePointAttr())&&i.width&&i.height&&(r={cols:[],heights:[],rows:[],widths:[]},h(function(t){var e=o+t,n=a.getColumnWidth(e);r.widths.push(n),r.cols.push(e)},!1,i.width),h(function(t){var n=e+t,o=a.getRowHeight(n);r.heights.push(o),r.rows.push(n)},!1,i.height)):r={cols:[o],heights:[a.getRowHeight(e)],rows:[e],widths:[a.getColumnWidth(o)]},r&&(r.width=n.reduce(r.widths,s,0),r.height=n.reduce(r.heights,s,0)),r}},e.prototype._onDetached=function(){},e.prototype._onAttached=function(){},e.prototype._onLockedChange=function(){},e}(m)}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";var a,s=this&&this.__extends||(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});o=[n,r,n(0),n(114),n(160),n(10),n(292),n(2),n(98),n(162)],void 0===(i=function(t,e,n,o,i,r,a,l,c,u){return function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.create=function(t){if(t&&t.source&&t.resource&&null!=t.fileLength&&t.fileName)return t.resId||l.warn("Will create resId by url!"),new e(t);l.warn("Failed to create AttachmentResource",t)},e.fromJSON=function(t,o){t.resId&&o&&o.attachMap||l.error("jsonObj or resourceList is wrong, ",t,o);var r=o.attachMap[t.resId];return r||l.error("resourceList is wrong"),r.resource&&(t.resId=i.parseImgSource(r.resource).resId),e.fromCollabJSON(n.extend(t,r))},e.fromCollabJSON=function(t){return t.fileLength&&t.fileName&&t.resId&&t.resource&&t.source||l.error("jsonObj is wrong, ",t),e.create({resId:t.resId,source:t.source,resource:t.resource,fileName:t.fileName,fileLength:t.fileLength})},e.fromXml=function(t,n){var o=$(n),i=o.children("source:first").text(),r=o.children("resource:first").text(),a=o.children("filename:first").text(),s=o.children("filelength:first").text();return s&&(s=parseInt(s,10)),e.create({resId:t,source:i,resource:r,fileName:a,fileLength:s,fakeLoading:!1,type:u.TYPE_ATTACHMENT})},e.prototype.getFileName=function(){return this.attachmentProps.fileName},e.prototype.getInfo=function(){return{fileLength:this.attachmentProps.fileLength,fileName:this.attachmentProps.fileName,resource:this.attachmentProps.resource,source:this.attachmentProps.source}},e.prototype.getResource=function(t){var e=this.attachmentProps.resource;return t&&t[e]&&(e=t[e]),e},e.prototype.getSource=function(t){var e=this.attachmentProps.source;return t&&t[e]&&(e=t[e]),e},e.prototype.toCollabJSON=function(){var t;return(t=this.getInfo()).resId=this.attachmentProps.resId,t},e.prototype.toHtml=function(t){var e,i=c("",document,!0,!0).ownerDocument,a=$(i.createElement("img"));return t=n.defaults(t||{},{resourceMap:null}),e=this.getSource(t.resourceMap)||"",r.IS_PC&&(e=o(e)),a.attr({alt:this.attachmentProps.fileName,"data-media-type":"attachment",filelength:this.attachmentProps.fileLength,filename:this.attachmentProps.fileName,path:this.getResource(),src:e,title:this.attachmentProps.fileName}),a.get(0).outerHTML},e.prototype.toJSON=function(){return{resId:this.getResId()}},e.prototype.toPlain=function(){return""},e.prototype.toXml=function(t,e){var n=t.createElement("resource-mono"),o=t.createElement("attach"),i=this.getInfo();a.appendText(t,n,"res-id",this.getResId()),a.appendText(t,o,"source",i.source),a.appendText(t,o,"resource",i.resource),a.appendText(t,o,"filename",i.fileName),a.appendText(t,o,"filelength",i.fileLength),n.appendChild(o),e.appendChild(n)},e.prototype.initialize=function(e){t.prototype.initialize.call(this,e),this.attachmentProps=this.resProps,this.attachmentProps.resId=e.resId||i.parseImgSource(e.resource).resId,this.attachmentProps.type=u.TYPE_ATTACHMENT},e}(u)}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";var a,s=this&&this.__extends||(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});o=[n,r,n(0),n(114),n(160),n(10),n(292),n(2),n(98),n(162)],void 0===(i=function(t,e,n,o,i,r,a,l,c,u){return function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.create=function(t){if(t&&t.source)return t.resId&&l.warn("Will create resId by url!"),new e(t);l.warn("Failed to create ImageResource",t)},e.fromCollabJSON=function(t){return t.resId&&t.source||l.error("jsonObj is wrong , ",t),e.create({height:t.height,resId:t.resId,source:t.source,title:"",type:u.TYPE_IMAGE,width:t.width})},e.fromJSON=function(t,o){t.resId&&o&&o.imageMap||l.error("jsonObj is or resourceList wrong , ",t,o);var r=o.imageMap[t.resId];return r||l.error("resourceList wrong"),r.source&&(t.resId=i.parseImgSource(r.source).resId),e.fromCollabJSON(n.extend(t,r))},e.fromXml=function(t,n){var o=$(n),i=o.children("source:first").text(),r=o.children("width:first").text(),a=o.children("height:first").text();return r&&(r=parseInt(r,10)),a&&(a=parseInt(a,10)),e.create({height:a,resId:t,source:i,title:"",type:u.TYPE_IMAGE,width:r})},e.prototype.getInfo=function(){var t=this.getSize();return null===t.width&&null===t.height&&(t=null),n.extend({source:this.getSource()},t)},e.prototype.getSize=function(){return{height:this.imageProps.height||null,width:this.imageProps.width||null}},e.prototype.getSource=function(t){var e=this.imageProps.source;return t&&t[e]&&(e=t[e]),e},e.prototype.setSource=function(t){return!(!t||t===this.imageProps.source)&&(this.imageProps.source=t+"",!0)},e.prototype.toCollabJSON=function(){var t={};return t.source=this.getSource(),t.width=this.imageProps.width||null,t.height=this.imageProps.height||null,t.resId=this.imageProps.resId,t},e.prototype.toHtml=function(t){var e,i=c("",document,!0,!0).ownerDocument,a=$(i.createElement("img"));return t=n.defaults(t||{},{resourceMap:null}),e=this.getSource(t.resourceMap)||"",r.IS_PC&&(e=o(e)),a.attr({"data-media-type":"image",height:"auto",src:e,width:"100%"}),a.get(0).outerHTML},e.prototype.toJSON=function(){return{resId:this.getResId()}},e.prototype.toPlain=function(){return""},e.prototype.toXml=function(t,e){var o=t.createElement("resource-mono"),i=t.createElement("image"),r=this.getSize();a.appendText(t,o,"res-id",this.getResId()),a.appendText(t,i,"source",this.getSource()),r&&n.each(["width","height"],function(t){var e=r[t];e&&a.appendText(i,t,e+"")}),o.appendChild(i),e.appendChild(o)},e.prototype.initialize=function(e){t.prototype.initialize.call(this,e),this.imageProps=this.resProps,this.imageProps.resId=e.resId||i.parseImgSource(e.source).resId,this.imageProps.type=u.TYPE_IMAGE},e}(u)}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";var a,s=this&&this.__extends||(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),l=this&&this.__assign||Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t};o=[n,r,n(3),n(72)],void 0===(i=function(t,e,n,o){return function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.fromCollabJSON=function(t,n){var i=o.getBlockById(t.blockId,n);return new e(l({block:i},t))},e.createSelectToEndRange=function(t,n,o){var i=t.toCodeLines();return new e({block:t,startLineIndex:n||1,endLineIndex:i.length,startLineCharIndex:o||0,endLineCharIndex:i.pop().length})},e.createBeginRange=function(t){return new e({block:t,startLineIndex:1,endLineIndex:1,startLineCharIndex:0,endLineCharIndex:0})},e.createNewRange=function(t){var e=t.preCodeRange,n=t.charOffset,o=t.lineOffset,i=t.needCollapse,r=void 0===i||i,a=e.clone();return o?(a.endLineIndex=e.startLineIndex+o,a.endLineCharIndex=0+n,r&&(a.startLineIndex=e.startLineIndex+o,a.startLineCharIndex=0+n)):(a.endLineCharIndex=e.startLineCharIndex+n,a.endLineIndex=e.startLineIndex,r&&(a.startLineCharIndex=e.startLineCharIndex+n,a.startLineIndex=e.startLineIndex)),a},e.prototype.convertToParaRangeStartEnd=function(){var t=this.block.toCodeLines(),e=function(e,n){return t.slice(0,e-1).join().length+n+e-1};return{start:e(this.startLineIndex,this.startLineCharIndex),end:e(this.endLineIndex,this.endLineCharIndex)}},e.prototype.isCollapsed=function(){return!this.selectWholeBlock&&(this.startLineIndex===this.endLineIndex&&this.startLineCharIndex===this.endLineCharIndex)},e.prototype.canDrawedByNative=function(){return!0},e.prototype.getDataAsJSON=function(){return this.block.toJSON(this.startLineIndex,this.startLineCharIndex,this.endLineIndex,this.endLineCharIndex)},e.prototype.getDataAsPlain=function(){return this.block.toPlain(this.startLineIndex,this.startLineCharIndex,this.endLineIndex,this.endLineCharIndex)},e.prototype.getDataAsHtml=function(){return this.block.toPlain(this.startLineIndex,this.startLineCharIndex,this.endLineIndex,this.endLineCharIndex)},e.prototype.collapse=function(t){void 0===t&&(t=!0),t?(this.startLineIndex=this.endLineIndex,this.startLineCharIndex=this.endLineCharIndex):(this.endLineIndex=this.startLineIndex,this.endLineCharIndex=this.startLineCharIndex)},e.prototype.clone=function(){return new e({startLineIndex:this.startLineIndex,endLineIndex:this.endLineIndex,startLineCharIndex:this.startLineCharIndex,endLineCharIndex:this.endLineCharIndex,selectWholeBlock:this.selectWholeBlock,block:this.block})},e.prototype.toCollabJSON=function(){var e=t.prototype.toCollabJSON.call(this);return e.selectWholeBlock=!!this.selectWholeBlock,e.startLineIndex=this.startLineIndex,e.startLineCharIndex=this.startLineCharIndex,e.endLineCharIndex=this.endLineCharIndex,e.endLineIndex=this.endLineIndex,e},e.prototype.initialize=function(e){t.prototype.initialize.call(this,e),this.type=n.CODE,this.selectWholeBlock=e.selectWholeBlock,this.startLineIndex=e.startLineIndex,this.startLineCharIndex=e.startLineCharIndex,this.endLineCharIndex=e.endLineCharIndex,this.endLineIndex=e.endLineIndex},e}(o)}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(){}return t.NONDATACMD_BLOCKSELECTION="nb_BlkSelection",t.NONDATACMD_CLINTPONG="nb_clientPong",t.NONDATACMD_COLLABCLOSE="nb_CollabClose",t.NONDATACMD_COLLABINFO="nb_CollabInfo",t.NONDATACMD_DATACMDFAILED="nb_dataCmdFailed",t.NONDATACMD_GETMODIFIERS="nb_getModifiers",t.NONDATACMD_NOTESAVE="nb_noteSave",t.NONDATACMD_LOCKRELEASE="nb_lockRelease",t.NONDATACMD_SESSIONINITIALIZED="nb_sessionInitialized",t.NONDATACMD_SEVERPING="nb_serverPing",t}();e.CmdNames=n,function(t){t[t.EXCEPTION=0]="EXCEPTION",t[t.NO_ERROR=1]="NO_ERROR",t[t.TIME_OUT=100]="TIME_OUT",t[t.STOP_CALL=101]="STOP_CALL"}(e.CustomResultCode||(e.CustomResultCode={})),function(t){t[t.FAILED_RECEIVE_COLLAB_CMD=4001]="FAILED_RECEIVE_COLLAB_CMD",t[t.FAILED_SEND_LOCAL_CMD=4002]="FAILED_SEND_LOCAL_CMD",t[t.MESSAGE_TOO_BIG=4003]="MESSAGE_TOO_BIG",t[t.SESSION_NOT_OPENED=4004]="SESSION_NOT_OPENED",t[t.CLOSED_BY_HOST=4500]="CLOSED_BY_HOST",t[t.COLLAB_SERVER_UNREACHABLE=9e3]="COLLAB_SERVER_UNREACHABLE",t[t.COLLAB_SERVER_SHUTDOWN=9003]="COLLAB_SERVER_SHUTDOWN",t[t.COLLAB_SESSION_CLOSED=9004]="COLLAB_SESSION_CLOSED"}(e.WSCustomCode||(e.WSCustomCode={})),function(t){t[t.LOCAL_INVALID_STARTRANGE=5001]="LOCAL_INVALID_STARTRANGE",t[t.LOCAL_INVALID_CMDJSON=5002]="LOCAL_INVALID_CMDJSON",t[t.LOCAL_TARGET_BLOCK_LOCKED=5003]="LOCAL_TARGET_BLOCK_LOCKED",t[t.LOCAL_EMPTY_CMD=5004]="LOCAL_EMPTY_CMD",t[t.LOCAL_CMD_TOO_FAST=5005]="LOCAL_CMD_TOO_FAST",t[t.LOCAL_INVALID_FOR_COLLAB=5006]="LOCAL_INVALID_FOR_COLLAB",t[t.LOCAL_BLOCKS_MISSING=5008]="LOCAL_BLOCKS_MISSING",t[t.LOCAL_NOT_READY_APPLY=5009]="LOCAL_NOT_READY_APPLY",t[t.LOCAL_DIRTY_BLOCKS=5010]="LOCAL_DIRTY_BLOCKS",t[t.COLLAB_TARGET_BLOCK_LOCKED=5500]="COLLAB_TARGET_BLOCK_LOCKED",t[t.COLLAB_NOTEVERSION_MISMATCH=5507]="COLLAB_NOTEVERSION_MISMATCH",t[t.COLLAB_BLOCKS_MISSING=5508]="COLLAB_BLOCKS_MISSING",t[t.COLLAB_DIRTY_BLOCKS=5510]="COLLAB_DIRTY_BLOCKS"}(e.DataCmdFailureCode||(e.DataCmdFailureCode={}))}.apply(i,[n,i]))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e,o=n(22),i=n(5),r=n(2),a=n(135),s=n(116),l=n(4),c=n(161);return e=o.extend({name:"atom.SetTableCellContent",_table:null,_cellRect:null,_oldContent:null,effected:!1,initialize:function(){var t=this.options.args;l.isCollabCommand(t)||(this._table=this.options.table,this._cellRect=this.options.cellRect,this._content=this.options.content),e.__super__.initialize.apply(this)},_computeSizeChange:function(t){if(t){var e=this._table.getCellSize(t.row,t.col),n={rowHeight:0,rowIndex:-1,colWidth:0,colIndex:-1};if(e)return e.height<a.ATTACHMENT_MIN_HEIGHT&&(n.rowHeight=e.heights[0]+a.ATTACHMENT_MIN_HEIGHT-e.height,n.rowIndex=e.rows[0]),e.width<a.ATTACHMENT_MIN_WIDTH&&(n.colWidth=e.widths[0]+a.ATTACHMENT_MIN_WIDTH-e.width,n.colIndex=e.cols[0]),n.rowHeight||n.colWidth?n:null}},apply:function(){var t,e=this._table,n=this._getCellInfo(this._cellRect)||{},o=this._contentInfo||e.getContentAt(n.row,n.col);return!!o&&(!!e.setCellContent(n.row,n.col,this._content)&&(this._content instanceof s&&(t=this._sizeChanged||this._computeSizeChange(n)),t&&t.rowHeight&&(this._oldSize={rowIndex:t.rowIndex,rowHeight:e.getRowHeight(t.rowIndex)},e.setRowHeight(t.rowIndex,t.rowHeight)),t&&t.colWidth&&(this._oldSize=this._oldSize||{},this._oldSize.colIndex=t.colIndex,this._oldSize.colWidth=e.getColumnWidth(t.colIndex),e.setColumnWidth(t.colIndex,t.colWidth)),this._sizeChanged=t,this._oldContent=o.content,this.effected=!0,this.effected))},doUnapply:function(){var t,e=this._table,n=this._getCellInfo(this._cellRect),o=this._oldSize;if(n)return t=e.setCellContent(n.row,n.col,this._oldContent),o&&o.rowHeight&&e.setRowHeight(o.rowIndex,o.rowHeight),o&&o.colWidth&&e.setColumnWidth(o.colIndex,o.colWidth),t},_getCellInfo:function(t){var e=this._table;if(null!=t.row&&null!=t.col)return{row:t.row,col:t.col,cell:e.getCell(t.row,t.col)};r.error("No cellRect!")},fromCollabJSON:function(){var t,n=this.options.args.collabProperties,o=n.cmdJSON;e.__super__.fromCollabJSON.apply(this),t=n.coreEditor.getNote(),o&&(this._table=t.getBlockById(o.blockId),this._content=c.contentFromCollabJSON(o.simpleValue1),this._oldContent=c.contentFromCollabJSON(o.simpleValue2),this._sizeChanged=o.sizeChanged,this._oldSize=o.oldSize,this._cellRect=o.newBlkId)},toCollabJSON:function(){var t=e.__super__.toCollabJSON.apply(this);return t.blockId=this._table.getId(),t.simpleValue1=c.contentToCollabJSON(this._content),t.simpleValue2=c.contentToCollabJSON(this._oldContent),t.sizeChanged=this._sizeChanged,t.oldSize=this._oldSize,t.newBlkId=this._cellRect,t}}),i.add(e),e}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(8);return{isNoteLinkUrl:function(t){return/^note:\/\/[a-z0-9\-]+$/i.test(t)},getNoteId:function(t){if(t=e.trim(t||"")){var n=/^note:\/\/([a-z0-9\-]+)$/i.exec(t);if(n&&n[1])return n[1]}},fillAsUrl:function(t){if(t=e.trim(t||"")){if(this.isNoteLinkUrl(t)&&(t=this.getNoteId(t)),t)return"note://"+t}}}}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){return n(29).View.extend({editorEvents:{"yne-editing-state-change":"onEditingStateChange","yne-selection-change":"onSelectionChange"},isVisible:!0,show:function(){this.$el.show(),this.isVisible=!0},hide:function(){this.$el.hide(),this.isVisible=!1},enable:function(){this.$el.removeClass("disabled")},disable:function(){this.$el.addClass("disabled")},onEditingStateChange:function(){},onSelectionChange:function(){}})}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o=n(45),i=n(11),r=i["__core-js_shared__"]||(i["__core-js_shared__"]={});(t.exports=function(t,e){return r[t]||(r[t]=void 0!==e?e:{})})("versions",[]).push({version:o.version,mode:n(76)?"pure":"global",copyright:"© 2019 Denis Pushkarev (zloirock.ru)"})},function(t,e,n){var o=n(47);t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==o(t)?t.split(""):Object(t)}},function(t,e){e.f={}.propertyIsEnumerable},function(t,e,n){"use strict";var o=n(9);t.exports=function(){var t=o(this),e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.unicode&&(e+="u"),t.sticky&&(e+="y"),e}},function(t,e,n){var o=n(9),i=n(31),r=n(17)("species");t.exports=function(t,e){var n,a=o(t).constructor;return void 0===a||null==(n=o(a)[r])?e:i(n)}},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";var a,s=this&&this.__extends||(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});o=[n,r,n(0),n(70),n(52),n(208),n(3),n(28),n(53),n(12)],void 0===(i=function(t,e,n,o,i,r,a,l,c,u){return function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.createBlank=function(){return new e({})},e.fromCollabJSON=function(t){return this.generalFromJSON(t,!0)},e.fromJSON=function(t){return this.generalFromJSON(t,!1)},e.fromXml=function(t){var n=new e({});return n.parseIdFromXml(t),n.setText(u.fromXml(t)),e.fromXmlHelp(n,$(t)),$(t).children().each(function(t,e){switch(e.nodeName){case l.TAG_ID_NAME:case l.LEGACY_TAG_ID_NAME:case"text":case"inline-styles":break;case"styles":o.fromXml(n,e);break;default:i.appendToTree(n.unknownTree,e)}}),n},e.generalFromJSON=function(e,n){var o=t.generalFromJSON.call(this,e,n);return o&&e.level&&o.setLevel(e.level),o},e.toXmlHelp=function(t,e){var n=t.getLevel();n&&$(e).attr("level",n),$(e).attr("compat","true")},e.fromXmlHelp=function(t,e){var n=$(e).attr("level");t.setLevel(n)},e.prototype.getBlockStyle=function(e,n){return"heading"===e?this.level:t.prototype.getBlockStyle.call(this,e,n)},e.prototype.getDefaultBlockStyles=function(){return n.extend({},t.prototype.getDefaultBlockStyles.apply(this,[]),r.headingBlockStyles[this.level])},e.prototype.getDefaultInlineStyles=function(){return n.extend({},t.prototype.getDefaultInlineStyles.call(this),r.headingInlineStyles[this.level])},e.prototype.getInlineStylesForEmpty=function(){return n.extend({heading:this.level},this.getDefaultInlineStyles())},e.prototype.getLevel=function(){return this.level},e.prototype.setLevel=function(t){t&&(this.level=t,this.trigger("content-change",this))},e.prototype.toCollabJSON=function(){var e=t.prototype.toCollabJSON.call(this);return e.richText=this.richText.toCollabJSON(),e.level=this.getLevel(),e},e.prototype.toHtml=function(t,e,n){var o,i,r,a=document.createElement("div"),s=$(a);return n=!0===n,s.attr("yne-bulb-block","heading").attr("yne-bulb-level",this.getLevel()).attr("id",this.getId()).css("white-space","pre-wrap"),this.applyBlockStylesOnElement(s),t=t||0,e=null==e?this.getEndOffset():e,o=this.sliceText(t,e,!1),i=c.rich2html(o,{withDefault:n}),s.html(i),r=a.outerHTML,a=s=null,r},e.prototype.toJSON=function(e,n){var o=this.sliceText(e,n,!1),i=t.prototype.toJSON.call(this,e,n);return i.richText=o.toJSON(),i.level=this.getLevel(),i},e.prototype.toXml=function(n){var o=t.prototype.toXml.apply(this,[n]);return e.toXmlHelp(this,o),o},e.prototype.initialize=function(e){t.prototype.initialize.call(this,e),this.type=a.HEADING,this.setLevel(e.level)},e}(l)}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";o=[n,r,n(0),n(2),n(3),n(566)],void 0===(i=function(t,e,n,o,i,r){return function(){function t(){}return t.getAllStyleNames=function(){return t.ALL_KEYS||(t.ALL_KEYS=[],n.each(r,function(e){var o=n.keys(e);n.each(o,function(e){-1===t.ALL_KEYS.indexOf(e)&&t.ALL_KEYS.push(e)})})),[].concat(t.ALL_KEYS)},t.getConfig=function(t,e,n){return(this.getConfigsOfBlock(e,n)||{})[t]},t.getConfigsOfBlock=function(e,i){if(e){var a=r[e],s={};return i=!1!==i,n.each(a,function(o,r){var a=n.clone(o);i&&t.overrideDefaults[e]&&null!=t.overrideDefaults[e][r]&&(a.default=t.overrideDefaults[e][r]),s[r]=a}),s}o.error("parameter is not valid",e)},t.getDefault=function(t,e,n){if(t&&e){var i=(this.getConfigsOfBlock(e,n)||{})[t];return i&&null!=i.default?i.default:void 0}o.error("parameter is not valid",t,e)},t.getDefaultsOfBlock=function(t,e){var o=this.getConfigsOfBlock(t,e),i={};return n.each(o,function(t,e){i[e]=t.default}),i},t.getStyleNamesOfBlock=function(e){var o=t.getConfigsOfBlock(e);return o?n.keys(o):[]},t.isSupport=function(e,n){var o=(t.getConfigsOfBlock(n)||{})[e];return o&&null!=o.type},t.reset=function(){t.overrideDefaults={}},t.setDefault=function(e,r,a){e&&null!=r||o.error("parameter is not valid",e,r);var s=[];a?s.push(a):s=i.getAllBlockTypes(),n.each(s,function(n){t.overrideDefaults[n]||(t.overrideDefaults[n]={}),t.overrideDefaults[n][e]=r})},t.overrideDefaults={},t}()}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";var a,s=this&&this.__extends||(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});o=[n,r,n(0),n(70),n(52),n(2),n(38),n(3)],void 0===(i=function(t,e,n,o,i,r,a,l){return function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.fromCollabJSON=function(t){var e=this.fromJSON(t);return t.blockId&&e.setId(t.blockId),e},e.fromJSON=function(t){if(t&&t.type===l.HR){var o=new e({});return n.each(t.styles,function(t,e){o.setBlockStyle(e,t)}),o}r.error("invalid jsonObj")},e.fromXml=function(t){var n=new e({}),r=$(t);return n.parseIdFromXml(t),r.children().each(function(t,e){switch(e.nodeName){case a.TAG_ID_NAME:case a.LEGACY_TAG_ID_NAME:break;case"styles":o.fromXml(n,e);break;default:i.appendToTree(n.unknownTree,e)}}),n},e.prototype.countWords=function(){return 0},e.prototype.toCollabJSON=function(){return this.toJSON()},e.prototype.toHtml=function(){var t=document.createElement("div"),e=document.createElement("div"),o=$(t),i=this.getBlockStyles();return o.attr("yne-bulb-block","hr"),n.each(i,function(t,e){switch(e){case"back-color":o.css("background-color",t);break;case"padding":o.css("padding",t),"0px"===o.css("padding-top")&&o.css({"padding-top":"4px","padding-bottom":"4px"});break;default:o.attr("yne-style-"+e,t)}}),n.each(i,function(t,e){o.attr("yne-style-"+e,t)}),$(e).css({width:"100%",height:"1px","background-color":"rgb(200, 200, 200)"}),o.append(e),o.css("clear","both"),t.outerHTML},e.prototype.toJSON=function(){return t.prototype.toJSON.call(this)},e.prototype.toPlain=function(){return new Array(81).join("-")},e.prototype.toXml=function(e){var n=t.prototype.toXml.apply(this,[e]),r=e.createElement("styles");return o.toXml(this,r,e),n.appendChild(r),i.appendToXml(this.unknownTree,n),n},e.prototype.initialize=function(e){t.prototype.initialize.call(this,e),this.type=l.HR},e}(a)}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";var a,s=this&&this.__extends||(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});o=[n,r,n(0),n(114),n(10),n(2),n(98),n(38),n(70),n(3),n(52)],void 0===(i=function(t,e,n,o,i,r,a,l,c,u,d){return function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.fromJSON=function(t){if(t&&t.type&&t.type===u.ATTACHMENT&&t.source&&t.resource){var n=new e({fakeLoading:!!t.fakeLoading,fileLength:t.fileLength,fileName:t.fileName,resource:t.resource,source:t.source});return t.styles&&n.setStyles(t.styles),t.blockId&&n.setId(t.blockId),n}r.warn("jsonObj or jsonObj.source/resource does NOT exist!")},e.fromXml=function(t){var n,o,i=$(t),r=$.trim(i.find("source").text()),a=$.trim(i.find("resource").text()),s=$.trim(i.find("filename").text())||"无文件名",u=$.trim(i.find("filelength").text());return o=parseInt(u,10),isNaN(o)&&(o=0),(n=new e({fakeLoading:!1,fileLength:o,fileName:s,resource:a,source:r})).parseIdFromXml(t),i.children().each(function(t,e){switch(e.nodeName){case l.TAG_ID_NAME:case l.LEGACY_TAG_ID_NAME:case"source":case"resource":case"filename":case"filelength":break;case"styles":c.fromXml(n,e);break;default:d.appendToTree(n.unknownTree,e)}}),n},e.prototype.countWords=function(){return 0},e.prototype.getFakeLoading=function(){return this.attachmentProps.fakeLoading},e.prototype.getFileLength=function(){return this.attachmentProps.fileLength},e.prototype.getFileName=function(){return this.attachmentProps.fileName},e.prototype.getResource=function(t){var e,n=this.attachmentProps.resource;return!0===t&&(e=this.getExtraInfo("pcResMap"))&&e[n]&&(n=e[n]),n},e.prototype.getSource=function(t){var e,n=this.attachmentProps.source;return!0===t&&(e=this.getExtraInfo("pcResMap"))&&e[n]&&(n=e[n]),n},e.prototype.getStyles=function(t){return t?this.getBlockStyle(t,!1):this.getBlockStyles()},e.prototype.setFakeLoading=function(t){this.attachmentProps.fakeLoading=t},e.prototype.setFileLength=function(t){var e=parseInt(t,10);return!isNaN(e)&&e!==this.attachmentProps.fileLength&&(this.attachmentProps.fileLength=e,this.trigger("content-change"),!0)},e.prototype.setFileName=function(t){return!(!(t=String(t||""))||t===this.attachmentProps.fileName)&&(this.attachmentProps.fileName=t,this.trigger("content-change"),!0)},e.prototype.setResource=function(t){return!(!(t=(t||"")+"")||t===this.attachmentProps.resource)&&(this.attachmentProps.resource=t,this.trigger("content-change"),!0)},e.prototype.setSource=function(t){return!(!(t=(t||"")+"")||t===this.attachmentProps.source)&&(this.attachmentProps.source=t,this.trigger("content-change"),!0)},e.prototype.setStyles=function(t,e){var o=this;return n.isString(t)?this.setBlockStyle(t,e):n.isObject(t)&&n.each(t,function(t,e){o.setBlockStyle(e,t)}),!0},e.prototype.toHtml=function(t,e,r){var s,l,c=this.getStyles(null),u=a("",document,!0,!0).ownerDocument,d=u.createElement("div"),p=$(d),h=$(u.createElement("img"));return p.attr("yne-bulb-block","attachment"),n.each(c,function(t,e){switch(e){case"align":p.css("text-align",t);break;case"float":p.css("float",t);break;case"back-color":p.css("background-color",t);break;case"padding":p.css("padding",t)}}),l=this.getSource(!0===r),i.IS_PC&&(l=o(l)),h.attr({alt:this.attachmentProps.fileName,"data-media-type":"attachment",filelength:this.attachmentProps.fileLength,filename:this.attachmentProps.fileName,path:this.getResource(!1),src:l,title:this.attachmentProps.fileName}),p.append(h),s=d.outerHTML,d=p=h=null,s},e.prototype.toJSON=function(){var e=t.prototype.toJSON.call(this);return e.source=this.getSource(!1),e.resource=this.getResource(!1),e.fileName=this.getFileName(),e.fileLength=this.getFileLength(),e},e.prototype.toPlain=function(){return""},e.prototype.toXml=function(e){var o,i,r=this;if(r.getSource(!1))return o=t.prototype.toXml.apply(r,[e]),n.each(["Source","Resource","FileName","FileLength"],function(t){var n=e.createElement(t.toLowerCase()),i=r["get"+t](),a=e.createTextNode(i);n.appendChild(a),o.appendChild(n)}),i=e.createElement("styles"),c.toXml(r,i,e),o.appendChild(i),d.appendToXml(r.unknownTree,o),o},e.prototype.initialize=function(e){if(null==e||null==e.source||null==e.resource||null==e.fileLength||null==e.fileName)throw new Error("props or prop(source, resource, fileName, fileLength) in props cannot be null");t.prototype.initialize.call(this,e),this.attachmentProps=n.clone(e),this.attachmentProps.fakeLoading=!!e.fakeLoading,this.type=u.ATTACHMENT},e}(l)}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";var a,s=this&&this.__extends||(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});o=[n,r,n(0),n(7),n(53),n(12),n(27),n(2)],void 0===(i=function(t,e,n,o,i,r,a,l){return function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.create=function(t){if(t&&t.richText)return new e(t);l.warn("Failed to create Lines",t)},e.createBlank=function(t){return t?e.create({richText:r.createBlank(!1)}):new e({})},e.fromCollabJSON=function(t){var o=e.createBlank();return n.map(t,function(t){o.appendRichText(r.fromCollabJSON(t))}),o},e.fromJSON=function(t){var o=e.createBlank();return n.map(t,function(t){o.appendRichText(r.fromJSON(t))}),o},e.splitRichText=function(t){if(t){if(0===t.getLength()||!t.isKeepLineBreak())return[t];var e,o=t.getReadOnlyData(),i=[],a=[],s=0;for(s=0;s<o.length;s++)(e=o[s]).isLineBreak()?(i.push(a),a=[]):a.push(e);return a.length&&i.push(a),i=n.map(i,function(t){var e=r.create("",!1);return e.appendRichChars(t),e})}},e.prototype.appendLines=function(t){t&&(this.richTextList=this.richTextList.concat(t.getAsRichTextList()))},e.prototype.appendRichText=function(t){var n=e.splitRichText(t);n&&n.length&&(this.richTextList=this.richTextList.concat(n))},e.prototype.getAsRichTextList=function(){return[].concat(this.richTextList)},e.prototype.getCommonStyles=function(t,e,n){var o=this.toRichText();return t=t||0,e=e||o.getLength(),o.getCommonStyles(t,e,n)},e.prototype.getCommonStyle=function(t){var e;return n.some(this.richTextList,function(n){if(n&&!n.isEmpty()){var i=n.getCommonStyle(0,n.getLength(),t,!0);if(null==e)null!=i&&(e=i);else if(e!==i)return e=o.INTERM,!0}}),e===o.INTERM&&(e=null),e},e.prototype.getCount=function(){return this.richTextList.length},e.prototype.getStyle=function(t){var e=[];return n.each(this.richTextList,function(n){var o=n.getStyle(0,n.getLength(),t);e.push(o)}),e},e.prototype.isEmpty=function(){var t=this.richTextList;return!t||!t.length||n.every(t,function(t){return t&&t.isEmpty()})},e.prototype.setStyle=function(t,e){var o;n.isArray(e)?(o=e,n.each(this.richTextList,function(e,n){var i=o[n];e.setStyle(0,e.getLength(),t,i)})):n.each(this.richTextList,function(n){n.setStyle(0,n.getLength(),t,e)})},e.prototype.toCollabJSON=function(){return n.map(this.richTextList,function(t){return t.toCollabJSON()})},e.prototype.toJSON=function(){return n.map(this.richTextList,function(t){return t.toJSON()})},e.prototype.toHtml=function(t){var e=(t=n.defaults(t||{},{handleLineWrapper:function(t){t.className="table-cell-line"}})).styleRules,o=n.map(this.richTextList,function(n,o){var r=i.rich2html(n,{styleRules:e}),a=document.createElement("div");return t.handleLineWrapper(a,n,o),a.innerHTML=r,a.outerHTML});return o=o.join("")},e.prototype.toPlain=function(){return n.map(this.richTextList,function(t){return t?t.toString():""})},e.prototype.toRichText=function(){var t,e=this.getCount(),n=this.richTextList,o=r.create("",!0);for(t=0;t<e;t++)o.append(n[t]),t<e-1&&o.append(r.create("\n",!0));return o},e.prototype.toString=function(){return this.toRichText().toString()},e.prototype.initialize=function(t){t=n.defaults(t||{},{richText:null}),this.richTextList=[],this.appendRichText(t.richText)},e}(a)}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";o=[n,r,n(0),n(2),n(134)],void 0===(i=function(t,e,n,o,i){return function(){function t(){}return t.cellsFromCollabJSON=function(t){return t?n.map(t,function(t){return n.map(t,function(t){return i.fromCollabJSON(t)})}):null},t.cellsFromJSON=function(t){var e,n,r,a=t.cellsJson,s=t.height,l=t.width,c=t.isUpdateCellId,u=t.resourceList,d=[];if(!a)return null;for(e=0;e<s;e++)for(d[e]=[],n=0;n<l;n++)a[r=e*l+n]||o.error("Bag json data, no cellData json, row, col: ",a,e,n),d[e][n]=i.fromJSON(a[r],c,u);return d},t.cellsToCollabJSON=function(t){return t?n.map(t,function(t){return n.map(t,function(t){return t.toCollabJSON?t.toCollabJSON():t})}):null},t}()}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";var a,s=this&&this.__extends||(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});o=[n,r,n(0),n(79),n(4),n(3),n(217),n(12),n(132),n(80),n(27),n(2),n(116),n(117),n(162),n(163),n(99),n(161)],void 0===(i=function(t,e,n,o,i,r,a,l,c,u,d,p,h,f,g,m,y,v){return function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.blockToCell=function(t){var n,o=e.blockToCellContent(t);return o&&(n=e.create({content:o})),n},e.blockToCellContent=function(t){if(t){var e,i,s,d,g,m,y=r.getType(t);switch(y){case r.PARAGRAPH:case r.QUOTE:case r.CATALOGUE:case r.CODE:case r.HEADING:i=c.create({richText:t.getText()});break;case r.IMAGE:case r.HANDWRITE:i=f.create({source:t.getSource()});break;case r.ATTACHMENT:i=h.create({fileLength:t.getFileLength(),fileName:t.getFileName(),resource:t.getResource(),source:t.getSource()});break;case r.LIST_ITEM:(e=t.getText()).getLength()&&(m={},n.each(e.getStylesAtIndex(0),function(t,e){a.isSupportedStyle(e)&&(m[e]=t)})),d=a.makePlainMarker(t,!1),d=l.create(d,!1),m&&d.setStyles(0,d.getLength(),m),d.append(l.create(" ",!1)),s=t.getLevel()||1,g=o.repeat(" ",4*(s-1)),(g=l.create(g,!1)).append(d),g.append(e),i=c.create({richText:g});break;case r.TODO:g=u.getMarker(t),g=l.create(g,!1),e=t.getText(),t.getChecked()&&e.setStyles(0,e.getLength(),{strike:!0}),g.append(e),i=c.create({richText:g});break;default:p.warn("Failed to handle block to cell",y,t)}return i}},e.create=function(t){if(t&&t.content){var n=t.content;if(n instanceof c||n instanceof g)return new e(t);p.warn("Failed to create TableCell",t)}else p.warn("Failed to create TableCell",t)},e.createByTable=function(t,n,o,i){var r=t.getId(),a=e.makeCellId(r,n,o);return e.create({cellId:a,content:i})},e.fromCollabJSON=function(t){var n={cellId:t.cellId,content:v.contentFromCollabJSON(t.content),styles:t.styles};return t.attr&&(n.mergeWidth=t.attr.width,n.mergeHeight=t.attr.height,n.mergePointDX=t.attr.dx,n.mergePointDY=t.attr.dy),e.create(n)},e.fromJSON=function(t,o,i){t||p.error("Bad json data!");var r={};return r.styles=n.pick(t,m.getAllStyleNames()),n.extend(r,n.pick(t,e.ATTRIBUTE_NAMES),{cellId:t.cellId,content:v.contentFromJSON(t.content,!1,i)||c.createBlank()}),o&&delete r.cellId,e.create(r)},e.fromXml=function(t){if(t&&t.tableBlockId&&null!=t.rowIndex&&null!=t.colIndex){var o,i={cellId:e.makeCellId(t.tableBlockId,t.rowIndex,t.colIndex)},r=t.cellRawData,a=t.resourceMap,s=e._resourceFromJSON(r,a),l=e.ATTRIBUTE_NAMES,u=m.getAllStyleNames(),d=["value","resource","inlineStyles"].concat(l,u);return s?i.content=s:(o=e._linesFromJSON(r),i.content=o||c.createBlank()),r=r||{},i.unknown=n.omit(r,d.concat(n.keys(v.oldStyleNameMap))),i.styles=n.pick(r,u),n.extend(i,n.pick(r,l)),e.create(i)}p.warn("Failed to create TableCell from JSON",t)},e.makeCellId=function(t,e,n){return[t,"cell",e,n].join("-")},e._linesFromJSON=function(t){var n=e._richTextFromJSON(t);return n?c.create({richText:n}):c.createBlank()},e._resourceFromJSON=function(t,e){if(t&&t.resource){var n=t.resource,o=e[n];return o&&o.getResId&&o.getResId()===n?o:void 0}},e._richTextFromJSON=function(t){if(t&&t.value){var e=t.value,o=new l({text:e}),i=v.oldStyleNameMap,r=o.getLength();return n.each(i,function(e,i){var a=e,s=t[i];null!=s&&("font-size"===a&&n.isString(s)&&(s=s.replace("px","")),o.setStyle(0,r,a,s))}),t.inlineStyles&&n.each(t.inlineStyles,function(t,e){n.each(t,function(t){o.setStyle(t.from,t.to,e,t.value)})}),o}},e.prototype.clearMergedCellAttr=function(){delete this.mergePointDX,delete this.mergePointDY},e.prototype.clearMergePointAttr=function(){delete this.mergeWidth,delete this.mergeHeight},e.prototype.clearStyles=function(){this.styles={}},e.prototype.clearStylesForEmpty=function(){this.stylesForEmpty={}},e.prototype.getBlockStyles=function(){return this.styles},e.prototype.getBlockStylesAsBulb=function(){var t=n.clone(this.styles);return m.tableStyles2BulbStyles(t)},e.prototype.getCellId=function(){return this.cellId},e.prototype.getCommonInlineStyle=function(t){var e=this.getContent();return this.isTextNoEmptyCell()&&e.getCommonStyle?e.getCommonStyle(t):this.stylesForEmpty[t]},e.prototype.getCommonInlineStyles=function(){var t=this.getContent();return this.isTextNoEmptyCell()&&t.getCommonStyles?t.getCommonStyles():this.stylesForEmpty},e.prototype.getContent=function(){return this.content},e.prototype.getInlineStyles=function(t){if(this.isTextNoEmptyCell()){var e=this.getContent(),n={};return t.forEach(function(t){n[t]=e.getStyle(t)}),n}},e.prototype.getMergedCellAttr=function(){return{dx:this.mergePointDX||0,dy:this.mergePointDY||0}},e.prototype.getMergePointAttr=function(){var t=this.mergeWidth||0;return{height:this.mergeHeight||0,width:t}},e.prototype.getStylesForEmpty=function(t){var e,o=this;return t?(e={},n.each(t,function(t){e[t]=o.stylesForEmpty[t]}),e):o.stylesForEmpty},e.prototype.getType=function(){var t=y.TEXT,e=this.getContent();if(e&&e.getType)switch(e.getType()){case g.TYPE_IMAGE:t=y.IMAGE;break;case g.TYPE_ATTACHMENT:t=y.ATTACHMENT}return t},e.prototype.isAttachmentCell=function(){return this.getType()===y.ATTACHMENT},e.prototype.isEmpty=function(){var t=this.getType(),e=this.content;return t===y.TEXT&&(!e||e.isEmpty())},e.prototype.isImageCell=function(){return this.getType()===y.IMAGE},e.prototype.isLocked=function(){return this.locked},e.prototype.isMergedCell=function(){var t=this.getMergedCellAttr();return t.dx>=1||t.dy>=1},e.prototype.isMergePoint=function(){var t=this.getMergePointAttr();return t.width>1||t.height>1},e.prototype.isTextNoEmptyCell=function(){var t=this.getContent();return!!t&&(this.getType()===e.TYPE_TEXT&&!t.isEmpty())},e.prototype.setBlockStyle=function(t,e){var o=m.getConfig(t);o&&(this.isLocked()||("Enum"===o.type?o.possible[e]||(e=o.default):"Number"!==o.type||n.isNumber(e)?"Boolean"!==o.type||n.isBoolean(e)?n["is"+o.type]&&(n["is"+o.type](e)||(e=e.default)):e="true"===e:(e=null===e||""===e?NaN:Number(e),!isNaN(e)&&e||(e=o.default)),e=e||o.default,this.styles[t]=e))},e.prototype.setBlockStyles=function(t){var e=this;if(!e.isLocked())return t?(n.each(t,function(t,n){e.setBlockStyle(n,t)}),!0):void 0},e.prototype.setInlineStyles=function(t){if(t&&this.isTextNoEmptyCell()){var e=this.getContent();n.each(t,function(t,n){e.setStyle(n,t)})}},e.prototype.setContent=function(t){var e=!1;if(!this.isLocked())return t instanceof c?(this.content=t,e=!0,this.isTextNoEmptyCell()&&this.clearStylesForEmpty()):t instanceof g&&(this.content=t,e=!0),e},e.prototype.setLocked=function(t){this.locked=!0===t},e.prototype.setMergedCellAttr=function(t,e){if(null!=t&&null!=e&&t>=0&&e>=0&&(t>0||e>0))return this.mergePointDX=t,this.mergePointDY=e,this.clearMergePointAttr(),!0},e.prototype.setMergePointAttr=function(t,e){return!(!t&&!e)&&(t>=1&&!e&&(p.warn("No valid mergeHeight, will set 1"),e=1),e>=1&&!t&&(p.warn("No valid mergeWidth, will set 1"),t=1),this.mergeWidth=t,this.mergeHeight=e,this.clearMergedCellAttr(),!0)},e.prototype.setStylesForEmpty=function(t){p.log("setStylesForEmpty",t),n.extend(this.stylesForEmpty,t)},e.prototype.setUnknown=function(t){t&&(this.unknown=t)},e.prototype.toCollabJSON=function(){var t,e={};return this.isMergedCell()&&(e=n.extend(e,this.getMergedCellAttr())),this.isMergePoint()&&(e=n.extend(e,this.getMergePointAttr())),t={cellId:this.getCellId(),content:v.contentToCollabJSON(this.content),styles:n.extend({},this.styles)},n.isEmpty(e)||(t.attr=e),t},e.prototype.toHtml=function(){p.error("Should not call TabelCell.toHtml()")},e.prototype.toJSON=function(t){var e,o={},i={};return this.isMergedCell()&&(o=n.extend(o,this.getMergedCellAttr()),n.extend(i,{mergePointDX:o.dx,mergePointDY:o.dy})),this.isMergePoint()&&(o=n.extend(o,this.getMergePointAttr()),n.extend(i,{mergeHeight:o.height,mergeWidth:o.width})),this.isTextNoEmptyCell()&&(i.value=this.content.toString(),t&&(e=this.content.getCommonStyles(null,null,!0),n.extend(i,v.inlineStyle2oldCell(e)))),t?n.extend(i,v.blockStyle2oldCell(this.styles)):n.extend(i,{cellId:this.getCellId(),content:v.contentToJSON(this.content)},v.blockStyle2oldCell(this.styles)),i},e.prototype.toPlain=function(t){return this.isMergedCell()?"":v.contentToPlain(this.content,t)},e.prototype.toXml=function(t,e,o){var i,r,a,s,l,c={};if(this.isMergedCell())return{mergePointDX:(i=this.getMergedCellAttr()).dx,mergePointDY:i.dy,value:""};switch(this.isMergePoint()&&(c={mergeHeight:(i=this.getMergePointAttr()).height,mergeWidth:i.width}),r=this.getType(),a=this.getContent(),n.isEmpty(this.styles)||n.extend(c,this.styles),n.isEmpty(this.unknown)||n.extend(c,this.unknown),r){case y.TEXT:s=a.toRichText().toJSON(!0),c.value=s.text,s.inlineStyles&&(c.inlineStyles=s.inlineStyles);break;case y.IMAGE:case y.ATTACHMENT:l=a.getResId(),c.value="",c.resource=l,l&&!0===o[l]?p.warn("resource has already in <resource-list>",l,a):(a.toXml(t,e),o[l]=!0);break;default:p.error("unvalid type",r)}return c},e.prototype.initialize=function(t){t=t||{},this.styles={},this.cellId=t.cellId||i.newGUID(),this.setContent(t.content),this.setBlockStyles(t.styles),this.setMergePointAttr(t.mergeWidth,t.mergeHeight),this.setMergedCellAttr(t.mergePointDX,t.mergePointDY),this.setUnknown(t.unknown),this.stylesForEmpty={}},e.TYPE_TEXT="text",e.ATTRIBUTE_NAMES=["mergeWidth","mergeHeight","mergePointDX","mergePointDY"],e}(d)}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";o=[n,r,n(109)],void 0===(i=function(t,e,n){return n({DEFAULT_ROW_HEIGHT:40,DEFAULT_COL_WIDTH:70,MIN_ROW_COUNT:1,MIN_COL_COUNT:1,MAX_ROW_COUNT:500,MAX_COL_COUNT:35,ATTACHMENT_MIN_WIDTH:285,ATTACHMENT_MIN_HEIGHT:64,DEFAULT_TABLE_WIDTH:620},!0)}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(2);return{_getHref:function(t,e){if(!(e<0||e>=t.getLength()))return(t.getTextStylesAtIndex(e)||{}).href},_hasHref:function(t,e,n){var o=this._getHref(t,e);return n?o===n:o&&o.length>0},isAtHrefBorder:function(t,e,n){var o=n?e-1:e,i=this._getHref(t,o),r=this._getHref(t,n?o+1:o-1);return i&&i.length>0&&i!==r},findHrefBorder:function(t,n,o){if(!t||!t.getText)return e.error("param is not valid!"),-1;var i,r,a,s=-1,l=t.getText().getLength();if(n>l)return-1;if(o){if(i=n-1,!(a=this._getHref(t,i)))return-1;for(r=i-1;r>=-1;r--)if(!this._hasHref(t,r,a)){s=r+1;break}}else{if(i=n,!(a=this._getHref(t,i)))return-1;for(r=i+1;r<=l;r++)if(!this._hasHref(t,r,a)){s=r-1;break}}return s},completeUrl:function(t){return!t||/\:\/\//.exec(t)?t:"http://"+t}}}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e,o=n(22),i=n(5),r=n(12),a=n(4);return e=o.extend({name:"atom.InsertCodeText",_textBlock:null,_startLineIndex:null,_insertedText:null,initialize:function(){var t=this.options.args;a.isCollabCommand(t)||(this._textBlock=this.options.block,this._startLineIndex=this.options.startBlockRange.startLineIndex,this._startLineCharIndex=this.options.startBlockRange.startLineCharIndex,this._insertedText=this.options.text),e.__super__.initialize.apply(this)},apply:function(){return!!this._insertedText&&(this._textBlock.insertText(this._startLineIndex,this._startLineCharIndex,this._insertedText),!0)},doUnapply:function(){this._textBlock&&this._insertedText&&this._textBlock.deleteText(this._startLineIndex,this._startLineCharIndex,this._startLineIndex,this._startLineCharIndex+this._insertedText.getLength())},fromCollabJSON:function(){var t=this.options.args,n=t.collabProperties.cmdJSON;e.__super__.fromCollabJSON.apply(this),n&&(this._insertedText=r.fromCollabJSON(n.richText),this._textBlock=t.collabProperties.coreEditor.getBlockById(n.blockId),this._start=n.startPosition)},toCollabJSON:function(){var t=e.__super__.toCollabJSON.apply(this);return t.blockId=this._textBlock.getId(),t.richText=this._insertedText.toCollabJSON(),t.startPosition=this._start,t}}),i.add(e),e}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e,o=n(13),i=n(5),r=n(3),a=n(16),s=n(2),l=n(34),c=n(83),u=n(4);return e=o.extend({name:"abstract.comp.InsertResource",_cmdArgs:null,_note:null,_newStartBlkId:null,_newEndBlkId:null,_resourceBlock:null,_retainStartBlock:null,insertResource:function(t,e,n){throw s.error("Method not implemented with:",t,e,n),"Method not implemented"},initialize:function(){var t;this._note=this.options.note,t=this._cmdArgs=this.options.args||{},e.__super__.initialize.apply(this,arguments),u.isCollabCommand(t)||(this._newStartBlkId=u.newGUID(),this._newEndBlkId=u.newGUID(),1===t.retainStartBlock||"1"===t.retainStartBlock||!0===t.retainStartBlock?this._retainStartBlock=!0:this._retainStartBlock=!1)},apply:function(){var t=this._cmdArgs.range,e=t.getStartBlockRange().block;return t?(t.isCollapsed()||t.isSingleTableSelected()||r.isCode(e)||a.deleteSelectedContent(this,this._note,t),t.isInMultiBlock()?this._handleMultiBlockSelection(t):r.isTable(e)?this._handleSingleTableSelection(t,e):this._handleSingleBlockSelection(t)):(s.error(this.name+":note range should NOT be null"),!1)},_deleteBlocks:function(t){this.executeAtomicCommand(new l({note:this._note,blocks:t}))},_deleteBlockText:function(t,e,n){var o="";return e<n&&(o=t.sliceText(e,n),this.executeAtomicCommand(new c({block:t,start:e,end:n}))),o},_handleMultiBlockSelection:function(t){var e,n,o,i,s,l,c,u,d=[],p=[];return e=t.getStartBlockRange().block,s=(i=t.getEndBlockRange()).block,r.isListItem(e)?(u=this._note.getNextBlock(s),i.start!==s.getLength()?(c=s.getText?s.getText():"",l=a.createNewListItem(e,s.getId(),c),p.push(l.getId())):r.isTextBlock(u)||(l=a.createNewParagraph(s,s.getId(),"")),this._deleteBlocks([s]),this._resourceBlock=this.insertResource(e,null,l),p.push(s.getId(),this._resourceBlock.getId()),l||(l=u)):r.isTextBlock(e)?r.isListItem(s)||!r.isTextBlock(s)?(c=s.getText?s.getText():"",l=a.createNewParagraph(s,s.getId(),c),this._deleteBlocks([s]),this._resourceBlock=this.insertResource(e,null,l),p.push(s.getId(),this._resourceBlock.getId())):(l=s,this._resourceBlock=this.insertResource(e),p.push(this._resourceBlock.getId())):(o=this._note.getPreBlock(e),r.isTextBlock(o)&&!r.isCode(o)||(n=a.createNewParagraph(o,this._newStartBlkId,""),p.push(this._newStartBlkId)),d.push(e),p.push(e.getId()),r.isTextBlock(s)||(d.push(s),l=a.createNewParagraph(s,s.getId(),""),p.push(s.getId())),this._deleteBlocks(d),this._resourceBlock=this.insertResource(o,n,l),p.push(this._resourceBlock.getId()),l||(l=s)),a.setTextBlockAsEndingRange(this,l,0,0),this.pushAffectedBlockIds(p),!0},_handleSingleBlockSelection:function(t){var e,n,o,i,s,l,c=[];if(n=(e=t.getStartBlockRange()).block,t.getEndBlockRange().block,!r.isTextBlock(n,e)||n.isEmpty()&&!r.isCode(n))i=this._note.getPreBlock(n),(s=this._note.getNextBlock(n))&&r.isTextBlock(s)||(l=a.createNewParagraph(n,this._newEndBlkId,""),c.push(this._newEndBlkId)),this._retainStartBlock&&(r.isTable(n)||r.isAttachment(n)||r.isImage(n))||r.isCatalogue(n)?(i=n,o=a.createNewParagraph(n,this._newStartBlkId,""),c.push(this._newStartBlkId)):(i&&r.isTextBlock(i)&&!r.isCode(i)||(o=a.createNewParagraph(n,this._newStartBlkId,""),c.push(this._newStartBlkId)),this._deleteBlocks([n]),c.push(n.getId())),this._resourceBlock=this.insertResource(i,o,l);else{if(r.isCode(n))return;s=this._note.getNextBlock(n),e.start!==n.getLength()?l=this._handleSingleParaBlock(e,n):r.isTextBlock(s)||(l=a.createNewParagraph(n,this._newEndBlkId,"")),c.push(this._newEndBlkId),this._resourceBlock=this.insertResource(n,null,l)}return c.push(this._resourceBlock.getId()),l||(l=s),a.setTextBlockAsEndingRange(this,l,0,0),this.pushAffectedBlockIds(c),!0},_handleSingleParaBlock:function(t,e){var n;return n=this._deleteBlockText(e,t.start,e.getLength()),r.isHeading(e)?a.createNewHeading(e,this._newEndBlkId,n,e.getLevel()):r.isCatalogue(e)?a.createNewCatalogue(e,{paraId:this._newEndBlkId,text:n,href:e.getHref()}):r.isListItem(e)?a.createNewListItem(e,this._newEndBlkId,n):r.isQuote(e)?a.createNewQuote(e,{id:this._newEndBlkId,text:n}):r.isTodo(e)?a.createNewTodo(e,{id:this._newEndBlkId,text:n,checked:!1}):a.createNewParagraph(e,this._newEndBlkId,n)},_handleSingleTableSelection:function(t,e){return this._resourceBlock=this.insertResource(e),this.setEndingRange(t),!0},fromCollabJSON:function(){var t=this._cmdArgs.collabProperties.cmdJSON;e.__super__.fromCollabJSON.apply(this),t&&(this._newStartBlkId=t.newStartBlkId,this._newEndBlkId=t.newEndBlkId,this._retainStartBlock=t.abstractSimpleValue1)},toCollabJSON:function(){var t;return(t=e.__super__.toCollabJSON.apply(this))&&(t.newStartBlkId=this._newStartBlkId,t.newEndBlkId=this._newEndBlkId,t.abstractSimpleValue1=this._retainStartBlock),t}}),i.add(e),e}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){for(var e=n(0),o=n(7),i={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",19:"pause",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",44:"printscreen",45:"ins",46:"del",106:"*",107:"+",109:"-",110:".",111:"/",144:"numlock",186:";",189:"-",187:"=",188:",",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},r=o.IS_MAC?{3:"enter",91:"meta",93:"meta",224:"meta"}:{91:"win",92:"win",93:"menu",224:"win",229:"ime"},a=function(t,n,o){return e.some(t,function(t,e){return t===n&&parseInt(e,10)===o})},s={},l="A".charCodeAt(0),c="Z".charCodeAt(0);l<=c;l++)i[l]=String.fromCharCode(l).toLowerCase();for(l=1;l<20;++l)i[111+l]="f"+l;for(l=0;l<=9;l++)i[48+l]=l+"";for(l=0;l<=9;++l)i[l+96]=l+"";return{isMatch:function(t,e){var n=t+"-"+e,o=s[n];return null==o&&(o=a(r,t,e)||a(i,t,e),s[n]=o),o},getKey:function(t){if(e.isNumber(t))return i[t+=""]||r[t]}}}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(173),o=n(8),i=n(0);return e.extend({editorEvents:{"yne-editing-state-change":"onEditingStateChange"},onChange:function(t){var e={},n=this.editor.controller.editingInlineStates;e[this.name]=t,this.editor.execCommandByToolbar("comp.ApplyStyles",{inlineStyles:e,editingInlineStates:n})},updateValueUI:function(t){var e=o(this.valueWrapperEl).find(".combo-value")[0];this.items[t]?o(e).text(this.items[t]):o(e).text(this.getUnlistedText(t)||"")},getUnlistedText:function(){return""},onEditingStateChange:function(t,e){this._isForceSelectWhenClick=!1,i.has(t,this.name)&&(e&&i.has(e,this.name)&&t[this.name]!==e[this.name]&&(this._isForceSelectWhenClick=!0),this.select(t[this.name]))}})}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o=n(40),i=n(18),r=n(88);t.exports=function(t){return function(e,n,a){var s,l=o(e),c=i(l.length),u=r(a,c);if(t&&n!=n){for(;c>u;)if((s=l[u++])!=s)return!0}else for(;c>u;u++)if((t||u in l)&&l[u]===n)return t||u||0;return!t&&-1}}},function(t,e){e.f=Object.getOwnPropertySymbols},function(t,e,n){var o=n(47);t.exports=Array.isArray||function(t){return"Array"==o(t)}},function(t,e,n){var o=n(48),i=n(58);t.exports=function(t){return function(e,n){var r,a,s=String(i(e)),l=o(n),c=s.length;return l<0||l>=c?t?"":void 0:(r=s.charCodeAt(l))<55296||r>56319||l+1===c||(a=s.charCodeAt(l+1))<56320||a>57343?t?s.charAt(l):r:t?s.slice(l,l+2):a-56320+(r-55296<<10)+65536}}},function(t,e,n){var o=n(15),i=n(47),r=n(17)("match");t.exports=function(t){var e;return o(t)&&(void 0!==(e=t[r])?!!e:"RegExp"==i(t))}},function(t,e,n){var o=n(17)("iterator"),i=!1;try{var r=[7][o]();r.return=function(){i=!0},Array.from(r,function(){throw 2})}catch(t){}t.exports=function(t,e){if(!e&&!i)return!1;var n=!1;try{var r=[7],a=r[o]();a.next=function(){return{done:n=!0}},r[o]=function(){return a},t(r)}catch(t){}return n}},function(t,e,n){"use strict";var o=n(106),i=RegExp.prototype.exec;t.exports=function(t,e){var n=t.exec;if("function"==typeof n){var r=n.call(t,e);if("object"!=typeof r)throw new TypeError("RegExp exec method returned something other than an Object or null");return r}if("RegExp"!==o(t))throw new TypeError("RegExp#exec called on incompatible receiver");return i.call(t,e)}},function(t,e,n){"use strict";n(253);var o=n(36),i=n(35),r=n(14),a=n(58),s=n(17),l=n(198),c=s("species"),u=!r(function(){var t=/./;return t.exec=function(){var t=[];return t.groups={a:"7"},t},"7"!=="".replace(t,"$<a>")}),d=function(){var t=/(?:)/,e=t.exec;t.exec=function(){return e.apply(this,arguments)};var n="ab".split(t);return 2===n.length&&"a"===n[0]&&"b"===n[1]}();t.exports=function(t,e,n){var p=s(t),h=!r(function(){var e={};return e[p]=function(){return 7},7!=""[t](e)}),f=h?!r(function(){var e=!1,n=/a/;return n.exec=function(){return e=!0,null},"split"===t&&(n.constructor={},n.constructor[c]=function(){return n}),n[p](""),!e}):void 0;if(!h||!f||"replace"===t&&!u||"split"===t&&!d){var g=/./[p],m=n(a,p,""[t],function(t,e,n,o,i){return e.exec===l?h&&!i?{done:!0,value:g.call(e,n,o)}:{done:!0,value:t.call(n,e,o)}:{done:!1}}),y=m[0],v=m[1];o(String.prototype,t,y),i(RegExp.prototype,p,2==e?function(t,e){return v.call(t,this,e)}:function(t){return v.call(t,this)})}}},function(t,e,n){var o=n(11).navigator;t.exports=o&&o.userAgent||""},function(t,e,n){"use strict";var o=n(11),i=n(1),r=n(36),a=n(94),s=n(77),l=n(93),c=n(92),u=n(15),d=n(14),p=n(146),h=n(105),f=n(184);t.exports=function(t,e,n,g,m,y){var v=o[t],_=v,b=m?"set":"add",C=_&&_.prototype,k={},w=function(t){var e=C[t];r(C,t,"delete"==t?function(t){return!(y&&!u(t))&&e.call(this,0===t?0:t)}:"has"==t?function(t){return!(y&&!u(t))&&e.call(this,0===t?0:t)}:"get"==t?function(t){return y&&!u(t)?void 0:e.call(this,0===t?0:t)}:"add"==t?function(t){return e.call(this,0===t?0:t),this}:function(t,n){return e.call(this,0===t?0:t,n),this})};if("function"==typeof _&&(y||C.forEach&&!d(function(){(new _).entries().next()}))){var S=new _,x=S[b](y?{}:-0,1)!=S,E=d(function(){S.has(1)}),I=p(function(t){new _(t)}),T=!y&&d(function(){for(var t=new _,e=5;e--;)t[b](e,e);return!t.has(-0)});I||((_=e(function(e,n){c(e,_,t);var o=f(new v,e,_);return null!=n&&l(n,m,o[b],o),o})).prototype=C,C.constructor=_),(E||T)&&(w("delete"),w("has"),m&&w("get")),(T||x)&&w(b),y&&C.clear&&delete C.clear}else _=g.getConstructor(e,t,m,b),a(_.prototype,n),s.NEED=!0;return h(_,t),k[t]=_,i(i.G+i.W+i.F*(_!=v),k),y||g.setStrong(_,t,m),_}},function(t,e,n){for(var o,i=n(11),r=n(35),a=n(86),s=a("typed_array"),l=a("view"),c=!(!i.ArrayBuffer||!i.DataView),u=c,d=0,p="Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array".split(",");d<9;)(o=i[p[d++]])?(r(o.prototype,s,!0),r(o.prototype,l,!0)):u=!1;t.exports={ABV:c,CONSTR:u,TYPED:s,VIEW:l}},function(t,e,n){"use strict";t.exports=n(76)||!n(14)(function(){var t=Math.random();__defineSetter__.call(null,t,function(){}),delete n(11)[t]})},function(t,e,n){"use strict";var o=n(1);t.exports=function(t){o(o.S,t,{of:function(){for(var t=arguments.length,e=new Array(t);t--;)e[t]=arguments[t];return new this(e)}})}},function(t,e,n){"use strict";var o=n(1),i=n(31),r=n(46),a=n(93);t.exports=function(t){o(o.S,t,{from:function(t){var e,n,o,s,l=arguments[1];return i(this),(e=void 0!==l)&&i(l),null==t?new this:(n=[],e?(o=0,s=r(l,arguments[2],2),a(t,!1,function(t){n.push(s(t,o++))})):a(t,!1,n.push,n),new this(n))}})}},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e,o=n(96),i=n(3),r=n(128),a=n(28),s=n(80),l=n(12),c=n(568),u=n(7),d=n(0),p=n(97),h=n(112),f=n(8),g=n(4);return e=null,o.extend({inheritStyleHandlers:{bold:!0,italic:!0,underline:!0,strike:!0,"font-family":!0,"font-size":!0,color:!0,"back-color":!0,"white-space":!0,align:!0,"line-height":!0,indent:!0,"text-indent":!0},computeBulbStyles:function(){var t,n=this.el,o=n.getAttribute("yne-bulb-block");this.bulbBlock=o,o===i.PARAGRAPH?(t=n.style.marginLeft,t=parseInt(t,10),isNaN(t)||(t=Math.ceil(t/u.INDENT_WIDTH),this.styles.indent=(this.styles.indent||0)+t)):o===i.TODO&&(t=n.querySelector("[yne-bulb-todo-content]"))?n.innerHTML=t.innerHTML:("catalogue-wrap"===n.getAttribute("yne-bulb-type")||!e&&o===i.CATALOGUE)&&(e=new h({}))},setup:function(){this.block=null},capture:function(t){t&&!0===t.isBr?this.emitBlock(!0):t&&!0===t.isText?this._appendText(t):t&&!0===t.isEmptyPara?this.emitBlock():this.captureBlock(t),this._hasChild=!0},captureBlock:function(t){this.emitBlock(),this.emit(t)},finish:function(){this.emitBlock(),this._hasChild||this.emit({isEmptyPara:!0})},_getBlock:function(){return this.block||(this.block=this.createBlock()),this.block},createBlock:function(){var t,n=this.el;switch(this.bulbBlock){case i.HEADING:return new r({level:n.getAttribute("yne-bulb-level"),id:n.id});case i.CATALOGUE:return t=f(n).find("a").attr("href"),/#\w+$/.test(t)&&(t=t.match(/\w+$/)[0]),new p({id:g.newGUID(),href:t,ownerList:e});case i.TODO:return new s({id:g.newGUID(),checked:"true"===n.getAttribute("yne-bulb-checked")});default:return new a}},_appendText:function(t){this.txtList=this.txtList||[],this.txtList.push(t)},emitBlock:function(t){var e,n,o,r=this,a=r.txtList;n=r._getBlock(),a&&(r.options&&r.options.holdSpaces||(a=c(a)),d.each(a,function(t){r.bulbBlock===i.CATALOGUE&&(t.styles.href=""),t.text&&(o=new l({text:t.text}),e=o.getLength(),d.each(t.styles,function(t,n){o.setStyle(0,e,n,t)}),n.append(o))})),(t||n.getLength()>0)&&(n.setBlockStyles(r.styles),r.emit(n)),r.block=null,r.txtList=null}})}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t,e){return function(t){return t.replace(/\xA0/g," ")}}.apply(i,[n,i]))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},,,function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(0),o=n(96);return o.extend({inheritStyleHandlers:{bold:!0,italic:!0,underline:!0,strike:!0,"font-family":!0,"font-size":!0,color:!0,"back-color":!0,"white-space":!0},inheritBlockStyles:{align:!0,"line-height":!0,indent:!0,"text-indent":!0},_computeInheritStyles:function(){o.prototype._computeInheritStyles.apply(this,arguments),this._computeInheritBlockStyles()},_computeInheritBlockStyles:function(){var t,n=this,o=n.parent,i=n.inheritBlockStyles;o&&o.styles&&(t=o.styles,e.each(i,function(e,o){if(!0===e){var i=t[o];i&&(n.styles[o]=i)}}))},capture:function(t){this.emit(t)}})}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(){return{parseImgSource:function(t){var e=t.split("?")[0].replace(/^\//,"").split("/");return{resId:e[e.length-1]}},isNoteImageSource:function(t){return/(http|https):\/\/note.youdao.com\/([\w.]+\/?)\s*/.test(t)}}}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";o=[n,r,n(0),n(132),n(2),n(116),n(117),n(162),n(99)],void 0===(i=function(t,e,n,o,i,r,a,s,l){return function(){function t(){}return t.boolean2string=function(t){return n.isBoolean(t)?String(t):t},t.blockStyle2oldCell=function(e){var o={};return n.map(e,function(e,n){o[n]=t.boolean2string(e)}),o},t.contentFromCollabJSON=function(e){return t.contentFromJSON(e,!0)},t.contentFromJSON=function(t,e,n){if(t){var s,c=t.type,u=t.data;switch(c){case l.IMAGE:s=e?a.fromCollabJSON(u):a.fromJSON(u,n);break;case l.ATTACHMENT:s=e?r.fromCollabJSON(u):r.fromJSON(u,n);break;case l.TEXT:s=e?o.fromCollabJSON(u):o.fromJSON(u);break;default:i.error("do not support type",c)}return s}},t.contentToCollabJSON=function(e){return t.contentToJSON(e,!0)},t.contentToHtml=function(t,e){if(!t)return"";var n={resourceMap:e};return t instanceof o||t instanceof a||t instanceof r?t.toHtml(n):(i.warn("unvalid content",t),"")},t.contentToJSON=function(t,e){e=!0===e;var n=l.TEXT;if(t){if(t.getType)switch(t.getType()){case s.TYPE_IMAGE:n=l.IMAGE;break;case s.TYPE_ATTACHMENT:n=l.ATTACHMENT}return{data:e?t.toCollabJSON():t.toJSON(),type:n}}},t.contentToPlain=function(t,e){return t?t instanceof o?t.toPlain().join(e?"\n":""):t instanceof a?t.toPlain():t instanceof r?t.toPlain():(i.warn("unvalid content",t),""):""},t.inlineStyle2oldCell=function(e){var o=this.oldStyleNameMap,i={};return n.map(o,function(n,o){null==e[n]||(i[o]=t.boolean2string(e[n]))}),i},t.oldStyleNameMap={bold:"bold",italic:"italic",underline:"underline",lineThrough:"strike",fontName:"font-family",fontSize:"font-size",textColor:"color",link:"href"},t}()}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";var a,s=this&&this.__extends||(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});o=[n,r,n(27),n(2)],void 0===(i=function(t,e,n,o){return function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.fromXml=function(t,e){o.error("fromXml() should be implemented by sub-class")},e.fromCollabJSON=function(t){return o.error("fromCollabJSON() should be implemented by sub-class"),null},e.prototype.getResId=function(){return this.resProps.resId||o.error("No resId"),this.resProps.resId},e.prototype.getType=function(){return this.resProps.type},e.prototype.isType=function(t){return this.resProps.type===t},e.prototype.toHtml=function(t){return o.error("toHtml() should be implemented by sub-class"),""},e.prototype.toJSON=function(){o.error("toJSON() should be implemented by sub-class")},e.prototype.toCollabJSON=function(){o.error("toCollabJSON() should be implemented by sub-class")},e.prototype.toPlain=function(){o.error("toPlain() should be implemented by sub-class")},e.prototype.toXml=function(t,e){o.error("toXml() should be implemented by sub-class")},e.prototype.initialize=function(t){this.resProps=t||{resId:"",type:e.TYPE_IMAGE}},e.TYPE_IMAGE="image",e.TYPE_ATTACHMENT="attachment",e}(n)}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";o=[n,r,n(0),n(583)],void 0===(i=function(t,e,n,o){return function(){function t(){}return t.bulbStyles2TableStyles=function(t){return t.align&&(t.textAlign=t.align,delete t.align),t},t.getAllDefaults=function(){var e={};return n.each(t.STYLE_NAMES,function(n){e[n]=t.getDefault(n)}),e},t.getAllStyleNames=function(){return[].concat(t.STYLE_NAMES)},t.getConfig=function(e){var n;return t.isSupport(e)&&(n=o[e]),n},t.getDefault=function(e){return(t.getConfig(e)||{}).default},t.isSupport=function(e){return t.STYLE_NAMES.indexOf(e)>-1},t.tableStyles2BulbStyles=function(t){return t.textAlign&&(t.align=t.textAlign,delete t.textAlign),t},t.STYLE_NAMES=n.keys(o)||[],t}()}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(){return{test:function(t){return t=String(t),/(https?:\/\/|www\.|ssh:\/\/|ftp:\/\/)[a-z0-9&_+\-\?\/\.=\#,:,@]+$/i.test(t)||/[a-z0-9_+\-\.]+@[a-z0-9_+\-\.]+$/i.test(t)||!1},matchEnd:function(t){var e,n;return t=String(t),(e=/(https?:\/\/|www\.|ssh:\/\/|ftp:\/\/)[a-z0-9&_+\-\?\/\.=\#,:@%\(\)~]+$/i.exec(t))?{mail:!1,fullURI:0===(n=e[0]).toLowerCase().indexOf("www.")?"http://"+n:n,result:e}:(e=/[a-z0-9_+\-\.]+@[a-z0-9_+\-\.]+$/i.exec(t))?{mail:!0,fullURI:"mailto:"+(n=e[0]),result:e}:void 0}}}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";var a,s=this&&this.__extends||(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});o=[n,r,n(7),n(0),n(3),n(28),n(53),n(219)],void 0===(i=function(t,e,n,o,i,r,a,l){var c;return(c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.createBlank=function(){return new e({})},e.prototype.getTextStylesAtIndex=function(t){return this.richText.getStylesAtIndex(t,this.getDefaultSetFont())},e.prototype.getInlineStyleForEmpty=function(t,e){return(this.getInlineStylesForEmpty(e)||this.getDefaultSetFont())[t]},e.prototype.getCommonInlineStyle=function(t,e){var n,o;return e?(n=e.start,o=e.end):(n=this.getStartOffset(),o=this.getEndOffset()),this.richText.getCommonStyle(n,o,t,l.getQuoteDefaultStyles())},e.prototype.getTextStyle=function(t,e,n){var i=this.richText;return o.isObject(e)&&null!=e.start&&(n=e.end,e=e.start),i.getStyle(e,n,t,this.getDefaultSetFont())},e.prototype.setTextStyle=function(t,e,n,i){var r=this.richText;o.isObject(n)&&null!=n.start&&(i=n.end,n=n.start),r.setStyle(n,i,t,e,this.getDefaultSetFont()),this.trigger("content-change")},e.prototype.toHtml=function(t,e,i){t=t||0,e=null==e?this.getEndOffset():e,i=!0===i;var r=document.createElement("div"),s=document.createElement("div"),l=$(r),c=$(s),u=this.getBlockStyles();return c.attr("yne-bulb-block","quote").css("white-space","pre-wrap").css("padding",n.QUOTE_PADDING).css("border-left",n.QUOTE_BORDER_LEFT).css("margin",n.QUOTE_MARGIN),u&&o.each(u,function(t,e){switch(e){case"back-color":t&&l.css("background-color",t);break;case"padding":t&&(c.css("padding",t),c.css("margin",t))}}),c.html(a.rich2html(this.sliceText(t,e,!1),{withDefault:i})),l.append(c),r.outerHTML},e.prototype.initialize=function(e){t.prototype.initialize.call(this,e),this.type=i.QUOTE},e}(r)).DEFAULT_STYLES={color:"#999999",bold:300,"font-family":"宋体","font-size":"14"},c}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";var a,s=this&&this.__extends||(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});o=[n,r,n(3),n(72)],void 0===(i=function(t,e,n,o){return function(t){function e(e){return t.call(this,e)||this}return s(e,t),e.isHeaderFooterRange=function(t){return n.isHeaderFooter(t.block)},e.prototype.collapse=function(t){void 0===t&&(t=!0),t?this.end=this.start:this.start=this.end},e.prototype.isCollapsed=function(){return this.start===this.end},e.prototype.clone=function(){return new e({block:this.block,end:this.end,start:this.start})},e.prototype.getDataAsPlain=function(){return""},e.prototype.canDrawedByNative=function(){return!0},e.prototype.toNativeRange=function(t){return null},e.prototype.toCollabJSON=function(){var t=this.block.toCollabJSON();return t.rangeType=this.type,t.blockId=this.block.getId(),t},e.prototype.countWords=function(){return this.end-this.start},e.prototype.initialize=function(e){t.prototype.initialize.call(this,e),this.type=n.HEADER_FOOTER,this.start=e.start||0,this.end=e.end||0,this.block=e.block},e}(o)}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";var a,s=this&&this.__extends||(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});o=[n,r,n(3),n(10),n(2),n(72)],void 0===(i=function(t,e,n,o,i,r){return function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.fromCollabJSON=function(t,o){var a,s=t.rangeType;if(s===n.ATTACHMENT)return(a=r.getBlockById(t.blockId,o))?new e({block:a}):void 0;i.error("wrong block range type:",s)},e.prototype.canDrawedByNative=function(){return!1},e.prototype.clone=function(){return new e({block:this.block})},e.prototype.collapse=function(t){},e.prototype.getDataAsHtml=function(t){return this.block.toHtml(null,null,t)},e.prototype.getDataAsJSON=function(){var t=this.block.toJSON();return(o.IS_WEB_NOTE||o.IS_WEB_GROUP)&&t.resource&&!/^http/i.test(t.resource)&&(t.resource=location.protocol+"//"+location.hostname+t.resource),t},e.prototype.getDataAsPlain=function(){return this.block.toPlain()},e.prototype.isCollapsed=function(){return!1},e.prototype.initialize=function(e){t.prototype.initialize.call(this,e),this.type=n.ATTACHMENT},e}(r)}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";var a,s=this&&this.__extends||(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});o=[n,r,n(2),n(3),n(72)],void 0===(i=function(t,e,n,o,i){return function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.fromCollabJSON=function(t,r){var a=t.rangeType;if(a===o.IMAGE){var s=i.getBlockById(t.blockId,r);return s?new e({block:s}):void 0}n.error("wrong block range type:",a)},e.prototype.isCollapsed=function(){return!1},e.prototype.clone=function(){return new e({block:this.block})},e.prototype.collapse=function(){},e.prototype.getDataAsJSON=function(){return this.block.toJSON()},e.prototype.getDataAsHtml=function(t){return this.block.toHtml(null,null,t)},e.prototype.getDataAsPlain=function(){return this.block.toPlain()},e.prototype.canDrawedByNative=function(){return!1},e.prototype.initialize=function(e){t.prototype.initialize.call(this,e),this.type=o.IMAGE},e}(i)}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e,o=n(22),i=n(5),r=n(12),a=n(4);return e=o.extend({name:"atom.DeleteCodeText",_textBlock:null,_startLineIndex:null,_startLineCharIndex:null,_endLineIndex:null,_endLineCharIndex:null,_deletedText:null,_inlineStyles:null,initialize:function(){var t=this.options.args;a.isCollabCommand(t)||(this._textBlock=this.options.block,this.options.startBlockRange.hasOwnProperty("startLineCharIndex")?(this._startLineIndex=this.options.startBlockRange.startLineIndex,this._startLineCharIndex=this.options.startBlockRange.startLineCharIndex):(this._startLineIndex=this.options.endBlockRange.startLineIndex,this._startLineCharIndex=this.options.endBlockRange.startLineCharIndex),this.options.endBlockRange.hasOwnProperty("endLineCharIndex")?(this._endLineIndex=this.options.endBlockRange.endLineIndex,this._endLineCharIndex=this.options.endBlockRange.endLineCharIndex):(this._endLineIndex=this.options.startBlockRange.endLineIndex,this._endLineCharIndex=this.options.startBlockRange.endLineCharIndex),this._inlineStyles=this.options.inlineStyles),e.__super__.initialize.apply(this)},apply:function(){var t=this._textBlock,e=t.sliceText(this._startLineIndex,this._startLineCharIndex,this._endLineIndex,this._endLineCharIndex);return!!e&&(this._deletedText=e,t.deleteText(this._startLineIndex,this._startLineCharIndex,this._endLineIndex,this._endLineCharIndex),!0)},doUnapply:function(){var t=this._deletedText;this._textBlock&&this._deletedText&&this._textBlock.insertText(this._startLineIndex,this._startLineCharIndex,t)},fromCollabJSON:function(){var t=this.options.args,n=t.collabProperties.cmdJSON;e.__super__.fromCollabJSON.apply(this),n&&(this._deletedText=r.fromCollabJSON(n.richText),this._textBlock=t.collabProperties.coreEditor.getBlockById(n.blockId),this._start=n.startPosition,this._end=n.endPosition)},toCollabJSON:function(){var t=e.__super__.toCollabJSON.apply(this);return t.blockId=this._textBlock.getId(),t.richText=this._deletedText.toCollabJSON(),t.startPosition=this._start,t.endPosition=this._end,t}}),i.add(e),e}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";o=[n,r,n(131),n(3),n(97),n(128),n(130),n(81),n(63),n(28),n(115),n(80),n(165)],void 0===(i=function(t,e,n,o,i,r,a,s,l,c,u,d,p){return function(){function t(){}return t.buildBlockFromJSON=function(t,e){var h=null,f=t.type;switch(f){case o.PARAGRAPH:h=c.fromCollabJSON(t);break;case o.IMAGE:h=s.fromJSON(t);break;case o.ATTACHMENT:h=n.fromJSON(t);break;case o.LIST_ITEM:h=l.fromCollabJSON(t);break;case o.TABLE:h=u.fromJSON(t);break;case o.HR:h=a.fromCollabJSON(t);break;case o.HEADING:h=r.fromCollabJSON(t);break;case o.CATALOGUE:h=i.fromCollabJSON(t);break;case o.TODO:h=d.fromCollabJSON(t);break;case o.QUOTE:h=p.fromCollabJSON(t);break;default:throw new Error("unsupported type [ "+f+"] in buildBlockFromJSON")}return h},t}()}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e,o=n(0),i=n(22),r=n(5),a=n(73),s=n(4);return e=i.extend({name:"atom.SetTableCellBlockStyle",_table:null,_rect:null,_type:null,effected:!1,_oldStyles:{},_styles:null,initialize:function(){var t=this.options.args;this._oldStyles={},s.isCollabCommand(t)||(this._table=this.options.table,this._styles=this.options.styles,this._toggle=this.options.toggle,this._rect=this.options.rect,this._type=this.options.type,this._default=this.options.default),this.type===a.TYPES.ALL&&(this._rect=this._rect||{top:0,left:0,width:this._table.getColumnCount(),height:this._table.getRowCount()}),e.__super__.initialize.apply(this)},apply:function(){var t,e,n,i,r,s,l,c,u=this._table,d=this._rect,p=this._styles||{},h=this._toggle,f=!1;if(!d)return this.effected;if(t=d.top+d.height,e=d.left+d.width,h){if(!(r=a.create({block:u,type:a.TYPES.NORMAL,rect:d})))return this.effected;if(!(s=r.getAsRectRange()))return this.effected;n=u.getCommonBlockStyle(h,s),p[h]=null!=n?!n:null==this._default||!this._default}for(i=o.keys(p),l=d.top;l<t;l++)for(c=d.left;c<e;c++)this._oldStyles[l+"-"+c]=u.getCellBlockStyles({row:l,col:c,names:i}),u.setCellBlockStyles({row:l,col:c,styles:p})&&(f=!0);return this.effected=f,this.effected},doUnapply:function(){var t,e,n=this._table,o=this._rect,i=o.top+o.height,r=o.left+o.width;for(t=o.top;t<i;t++)for(e=o.left;e<r;e++)n.setCellBlockStyles({row:t,col:e,styles:this._oldStyles[t+"-"+e]})},fromCollabJSON:function(){var t,n=this.options.args.collabProperties,o=n.cmdJSON;e.__super__.fromCollabJSON.apply(this),t=n.coreEditor.getNote(),o&&(this._table=t.getBlockById(o.blockId),this._styles=o.styleNameValues,this._oldStyles=o.oldStyleNameValues,this._rect=o.simpleValue1,this._type=o.simpleValue2,this._toggle=o.newBlkId)},toCollabJSON:function(){var t=e.__super__.toCollabJSON.apply(this);return t.blockId=this._table.getId(),t.styleNameValues=this._styles||null,t.oldStyleNameValues=this._oldStyles,t.simpleValue1=this._rect,t.simpleValue2=this._type,t.newBlkId=this._toggle||null,t}}),r.add(e),e}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e,o=n(22),i=n(5),r=n(0),a=n(4);return e=o.extend({name:"atom.SetListItemLevel",_listItems:null,_newLevels:null,_oldLevels:null,initialize:function(){var t=this,n=t.options,o=n.args;a.isCollabCommand(o)||(t._listItems=n.listItems,t._newLevels={},n.newLevel?r.each(t._listItems,function(e,o){t._newLevels[o]=n.newLevel}):n.deltaLevel&&r.each(t._listItems,function(e,o){t._newLevels[o]=e.getLevel()+n.deltaLevel})),e.__super__.initialize.apply(t)},apply:function(){var t=this;return t._oldLevels={},r.each(t._newLevels,function(e,n){t._oldLevels[n]=t._listItems[n].getLevel(),t._listItems[n].setLevel(e)}),!0},doUnapply:function(){var t=this;return r.each(t._oldLevels,function(e,n){t._listItems[n].setLevel(e)}),!0},fromCollabJSON:function(){var t,n=this,o=n.options.args,i=o.collabProperties.cmdJSON;i&&(t=o.collabProperties.coreEditor.getNote(),i.oldLevels&&(n._oldLevels=i.oldLevels),n._newLevels=i.newLevels,n._listItems=[],r.each(i.listItemIds,function(e){n._listItems.push(t.getBlockById(e))})),e.__super__.fromCollabJSON.apply(n)},toCollabJSON:function(){var t=[],n=e.__super__.toCollabJSON.apply(this);return this._oldLevels&&(n.oldLevels=this._oldLevels),n.newLevels=this._newLevels,r.each(this._listItems,function(e){t.push(e.getId())}),n.listItemIds=t,n}}),i.add(e),e}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(0),o=n(8),i=n(19),r=n(122),a=n(10),s=n(30),l=n(7);return r.extend({className:"toolbar-item toolbar-combo-box",events:{"click .combo-value-wrapper":"onValueWrapperElClick","click .combo-expand-wrapper":"onExpandWrapperElClick","click .combo-menu-wrapper":"onMenuWrapperClick",mousedown:"onMouseDown"},name:"unknown",label:"unknown",defaultValue:"",items:{},value:"",templateName:"toolbar-combo-box-template",_isForceSelectWhenClick:!1,initialize:function(t){this.editor=t.editor,this.render(),this.defaultSetValue?this.select(this.defaultSetValue):this.select(this.defaultValue),this.bindEvents(),this.bindDocumentEvents(),this.bindEditorEvents()},render:function(){var t,e=this.$el;if(e.addClass("combo-box-"+this.name),t=i.render("web",this.templateName,{name:this.name,label:this.label,defaultValue:this.defaultValue,items:this.items}),e.html(t),this.valueWrapperEl=e.find(".combo-value-wrapper")[0],this.expandWrapperEl=e.find(".combo-expand-wrapper")[0],this.menuWrapperEl=e.find(".combo-menu-wrapper")[0],this.displayWrapperEl=e.find(".combo-display-wrapper")[0],o(this.displayWrapperEl).tooltipster({animation:"",animationDuration:0,theme:["tooltipster-borderless","tooltipster-borderless-customized"],side:"bottom",delay:[800,300]}),this.isVisible||this.hide(),"heading"===this.name&&(!s.isSafari()||a.IS_MAC))for(var n=l.IS_MAC?"Command+":"Ctrl+",r=3;r<=6;r++)o(o(this.menuWrapperEl).find("li[data-value="+r+"]")[0]).tooltipster({animation:"",animationDuration:0,theme:["tooltipster-heading","tooltipster-heading-customized"],side:"right",delay:[800,300],content:n+(r-2)})},bindEvents:function(){},bindDocumentEvents:function(){e.bindAll(this,"onDocumentMouseDown"),o(document).on("mousedown",this.onDocumentMouseDown)},bindEditorEvents:function(){var t=this,n=t.editor,o=t.editorEvents;o&&e.each(o,function(e,o){n.on(o,t[e].bind(t))})},onValueWrapperElClick:function(){this.toggleMenu()},onExpandWrapperElClick:function(){this.toggleMenu()},onMenuWrapperClick:function(t){var e=t.target,n=o(e).closest(".combo-item")[0];n&&(this.hideMenu(),this.onItemClick(n))},onItemClick:function(t){var e,n,i=o(t).data("value"),r=this.editor.getNoteRange();i&&(i!==this.value||!0===this._isForceSelectWhenClick||r.isInMultiBlock())&&(this._isForceSelectWhenClick=!1,this.select(i),this.onChange(i)),r.isSingleTableSelected()&&(n=(e=r.startRange).getAsRectRang?e.getAsRectRang:null)&&!n.onlyOneCell()&&(this.select(i),this.onChange(i))},select:function(t){this.value=t,this.updateValueUI(t)},updateValueUI:function(){},onChange:function(){},showMenu:function(){var t=this.menuWrapperEl;o(t).removeClass("menu-position-fix"),o(t).addClass("show"),t.getBoundingClientRect().right>document.documentElement.offsetWidth&&o(t).addClass("menu-position-fix")},hideMenu:function(){o(this.menuWrapperEl).removeClass("show")},toggleMenu:function(){o(this.menuWrapperEl).hasClass("show")?this.hideMenu():this.showMenu()},onDocumentMouseDown:function(t){var e=t.target;o.contains(this.el,e)||this.hideMenu()},onMouseDown:function(t){t.preventDefault()},reset:function(){this.defaultSetValue?this.select(this.defaultSetValue):this.select(this.defaultValue)}})}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(56),o=n(0);return e.extend({editorEvents:{"yne-editing-state-change":"onEditingStateChange"},onEditingStateChange:function(t){o.has(t,this.name)&&this.setState(t[this.name])},onClick:function(){var t={},e=this.editor.controller.editingInlineStates;t[this.name]=!this.state,this.editor.execCommandByToolbar("comp.ApplyStyles",{inlineStyles:t,editingInlineStates:e})}})}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){return n(173).extend({editorEvents:{"yne-selection-change":"onSelectionChange"},onChange:function(t){var e={};e[this.name]=t,this.editor.execCommandByToolbar("comp.ApplyStyles",{blockStyles:e})}})}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(26),o=n(8),i=n(0),r=n(7),a=n(139),s=["shift","alt","ctrl","meta"],l={return:"enter",escape:"esc",plus:"+"},c={mod:r.IS_MAC?"meta":"ctrl",option:"alt",command:"meta"};return e.extend({initialize:function(t){(t=t||{}).el&&(i.bindAll(this,"_onKeyDown"),this.el=t.el,this._beforeMatch=t.beforeMatch,this._afterMatch=t.afterMatch,this._hasBindEvents=!1)},_bindEvents:function(){this._hasBindEvents||(o(this.el).on("keydown",this._onKeyDown),this._hasBindEvents=!0)},_unbindEvents:function(){this._hasBindEvents&&(o(this.el).off("keydown",this._onKeyDown),this._hasBindEvents=!1)},_prepareForBindKey:function(){this._hasBindEvents||this._bindEvents(),this._keyMap||(this._keyMap={}),this._matchCache||(this._matchCache={})},_formatKey:function(t){t=(t=(t=o.trim(t)).toLowerCase()).replace(/\s+/g,""),i.each(c,function(e,n){t=t.replace(n+"+",e+"+")});var e={},n=t.split(/\+/),r=i.last(n),a=[];return r=l[r]||r,e.key=r,i.each(s,function(n){t.indexOf(n)>-1&&(e[n]=!0,a.push(n))}),a.push(r),e.mark=a.join("-"),e},isEventMatchKey:function(t,e){var n=this._extractEventInfo(t),o=this._formatKey(e);return this._isMatch(n,o)},_extractEventInfo:function(t){var e={},n=[];return i.each(s,function(o){t[o+"Key"]&&(e[o]=!0,n.push(o))}),n.push(t.keyCode),e.keyCode=t.keyCode,e.mark=n.join("-"),e},_isMatch:function(t,e){return!(!e||!event)&&(i.every(s,function(n){return e[n]===t[n]})&&a.isMatch(e.key,t.keyCode))},_onKeyDown:function(t){var e,n,o=this,r=o._keyMap,a=o._extractEventInfo(t),s=a.mark,l=o._matchCache,c=l[s];o._beforeMatch&&o._beforeMatch(t),c||(c=l[s]={eventInfo:a},e={},n=!1,i.each(r,function(t,i){o._isMatch(a,t.keyInfo)&&(e[i]=t,n=!0)}),n&&(c.handlers=e)),i.each(c.handlers,function(e){e.callback.apply(null,[t])}),o._afterMatch&&o._afterMatch(t,n)},bind:function(t,e){var n,o,r=this,a=r._formatKey(t);a&&(r._prepareForBindKey(),o=r._keyMap["key-"+t]={keyInfo:a,callback:e},n=r._matchCache,i.each(n,function(t){if(t&&t.eventInfo){var e,n=t.handlers;n?e=!0:(n={},e=!1),r._isMatch(t.eventInfo,a)&&(n[a.mark]=o,e=!0),e&&(t.handlers=n)}}))},unbind:function(t){var e=this._keyMap,n=this._matchCache,o="key-"+t;e&&e[o]&&delete e[o],i.each(n,function(t){var e=t.handlers;e&&e[o]&&delete e[o]})},unbindAll:function(){this._unbindEvents(),this._keyMap={},this._matchCache={}},clearCache:function(){this._matchCache={}}})}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o=n(15),i=n(11).document,r=o(i)&&o(i.createElement);t.exports=function(t){return r?i.createElement(t):{}}},function(t,e,n){var o=n(11),i=n(45),r=n(76),a=n(235),s=n(24).f;t.exports=function(t){var e=i.Symbol||(i.Symbol=r?{}:o.Symbol||{});"_"==t.charAt(0)||t in e||s(e,t,{value:a.f(t)})}},function(t,e,n){var o=n(123)("keys"),i=n(86);t.exports=function(t){return o[t]||(o[t]=i(t))}},function(t,e){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(t,e,n){var o=n(11).document;t.exports=o&&o.documentElement},function(t,e,n){var o=n(15),i=n(9),r=function(t,e){if(i(t),!o(e)&&null!==e)throw TypeError(e+": can't set as prototype!")};t.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(t,e,o){try{(o=n(46)(Function.call,n(41).f(Object.prototype,"__proto__").set,2))(t,[]),e=!(t instanceof Array)}catch(t){e=!0}return function(t,n){return r(t,n),e?t.__proto__=n:o(t,n),t}}({},!1):void 0),check:r}},function(t,e){t.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"},function(t,e,n){var o=n(15),i=n(182).set;t.exports=function(t,e,n){var r,a=e.constructor;return a!==n&&"function"==typeof a&&(r=a.prototype)!==n.prototype&&o(r)&&i&&i(t,r),t}},function(t,e,n){"use strict";var o=n(48),i=n(58);t.exports=function(t){var e=String(i(this)),n="",r=o(t);if(r<0||r==1/0)throw RangeError("Count can't be negative");for(;r>0;(r>>>=1)&&(e+=e))1&r&&(n+=e);return n}},function(t,e){t.exports=Math.sign||function(t){return 0==(t=+t)||t!=t?t:t<0?-1:1}},function(t,e){var n=Math.expm1;t.exports=!n||n(10)>22025.465794806718||n(10)<22025.465794806718||-2e-17!=n(-2e-17)?function(t){return 0==(t=+t)?t:t>-1e-6&&t<1e-6?t+t*t/2:Math.exp(t)-1}:n},function(t,e,n){"use strict";var o=n(76),i=n(1),r=n(36),a=n(35),s=n(108),l=n(189),c=n(105),u=n(42),d=n(17)("iterator"),p=!([].keys&&"next"in[].keys()),h=function(){return this};t.exports=function(t,e,n,f,g,m,y){l(n,e,f);var v,_,b,C=function(t){if(!p&&t in x)return x[t];switch(t){case"keys":case"values":return function(){return new n(this,t)}}return function(){return new n(this,t)}},k=e+" Iterator",w="values"==g,S=!1,x=t.prototype,E=x[d]||x["@@iterator"]||g&&x[g],I=E||C(g),T=g?w?C("entries"):I:void 0,O="Array"==e&&x.entries||E;if(O&&(b=u(O.call(new t)))!==Object.prototype&&b.next&&(c(b,k,!0),o||"function"==typeof b[d]||a(b,d,h)),w&&E&&"values"!==E.name&&(S=!0,I=function(){return E.call(this)}),o&&!y||!p&&!S&&x[d]||a(x,d,I),s[e]=I,s[k]=h,g)if(v={values:w?I:C("values"),keys:m?I:C("keys"),entries:T},y)for(_ in v)_ in x||r(x,_,v[_]);else i(i.P+i.F*(p||S),e,v);return v}},function(t,e,n){"use strict";var o=n(89),i=n(85),r=n(105),a={};n(35)(a,n(17)("iterator"),function(){return this}),t.exports=function(t,e,n){t.prototype=o(a,{next:i(1,n)}),r(t,e+" Iterator")}},function(t,e,n){var o=n(145),i=n(58);t.exports=function(t,e,n){if(o(e))throw TypeError("String#"+n+" doesn't accept regex!");return String(i(t))}},function(t,e,n){var o=n(17)("match");t.exports=function(t){var e=/./;try{"/./"[t](e)}catch(n){try{return e[o]=!1,!"/./"[t](e)}catch(t){}}return!0}},function(t,e,n){var o=n(108),i=n(17)("iterator"),r=Array.prototype;t.exports=function(t){return void 0!==t&&(o.Array===t||r[i]===t)}},function(t,e,n){"use strict";var o=n(24),i=n(85);t.exports=function(t,e,n){e in t?o.f(t,e,i(0,n)):t[e]=n}},function(t,e,n){var o=n(106),i=n(17)("iterator"),r=n(108);t.exports=n(45).getIteratorMethod=function(t){if(null!=t)return t[i]||t["@@iterator"]||r[o(t)]}},function(t,e,n){var o=n(409);t.exports=function(t,e){return new(o(t))(e)}},function(t,e,n){"use strict";var o=n(25),i=n(88),r=n(18);t.exports=function(t){for(var e=o(this),n=r(e.length),a=arguments.length,s=i(a>1?arguments[1]:void 0,n),l=a>2?arguments[2]:void 0,c=void 0===l?n:i(l,n);c>s;)e[s++]=t;return e}},function(t,e,n){"use strict";var o=n(78),i=n(252),r=n(108),a=n(40);t.exports=n(188)(Array,"Array",function(t,e){this._t=a(t),this._i=0,this._k=e},function(){var t=this._t,e=this._k,n=this._i++;return!t||n>=t.length?(this._t=void 0,i(1)):i(0,"keys"==e?n:"values"==e?t[n]:[n,t[n]])},"values"),r.Arguments=r.Array,o("keys"),o("values"),o("entries")},function(t,e,n){"use strict";var o,i,r=n(126),a=RegExp.prototype.exec,s=String.prototype.replace,l=a,c=(o=/a/,i=/b*/g,a.call(o,"a"),a.call(i,"a"),0!==o.lastIndex||0!==i.lastIndex),u=void 0!==/()??/.exec("")[1];(c||u)&&(l=function(t){var e,n,o,i,l=this;return u&&(n=new RegExp("^"+l.source+"$(?!\\s)",r.call(l))),c&&(e=l.lastIndex),o=a.call(l,t),c&&o&&(l.lastIndex=l.global?o.index+o[0].length:e),u&&o&&o.length>1&&s.call(o[0],n,function(){for(i=1;i<arguments.length-2;i++)void 0===arguments[i]&&(o[i]=void 0)}),o}),t.exports=l},function(t,e,n){"use strict";var o=n(144)(!0);t.exports=function(t,e,n){return e+(n?o(t,e).length:1)}},function(t,e,n){var o,i,r,a=n(46),s=n(242),l=n(181),c=n(177),u=n(11),d=u.process,p=u.setImmediate,h=u.clearImmediate,f=u.MessageChannel,g=u.Dispatch,m=0,y={},v=function(){var t=+this;if(y.hasOwnProperty(t)){var e=y[t];delete y[t],e()}},_=function(t){v.call(t.data)};p&&h||(p=function(t){for(var e=[],n=1;arguments.length>n;)e.push(arguments[n++]);return y[++m]=function(){s("function"==typeof t?t:Function(t),e)},o(m),m},h=function(t){delete y[t]},"process"==n(47)(d)?o=function(t){d.nextTick(a(v,t,1))}:g&&g.now?o=function(t){g.now(a(v,t,1))}:f?(r=(i=new f).port2,i.port1.onmessage=_,o=a(r.postMessage,r,1)):u.addEventListener&&"function"==typeof postMessage&&!u.importScripts?(o=function(t){u.postMessage(t+"","*")},u.addEventListener("message",_,!1)):o="onreadystatechange"in c("script")?function(t){l.appendChild(c("script")).onreadystatechange=function(){l.removeChild(this),v.call(t)}}:function(t){setTimeout(a(v,t,1),0)}),t.exports={set:p,clear:h}},function(t,e,n){var o=n(11),i=n(200).set,r=o.MutationObserver||o.WebKitMutationObserver,a=o.process,s=o.Promise,l="process"==n(47)(a);t.exports=function(){var t,e,n,c=function(){var o,i;for(l&&(o=a.domain)&&o.exit();t;){i=t.fn,t=t.next;try{i()}catch(o){throw t?n():e=void 0,o}}e=void 0,o&&o.enter()};if(l)n=function(){a.nextTick(c)};else if(!r||o.navigator&&o.navigator.standalone)if(s&&s.resolve){var u=s.resolve(void 0);n=function(){u.then(c)}}else n=function(){i.call(o,c)};else{var d=!0,p=document.createTextNode("");new r(c).observe(p,{characterData:!0}),n=function(){p.data=d=!d}}return function(o){var i={fn:o,next:void 0};e&&(e.next=i),t||(t=i,n()),e=i}}},function(t,e,n){"use strict";var o=n(31);function i(t){var e,n;this.promise=new t(function(t,o){if(void 0!==e||void 0!==n)throw TypeError("Bad Promise constructor");e=t,n=o}),this.resolve=o(e),this.reject=o(n)}t.exports.f=function(t){return new i(t)}},function(t,e,n){"use strict";var o=n(11),i=n(23),r=n(76),a=n(151),s=n(35),l=n(94),c=n(14),u=n(92),d=n(48),p=n(18),h=n(262),f=n(90).f,g=n(24).f,m=n(196),y=n(105),v="prototype",_="Wrong index!",b=o.ArrayBuffer,C=o.DataView,k=o.Math,w=o.RangeError,S=o.Infinity,x=b,E=k.abs,I=k.pow,T=k.floor,O=k.log,A=k.LN2,N=i?"_b":"buffer",D=i?"_l":"byteLength",B=i?"_o":"byteOffset";function R(t,e,n){var o,i,r,a=new Array(n),s=8*n-e-1,l=(1<<s)-1,c=l>>1,u=23===e?I(2,-24)-I(2,-77):0,d=0,p=t<0||0===t&&1/t<0?1:0;for((t=E(t))!=t||t===S?(i=t!=t?1:0,o=l):(o=T(O(t)/A),t*(r=I(2,-o))<1&&(o--,r*=2),(t+=o+c>=1?u/r:u*I(2,1-c))*r>=2&&(o++,r/=2),o+c>=l?(i=0,o=l):o+c>=1?(i=(t*r-1)*I(2,e),o+=c):(i=t*I(2,c-1)*I(2,e),o=0));e>=8;a[d++]=255&i,i/=256,e-=8);for(o=o<<e|i,s+=e;s>0;a[d++]=255&o,o/=256,s-=8);return a[--d]|=128*p,a}function L(t,e,n){var o,i=8*n-e-1,r=(1<<i)-1,a=r>>1,s=i-7,l=n-1,c=t[l--],u=127&c;for(c>>=7;s>0;u=256*u+t[l],l--,s-=8);for(o=u&(1<<-s)-1,u>>=-s,s+=e;s>0;o=256*o+t[l],l--,s-=8);if(0===u)u=1-a;else{if(u===r)return o?NaN:c?-S:S;o+=I(2,e),u-=a}return(c?-1:1)*o*I(2,u-e)}function P(t){return t[3]<<24|t[2]<<16|t[1]<<8|t[0]}function M(t){return[255&t]}function F(t){return[255&t,t>>8&255]}function H(t){return[255&t,t>>8&255,t>>16&255,t>>24&255]}function j(t){return R(t,52,8)}function V(t){return R(t,23,4)}function U(t,e,n){g(t[v],e,{get:function(){return this[n]}})}function z(t,e,n,o){var i=h(+n);if(i+e>t[D])throw w(_);var r=t[N]._b,a=i+t[B],s=r.slice(a,a+e);return o?s:s.reverse()}function G(t,e,n,o,i,r){var a=h(+n);if(a+e>t[D])throw w(_);for(var s=t[N]._b,l=a+t[B],c=o(+i),u=0;u<e;u++)s[l+u]=c[r?u:e-u-1]}if(a.ABV){if(!c(function(){b(1)})||!c(function(){new b(-1)})||c(function(){return new b,new b(1.5),new b(NaN),"ArrayBuffer"!=b.name})){for(var J,W=(b=function(t){return u(this,b),new x(h(t))})[v]=x[v],$=f(x),K=0;$.length>K;)(J=$[K++])in b||s(b,J,x[J]);r||(W.constructor=b)}var Y=new C(new b(2)),X=C[v].setInt8;Y.setInt8(0,2147483648),Y.setInt8(1,2147483649),!Y.getInt8(0)&&Y.getInt8(1)||l(C[v],{setInt8:function(t,e){X.call(this,t,e<<24>>24)},setUint8:function(t,e){X.call(this,t,e<<24>>24)}},!0)}else b=function(t){u(this,b,"ArrayBuffer");var e=h(t);this._b=m.call(new Array(e),0),this[D]=e},C=function(t,e,n){u(this,C,"DataView"),u(t,b,"DataView");var o=t[D],i=d(e);if(i<0||i>o)throw w("Wrong offset!");if(i+(n=void 0===n?o-i:p(n))>o)throw w("Wrong length!");this[N]=t,this[B]=i,this[D]=n},i&&(U(b,"byteLength","_l"),U(C,"buffer","_b"),U(C,"byteLength","_l"),U(C,"byteOffset","_o")),l(C[v],{getInt8:function(t){return z(this,1,t)[0]<<24>>24},getUint8:function(t){return z(this,1,t)[0]},getInt16:function(t){var e=z(this,2,t,arguments[1]);return(e[1]<<8|e[0])<<16>>16},getUint16:function(t){var e=z(this,2,t,arguments[1]);return e[1]<<8|e[0]},getInt32:function(t){return P(z(this,4,t,arguments[1]))},getUint32:function(t){return P(z(this,4,t,arguments[1]))>>>0},getFloat32:function(t){return L(z(this,4,t,arguments[1]),23,4)},getFloat64:function(t){return L(z(this,8,t,arguments[1]),52,8)},setInt8:function(t,e){G(this,1,t,M,e)},setUint8:function(t,e){G(this,1,t,M,e)},setInt16:function(t,e){G(this,2,t,F,e,arguments[2])},setUint16:function(t,e){G(this,2,t,F,e,arguments[2])},setInt32:function(t,e){G(this,4,t,H,e,arguments[2])},setUint32:function(t,e){G(this,4,t,H,e,arguments[2])},setFloat32:function(t,e){G(this,4,t,V,e,arguments[2])},setFloat64:function(t,e){G(this,8,t,j,e,arguments[2])}});y(b,"ArrayBuffer"),y(C,"DataView"),s(C[v],a.VIEW,!0),e.ArrayBuffer=b,e.DataView=C},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t,e){var n=function(t,e,n,o,i){void 0===n&&(n="black"),void 0===o&&(o="white"),e&&1===e.length&&(e=e[0])};return{log:n,breakPointsLog:function(t,e){var o={fontColor:"white",backColor:"grey"};switch(t){case"execCommand":o.backColor="#3399FF";break;case"execEditorApi":o.backColor="#663399"}n(0,e,o.fontColor,o.backColor)},warn:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];1===t.length&&(t=t[0]),n(0,t,"#333333","#FFFF33")},error:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];1===t.length&&(t=t[0]),n(0,t,"red","#FFCCCC")}}}.apply(i,[n,i]))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(271),o=n(595),i=n(598),r=n(600),a=n(2);return{parseHtml:function(t){var n=e(t);return a.log("parseHtml OK",n),n},parsePlain:function(t,e,n,i){return o(t,e,n,i)},parseJSON:function(t,e){return i(t,e)},parseOCR:function(t,e){return r(t,e)}}}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(79),o=n(7),i=n(0),r=n(565),a=["bold","bolder","700","800","900"],s=n(51),l={"xx-small":12,"x-small":12,small:13,medium:16,large:18,"x-large":24,"xx-large":32};return{bold:{inheritable:!0,action:function(t){var n=t.style.fontWeight;return(n=n&&e.trim(n).toLowerCase())&&"inherit"!==n?-1!==i.indexOf(a,n):null}},italic:{inheritable:!0,action:function(t){var e=t.style.fontStyle;return e?"italic"===e:null}},underline:{inheritable:!0,action:function(t,e,n){var o=t.style.textDecoration;return!!/(^|\s)underline($|\s)/i.test(o)||!(o&&!n)&&n}},strike:{inheritable:!0,action:function(t,e,n){var o=t.style.textDecoration;return!!/(^|\s)line-through($|\s)/i.test(o)||!(o&&!n)&&n}},"font-family":{inheritable:!0,action:function(t){var e=t.style.fontFamily;return 0===e.trim().indexOf("-apple-system")?s.DEFAULT_FONT:s.getFontFirstValue(e)}},"font-size":{inheritable:!0,action:function(t,n,o){var i=t.style.fontSize;if(i=e.trim(i+""),/^[\d.]+px$/.test(i)?i=parseInt(i,10):/^[\d.]+pt$/.test(i)?i=Math.floor(4*parseFloat(i,10)/3):/^[\d.]+em$/.test(i)?(i=parseFloat(i,10),i*=o||14,i=Math.floor(i)):/^[\d.]+rem$/.test(i)?(i=parseFloat(i,10),i*=10,i=Math.floor(i)):i=l[i],i&&!isNaN(i))return i}},color:{inheritable:!0,action:function(t){var e=t.style.color;return r(e,!1)}},"back-color":{inheritable:!0,action:function(t){var e=t.style.backgroundColor;return r(e,!0)}},align:{inheritable:!0,action:function(t){var n=t.style.textAlign||t.align;if((n=n&&e.trim(n).toLowerCase())&&"inherit"!==n)return n}},"line-height":{inheritable:!0,requireValues:["font-size"],action:function(t,n){var o=e.trim(t.style.lineHeight+""),i=n["font-size"]||14;if(/^[\d.]+$/.test(o)?o=parseFloat(o,10):/^[\d.]+px$/.test(o)?(o=parseFloat(o,10),o/=i):o=0,o&&!isNaN(o)&&o>1)return o}},indent:{inheritable:!0,action:function(t,e,n){var o=0;return"BLOCKQUOTE"===t.tagName&&(o=1),o+=n||0}},"text-indent":{inheritable:!0,action:function(t){var n=t.style.textIndent;if(n=e.trim(n+""),n=/^[\d.]+px$/.test(n)?parseFloat(n,10):/^[\d.]+pt$/.test(n)?4*parseFloat(n,10)/3:null)return(n=Math.floor(n/o.INDENT_WIDTH))||1}},width:{inheritable:!1,action:function(t){var n=t.style.width||t.width;if(n=e.trim(n+""),/^[\d.]+(px)?$/.test(n)&&(n=parseInt(n,10)),n&&!isNaN(n))return n}},float:{inheritable:!1,action:function(t){return t.style.float}},"white-space":{inheritable:!0,action:function(t){var e=t.style.whiteSpace;if(e&&"inherit"!==e)return e}}}}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";o=[n,r,n(0)],void 0===(i=function(t,e,n){var o,i;return function(t){t[t.major=1]="major",t[t.minor=0]="minor",t[t.revision=3]="revision"}(o||(o={})),function(t){t[t.GRETER=1]="GRETER",t[t.EQUAL=0]="EQUAL",t[t.LESS=-1]="LESS"}(i||(i={})),function(){function t(){}return t.getDefaultAsString=function(){return o.major+"."+o.minor+"."+o.revision},t.parse=function(e){if(e){var n=(e+"").split(".");return{major:t.getAsInt(n[0]),minor:t.getAsInt(n[1]),revision:t.getAsInt(n[2])}}},t.isLessThanDefault=function(e){if(!e)return!0;var n=t.parse(e);return t.compare(n,o)===i.LESS},t.isCompatible=function(e){if(!(e=e||"")||"true"===e)return!0;var n=t.parse(e);return t.compare(o,n)!==i.LESS},t.getAsInt=function(t){t=t||"";var e=parseInt(t+"",10);return isNaN(e)?0:e},t.compareInt=function(t,e){return t===e?i.EQUAL:t>e?i.GRETER:i.LESS},t.compare=function(e,o){var r=i.EQUAL;return n.some(["major","minor","revision"],function(n){var a=t.compareInt(e[n]||0,o[n]||0);if(a!==i.EQUAL)return r=a,!0}),r},t}()}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e,o,i,r,a=n(0),s={};for(r in o=[(e={default:{name:"普通文本","font-size":14},a:{name:"标题","font-size":32,bold:!0},b:{name:"副标题","font-size":18,color:"#595959",bold:!0},1:{name:"标题1","font-size":28,bold:!0},2:{name:"标题2","font-size":20,bold:!0},3:{name:"标题3","font-size":16,bold:!0},4:{name:"标题4","font-size":14,bold:!0}}).default,e.a,e.b,e[1],e[2],e[3],e[4]],i={},e)"default"!==r&&(s[r]=a.clone(e[r]),delete s[r].name,delete s[r].align);return{headingMap:e,headingArray:o,headingBlockStyles:i,headingInlineStyles:s}}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(){return{getNamespace:function(){return"note.youdao.com"}}}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";o=[n,r,n(0),n(275)],void 0===(i=function(t,e,n,o){return function(){function t(){}return t.checkValid=function(t){var e,i,r=t.length;if(!n.isString(t))return!1;for(e=0;e<r;e++)if(!(9===(i=o(t,e))||10===i||13===i||i>=32&&i<=55295||i>=57344&&i<=65533)){if(!(i>=65536&&i<=1114111))return!1;e++}return!0},t.clear=function(t){var e,i,r="",a=t.length;if(!n.isString(t))return t;for(e=0;e<a;e++)9===(i=o(t,e))||10===i||13===i||i>=32&&i<=55295||i>=57344&&i<=65533?r+=t[e]:i>=65536&&i<=1114111&&(r+=t[e],r+=t[++e]);return r},t}()}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},,,,,,,function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";o=[n,r,n(2),n(0),n(274),n(32)],void 0===(i=function(t,e,n,o,i,r){return function(){function t(){}return t.convertToCssStyle=function(t,e){if(t){var n=o.pick(t,this.SUPPORTED_STYLES);return n=o.defaults(n,r.getAllDefault()),e&&o.each(n,function(t,o){null!=t&&(n[o]=e.valueToView(o,t))}),i.convertToCssStyle(n)}},t.isSupportedStyle=function(e){return t.SUPPORTED_STYLES.indexOf(e)>-1},t.makeHtmlMarker=function(e){if(e){var o,i,r=e.getLevel(),a=e.getText();return o=e.isOrdered()?t.ORDERED_STYLE_TYPES[r%3]:t.UNORDERED_STYLE_TYPES[r%3],a.getLength()&&(i=this.convertToCssStyle(a.getStylesAtIndex(0))),{listStyleType:o,markerStyles:i}}n.warn("Failed to create marker",e)},t.makePlainMarker=function(e,o){if(!e)return n.warn("Failed to create marker",e),"";o=!1!==o;var i,r="",a=e.getLevel();if(e.isOrdered()){switch(i=e.getIndex(),a%3){case 0:r=t.toRoman(i);break;case 2:r=t.toAlphabet(i);break;default:case 1:r=i}r+="."}else switch(a%3){case 0:r="■";break;case 2:r="○";break;default:case 1:r="●"}return o&&(r+=" "),r},t.toAlphabet=function(t){if(isNaN(t))return"";var e="a".charCodeAt(0),n="z".charCodeAt(0)-e+1,o="";for(t--;t>=0;)o=String.fromCharCode(t%n+e)+o,t=Math.floor(t/n)-1;return o},t.toRoman=function(t){if(isNaN(t))return"";for(var e=[["","i","ii","iii","iv","v","vi","vii","viii","ix"],["","x","xx","xxx","xl","l","lx","lxx","lxxx","xcc"],["","c","cc","ccc","cd","d","dc","dcc","dcc","cm"]],n="",o=0,i=0,r=1e3;i<3;i++,r/=10)o=Math.floor(t%r/(r/10)),n+=e[2-i][o];return n},t.SUPPORTED_STYLES=["font-size","font-family","color","bold","italic"],t.ORDERED_STYLE_TYPES=["lower-roman","decimal","lower-alpha"],t.UNORDERED_STYLE_TYPES=["square","disc","circle"],t}()}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t,e){return function(){return{value:""}}}.apply(i,[n,i]))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(){var t={color:"#999999",bold:300,"font-family":"宋体","font-size":"14"};return{getQuoteDefaultStyles:function(){return t},getQuoteSize:function(){return t["font-size"]},getQuoteColor:function(){return t.color}}}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(0),o=n(7);return{parseToBoolean:function(t,n){var o=null;return e.isBoolean(t)?o=t:e.isNumber(t)?0===t?o=!1:1===t&&(o=!0):e.isString(t)&&("0"===t.toLowerCase()||"false"===t.toLowerCase()?o=!1:"1"!==t.toLowerCase()&&"true"!==t.toLowerCase()||(o=!0)),null===o&&e.isBoolean(n)&&(o=n),o},parseToNumber:function(t,n){var o=null;return e.isNumber(t)?o=t:e.isString(t)&&(o=window.parseInt(t)),(isNaN(o)||null===o)&&e.isNumber(n)&&(o=n),o},parseToPageType:function(t){var e=o.PAGE_TYPE_NONE;return t&&(t.trim().toUpperCase()===o.PAGE_TYPE_B5?e=o.PAGE_TYPE_B5:t.trim().toUpperCase()===o.PAGE_TYPE_A4?e=o.PAGE_TYPE_A4:t.trim().toUpperCase()===o.PAGE_TYPE_TEST&&(e=o.PAGE_TYPE_TEST)),e}}}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";var a,s=this&&this.__extends||(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});o=[n,r,n(72),n(3),n(10)],void 0===(i=function(t,e,n,o,i){return function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.fromXml=function(t){throw new Error("HandWrite do NOT support fromXml till now")},e.prototype.canDrawedByNative=function(){return!1},e.prototype.clone=function(){return new e({block:this._rangeProps.block})},e.prototype.collapse=function(){},e.prototype.getDataAsJSON=function(){var t=this._rangeProps.block.toJSON();return(i.IS_WEB_NOTE||i.IS_WEB_GROUP)&&t.resource&&!/^http/i.test(t.resource)&&(t.resource=location.protocol+"//"+location.hostname+t.resource),t},e.prototype.getDataAsHtml=function(t){return this._rangeProps.block.toHtml(null,null,t)},e.prototype.getDataAsPlain=function(){return this._rangeProps.block.toPlain()},e.prototype.isCollapsed=function(){return!1},e.prototype.initialize=function(e){t.prototype.initialize.call(this,e),this.type=o.HANDWRITE,this._rangeProps={block:e.block}},e}(n)}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";var a,s=this&&this.__extends||(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});o=[n,r,n(3),n(72)],void 0===(i=function(t,e,n,o){return function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.prototype.clone=function(){return new e({block:this.block})},e.prototype.collapse=function(){},e.prototype.isCollapsed=function(){return!1},e.prototype.getDataAsHtml=function(){return this.block.toHtml()},e.prototype.getDataAsJSON=function(){return this.block.toJSON()},e.prototype.getDataAsPlain=function(){return this.block.toPlain()},e.prototype.canDrawedByNative=function(){return!0},e.prototype.initialize=function(e){t.prototype.initialize.call(this,e),this.type=n.HR},e}(o)}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(){return{contains:function(t,e){if(!t||!e)return!1;var n=t.left+t.width,o=t.top+t.height,i=e.left+e.width,r=e.top+e.height;return t.left<=e.left&&t.top<=e.top&&n>=i&&o>=r},union:function(t,e){if(t&&e){var n=Math.min(t.left,e.left),o=Math.min(t.top,e.top);return t={left:n,top:o,width:Math.max(t.left+t.width,e.left+e.width)-n,height:Math.max(t.top+t.height,e.top+e.height)-o}}}}}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";var a,s=this&&this.__extends||(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});o=[n,r,n(3),n(72)],void 0===(i=function(t,e,n,o){return function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.prototype.canDrawedByNative=function(){return!1},e.prototype.clone=function(){return new e({block:this.block})},e.prototype.collapse=function(){},e.prototype.getDataAsHtml=function(){return this.block.toHtml()},e.prototype.getDataAsJSON=function(){return this.block.toJSON()},e.prototype.getDataAsPlain=function(){return this.block.toPlain()},e.prototype.isCollapsed=function(){return!1},e.prototype.initialize=function(e){t.prototype.initialize.call(this,e),this.type=n.UNKNOWN},e}(o)}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(){}return t.isCmdVersionMatchNoteVersion=function(t,e){return t-e==1},t.isMessageTooLarge=function(t){return t>5e3},t.newGUID=function(){var t="";return t+=Math.floor(10*Math.random()).toString().substr(0,1),t+=Math.floor(10*Math.random()).toString().substr(0,1),t+="-",t+=Date.now().toString()},t}();e.Utils=n}.apply(i,[n,i]))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e,o=n(22),i=n(5),r=n(0),a=n(4);return e=o.extend({name:"atom.SetInlineStyle",_selectedBlocks:null,_start:null,_end:null,_isFullText:!1,_oldStyleNameValues:{},_styleNameValues:null,initialize:function(){var t=this.options.args;this._oldStyleNameValues={},a.isCollabCommand(t)||(this._selectedBlocks=this.options.blocks,this._styleNameValues=this.options.styleNameValues,this._start=this.options.start,this._end=this.options.end,this._isFullText=this.options.fullText),e.__super__.initialize.apply(this)},apply:function(){var t=this;r.each(t._styleNameValues,function(e,n){t._setStyleToSelectedBlocks(n,e)})},doUnapply:function(){var t,e=this;r.each(e._selectedBlocks,function(n){t=e._oldStyleNameValues[n.getId()],e._isFullText&&(e._start=n.getStartOffset(),e._end=n.getEndOffset()),r.each(t,function(t,o){n.setTextStyle(o,t,e._start,e._end)})})},fromCollabJSON:function(){var t,n=this,o=n.options.args.collabProperties,i=o.cmdJSON;e.__super__.fromCollabJSON.apply(n),t=o.coreEditor.getNote(),i&&(n._selectedBlocks=[],r.each(i.blockIds,function(e){n._selectedBlocks.push(t.getBlockById(e))}),n._styleNameValues=i.styleNameValues,n._oldStyleNameValues=i.oldStyleNameValues,n._start=i.startPosition,n._end=i.endPosition,n._isFullText=i.simpleValue1)},toCollabJSON:function(){var t=[],n=e.__super__.toCollabJSON.apply(this);return this._selectedBlockIds=[],r.each(this._selectedBlocks,function(e){t.push(e.getId())}),n.blockIds=t,n.styleNameValues=this._styleNameValues,n.oldStyleNameValues=this._oldStyleNameValues,n.startPosition=this._start,n.endPosition=this._end,this._isFullText&&(n.simpleValue1=!0),n},_setStyleToSelectedBlocks:function(t,e){var n,o,i=this,a={};a[t]=e,r.each(i._selectedBlocks,function(r){o=r.getId(),i._isFullText&&(i._start=r.getStartOffset(),i._end=r.getEndOffset()),n=r.getTextStyle(t,i._start,i._end),i._oldStyleNameValues[o]||(i._oldStyleNameValues[o]={}),i._oldStyleNameValues[o][t]=n,a=r.getInlineStylesForEmpty(),r.isEmpty()&&r.setInlineStylesForEmpty(i.getInlineStates(a,t,e)),r.setTextStyle(t,e,i._start,i._end)})},getInlineStates:function(t,e,n){if(t)return t[e]=n,t}}),i.add(e),e}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e,o=n(22),i=n(5),r=n(0),a=n(4);return e=o.extend({name:"atom.SetBlockStyle",_selectedBlocks:null,_oldStyleNameValues:{},_styleNameValues:null,initialize:function(t){var n=this.options.args;this._oldStyleNameValues={},a.isCollabCommand(n)||(this._selectedBlocks=t.blocks,this._styleNameValues=this.options.styleNameValues),e.__super__.initialize.apply(this,arguments)},apply:function(){var t=this;r.each(t._styleNameValues,function(e,n){t._setStyleToSelectedBlocks(n,e)})},doUnapply:function(){var t,e=this;r.each(e._selectedBlocks,function(n){t=e._oldStyleNameValues[n.getId()],r.each(t,function(t,e){n.setBlockStyle(e,t)})})},fromCollabJSON:function(){var t=this,n=t.options.args.collabProperties,o=n.cmdJSON;e.__super__.fromCollabJSON.apply(t),t._note=n.coreEditor.getNote(),o&&(t._selectedBlocks=[],r.each(o.blockIds,function(e){t._selectedBlocks.push(t._note.getBlockById(e))}),t._styleNameValues=o.styleNameValues,t._oldStyleNameValues=o.oldStyleNameValues)},toCollabJSON:function(){var t=e.__super__.toCollabJSON.apply(this),n=[];return r.each(this._selectedBlocks,function(t){n.push(t.getId())}),t.blockIds=n,t.styleNameValues=this._styleNameValues,t.oldStyleNameValues=this._oldStyleNameValues,t},_setStyleToSelectedBlocks:function(t,e){var n,o,i=this;r.each(i._selectedBlocks,function(r){o=r.getId(),n=r.getBlockStyle(t),i._oldStyleNameValues[o]||(i._oldStyleNameValues[o]={}),i._oldStyleNameValues[o][t]=n,r.setBlockStyle(t,e)})}}),i.add(e),e}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e,o=n(22),i=n(5),r=n(4),a={POINT:"point",CELL:"cell"};return e=o.extend({name:"atom.SetTableCellAttr",_table:null,_rect:null,_type:null,_value:null,_oldValue:null,effected:!1,initialize:function(){var t=this.options.args;r.isCollabCommand(t)||(this._table=this.options.table,this._rect=this.options.rect,this._type=this.options.type,this._value=this.options.value),e.__super__.initialize.apply(this)},apply:function(){var t=this._type,e=this._table,n=this._rect,o=this._value;if(o)return t===a.POINT?(this._oldValue=this._getOldAttr(n.row,n.col),e.setMergePointAttrAt(n.row,n.col,o.width,o.height),void(this.effected=!0)):t===a.CELL?(this._oldValue=this._getOldAttr(n.row,n.col),e.setMergedCellAttrAt(n.row,n.col,o.dx,o.dy),void(this.effected=!0)):void 0;(e.isMergePoint(n.row,n.col)||e.isMergedCell(n.row,n.col))&&(this._oldValue=this._getOldAttr(n.row,n.col),e.clearCellAttr(n.row,n.col),this.effected=!0)},_getOldAttr:function(t,e){var n=this._table;return n.isMergedCell(t,e)?n.getMergedCellAttrAt(t,e):n.isMergePoint(t,e)?n.getMergePointAttrAt(t,e):null},doUnapply:function(){var t=this._table,e=this._rect,n=this._oldValue;n?((n.width||n.height)&&t.setMergePointAttrAt(e.row,e.col,n.width,n.height),(n.dx||n.dy)&&t.setMergedCellAttrAt(e.row,e.col,n.dx,n.dy)):t.clearCellAttr(e.row,e.col)},fromCollabJSON:function(){var t,n=this.options.args.collabProperties,o=n.cmdJSON;e.__super__.fromCollabJSON.apply(this),t=n.coreEditor.getNote(),o&&(this._table=t.getBlockById(o.blockId),this._value=o.styleNameValues,this._oldValue=o.oldStyleNameValues,this._rect=o.simpleValue1,this._type=o.simpleValue2)},toCollabJSON:function(){var t=e.__super__.toCollabJSON.apply(this);return t.blockId=this._table.getId(),t.styleNameValues=this._value,t.oldStyleNameValues=this._oldValue,t.simpleValue1=this._rect,t.simpleValue2=this._type,t}},{TYPES:a}),i.add(e),e}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(){return{keyBackspace:{currentLineIsEmpty:{backToLineStart:!1,backToPreLineEnd:!0}},keyEnter:{whenEndCharIs:{",":0,")":0,"}":0,";":0,":":4,"(":4,"{":4,default:0}},keyTab:{addSpacesNum:4}}}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(209),o=new RegExp("^http[s]{0,1}://"+e.getNamespace()),i="//"+e.getNamespace(),r=!1;return{setUseConvert:function(t){r=!!t},isInnerResoures:function(t){return o.test(t)},getURL:function(t){return r&&this.isInnerResoures(t)?t.replace(o,i):t}}}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(){return function(){}}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){return n(56).extend({editorEvents:{"yne-selection-change":"onSelectionChange"},onSelectionChange:function(){this.setState(this.querySelectionState())},querySelectionState:function(){return this.editor.querySelectionInlineStyle(this.name)}})}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(8),o=n(164),i=n(55),r=n(71);return{_container:null,getUrlInfoBeforeRange:function(t,e){var n,o,a=t.commonAncestorContainer,s={textNodeArray:[],endIndex:-1};if(i.isRangeInNode(e,t))return this._container=e,this._isInLinkElement(a)?o={alreadyUrl:!0}:(r.isElement(a)?(n=this._findLastTextNode(a))&&(s.endIndex=n.length):s.endIndex=t.endOffset,o=this._iteratorOfTextNodeBefore(s,a),this._container=null,o)},_iteratorOfTextNodeBefore:function(t,e){var n;if(r.isText(e))n=e;else{if(!r.isElement(e))return;n=this._findLastTextNode(e)}if(n)return t.textNodeArray.unshift(n),this._parseTextNodeObject(t)||this._iteratorOfTextNodeBefore(t,this._findPreviousNode(n))},_findPreviousNode:function(t){var e=t.previousSibling;return e?this._isUnvalidElement(e)?null:e:(t=t.parentNode)?this._findPreviousNode(t):null},_findLastTextNode:function(t){var e,n,o;if(t){if(r.isText(t))return t;if(0===(o=t.childNodes.length))return t=this._findPreviousNode(t),this._findLastTextNode(t);for(n=o-1;n>=0;n--)return e=t.childNodes[n],this._findLastTextNode(e)}return null},_parseTextNodeObject:function(t){var e,n,i,r,a,s="",l=t.textNodeArray[0].nodeValue,c=0,u="",d=t.endIndex,p=t.textNodeArray,h=t.textNodeArray.length;for(r=0;r<h-1;r++)u+=p[r].nodeValue;if(u+=p[h-1].nodeValue.slice(0,d),(e=o.matchEnd(u))&&e.result){for(i=e.result.index,a=0;a<h-1;a++){if(i-=s.length,s.length<=i&&l.length>i){c=a;break}s+=p[a].nodeValue,l+=p[a+1].nodeValue}n={uri:e.fullURI,startNode:p[c],startOffset:i,endNode:p[h-1],endOffset:d}}return n},_isUnvalidElement:function(t){var n,o;return!r.isText(t)&&(!r.isElement(t)||!e.contains(this._container,t)||(n=t.currentStyle||window.getComputedStyle(t,""),o="A"===t.nodeName,"block"===n.display||o))},_isInLinkElement:function(t){if(e.contains(this._container,t)){for(;t&&t!==this._container;){if("A"===t.nodeName)return!0;t=t.parentNode}return!1}}}}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){t.exports=!n(23)&&!n(14)(function(){return 7!=Object.defineProperty(n(177)("div"),"a",{get:function(){return 7}}).a})},function(t,e,n){e.f=n(17)},function(t,e,n){var o=n(39),i=n(40),r=n(141)(!1),a=n(179)("IE_PROTO");t.exports=function(t,e){var n,s=i(t),l=0,c=[];for(n in s)n!=a&&o(s,n)&&c.push(n);for(;e.length>l;)o(s,n=e[l++])&&(~r(c,n)||c.push(n));return c}},function(t,e,n){var o=n(24),i=n(9),r=n(87);t.exports=n(23)?Object.defineProperties:function(t,e){i(t);for(var n,a=r(e),s=a.length,l=0;s>l;)o.f(t,n=a[l++],e[n]);return t}},function(t,e,n){var o=n(40),i=n(90).f,r={}.toString,a="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];t.exports.f=function(t){return a&&"[object Window]"==r.call(t)?function(t){try{return i(t)}catch(t){return a.slice()}}(t):i(o(t))}},function(t,e,n){"use strict";var o=n(87),i=n(142),r=n(125),a=n(25),s=n(124),l=Object.assign;t.exports=!l||n(14)(function(){var t={},e={},n=Symbol(),o="abcdefghijklmnopqrst";return t[n]=7,o.split("").forEach(function(t){e[t]=t}),7!=l({},t)[n]||Object.keys(l({},e)).join("")!=o})?function(t,e){for(var n=a(t),l=arguments.length,c=1,u=i.f,d=r.f;l>c;)for(var p,h=s(arguments[c++]),f=u?o(h).concat(u(h)):o(h),g=f.length,m=0;g>m;)d.call(h,p=f[m++])&&(n[p]=h[p]);return n}:l},function(t,e){t.exports=Object.is||function(t,e){return t===e?0!==t||1/t==1/e:t!=t&&e!=e}},function(t,e,n){"use strict";var o=n(31),i=n(15),r=n(242),a=[].slice,s={};t.exports=Function.bind||function(t){var e=o(this),n=a.call(arguments,1),l=function(){var o=n.concat(a.call(arguments));return this instanceof l?function(t,e,n){if(!(e in s)){for(var o=[],i=0;i<e;i++)o[i]="a["+i+"]";s[e]=Function("F,a","return new F("+o.join(",")+")")}return s[e](t,n)}(e,o.length,o):r(e,o,t)};return i(e.prototype)&&(l.prototype=e.prototype),l}},function(t,e){t.exports=function(t,e,n){var o=void 0===n;switch(e.length){case 0:return o?t():t.call(n);case 1:return o?t(e[0]):t.call(n,e[0]);case 2:return o?t(e[0],e[1]):t.call(n,e[0],e[1]);case 3:return o?t(e[0],e[1],e[2]):t.call(n,e[0],e[1],e[2]);case 4:return o?t(e[0],e[1],e[2],e[3]):t.call(n,e[0],e[1],e[2],e[3])}return t.apply(n,e)}},function(t,e,n){var o=n(11).parseInt,i=n(107).trim,r=n(183),a=/^[-+]?0[xX]/;t.exports=8!==o(r+"08")||22!==o(r+"0x16")?function(t,e){var n=i(String(t),3);return o(n,e>>>0||(a.test(n)?16:10))}:o},function(t,e,n){var o=n(11).parseFloat,i=n(107).trim;t.exports=1/o(n(183)+"-0")!=-1/0?function(t){var e=i(String(t),3),n=o(e);return 0===n&&"-"==e.charAt(0)?-0:n}:o},function(t,e,n){var o=n(47);t.exports=function(t,e){if("number"!=typeof t&&"Number"!=o(t))throw TypeError(e);return+t}},function(t,e,n){var o=n(15),i=Math.floor;t.exports=function(t){return!o(t)&&isFinite(t)&&i(t)===t}},function(t,e){t.exports=Math.log1p||function(t){return(t=+t)>-1e-8&&t<1e-8?t-t*t/2:Math.log(1+t)}},function(t,e,n){var o=n(186),i=Math.pow,r=i(2,-52),a=i(2,-23),s=i(2,127)*(2-a),l=i(2,-126);t.exports=Math.fround||function(t){var e,n,i=Math.abs(t),c=o(t);return i<l?c*(i/l/a+1/r-1/r)*l*a:(n=(e=(1+a/r)*i)-(e-i))>s||n!=n?c*(1/0):c*n}},function(t,e,n){var o=n(9);t.exports=function(t,e,n,i){try{return i?e(o(n)[0],n[1]):e(n)}catch(e){var r=t.return;throw void 0!==r&&o(r.call(t)),e}}},function(t,e,n){var o=n(31),i=n(25),r=n(124),a=n(18);t.exports=function(t,e,n,s,l){o(e);var c=i(t),u=r(c),d=a(c.length),p=l?d-1:0,h=l?-1:1;if(n<2)for(;;){if(p in u){s=u[p],p+=h;break}if(p+=h,l?p<0:d<=p)throw TypeError("Reduce of empty array with no initial value")}for(;l?p>=0:d>p;p+=h)p in u&&(s=e(s,u[p],p,c));return s}},function(t,e,n){"use strict";var o=n(25),i=n(88),r=n(18);t.exports=[].copyWithin||function(t,e){var n=o(this),a=r(n.length),s=i(t,a),l=i(e,a),c=arguments.length>2?arguments[2]:void 0,u=Math.min((void 0===c?a:i(c,a))-l,a-s),d=1;for(l<s&&s<l+u&&(d=-1,l+=u-1,s+=u-1);u-- >0;)l in n?n[s]=n[l]:delete n[s],s+=d,l+=d;return n}},function(t,e){t.exports=function(t,e){return{value:e,done:!!t}}},function(t,e,n){"use strict";var o=n(198);n(1)({target:"RegExp",proto:!0,forced:o!==/./.exec},{exec:o})},function(t,e,n){n(23)&&"g"!=/./g.flags&&n(24).f(RegExp.prototype,"flags",{configurable:!0,get:n(126)})},function(t,e){t.exports=function(t){try{return{e:!1,v:t()}}catch(t){return{e:!0,v:t}}}},function(t,e,n){var o=n(9),i=n(15),r=n(202);t.exports=function(t,e){if(o(t),i(e)&&e.constructor===t)return e;var n=r.f(t);return(0,n.resolve)(e),n.promise}},function(t,e,n){"use strict";var o=n(258),i=n(95);t.exports=n(150)("Map",function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{get:function(t){var e=o.getEntry(i(this,"Map"),t);return e&&e.v},set:function(t,e){return o.def(i(this,"Map"),0===t?0:t,e)}},o,!0)},function(t,e,n){"use strict";var o=n(24).f,i=n(89),r=n(94),a=n(46),s=n(92),l=n(93),c=n(188),u=n(252),d=n(91),p=n(23),h=n(77).fastKey,f=n(95),g=p?"_s":"size",m=function(t,e){var n,o=h(e);if("F"!==o)return t._i[o];for(n=t._f;n;n=n.n)if(n.k==e)return n};t.exports={getConstructor:function(t,e,n,c){var u=t(function(t,o){s(t,u,e,"_i"),t._t=e,t._i=i(null),t._f=void 0,t._l=void 0,t[g]=0,null!=o&&l(o,n,t[c],t)});return r(u.prototype,{clear:function(){for(var t=f(this,e),n=t._i,o=t._f;o;o=o.n)o.r=!0,o.p&&(o.p=o.p.n=void 0),delete n[o.i];t._f=t._l=void 0,t[g]=0},delete:function(t){var n=f(this,e),o=m(n,t);if(o){var i=o.n,r=o.p;delete n._i[o.i],o.r=!0,r&&(r.n=i),i&&(i.p=r),n._f==o&&(n._f=i),n._l==o&&(n._l=r),n[g]--}return!!o},forEach:function(t){f(this,e);for(var n,o=a(t,arguments.length>1?arguments[1]:void 0,3);n=n?n.n:this._f;)for(o(n.v,n.k,this);n&&n.r;)n=n.p},has:function(t){return!!m(f(this,e),t)}}),p&&o(u.prototype,"size",{get:function(){return f(this,e)[g]}}),u},def:function(t,e,n){var o,i,r=m(t,e);return r?r.v=n:(t._l=r={i:i=h(e,!0),k:e,v:n,p:o=t._l,n:void 0,r:!1},t._f||(t._f=r),o&&(o.n=r),t[g]++,"F"!==i&&(t._i[i]=r)),t},getEntry:m,setStrong:function(t,e,n){c(t,e,function(t,n){this._t=f(t,e),this._k=n,this._l=void 0},function(){for(var t=this._k,e=this._l;e&&e.r;)e=e.p;return this._t&&(this._l=e=e?e.n:this._t._f)?u(0,"keys"==t?e.k:"values"==t?e.v:[e.k,e.v]):(this._t=void 0,u(1))},n?"entries":"values",!n,!0),d(e)}}},function(t,e,n){"use strict";var o=n(258),i=n(95);t.exports=n(150)("Set",function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{add:function(t){return o.def(i(this,"Set"),t=0===t?0:t,t)}},o)},function(t,e,n){"use strict";var o,i=n(11),r=n(60)(0),a=n(36),s=n(77),l=n(239),c=n(261),u=n(15),d=n(95),p=n(95),h=!i.ActiveXObject&&"ActiveXObject"in i,f=s.getWeak,g=Object.isExtensible,m=c.ufstore,y=function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},v={get:function(t){if(u(t)){var e=f(t);return!0===e?m(d(this,"WeakMap")).get(t):e?e[this._i]:void 0}},set:function(t,e){return c.def(d(this,"WeakMap"),t,e)}},_=t.exports=n(150)("WeakMap",y,v,c,!0,!0);p&&h&&(l((o=c.getConstructor(y,"WeakMap")).prototype,v),s.NEED=!0,r(["delete","has","get","set"],function(t){var e=_.prototype,n=e[t];a(e,t,function(e,i){if(u(e)&&!g(e)){this._f||(this._f=new o);var r=this._f[t](e,i);return"set"==t?this:r}return n.call(this,e,i)})}))},function(t,e,n){"use strict";var o=n(94),i=n(77).getWeak,r=n(9),a=n(15),s=n(92),l=n(93),c=n(60),u=n(39),d=n(95),p=c(5),h=c(6),f=0,g=function(t){return t._l||(t._l=new m)},m=function(){this.a=[]},y=function(t,e){return p(t.a,function(t){return t[0]===e})};m.prototype={get:function(t){var e=y(this,t);if(e)return e[1]},has:function(t){return!!y(this,t)},set:function(t,e){var n=y(this,t);n?n[1]=e:this.a.push([t,e])},delete:function(t){var e=h(this.a,function(e){return e[0]===t});return~e&&this.a.splice(e,1),!!~e}},t.exports={getConstructor:function(t,e,n,r){var c=t(function(t,o){s(t,c,e,"_i"),t._t=e,t._i=f++,t._l=void 0,null!=o&&l(o,n,t[r],t)});return o(c.prototype,{delete:function(t){if(!a(t))return!1;var n=i(t);return!0===n?g(d(this,e)).delete(t):n&&u(n,this._i)&&delete n[this._i]},has:function(t){if(!a(t))return!1;var n=i(t);return!0===n?g(d(this,e)).has(t):n&&u(n,this._i)}}),c},def:function(t,e,n){var o=i(r(e),!0);return!0===o?g(t).set(e,n):o[t._i]=n,t},ufstore:g}},function(t,e,n){var o=n(48),i=n(18);t.exports=function(t){if(void 0===t)return 0;var e=o(t),n=i(e);if(e!==n)throw RangeError("Wrong length!");return n}},function(t,e,n){var o=n(90),i=n(142),r=n(9),a=n(11).Reflect;t.exports=a&&a.ownKeys||function(t){var e=o.f(r(t)),n=i.f;return n?e.concat(n(t)):e}},function(t,e,n){"use strict";var o=n(143),i=n(15),r=n(18),a=n(46),s=n(17)("isConcatSpreadable");t.exports=function t(e,n,l,c,u,d,p,h){for(var f,g,m=u,y=0,v=!!p&&a(p,h,3);y<c;){if(y in l){if(f=v?v(l[y],y,n):l[y],g=!1,i(f)&&(g=void 0!==(g=f[s])?!!g:o(f)),g&&d>0)m=t(e,n,f,r(f.length),m,d-1)-1;else{if(m>=9007199254740991)throw TypeError();e[m]=f}m++}y++}return m}},function(t,e,n){var o=n(18),i=n(185),r=n(58);t.exports=function(t,e,n,a){var s=String(r(t)),l=s.length,c=void 0===n?" ":String(n),u=o(e);if(u<=l||""==c)return s;var d=u-l,p=i.call(c,Math.ceil(d/c.length));return p.length>d&&(p=p.slice(0,d)),a?p+s:s+p}},function(t,e,n){var o=n(87),i=n(40),r=n(125).f;t.exports=function(t){return function(e){for(var n,a=i(e),s=o(a),l=s.length,c=0,u=[];l>c;)r.call(a,n=s[c++])&&u.push(t?[n,a[n]]:a[n]);return u}}},function(t,e,n){var o=n(106),i=n(268);t.exports=function(t){return function(){if(o(this)!=t)throw TypeError(t+"#toJSON isn't generic");return i(this)}}},function(t,e,n){var o=n(93);t.exports=function(t,e){var n=[];return o(t,!1,n.push,n,e),n}},function(t,e){t.exports=Math.scale||function(t,e,n,o,i){return 0===arguments.length||t!=t||e!=e||n!=n||o!=o||i!=i?NaN:t===1/0||t===-1/0?t:(t-e)*(i-o)/(n-e)+o}},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";var a,s=this&&this.__extends||(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});o=[n,r,n(0),n(79),n(4),n(50),n(27),n(2),n(205),n(7),n(210),n(601),n(207),n(38),n(602),n(3),n(112),n(294),n(62),n(63),n(28),n(12),n(32),n(293),n(209)],void 0===(i=function(t,e,n,o,i,r,a,l,c,u,d,p,h,f,g,m,y,v,_,b,C,k,w,S,x){return function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.entityCache={},e}return s(e,t),e.createBlank=function(t,n){var o=C.createBlank(t);return n||(n=new e({})),n.append(o),n},e.fromHtml=function(t,o,i,r){var a,s=c.parseHtml(t);return o||(o=new e({})),a=(r=n.defaults(r||{},{isAsync:!1,progressCallBack:function(){}})).progressCallBack,e._parseHTMLInBatch(s,0,o,i,a,r.isAsync)?o:null},e.fromOCR=function(t,o,i){var r=c.parseOCR(t,i),a=0;return o=o||new e({}),n.each(r,function(t){t&&(o.append(t),a++)}),a?o:null},e.fromXml=function(t,o,i,r){var a,s,c,p,f,g,m={},b={};return o||(o=new e({})),g=(r=n.defaults(r||{},{isAsync:!1,progressCallBack:function(){}})).progressCallBack,n.isString(t)?(t=d.clear(t),a=$.parseXML(t)):a=t,g({percent:.1}),o.setContentStatus(!0),l.log(a),(c=(s=$(a).find("note:first")).attr("schema-version"))&&o.setSchemaVersion(c),p=parseInt(s.attr("file-version"),10),isNaN(p)&&(p=0),o.setFileVersion(p),s&&s.get(0)?(s.find("head").children().each(function(t,e){var n;switch(e.nodeName){case"list":n=_.fromXml(e),m[$(e).attr("id")]=n;break;case"catalogue-wrap":n=y.fromXml(e),b[$(e).attr("id")]=n;break;case"header":n=v.fromXml(e),o.setHeaderFooter(n,!1,!0);break;case"footer":n=v.fromXml(e),o.setHeaderFooter(n,!0,!0);break;default:n=$(e).attr(u.COMPAT),h.isCompatible(n)&&(n=e.cloneNode(!0),o.headUnknownNodeList.push(n))}}),g({percent:.15}),f=s.find("body").children(),e._parseXMLBodyInBatch(f,0,o,m,b,i,g,r.isAsync),o):(o.isBlank()&&o.append(C.createBlank()),g({percent:1}),o.setContentStatus(!1),o.updateContentParseTimer(null),o)},e.unescape=function(t){var e=document.createElement("span");return e.innerHTML=t,e.textContent},e._parseHTMLInBatch=function(t,o,i,r,a,s){var l,c,u,d=Date.now(),p=!1,h=i.getExtraInfo("pcTodoMap");if(null==t&&0===t.length)return a({percent:1}),i.updateContentParseTimer(null),!1;for(;o<t.length;)if(l=t[o],m.isImage(l)&&r&&r.length>0&&n.each(r,function(t){t.resId!==l.getResId()||l.setImageInfo(t)}),m.isTodo(l)&&l.isFromOldTodo()&&((u=l.getLegacyResId())&&h&&h[u]?(l.setText(e.unescape(JSON.parse(h[u]).content)),l.setChecked(JSON.parse(JSON.parse(h[u]).checked))):l=null),l&&(i.append(l),p=!0),++o>=t.length?(a({percent:1}),i.updateContentParseTimer(null)):a({percent:.15+o/t.length*.85}),s&&Date.now()-d>100){c=setTimeout(e._parseHTMLInBatch.bind(null,t,o,i,r,a,s),10),i.updateContentParseTimer(c);break}return p},e._parseXMLBodyInBatch=function(t,o,r,a,s,l,c,d){var p,y,v,_,b,C,k,w,x=Date.now();if(null==t||0===t.length)return c({percent:1}),r.updateContentParseTimer(null),void r.setContentStatus(!1);for(;o<t.length;){if(y=(p=t[o]).nodeName,v=g[y],_=$(p).attr(u.COMPAT),(!v&&h.isCompatible(_)||v&&_&&!h.isCompatible(_))&&(v=S),v&&v.fromXml){if(!(b=v.fromXml(p)))throw r.updateContentParseTimer(null),new Error("Failed to parse block from xml node!");for(C=f.parseResourceList(p),b.setResourceIds(C),m.isListItem(b)&&b.setOwnerList(a[$(p).attr("list-id")]),m.isImage(b)&&l&&l.length>0&&n.each(l,function(t){t.resId!==b.getResId()||b.setImageInfo(t)}),m.isCatalogue(b)&&b.setOwnerList(s[$(p).attr("catalogue-id")]),r.append(b),b.isValidForCollab()||r.setValidForCollab(!1),w=b.getId();r.originalBlockIds.indexOf(w)>-1;)w=i.newGUID();w!==b.getId()&&(r.setValidForCollab(!1),b.setId(w)),r.originalBlockIds.push(w)}if(++o>=t.length)c({percent:1}),r.setContentStatus(!1),r.updateContentParseTimer(null);else if(c({percent:.15+o/t.length*.85}),d&&Date.now()-x>100){k=setTimeout(e._parseXMLBodyInBatch.bind(null,t,o,r,a,s,l,c,d),10),r.updateContentParseTimer(k);break}}},e.prototype.append=function(t){this.insert(this.blocks.length,t)},e.prototype.clearHighlight=function(){this.trigger("clear-high-light")},e.prototype.countWords=function(t,e){var n,o,i=function(t){return!m.isHr(t)};return t&&(n=!0,o=this._parseWordCountInfo(t.getDataAsPlain(this,i))),(!t||!o.all&&e)&&(n=!1,o=this._parseWordCountInfo(this.toPlain(i))),{count:o.all,detail:o,isSelected:n}},e.prototype.findAttachmentByResource=function(t,e){return n.filter(this.blocks,function(n){return m.isAttachment(n)&&n.getResource(e)===t})},e.prototype.getAllBlocks=function(){return this.blocks},e.prototype.getAllResouceIds=function(){var t=[];return n.each(this.blocks,function(e){var n=e.getResourceIds();n&&n.length&&(t=t.concat(n))}),t=n.uniq(t)},e.prototype.getAllResourceInfo=function(t,e){var o,i,r,a,s=[];return t=t||this.blocks,e=e||[m.IMAGE,m.ATTACHMENT,m.HANDWRITE,m.TABLE],n.each(this.blocks,function(t){m.isAttachment(t)&&e.indexOf(m.ATTACHMENT)>-1||m.isHandWrite(t)&&e.indexOf(m.HANDWRITE)>-1?(o=t.getSource(!1),i=t.getSource(!0),r=t.getResource(!1),a=t.getResource(!0),o&&i&&r&&a&&s.push({extraResource:a,extraSource:i,resource:r,source:o})):m.isImage(t)&&e.indexOf(m.IMAGE)>-1?(o=t.getSource(!1),i=t.getSource(!0),o&&i&&s.push({blockId:t.getId(),extraSource:i,source:o})):m.isTable(t)&&(s=s.concat(t.getAllResourceInfo()))}),s},e.prototype.getAttachmentByResource=function(t,e){return n.filter(this.blocks,function(n){return m.isAttachment(n)&&n.getResource(e)===t})},e.prototype.getBlockAt=function(t){return this.blocks[t]},e.prototype.getBlockById=function(t){return this.header&&t===this.header.getId()?this.header:this.footer&&t===this.footer.getId()?this.footer:n.find(this.blocks,function(e){return t===e.getId()})},e.prototype.getBlockIndex=function(t){return n.indexOf(this.blocks,t)},e.prototype.getBlockIndexById=function(t){var e,n=-1;return(e=this.getBlockById(t))&&(n=this.getBlockIndex(e)),n},e.prototype.getCommonInlineStyle=function(t,e){var o=this;if(t&&e){var i,r=t.getStartBlockRange(),a=t.getEndBlockRange(),s=r.block,l=a.block,c=null,d=[],p=!0;return this.isNonEmptyParaTable(s)&&(d.push(s.getCommonInlineStyle(e,r)),p=!1),s!==l&&(i=this.getInterBlocks(s,l),n.each(i,function(t){o.isNonEmptyParaTable(t)&&(d.push(t.getCommonInlineStyle(e)),p=!1)}),this.isNonEmptyParaTable(l)&&(d.push(l.getCommonInlineStyle(e,a)),p=!1)),p?(m.isTextBlock(s)&&(c=s.getInlineStyleForEmpty(e,!0)),c||w.getDefault(e)):(n.some(d,function(t){if(null===c)c=t;else if(null!=t&&c!==t)return c=u.INTERM,!0}),c)}},e.prototype.getExtraInfo=function(t){return t?(this.extraInfo||{})[t]:this.extraInfo},e.prototype.getHeaderFooter=function(t){return t?this.footer:this.header},e.prototype.getFileVersion=function(){return this.fileVersion},e.prototype.getEntityCache=function(t){var e=this.entityCache;return n.pick(e,t)},e.prototype.entityExistInCache=function(t){var e=this.getEntityCache(t);return n.keys(e).length===t.length},e.prototype.getImageBySource=function(t,e){return n.filter(this.blocks,function(n){return m.isImage(n)&&n.getSource(e)===t})},e.prototype.getInterBlocks=function(t,e,n){var o=this.blocks,i=this.getBlockIndex(t),r=this.getBlockIndex(e);return n?o.slice(i,r+1):o.slice(i+1,r)},e.prototype.getLastBlock=function(){return n.last(this.blocks)},e.prototype.getNextBlock=function(t){var e=this.getBlockIndex(t);if(e>=0)return this.getBlockAt(e+1)},e.prototype.getNoteId=function(){return this.noteId},e.prototype.getPreBlock=function(t){var e=this.getBlockIndex(t);if(e>0)return this.getBlockAt(e-1)},e.prototype.getRangeBlockStyle=function(t,e){if(t&&e){var o=t.getStartBlockRange(),i=t.getEndBlockRange(),r=o.block,a=i.block,s=this.getInterBlocks(r,a,!0),c=null;return t.isSingleTableSelected()?s[0]?s[0].getCommonBlockStyle(e,o):void l.warn("No table block find, need update noteRange"):(n.each(s,function(t){var n=t.getBlockStyle(e);c=null===c?n:c===n?c:u.INTERM}),c)}},e.prototype.getSchemaVersion=function(){return this.schemaVersion||h.getDefaultAsString()},e.prototype.hasHandWriteBlock=function(){var t=!1;return n.some(this.blocks,function(e){return m.isHandWrite(e)&&(t=!0),t}),t},e.prototype.highlight=function(t,e){var o,i,r=[];e=n.defaults(e||{},{ignoreCase:!1}),t&&t.length&&(o=[],n.each(t,function(t){if(t&&!/\s/.test(t)){var e=new k({text:t});o.push(e)}}),o=o.length?o:null),i=this.blocks.slice(),this.header&&i.unshift(this.header),this.footer&&i.push(this.footer),n.each(i,function(t){(null!=o||null!=e.images&&e.images.length>0&&(m.isImage(t)||m.isTable(t)))&&t.highlight(o,e,function(t){r.push(t)})}),this.trigger("high-light",r),n.isFunction(e.callback)&&e.callback(r.length)},e.prototype.insert=function(t,e){if(!e)throw new Error("cannot insert null block");this.blocks.splice(t,0,e),this._bindEventsForBlock(e),e.trigger("attached",this),this.trigger("insert-block",t,e)},e.prototype.isBlank=function(){return!this.blocks||0===this.blocks.length},e.prototype.isEmptyContent=function(){var t,e=this.blocks;return!!(e&&1===e.length&&(t=e[0])&&t.isEmptyContent)&&t.isEmptyContent()},e.prototype.isParsingData=function(){return null!=this.contentParseTimer},e.prototype.isReadOnly=function(){return this.readOnly},e.prototype.isSameNote=function(t){return t===this.noteId},e.prototype.isDragProhibited=function(){return this.dragProhibited},e.prototype.isCopyProhibited=function(){return this.copyProhibited},e.prototype.isSameList=function(t,e){var n,o,i,r,a,s,c,u,d,p;if(!t)return l.error("isSameList:noteRange should not be null"),!1;for(n=t.getStartBlockRange(),o=t.getEndBlockRange(),i=n.block,r=o.block,p=(a=this.getInterBlocks(i,r,!0)).length,s=0;s<p;s++)if((c=a[s])instanceof C){if(!(c instanceof b))return!1;if((u=c.getOwnerList()).getType()!==e)return!1;if(d){if(d!==c.getOwnerList())return!1}else d=u}return!!d},e.prototype.isValidForCollab=function(){return this.validForCollab},e.prototype.lastBlockIsEasyInput=function(){var t=this.getLastBlock();return m.isTextBlock(t)},e.prototype.lockBlock=function(t,e){this._setBlockLocked(t,!0,e)},e.prototype.nextHighlight=function(){this.trigger("next-high-light")},e.prototype.preHighlight=function(){this.trigger("pre-high-light")},e.prototype.remove=function(t,e){var n=this.blocks.splice(t,1)[0];n&&(n.trigger("detached",this),this._unbindEventsForBlock(n),this.trigger("remove-block",t,e))},e.prototype.removeBlock=function(t){this.remove(this.getBlockIndex(t))},e.prototype.removeBlockById=function(t,e){this.remove(this.getBlockIndexById(t),e)},e.prototype.replace=function(t,e){var n=this.blocks.splice(t,1,e)[0];return n?(n.trigger("detached",this),this._unbindEventsForBlock(n)):l.warn("oldBlock should not be null"),e&&(this._bindEventsForBlock(e),e.trigger("attached",this)),this.trigger("replace-block",t,e,n),n},e.prototype.reset=function(){this.destroy(),this.noteId=i.newGUID(),this.headUnknownNodeList=[],this.blocks=[],this.originalBlockIds=[],null!=this.contentParseTimer&&(clearTimeout(this.contentParseTimer),this.contentParseTimer=null),this.header=null,this.footer=null},e.prototype.setExtraInfo=function(t){this.extraInfo=t,this._triggerExtraInfoChange()},e.prototype.setEntityCache=function(t){this.entityCache=Object.assign(this.entityCache,t)},e.prototype.removeEntityCache=function(){this.entityCache={}},e.prototype.setEntity=function(t,e){var n;e&&(n=this.getBlockById(e))&&n instanceof C&&n.setEntity(t)},e.prototype.setExtraInfoWithKey=function(t,e,n,o){var i=this.extraInfo,r=i[t];i||(i={},o=!0),r||(i[t]=r={}),r[e]=n,!0===o?this.setExtraInfo(i):this.extraInfo=i},e.prototype.setFileVersion=function(t){this.fileVersion=t},e.prototype.setDragProhibited=function(t){t!==this.dragProhibited&&(this.dragProhibited=t)},e.prototype.setCopyProhibited=function(t){t!==this.copyProhibited&&(this.copyProhibited=t,this.trigger("copy-prohibited",t))},e.prototype.setHeaderFooter=function(t,e,n){e?this.footer=t:this.header=t,n&&this.trigger("header-footer-changed",e)},e.prototype.setReadOnly=function(t){(t=!!t)!==this.readOnly&&(this.readOnly=t,this.trigger("read-only-change",t),n.each(this.blocks,function(e){e.setReadOnly(t)}))},e.prototype.setContentStatus=function(t){this.contentStart=t},e.prototype.getContentStatus=function(){return this.contentStart},e.prototype.setSchemaVersion=function(t){h.isLessThanDefault(t)?l.warn("schema version is older than current, need upgrade!"):this.schemaVersion=t||h.getDefaultAsString()},e.prototype.setValidForCollab=function(t){this.validForCollab=t},e.prototype.toHtml=function(t,e){var n,o,i,r,a,s,l,c,u,d,p,h,f,g,y,v=this.blocks,_=v.length,b=[],C=[];for(e=!0===e,t?(s=t.getStartBlockRange(),l=t.getEndBlockRange(),c=s.block,u=l.block,d=this.getBlockIndex(c),p=this.getBlockIndex(u),y=t.isInSingleBlock()):(d=0,p=_-1),o=d;o<=p;o++)g=null,h=o===d,f=o===p,n=v[o],h&&s?(g=s,y||(g=g.clone()).expandToEnd()):f&&l&&(g=l,y||(g=g.clone()).expandToStart()),m.isListItem(n)||m.isCatalogue(n)?(a=n.getOwnerList(),r&&r!==a&&C.length&&(i=this._toHtmlWithSameOwnerList(C,e),b.push(i),C=[]),C.push({block:n,range:g||null}),r=a):(r=null,C.length&&(i=this._toHtmlWithSameOwnerList(C,e),b.push(i),C=[]),i=g?g.getDataAsHtml(e):n.toHtml(null,null,e),b.push(i));return C.length&&(i=this._toHtmlWithSameOwnerList(C,e),b.push(i)),b.join("")},e.prototype.toPlain=function(t){var e=t?n.filter(this.blocks,t):this.blocks;return n.map(e,function(t){return t.toPlain()}).join("\n")},e.prototype.toXml=function(){var t,e,i,r,a,s,c="http://"+x.getNamespace(),u=this._createXMLDocument(c,"note"),d=u.createElement("head"),p=u.createElement("body"),h={},f=this.getSchemaVersion(),g=this.getFileVersion(),m=u.documentElement,y=[];return m.appendChild(d),m.appendChild(p),f&&m.setAttribute("schema-version",f),m.setAttribute("file-version",g.toString()),n.each(this.blocks,function(t){var e,o,i,r,a,s;t&&t.toXml&&(e=t.toXml(u)),e?e.listItem?(o=e,p.appendChild(o.listItem),r=o.listId,h[r]||(h[r]=!0,i=u.createElement("list"),a=o.ownerList.unknownAttrs,n.each(a,function(t){var e=t.cloneNode(!0);i.setAttributeNode(e)}),i.setAttribute("id",r),i.setAttribute("type",o.listType),d.appendChild(i))):("catalogue"===e.tagName&&(s=e.getAttribute("catalogue-id"),-1===y.indexOf(s)&&y.push(s)),p.appendChild(e)):l.warn("block.toXml() failed!")}),n.each(this.headUnknownNodeList,function(t){if(t&&t.cloneNode){var e=t.cloneNode(!0);d.appendChild(e)}}),s=d.querySelectorAll("catalogue-wrap"),n.each(s,function(t){d.removeChild(t)}),n.each(y,function(t){t&&((a=u.createElement("catalogue-wrap")).setAttribute("id",t),a.setAttribute("compat","true"),d.appendChild(a))}),e=this.getHeaderFooter(!1),i=this.getHeaderFooter(!0),e&&(t=e.toXml(u))&&d.appendChild(t),i&&(t=i.toXml(u))&&d.appendChild(t),r=(new XMLSerializer).serializeToString(u),o.startsWith(r,"<?xml")||(r='<?xml version="1.0"?>\n'+r),r},e.prototype.unlockBlock=function(t){this._setBlockLocked(t,!1)},e.prototype.updateContentParseTimer=function(t){this.contentParseTimer!==t&&(clearTimeout(this.contentParseTimer),this.contentParseTimer=t),null==t&&this.trigger("content-parse-done")},e.prototype.initialize=function(){this.extraInfo={},this.noteId=i.newGUID(),this.blocks=[],this.originalBlockIds=[],this.headUnknownNodeList=[],this.schemaVersion=h.getDefaultAsString(),this.fileVersion=0},e.prototype.destroy=function(){var t=this;n.each(t.blocks,function(e){t._unbindEventsForBlock(e)}),t.blocks=null,t.readOnly=!1,t.validForCollab=!0},e.prototype.isNonEmptyParaTable=function(t){return t instanceof C&&!t.isEmpty()||m.isTable(t)&&!t.isEmptyContent()},e.prototype._bindEventsForBlock=function(t){var e;t&&(this._unbindEventsForBlock(t),e=this._listenerEventsForBlock(),r.addListeners(e,t,this),e=this._bubbleEventsForBlock(t),r.bubble(e,t,this))},e.prototype._bubbleEventsForBlock=function(t){var e={};return m.isTable(t)&&(e=n.extend(e,{"color-picker-show":!0,"get-block-view":!0,"yne-user-action-collection":!0})),e},e.prototype._listenerEventsForBlock=function(){return{"get-default-set-font":"_onGetDefaultSetFont","get-extra-info":"_onGetExtraInfo"}},e.prototype._onGetDefaultSetFont=function(t){this.trigger("get-default-set-font",function(e){t(e)})},e.prototype._onGetExtraInfo=function(t,e){e(this.getExtraInfo(t))},e.prototype._parseCataloguesToHtml=function(t){var e,n,o=document.createElement("div"),i=document.createElement("div"),r="";for(n=0;n<t.length;n++)r+=(e=t[n].block).toHtml();return o.innerHTML=r,i.setAttribute("yne-bulb-type","catalogue-wrap-container"),i.style.backgroundColor=e.getBlockStyle("back-color"),i.appendChild(o),i.outerHTML},e.prototype._parseWordCountInfo=function(t){var e=/[A-z0-9~!@#$%^&*()_+{}|:"<>?`\-=[\]\\;',.\/]+/g,n=t.match(e),o=t.match(/[\u4e00-\u9fa5\u3002\uff1b\uff0c\uff1a\u201c\u201d\uff08\uff09\u3001\uff1f\u300a\u300b]/g),i=t.replace(e,"").replace(/\s+/g,"").length,r=o?o.length:0,a=n?n.length:0,s=i-r;return{all:r+a+s,chinese:r,nonChinese:a+s}},e.prototype._parseListItemsToTree=function(t){var e,n,o,i,r,a,s,l,c,u=new p(0),d=t.length;for(r=u,e=0;e<d;e++){if(o=(n=t[e]).block,i=n.range||{},l=o.getLevel(),s=new p(l,o,i.start,i.end),(c=l-r.getLevel())>1)for(;l-r.getLevel()>1;)a=new p(r.getLevel()+1),r.addChildNodes([a]),r=a;else if(c<1)for(;l-r.getLevel()<1;)r=r.getParentNode();r.addChildNodes([s]),r=s}return u},e.prototype._setBlockLocked=function(t,e,o){var i,r=this;i=n.isArray(t)?t:[t],n.each(i,function(i){var a;(a=n.isString(i)?r.getBlockById(i):i)?a.setLocked(e,o):l.log("BlockLock: skip non-existing block",t)})},e.prototype._toHtmlWithSameOwnerList=function(t,e){var o,i,r=n.first(t).block;if(m.isListItem(r)){if(o=this._parseListItemsToTree(t)){i=o.toHtml(!0===e);var a=document.createElement("div");r&&r.getBlockStyle("back-color")&&(a.style.backgroundColor=r.getBlockStyle("back-color")),a.innerHTML=i,i=a.outerHTML}}else m.isCatalogue(r)&&(i=this._parseCataloguesToHtml(t));return i||""},e.prototype._triggerExtraInfoChange=function(){n.each(this.blocks,function(t){t.trigger("extra-info-change")})},e.prototype._unbindEventsForBlock=function(t){if(t){var e=function(e){e&&n.each(e,function(e,n){t.off(n)})};e(this._listenerEventsForBlock()),e(this._bubbleEventsForBlock(t))}},e.prototype._createXMLDocument=function(t,e){var n=document.implementation.createDocument(t,e,null);return n.createElement=function(t){return this.createElementNS(this.documentElement.namespaceURI,t)},n},e}(a)}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e,o=n(562),i=n(287),r=n(594);return function(t,n){return e||(e=new o(i)).define(".MsoListParagraph",r,o.PRIORITY.HIGH),e.parse(t,n)}}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";o=[n,r,n(109)],void 0===(i=function(t,e,n){return n({DEFAULT_FONT:"Microsoft YaHei"})}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(){return function(t){var e=0;return t?e=("string"==typeof t?t:t.toString()).replace(/(\s)/g,"").length:e}}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";o=[n,r,n(0),n(51)],void 0===(i=function(t,e,n,o){return function(){function t(){}return t.getRules=function(e){var o=e?n.clone(e):{};return n.defaults(o,t.DEFAULT_RULES),o},t.convertToCssStyle=function(e,o,i){var r={},a=t.getRules(i);return n.isArray(o)&&(a=n.pick(a,o)),n.isObject(e)&&n.each(a,function(t,n){r[n]=t(e)}),r},t.DEFAULT_RULES={"font-size":function(t){var e=t["font-size"];if(null!=e)return e+"px"},"font-family":function(t){var e=t["font-family"];return e=o.getAllValueByFont(e)||e},color:function(t){return t.color},"background-color":function(t){return t["back-color"]},"font-weight":function(t){return{true:"bold",false:"normal"}[t.bold+""]},"font-style":function(t){return{true:"italic",false:"normal"}[t.italic+""]},"text-decoration":function(t){if(!1===t.underline&&!1===t.strike)return"none";var e=[];return t.underline&&e.push("underline"),t.strike&&e.push("line-through"),e.join(" ")||""}},t}()}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t,e){return function(t,e){if(null!=String.prototype.codePointAt)return String.prototype.codePointAt.call(t,e);if(null==t)throw new TypeError("codePointAt第一个参数必须为String");var n,o,i=(t=String(t)).length,r=isNaN(e)?0:Number(e);return r<0||r>=i?void 0:(n=t.charCodeAt(r))>=55296&&n<=56319&&i>r+1&&(o=t.charCodeAt(r+1))>=56320&&o<=57343?1024*(n-55296)+o-56320+65536:n}}.apply(i,[n,i]))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";o=[n,r,n(272),n(109),n(43)],void 0===(i=function(t,e,n,o,i){var r="transparent",a="#000000";return o({bold:{key:"b",default:!1,type:"Boolean"},italic:{key:"i",default:!1,type:"Boolean"},underline:{key:"u",default:!1,type:"Boolean"},strike:{key:"s",default:!1,type:"Boolean"},"font-family":{key:"ff",default:n.DEFAULT_FONT,type:"String"},"font-size":{key:"fs",default:14,type:"Number"},color:{key:"cl",default:a,type:"String",equalDefault:function(t){return t===a||i.equals(t,a)}},"back-color":{key:"bc",default:r,type:"String",equalDefault:function(t){return t===r||i.equals(t,r)}},href:{key:"href",default:"",type:"String"}})}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";o=[n,r,n(275)],void 0===(i=function(t,e,n){return function(t){var e,o=[];for(e=0;e<t.length;e++)n(t,e)>65535?(o.push(t.slice(e,e+2)),e++):o.push(t[e]);return o}}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";o=[n,r,n(0),n(32)],void 0===(i=function(t,e,n,o){return function(){function t(){}return t.add=function(e){e&&!o.isSupport(e)&&(n.contains(t.unknownInlineStyleNames,e)||t.unknownInlineStyleNames.push(e))},t.get=function(){return t.unknownInlineStyleNames},t.reset=function(){t.unknownInlineStyleNames=[]},t.unknownInlineStyleNames=[],t}()}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},,,,,,,,,function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(0),o=n(574),i=n(575),r=n(576),a={a:r.AnchorHandler,abbr:r.InlineHandler,acronym:r.InlineHandler,address:r.ParagraphHandler,applet:!1,area:!1,article:r.ParagraphHandler,aside:r.ParagraphHandler,audio:!1,b:r.InlineHandler,base:!1,basefont:!1,bdi:r.InlineHandler,bdo:r.InlineHandler,bgsound:!1,big:r.InlineHandler,blink:r.InlineHandler,blockquote:r.ParagraphHandler,body:r.ParagraphHandler,br:r.BreakHandler,button:!1,canvas:!1,center:r.ParagraphHandler,cite:r.InlineHandler,code:r.InlineHandler,command:!1,content:!1,data:!1,datalist:!1,dd:r.ParagraphHandler,del:r.InlineHandler,details:r.ParagraphHandler,dfn:r.InlineHandler,dialog:!1,dir:r.InlineHandler,div:r.ParagraphHandler,dl:r.ParagraphHandler,dt:r.ParagraphHandler,element:!1,em:r.InlineHandler,embed:!1,fieldset:r.ParagraphHandler,figcaption:r.ParagraphHandler,figure:r.ParagraphHandler,font:r.InlineHandler,footer:r.ParagraphHandler,form:r.ParagraphHandler,frame:!1,frameset:!1,h1:r.ParagraphHandler,h2:r.ParagraphHandler,h3:r.ParagraphHandler,h4:r.ParagraphHandler,h5:r.ParagraphHandler,h6:r.ParagraphHandler,header:r.ParagraphHandler,hgroup:r.ParagraphHandler,hr:r.HrHandler,html:r.ParagraphHandler,i:r.InlineHandler,iframe:!1,image:!1,img:r.ImageHandler,input:r.TodoHandler,ins:r.InlineHandler,isindex:!1,kbd:r.InlineHandler,keygen:!1,label:r.InlineHandler,legend:r.ParagraphHandler,li:r.ListItemHandler,link:!1,listing:!1,main:r.ParagraphHandler,map:!1,mark:r.InlineHandler,marquee:r.ParagraphHandler,menu:!1,menuitem:!1,meta:!1,meter:r.InlineHandler,multicol:r.ParagraphHandler,nav:r.ParagraphHandler,nobr:r.InlineHandler,noembed:!1,noframes:!1,noscript:!1,object:!1,ol:r.ListHandler,optgroup:!1,option:!1,output:r.InlineHandler,p:r.ParagraphHandler,param:!1,picture:!1,plaintext:r.ParagraphHandler,pre:r.ParagraphHandler,progress:!1,q:r.InlineHandler,rp:r.InlineHandler,rt:r.InlineHandler,rtc:r.InlineHandler,ruby:r.ParagraphHandler,s:r.InlineHandler,samp:r.InlineHandler,script:!1,section:r.ParagraphHandler,select:!1,shadow:!1,small:r.InlineHandler,source:!1,spacer:!1,span:r.InlineHandler,strike:r.InlineHandler,strong:r.InlineHandler,style:!1,sub:r.InlineHandler,summary:r.ParagraphHandler,sup:r.InlineHandler,table:r.TableHandler,template:!1,textarea:r.ParagraphHandler,time:r.InlineHandler,title:!1,track:!1,tt:r.InlineHandler,u:r.InlineHandler,ul:r.ListHandler,var:r.InlineHandler,video:!1,wbr:!1,xmp:!1},s=function(t,n){t&&t.length&&e.each(t,function(t){null==n[t]&&(n[t]=!1)})};return s(o,a),s(i,a),a}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e,o=n(159),i=n(81),r=n(131),a=n(290),s=n(80),l=n(0);return e=o.extend({inheritStyleHandlers:!1,uninheritStyleHandlers:{width:!0,float:!0},inheritBlockStyles:{align:!0},_handleNoteLink:function(){var t,e,n,o=this.el;t=o.getAttribute("data-attr-noteid"),e=o.getAttribute("alt"),t&&e&&((n=this.parent&&this.parent.styles?l.clone(this.parent.styles):{}).href="note://"+t,n.color="#003884",n.underline=!0,this.emit({text:e,styles:n,isText:!0}))},_handleNoteTodo:function(){var t=this.el.getAttribute("data-res-todo"),e=new s({legacyResId:t});this.emit(e)},finish:function(){var t,n,o,s,c,u=this,d=u.el,p=d.getAttribute("src")||d.getAttribute("data-src"),h=function(t,e){l.each(t,function(t,n){var o=e.style[t];o&&(u.styles[n]=o)})};e.isNoteLink(d)?u._handleNoteLink():e.isTodo(d)?u._handleNoteTodo():p&&((o=d.parentNode)&&(s=o.getAttribute("yne-bulb-block")),e.isAttachment(d)?(n=d.getAttribute("path"),t=new r({source:p,resource:n,fileName:e.getAttachmentFileName(d),fileLength:e.getAttachmentFileLength(d)}),"attachment"===s&&h({align:"textAlign",float:"float"},o)):e.isImage(d)?("image"===s&&h({align:"textAlign",width:"width",float:"float"},o),t=new i({source:p}),u.styles.width&&u.styles.width>620&&(u.styles.width=620)):e.isHandWrite(d)&&(t=(c=d.getAttribute("data-res-handwrite"))?new a({source:p,resource:c}):new i({source:p})),t&&(t.setStyles(u.styles),u.emit(t)))}},{isAttachment:function(t){var e=t.getAttribute("path"),n=t.dataset.mediaType;return e&&("attachment"===n||!n)},isImage:function(t){var e=t.dataset.mediaType;return!t.getAttribute("path")&&(!e||["image"].indexOf(e)>-1)},isHandWrite:function(t){return"handwrite"===t.dataset.mediaType},isNoteLink:function(t){return"notelink"===t.dataset.mediaType},isTodo:function(t){return"todo"===t.dataset.mediaType},getAttachmentFileName:function(t){return t.getAttribute("filename")||t.getAttribute("alt")||t.getAttribute("title")||""},getAttachmentFileLength:function(t){return t.getAttribute("filelength")||""}})}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(0),o=n(2),i=n(3),r=function(t){var e=document.createElement("CANVAS"),n=e.getContext("2d"),i=null;if(!t)return null;e.height=t.naturalHeight,e.width=t.naturalWidth,n.fillStyle="white",n.fillRect(0,0,e.width,e.height),n.drawImage(t,0,0);try{i=e.toDataURL("image/jpeg",1)}catch(t){o.warn(t.message)}return i};return{getBase64Data:function(t){if(!t)return{};var n,o={data:{}},i=o.data;return e.each(t,function(t){(n=r(t.img))&&(i[t.source]={base64:n})}),o},parseImageJson:function(t){var e=null;if(!t)return null;try{e=JSON.parse(t)}catch(t){return o.error("no imagejson or parse imagejson error"),null}return e},base64ToBlob:function(t){for(var e=t.split(","),n=e[0].match(/:(.*?);/)[1],o=atob(e[1]),i=o.length,r=new Uint8Array(i);i--;)r[i]=o.charCodeAt(i);return new Blob([r],{type:n})},imgToBase64:r,setBlockIds:function(t,n){var o=[];return e.each(t,function(t){if(i.isImage(t)){var e=t.getSource(),r=n[e];r&&r.base64&&(o.push(t),r.imgBlockIds?r.imgBlockIds.push(t.getId()):r.imgBlockIds=[t.getId()])}}),o}}}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";var a,s=this&&this.__extends||(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});o=[n,r,n(0),n(98),n(38),n(3)],void 0===(i=function(t,e,n,o,i,r){return function(t){function e(e){return t.call(this,e)||this}return s(e,t),e.fromXml=function(t){throw new Error("HandWrite do NOT support fromXml till now")},e.fromJSON=function(t){if(!(t&&t.type&&t.type===r.HANDWRITE&&t.source&&t.resource))throw new Error("jsonObj or jsonObj.source/resource does NOT exist!");var n=new e({resource:t.resource,source:t.source});return t.blockId&&n.setId(t.blockId),n},e.prototype.getSource=function(t){var e,n=this.handWriteProps.source;return!0===t&&(e=this.getExtraInfo("pcResMap"))&&e[n]&&(n=e[n]),n},e.prototype.getResource=function(t){var e,n=this.handWriteProps.resource;return!0===t&&(e=this.getExtraInfo("pcResMap"))&&e[n]&&(n=e[n]),n},e.prototype.setStyles=function(){},e.prototype.toHtml=function(t,e,n){var i=o("",document,!0,!0).ownerDocument,r=i.createElement("div"),a=$(r),s=$(i.createElement("img"));return a.attr("yne-bulb-block","handwrite"),s.attr({"data-media-type":"handwrite","data-res-handwrite":this.handWriteProps.resource,src:this.getSource(n)}),a.append(s),r.outerHTML},e.prototype.toJSON=function(){var e=t.prototype.toJSON.call(this);return e.source=this.getSource(!1),e.resource=this.getResource(!1),e},e.prototype.toPlain=function(){return""},e.prototype.toXml=function(){throw new Error("HandWrite do NOT support toXml till now")},e.prototype.initialize=function(e){if(null==e||null==e.source||null==e.resource)throw new Error("props and props.source and props.resource  cannot be null");t.prototype.initialize.apply(this,[e]),this.handWriteProps=n.clone(e),this.type=r.HANDWRITE},e}(i)}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e,o=n(96),i=n(62),r=n(63),a=n(0),s=n(4);return e=o.extend({list:null,level:null,type:null,_itemCounter:null,prevSimilar:null,inheritStyleHandlers:{bold:!0,italic:!0,underline:!0,strike:!0,"font-family":!0,"font-size":!0,color:!0,"back-color":!0,"white-space":!0,align:!0,"line-height":!0,indent:!0,"text-indent":!0},_parseTypeFromElement:function(){return"ul"===this.el.tagName.toLowerCase()?i.UNORDERED:i.ORDERED},_getStartIndexFromElement:function(){var t=this.type,e=this.el,n=-1;return t!==i.ORDERED?n:("list"===e.getAttribute("yne-block-type")&&(n=parseInt(e.getAttribute("start"),10),isNaN(n)&&(n=-1)),n)},increaseItemCounter:function(){var t,e=this.prevSimilar;e&&e.increaseItemCounter?e.increaseItemCounter():(t=this._itemCounter||0,t+=1,this._itemCounter=t)},getItemCounter:function(){var t=this.prevSimilar;return t?t.getItemCounter():this._itemCounter||0},setup:function(){var t,e,n,o=this._findParentListHandler();this.list=null,this.level=1,o&&(this.level=o.level+1),n=this._parseTypeFromElement(),this.type=n,(e=this._getStartIndexFromElement())>1&&(t=this._getPreviousSimilar())&&t.getItemCounter()===e-1&&(this.prevSimilar=t,this.list=t.list),this.list||(this.list=new i({type:n,listId:s.newGUID()}))},capture:function(t){var e=this.level;t instanceof r&&t.getLevel()<e&&t.setLevel(e),this.emit(t)},_findParentListHandler:function(){for(var t=this.parent;t;){if(t instanceof e)return t;t=t.parent}},_getPreviousSimilar:function(){var t,n=this.level,o=this.type,i=this.parent.children;return a.some(i,function(i){if(i instanceof e&&i.level===n&&i.type===o)return t=i,!0}),t}})}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(2);return{appendText:function(t,n,o,i){if(t&&n&&o&&i){var r=t.createElement(o),a=t.createTextNode(i);r.appendChild(a),n.appendChild(r)}else e.warn("unvalid parameters")}}}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";var a,s=this&&this.__extends||(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});o=[n,r,n(0),n(4),n(38),n(3)],void 0===(i=function(t,e,n,o,i,r){return function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.fromJSON=function(){},e.fromXml=function(t){var n=new e({xmlNode:t});return n.parseIdFromXml(t),n},e.prototype.countWords=function(){return 0},e.prototype.setBlockStyle=function(){},e.prototype.setBlockStyles=function(){},e.prototype.getBlockStyles=function(){return null},e.prototype.getBlockStyle=function(){return null},e.prototype.getDefaultBlockStyles=function(){return null},e.prototype.toJSON=function(){return null},e.prototype.toHtml=function(){return""},e.prototype.toPlain=function(){return""},e.prototype.toXml=function(t){var e,r,a=!1;return n.some(this.unknownProps.xmlNode.childNodes,function(t){return t.nodeName===i.TAG_ID_NAME&&(a=!0),a}),a||(e=t.createElement(i.TAG_ID_NAME),r=t.createTextNode(o.newGUID()),e.appendChild(r),this.unknownProps.xmlNode.appendChild(e)),this.unknownProps.xmlNode},e.prototype.initialize=function(e){t.prototype.initialize.call(this,e),this.unknownProps=n.clone(e),this.type=r.UNKNOWN},e}(i)}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";var a,s=this&&this.__extends||(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});o=[n,r,n(52),n(38),n(3)],void 0===(i=function(t,e,n,o,i){return function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.createBlank=function(t){return new e({content:"",isFooter:!0===t})},e.format=function(t,e){return t?(null!=(e=e||{}).pageIndex&&(t=t.replace(/:p/,e.pageIndex+1)),e.pageCount&&(t=t.replace(/:n/,e.pageCount)),t):t},e.fromXml=function(t){var o=$(t),i=o.find(">text").text(),r=new e({align:o.find("styles>align").text(),content:i,isFooter:"footer"===t.nodeName});return o.children().each(function(t,e){switch(e.nodeName){case"text":break;case"styles":$(e).children().each(function(t,o){"align"!==o.nodeName&&n.appendToTree(r.unknownStyles,e)});break;default:n.appendToTree(r.unknownTree,e)}}),r},e.parse=function(t,e){return t.replace(/\d+/,function(t){return parseInt(t,10)===e.pageIndex+1?":p":t}).replace(/\d+/,function(t){return parseInt(t,10)===e.pageCount?":n":t})},e.prototype.getAlign=function(){return this.align},e.prototype.getBlockStyle=function(t){if("align"===t)return this.getAlign()||"center"},e.prototype.getContent=function(t,n){return e.format(this.content,n)},e.prototype.getInfo=function(){return{align:this.getAlign(),content:this.getContent(),isFooter:this.isFooter}},e.prototype.setAlign=function(t){this.align=t},e.prototype.setContent=function(t){this.content=t},e.prototype.setContentAndStyle=function(t,e){null!=t&&(this.content=t),null!=e&&(this.align=e),this.trigger("change",t,e)},e.prototype.toCollabJSON=function(){return{headerFooterInfo:this.getInfo()}},e.prototype.toXml=function(t){var e,o=this.isFooter?"footer":"header",i=t.createElement(o),r=t.createElement("styles"),a=t.createElement("text"),s=t.createTextNode(this.getContent());return a.appendChild(s),i.appendChild(a),(e=t.createElement("align")).appendChild(t.createTextNode(this.getAlign())),r.appendChild(e),n.appendToXml(this.unknownStyles,r),i.appendChild(r),n.appendToXml(this.unknownTree,i),i.setAttribute("compat","true"),i},e.prototype.initialize=function(e){e=e||{isFooter:!1,content:"",align:"center"},t.prototype.initialize.call(this,e),this.type=i.HEADER_FOOTER,this.blockId=e.isFooter?"footer-fixed-id":"header-fixed-id",this.content=e.content||"",this.align=e.align||"center",this.isFooter=!0===e.isFooter,this.unknownTree={},this.unknownStyles={}},e}(o)}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(0);return{getAsArray:function(){return[9,12,14,16,18,22,26,30,36,42]},getAsList:function(){var t=this.getAsArray(),n={};return e.each(t,function(t){n[t]=t}),n},getMin:function(){return this.getAsArray()[0]},getMax:function(){var t=this.getAsArray();return t[t.length-1]}}}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(13),o=n(5),i=n(7),r=n(2),a=n(21),s=n(73),l=n(4),c=e.extend({name:"ManagerAdapter",effected:!0,_block:null,_dataBefore:null,_dataAfter:null,_args:null,initialize:function(t){var e;t.args=t.args||{},this._args=t.args,c.__super__.initialize.apply(this,arguments),l.isCollabCommand(this._args)||(this._block=t.block,this._dataBefore=t.dataBefore,this._dataAfter=t.dataAfter,(e=this._args.range)&&e.clone&&(this.setStartingRange(e),this.setEndingRange(e.clone(!0))))},apply:function(){var t=this._args.collabProperties||{},e=t.coreEditor;e.isCollabEnabled()&&t.isCollabCmd&&(this._block?this._NeedToSetData(e)&&this._block.setInnerData(this._dataAfter):(t.dataCmdError="Table block has been deleted",t.isOwnCmd&&e.notifyErrorToHost(i.INVALIDACTION_BLOCKS_DIRTY,t.coreEditor),this.effected=!1))},doReapply:function(t){var e,n,o=this._block,r=t.collabProperties,a=r.coreEditor;o&&(e=o.getInnerCommandManager()),a.isCollabEnabled()?(r.redoUndoEffected=!0,r.isCollabCmd?o?(o.setInnerData(this._dataAfter),r.isOwnCmd&&e&&(n=e.redoStack.pop())&&e.undoStack.push(n)):(r.dataCmdError="Table block has been deleted",r.isOwnCmd&&r.coreEditor.notifyErrorToHost(i.INVALIDACTION_BLOCKS_DIRTY,a),r.redoUndoEffected=!1):e&&e.redo()):e&&e.redo()},sendInfoToInner:function(t){var e=this._block;e&&e.sendInfoToInner?e.sendInfoToInner(t):r.error("The block or sendInfoToInner() method is not valid!")},doUnapply:function(t){var e,n,o=this._block,r=t.collabProperties||{},a=r.coreEditor;o&&(e=o.getInnerCommandManager()),a.isCollabEnabled()&&r.isCollabCmd?o?(o.setInnerData(this._dataBefore),r.isOwnCmd&&e&&(n=e.undoStack.pop())&&e.redoStack.push(n)):(r.dataCmdError="Table block has been deleted",r.isOwnCmd&&a.notifyErrorToHost(i.INVALIDACTION_BLOCKS_DIRTY,a),r.redoUndoEffected=!1):e&&e.undo()},fromCollabJSON:function(){var t=this._args.collabProperties,e=t.cmdJSON,n=t.coreEditor.getBlockById(e.blockId);this._block=n,this._dataBefore=e.dataBefore,this._dataAfter=e.dataAfter,c.__super__.fromCollabJSON.apply(this)},getBlockId:function(){var t=null;return this._block&&(t=this._block.getId()),t},toCollabJSON:function(){var t,e=this._block.getId();return this.rangeIsRequired=!1,(t=c.__super__.toCollabJSON.apply(this)).blockId=e,t.dataBefore=this._dataBefore,t.dataAfter=this._dataAfter,t},_NeedToSetData:function(t){var e=this._args.collabProperties||{},n=t.getLastNotOwnExecCmd(),o=!0;return e.isOwnCmd&&(n?n.name!==this.name?(r.log(this.name+": lastNotOwnCmd.name is "+n.name),o=!1):this._block.getId()!==this.getBlockId()?(r.log(this.name+": lastNotOwnCmd do NOT operate same table"),o=!1):this.getCmdOriginalNoteVersion()!==n.getCmdOriginalNoteVersion()?(r.log(this.name+": lastNotOwnCmd originalNoteVersion NOT same"),o=!1):r.log(this.name+": Need to set data again to resolve conflict"):(r.log(this.name+": lastNotOwnCmd is null"),o=!1)),o}},{create:function(t,e,n){var o,i,l={};if(t&&t.getInnerCommandManager&&t.setInnerData)return o=new s({block:t}),i=new a({startRange:o,endRange:o}),l.range=i,new c({args:l,block:t,dataBefore:e,dataAfter:n});r.error("The block is not valid: ",t)}});return o.add(c),c}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(26),o=n(7),i=n(4),r=n(2);return e.extend({name:"UnknownCommand",isSimple:!1,cmdError:null,cmdId:null,isCollabRedo:!1,isCollabUndo:!1,rangeIsRequired:null,initialize:function(){var t=this.options.args||{};i.isCollabCommand(t)?this.fromCollabJSON(t.collabProperties.cmdJSON):this.cmdId=i.newGUID()},apply:function(){throw"Method not implemented."},doReapply:function(){throw"Method not implemented."},doUnapply:function(){throw"Method not implemented."},fromCollabJSON:function(){var t=this.options.args.collabProperties.cmdJSON;null!=t.cmdId?this.cmdId=t.cmdId:r.debugAlert("cmdJSON.cmdId should NOT be null")},getCmdId:function(){var t=this.cmdId;return null==t&&r.debugAlert("cmdId should NOT be null"),t},setCollabRedo:function(t){this.isCollabRedo=t},setCollabUndo:function(t){this.isCollabUndo=t},toCollabJSON:function(){var t={};return t[o.CJSON_ACTION]=this.name,t.cmdId=this.getCmdId(),t}})}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e,o=n(0),i=n(22),r=n(5),a=n(73),s=n(4);return e=i.extend({name:"atom.SetTableCellInlineStyle",_table:null,_rect:null,_type:null,effected:!1,_oldStyles:{},_styles:null,initialize:function(){var t=this.options.args;this._oldStyles={},s.isCollabCommand(t)||(this._table=this.options.table,this._styles=this.options.styles,this._rect=this.options.rect,this._type=this.options.type,this._toggle=this.options.toggle),this.type===a.TYPES.ALL&&(this._rect=this._rect||{top:0,left:0,width:this._table.getColumnCount(),height:this._table.getRowCount()}),e.__super__.initialize.apply(this)},apply:function(){var t,e,n,i,r,s=this._table,l=this._rect,c=this._styles||{},u=this._toggle,d=l.top+l.height,p=l.left+l.width;if(!l)return this.effected;if(u){if(i=a.create({block:s,type:a.TYPES.NORMAL,rect:l})){if(!(r=i.getAsRectRange()))return this.effected;t=s.getCommonInlineStyle(u,r)}c[u]=null==t||!t}for(e=l.top;e<d;e++)for(n=l.left;n<p;n++)this._oldStyles[e+"-"+n]=s.getCellInlineStyles({row:e,col:n,names:o.keys(c)}),s.setCellInlineStyles({row:e,col:n,styles:c})&&(this.effected=!0);return this.effected},doUnapply:function(){var t,e,n=this._table,o=this._rect,i=o.top+o.height,r=o.left+o.width;for(t=o.top;t<i;t++)for(e=o.left;e<r;e++)n.setCellInlineStyles({row:t,col:e,styles:this._oldStyles[t+"-"+e]})},fromCollabJSON:function(){var t,n=this.options.args.collabProperties,o=n.cmdJSON;e.__super__.fromCollabJSON.apply(this),t=n.coreEditor.getNote(),o&&(this._table=t.getBlockById(o.blockId),this._styles=o.styleNameValues,this._oldStyles=o.oldStyleNameValues,this._rect=o.simpleValue1,this._type=o.simpleValue2,this._toggle=o.newBlkId)},toCollabJSON:function(){var t=e.__super__.toCollabJSON.apply(this);return t.blockId=this._table.getId(),t.styleNameValues=this._styles||null,t.oldStyleNameValues=this._oldStyles,t.simpleValue1=this._rect,t.simpleValue2=this._type,t.newBlkId=this._toggle||null,t}}),r.add(e),e}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e,o=n(13),i=n(5),r=n(16),a=n(3),s=n(2),l=n(34),c=n(83),u=n(169),d=n(118),p=n(102),h=n(226),f=n(136),g=n(101);return e=o.extend({name:"abstract.comp.DeleteNoteRange",_cmdArgs:null,_note:null,initialize:function(){this._note=this.options.note,this._cmdArgs=this.options.args,e.__super__.initialize.apply(this)},apply:function(){var t,e,n,o,i,c,h=this._cmdArgs.range,f=[];if(!h)return s.error(this.name+":note range should NOT be null"),!1;if(e=(t=h.getStartBlockRange()).block,n=h.getEndBlockRange().block,o=this._note.getNextBlock(n),a.isCode(e))return t.selectWholeBlock||this._cmdArgs.isCodeDelete?(i=r.replaceBlockWithParagraph(this,this._note,e,""),r.setTextBlockAsEndingRange(this,i,0,0)):(h.isCollapsed()?(c=d.createNewRange({preCodeRange:t,charOffset:1}),this.executeAtomicCommand(new u({block:e,startBlockRange:t,endBlockRange:c}))):r.deleteSelectedContent(this,this._note,h),r.setCodeBlockAsEndingRange(this,t,0,0)),!0;if(!h.isCollapsed()&&(r.deleteSelectedContent(this,this._note,h),h.isInSingleBlock()&&a.isTextBlock(e)))return r.setTextBlockAsEndingRange(this,e,t.start,t.start),!0;if(h.isInSingleBlock()){if(a.isTextBlock(e)){if(h.isCollapsed())return t.start===e.getLength()?this._deleteAtTextBlockEnd(o,e):this._deleteAtTextBlockMiddle(e,t.start);r.setTextBlockAsEndingRange(this,e,t.start,t.start)}else o&&!a.isTable(o)?(this.executeAtomicCommand(new l({note:this._note,blocks:[e]})),e=o):e=r.replaceBlockWithParagraph(this,this._note,e,""),a.isTextBlock(e)?r.setTextBlockAsEndingRange(this,e,0,0):r.setNonTextBlockAsEndingRange(this,e);return!0}return h.isInMultiBlock(n)?(a.isTextBlock(e)&&a.isTextBlock(n)?(this.executeAtomicCommand(new p({block:e,start:e.getLength(),text:n.getText()})),f.push(n),r.setTextBlockAsEndingRange(this,e,t.start,t.start)):a.isTextBlock(e)?(f.push(n),r.setTextBlockAsEndingRange(this,e,t.start,t.start)):a.isTextBlock(n)?(f.push(e),r.setTextBlockAsEndingRange(this,n,0,0)):(f.push(e),o?f.push(n):n=r.replaceBlockWithParagraph(this,this._note,n,""),r.setTextBlockAsEndingRange(this,n,0,0)),this.executeAtomicCommand(new l({note:this._note,blocks:f})),!0):void 0},_deleteAtTextBlockEnd:function(t,e){var n;return!(t&&!a.isTable(t))||(a.isAttachment(t)||a.isImage(t)||a.isCode(t)?(this.setEndingRange(g.buildNoteRangeFromNonTextBlock(t)),!0):(n=e.getLength(),a.isTextBlock(t)&&this.executeAtomicCommand(new p({block:e,start:e.getLength(),text:t.getText()})),this.executeAtomicCommand(new l({note:this._note,blocks:[t]})),r.setTextBlockAsEndingRange(this,e,n,n),!0))},_deleteAtTextBlockMiddle:function(t,e){if(f.isAtHrefBorder(t,e,!1))return this._deleteHref(t,e,!1),!0;this.executeAtomicCommand(new c({block:t,start:e,end:e+1})),r.setTextBlockAsEndingRange(this,t,e,e)},_deleteHref:function(t,e){var n;-1!==(n=f.findHrefBorder(t,e,!1))&&this.executeAtomicCommand(new h({blocks:[t],styleNameValues:{href:"",color:"#393939",underline:!1},start:e,end:n+1}))},isSingleBlockAffected:function(){var t,n,o=this._args.range,i=e.__super__.isSingleBlockAffected.apply(this),r=0;return i&&o&&o.isCollapsed()&&(t=(n=o.getStartBlockRange()).block,r=n.start,this._note.getNextBlock(t)&&r===t.getEndOffset()&&(i=!1)),i}}),i.add(e),e}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";var a,s=this&&this.__extends||(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});o=[n,r,n(3),n(64)],void 0===(i=function(t,e,n,o){return function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.prototype.initialize=function(e){t.prototype.initialize.call(this,e),this.type=n.TODO},e}(o)}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e,o=n(22),i=n(5),r=n(133),a=n(4);return e=o.extend({name:"atom.InsertTableRowCol",_table:null,_rect:null,_cellsData:null,_dataLength:null,effected:!1,initialize:function(){var t=this.options,n=t.args;a.isCollabCommand(n)||(this._cellsData=t.cellsData,this._sizes=t.sizes,this._rect=t.rect,this._table=t.table,this._dataLength=this._cellsData.length),e.__super__.initialize.apply(this)},apply:function(){var t=this._rect,e=this._table,n=this._cellsData,o=this._sizes;null!=t.row&&(e.insertRows(t.row,n,o),this.effected=!0),null!=t.col&&(e.insertCols(t.col,n,o),this.effected=!0)},doUnapply:function(){var t=this._rect,e=this._table,n=this._dataLength;null!=t.row&&e.deleteRows(t.row,n),null!=t.col&&e.deleteCols(t.col,n)},fromCollabJSON:function(){var t,n=this.options.args.collabProperties,o=n.cmdJSON;e.__super__.fromCollabJSON.apply(this),t=n.coreEditor.getNote(),o&&(this._table=t.getBlockById(o.blockId),this._cellsData=r.cellsFromCollabJSON(o.dataBefore),this._rect=o.simpleValue1,this._dataLength=o.simpleValue2)},toCollabJSON:function(){var t=e.__super__.toCollabJSON.apply(this);return t.blockId=this._table.getId(),t.dataBefore=r.cellsToCollabJSON(this._cellsData),t.simpleValue1=this._rect,t.simpleValue2=this._dataLength,t}}),i.add(e),e}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e,o,i=n(0),r={ACTION_SHOW_ENABLE:1,ACTION_HIDE:2,ACTION_ENABLE:3,ACTION_DISABLE:4},a={RANGE_DEFAULT:1,RANGE_HEADER_FOOTER:2,RANGE_TABLE_CELL:3,RANGE_CATALOGUE:4,RANGE_IMAGE:5,RANGE_ATTACHMENT:6,RANGE_QUOTE:7,RANGE_CODE:8},s={EDITOR_BUTTON_STATE_MAP:{undo:[{on:a.RANGE_DEFAULT,action:r.ACTION_SHOW_ENABLE},{on:a.RANGE_HEADER_FOOTER,action:r.ACTION_DISABLE}],redo:[{on:a.RANGE_DEFAULT,action:r.ACTION_SHOW_ENABLE},{on:a.RANGE_HEADER_FOOTER,action:r.ACTION_DISABLE}],"remove-format":[{on:a.RANGE_DEFAULT,action:r.ACTION_SHOW_ENABLE},{on:a.RANGE_HEADER_FOOTER,action:r.ACTION_DISABLE},{on:a.RANGE_IMAGE,action:r.ACTION_DISABLE},{on:a.RANGE_ATTACHMENT,action:r.ACTION_DISABLE}],"format-painter":[{on:a.RANGE_DEFAULT,action:r.ACTION_SHOW_ENABLE},{on:a.RANGE_HEADER_FOOTER,action:r.ACTION_DISABLE},{on:a.RANGE_IMAGE,action:r.ACTION_DISABLE},{on:a.RANGE_ATTACHMENT,action:r.ACTION_DISABLE}],"no-table-split":[{on:a.RANGE_DEFAULT,action:r.ACTION_SHOW_ENABLE},{on:a.RANGE_HEADER_FOOTER,action:r.ACTION_DISABLE},{on:a.RANGE_TABLE_CELL,action:r.ACTION_HIDE}],heading:[{on:a.RANGE_DEFAULT,action:r.ACTION_SHOW_ENABLE},{on:a.RANGE_HEADER_FOOTER,action:r.ACTION_DISABLE},{on:a.RANGE_TABLE_CELL,action:r.ACTION_HIDE},{on:a.RANGE_IMAGE,action:r.ACTION_DISABLE},{on:a.RANGE_ATTACHMENT,action:r.ACTION_DISABLE}],"base-split":[{on:a.RANGE_DEFAULT,action:r.ACTION_SHOW_ENABLE},{on:a.RANGE_HEADER_FOOTER,action:r.ACTION_DISABLE}],"font-family":[{on:a.RANGE_DEFAULT,action:r.ACTION_SHOW_ENABLE},{on:a.RANGE_HEADER_FOOTER,action:r.ACTION_DISABLE},{on:a.RANGE_IMAGE,action:r.ACTION_DISABLE},{on:a.RANGE_ATTACHMENT,action:r.ACTION_DISABLE}],"font-size":[{on:a.RANGE_DEFAULT,action:r.ACTION_SHOW_ENABLE},{on:a.RANGE_HEADER_FOOTER,action:r.ACTION_DISABLE},{on:a.RANGE_IMAGE,action:r.ACTION_DISABLE},{on:a.RANGE_ATTACHMENT,action:r.ACTION_DISABLE}],bold:[{on:a.RANGE_DEFAULT,action:r.ACTION_SHOW_ENABLE},{on:a.RANGE_HEADER_FOOTER,action:r.ACTION_DISABLE},{on:a.RANGE_IMAGE,action:r.ACTION_DISABLE},{on:a.RANGE_ATTACHMENT,action:r.ACTION_DISABLE}],italic:[{on:a.RANGE_DEFAULT,action:r.ACTION_SHOW_ENABLE},{on:a.RANGE_HEADER_FOOTER,action:r.ACTION_DISABLE},{on:a.RANGE_IMAGE,action:r.ACTION_DISABLE},{on:a.RANGE_ATTACHMENT,action:r.ACTION_DISABLE}],underline:[{on:a.RANGE_DEFAULT,action:r.ACTION_SHOW_ENABLE},{on:a.RANGE_HEADER_FOOTER,action:r.ACTION_DISABLE},{on:a.RANGE_IMAGE,action:r.ACTION_DISABLE},{on:a.RANGE_ATTACHMENT,action:r.ACTION_DISABLE}],strike:[{on:a.RANGE_DEFAULT,action:r.ACTION_SHOW_ENABLE},{on:a.RANGE_HEADER_FOOTER,action:r.ACTION_DISABLE},{on:a.RANGE_IMAGE,action:r.ACTION_DISABLE},{on:a.RANGE_ATTACHMENT,action:r.ACTION_DISABLE}],color:[{on:a.RANGE_DEFAULT,action:r.ACTION_SHOW_ENABLE},{on:a.RANGE_HEADER_FOOTER,action:r.ACTION_DISABLE},{on:a.RANGE_IMAGE,action:r.ACTION_DISABLE},{on:a.RANGE_ATTACHMENT,action:r.ACTION_DISABLE}],"back-color":[{on:a.RANGE_DEFAULT,action:r.ACTION_SHOW_ENABLE},{on:a.RANGE_HEADER_FOOTER,action:r.ACTION_DISABLE},{on:a.RANGE_IMAGE,action:r.ACTION_DISABLE},{on:a.RANGE_ATTACHMENT,action:r.ACTION_DISABLE}],"unordered-list":[{on:a.RANGE_DEFAULT,action:r.ACTION_SHOW_ENABLE},{on:a.RANGE_HEADER_FOOTER,action:r.ACTION_DISABLE},{on:a.RANGE_TABLE_CELL,action:r.ACTION_HIDE},{on:a.RANGE_CATALOGUE,action:r.ACTION_DISABLE},{on:a.RANGE_IMAGE,action:r.ACTION_DISABLE},{on:a.RANGE_ATTACHMENT,action:r.ACTION_DISABLE}],"ordered-list":[{on:a.RANGE_DEFAULT,action:r.ACTION_SHOW_ENABLE},{on:a.RANGE_HEADER_FOOTER,action:r.ACTION_DISABLE},{on:a.RANGE_TABLE_CELL,action:r.ACTION_HIDE},{on:a.RANGE_CATALOGUE,action:r.ACTION_DISABLE},{on:a.RANGE_IMAGE,action:r.ACTION_DISABLE},{on:a.RANGE_ATTACHMENT,action:r.ACTION_DISABLE}],todo:[{on:a.RANGE_DEFAULT,action:r.ACTION_SHOW_ENABLE},{on:a.RANGE_HEADER_FOOTER,action:r.ACTION_DISABLE},{on:a.RANGE_TABLE_CELL,action:r.ACTION_HIDE},{on:a.RANGE_CATALOGUE,action:r.ACTION_DISABLE},{on:a.RANGE_IMAGE,action:r.ACTION_DISABLE},{on:a.RANGE_ATTACHMENT,action:r.ACTION_DISABLE}],quote:[{on:a.RANGE_DEFAULT,action:r.ACTION_SHOW_ENABLE},{on:a.RANGE_HEADER_FOOTER,action:r.ACTION_DISABLE},{on:a.RANGE_TABLE_CELL,action:r.ACTION_HIDE},{on:a.RANGE_CATALOGUE,action:r.ACTION_DISABLE},{on:a.RANGE_IMAGE,action:r.ACTION_DISABLE},{on:a.RANGE_ATTACHMENT,action:r.ACTION_DISABLE}],align:[{on:a.RANGE_DEFAULT,action:r.ACTION_SHOW_ENABLE},{on:a.RANGE_QUOTE,action:r.ACTION_DISABLE}],"table-justify":[{on:a.RANGE_DEFAULT,action:r.ACTION_HIDE},{on:a.RANGE_TABLE_CELL,action:r.ACTION_SHOW_ENABLE}],indent:[{on:a.RANGE_DEFAULT,action:r.ACTION_SHOW_ENABLE},{on:a.RANGE_HEADER_FOOTER,action:r.ACTION_DISABLE},{on:a.RANGE_TABLE_CELL,action:r.ACTION_HIDE},{on:a.RANGE_IMAGE,action:r.ACTION_DISABLE},{on:a.RANGE_ATTACHMENT,action:r.ACTION_DISABLE},{on:a.RANGE_QUOTE,action:r.ACTION_DISABLE}],outdent:[{on:a.RANGE_DEFAULT,action:r.ACTION_SHOW_ENABLE},{on:a.RANGE_HEADER_FOOTER,action:r.ACTION_DISABLE},{on:a.RANGE_TABLE_CELL,action:r.ACTION_HIDE},{on:a.RANGE_IMAGE,action:r.ACTION_DISABLE},{on:a.RANGE_ATTACHMENT,action:r.ACTION_DISABLE},{on:a.RANGE_QUOTE,action:r.ACTION_DISABLE}],code:[{on:a.RANGE_DEFAULT,action:r.ACTION_SHOW_ENABLE},{on:a.RANGE_HEADER_FOOTER,action:r.ACTION_DISABLE},{on:a.RANGE_TABLE_CELL,action:r.ACTION_HIDE},{on:a.RANGE_CATALOGUE,action:r.ACTION_DISABLE}],"code-theme":[{on:a.RANGE_DEFAULT,action:r.ACTION_HIDE},{on:a.RANGE_CODE,action:r.ACTION_SHOW_ENABLE}],"code-language":[{on:a.RANGE_DEFAULT,action:r.ACTION_HIDE},{on:a.RANGE_CODE,action:r.ACTION_SHOW_ENABLE}],"line-height":[{on:a.RANGE_DEFAULT,action:r.ACTION_SHOW_ENABLE},{on:a.RANGE_HEADER_FOOTER,action:r.ACTION_DISABLE},{on:a.RANGE_TABLE_CELL,action:r.ACTION_HIDE},{on:a.RANGE_IMAGE,action:r.ACTION_DISABLE},{on:a.RANGE_ATTACHMENT,action:r.ACTION_DISABLE}],"table-wrap":[{on:a.RANGE_DEFAULT,action:r.ACTION_HIDE},{on:a.RANGE_TABLE_CELL,action:r.ACTION_SHOW_ENABLE}],"table-operate":[{on:a.RANGE_DEFAULT,action:r.ACTION_HIDE},{on:a.RANGE_TABLE_CELL,action:r.ACTION_SHOW_ENABLE}],"table-split":[{on:a.RANGE_DEFAULT,action:r.ACTION_HIDE},{on:a.RANGE_TABLE_CELL,action:r.ACTION_SHOW_ENABLE}],"table-merge":[{on:a.RANGE_DEFAULT,action:r.ACTION_HIDE},{on:a.RANGE_TABLE_CELL,action:r.ACTION_SHOW_ENABLE}],table:[{on:a.RANGE_DEFAULT,action:r.ACTION_SHOW_ENABLE},{on:a.RANGE_HEADER_FOOTER,action:r.ACTION_DISABLE},{on:a.RANGE_TABLE_CELL,action:r.ACTION_HIDE},{on:a.RANGE_CATALOGUE,action:r.ACTION_DISABLE}],hr:[{on:a.RANGE_DEFAULT,action:r.ACTION_SHOW_ENABLE},{on:a.RANGE_HEADER_FOOTER,action:r.ACTION_DISABLE},{on:a.RANGE_TABLE_CELL,action:r.ACTION_HIDE},{on:a.RANGE_CATALOGUE,action:r.ACTION_DISABLE}],link:[{on:a.RANGE_DEFAULT,action:r.ACTION_SHOW_ENABLE},{on:a.RANGE_HEADER_FOOTER,action:r.ACTION_DISABLE},{on:a.RANGE_CATALOGUE,action:r.ACTION_DISABLE}],img:[{on:a.RANGE_DEFAULT,action:r.ACTION_SHOW_ENABLE},{on:a.RANGE_HEADER_FOOTER,action:r.ACTION_DISABLE},{on:a.RANGE_CATALOGUE,action:r.ACTION_DISABLE}],attachment:[{on:a.RANGE_DEFAULT,action:r.ACTION_SHOW_ENABLE},{on:a.RANGE_HEADER_FOOTER,action:r.ACTION_DISABLE},{on:a.RANGE_CATALOGUE,action:r.ACTION_DISABLE}],catalogue:[{on:a.RANGE_DEFAULT,action:r.ACTION_SHOW_ENABLE},{on:a.RANGE_HEADER_FOOTER,action:r.ACTION_DISABLE},{on:a.RANGE_TABLE_CELL,action:r.ACTION_HIDE},{on:a.RANGE_CATALOGUE,action:r.ACTION_DISABLE}]}},l=["font-family","font-size","table","table-justify","table-wrap","table-operate","table-split","table-merge"];return e=["undo","redo","code","code-language","code-theme"].concat(l),o={on:a.RANGE_CODE,action:r.ACTION_DISABLE},Object.keys(s.EDITOR_BUTTON_STATE_MAP).forEach(function(t){e.indexOf(t)>-1||s.EDITOR_BUTTON_STATE_MAP[t].push(o)}),function(t,e){t.forEach(function(t){s.EDITOR_BUTTON_STATE_MAP[t]&&s.EDITOR_BUTTON_STATE_MAP[t].push(e)})}(l,{on:a.RANGE_CODE,action:r.ACTION_HIDE}),i.extend(s,r,a)}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";var a,s=this&&this.__extends||(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});o=[n,r,n(26)],void 0===(i=function(t,e,n){return function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.createCommandTypeEvent=function(t){return new e({data:t,type:e.EVENT_TYPES.COMMAND})},e.createUserTypeEvent=function(t){return new e({data:t,type:e.EVENT_TYPES.USER})},e.prototype.getType=function(){return this.type},e.prototype.getData=function(){return this.data},e.prototype.isCommandType=function(){return this.type===e.EVENT_TYPES.COMMAND},e.prototype.isUserType=function(){return this.type===e.EVENT_TYPES.USER},e.prototype.initialize=function(t){this.type=t.type,this.data=t.data,delete this.options},e.EVENT_TYPES={COMMAND:1,USER:2},e}(n)}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){return n(305).extend({initialize:function(t){var e=t.event,n=e.originalEvent||e;this._dataTransfer=n.clipboardData}})}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(0),o=n(26),i=n(2),r=n(30).isEdge(),a=n(676),s={"text/html":!0,"text/plain":!0,"text/uri-list":!0,"text/yne-image-json":!1,"text/yne-json":!1,"text/yne-note-id":!1,"text/yne-table-json":!1};return o.extend({initialize:function(t){var e=t.event,n=e.originalEvent||e;this._dataTransfer=n.dataTransfer},_getCustomData:function(t){var e,n;if(!this._altData){e=this._dataTransfer.getData("application/json");try{n=JSON.parse(e),this._altData=n}catch(t){i.error(t),this._altData={}}}return this._altData[t]},getData:function(t){var e,n,o=this._dataTransfer;return r?(!0===(e=s[t])?(n=o.getData(t),i.log("get standard type",t,n)):!1===e?(n=this._getCustomData(t),i.log("get custom type",t,n)):i.error("type should be registered!",t),n):o.getData(t)},setDataMap:function(t){var n,o=this._dataTransfer,l=function(e,n){i.log("set data to data transfer",n,e);try{var r=e;"text/html"===n&&null!=t["text/yne-json"]&&null!=t["text/html"]&&(t["text/html"]=t["text/html"]+"\x3c!--5f39ae17-8c62-4a45-bc43-b32064c9388a:"+a.encode(t["text/yne-json"])+"--\x3e",r=t["text/html"]),o.setData(n,r)}catch(t){i.error(t)}},c={},u=0;if(r){if(e.each(t,function(t,e){var n=s[e];!0===n?l(t,e):!1===n?(i.log("set custom type",e),c[e]=t,u++):i.error("type should be registered!",e)}),u>0)try{n=JSON.stringify(c),l(n,"application/json")}catch(t){i.error(t)}}else e.each(t,l)},clearData:function(t){return this._dataTransfer.clearData(t)},setProperty:function(t,e){this._dataTransfer[t]=e}})}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(){return function(t){var e,n;window.getSelection?(e=window.getSelection()).getRangeAt&&e.rangeCount&&((n=e.getRangeAt(0)).deleteContents(),n.insertNode(document.createTextNode(t))):document.selection&&document.selection.createRange&&(document.selection.createRange().text=t)}}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},,function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(84),o=n(0);return e.extend({name:"no-table-split",isVisible:!1,initialize:function(t){this.editor=t.editor,this.bindEditorEvents(),this.isVisible||this.hide()},editorEvents:{"yne-selection-change":"onSelectionChange"},bindEditorEvents:function(){var t=this,e=t.editor,n=t.editorEvents;n&&o.each(n,function(n,o){e.on(o,t[n].bind(t))})}})}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(757),o=n(0);return e.extend({editorEvents:{"yne-editing-state-change":"onEditingStateChange"},onEditingStateChange:function(t){o.has(t,this.name)&&(this.selectedValue=t[this.name])}})}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";var a,s=this&&this.__extends||(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});o=[n,r,n(3),n(64)],void 0===(i=function(t,e,n,o){return function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.prototype.initialize=function(e){t.prototype.initialize.call(this,e),this.type=n.QUOTE},e}(o)}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(0);return{getFileType:function(t){if(e.isUndefined(t))return null;var n=t.toLowerCase().split(".");return{table:"table",pdf:"pdf",txt:"txt",text:"txt",mht:"html",doc:"word",docx:"word",excel:"excel",xls:"excel",xlsx:"excel",csv:"excel",ppt:"ppt",pps:"ppt",pptx:"ppt",ppsx:"ppt",flash:"flash",swf:"flash",flv:"flash",compress:"compress",zip:"compress",rar:"compress","7z":"compress",audio:"audio",mp3:"music",aac:"music",ogg:"music",wav:"music",flac:"music",m4a:"music",ape:"music",wma:"music",video:"video",rm:"video",rmvb:"video",avi:"video",mkv:"video",mpg:"video",mpeg:"video",wmv:"video",ts:"video",m4v:"video",mp4:"video",image:"image",jpg:"image",jpeg:"image",gif:"image",png:"image",bmp:"image",md:"md",scan:"scan",html:"html",htm:"html"}[n[n.length-1]]||"other"},getSizeString:function(t){var e=0,n=parseInt(t);if(n=n||0,isNaN(n))return"未知大小";if(n<=0)return"";for(;n>=1024&&e<3;)e++,n/=1024;return String(Math.floor(100*n)/100)+["B","KB","MB","GB","TB"][e]},splitFileFullName:function(t){if(e.isUndefined(t))return null;var n,o,i=t.lastIndexOf(".");return i<0?(n=t,o=""):0===i?(n="",o=t):(n=t.substring(0,i-1),o=t.substring(i-1)),{fileName:n,fileType:o}},getFileIconByName:function(t){var e="src--svg--type_other_large",n=this.getFileType(t);return n&&(e="src--svg--type_"+n+"_large"),e}}}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(0),o=n(8);return{isDataUrl:function(t){return/^data:/i.test(t)},isFileUrl:function(t){return/^(file:\/\/)/i.test(t)},isHttpUrl:function(t){return/^http/i.test(t)},has:function(t){return/\?\d+$/.test(String(t))},remove:function(t){return String(t).replace(/\?\d+$/,"")},addIfNeeded:function(t,n){if(t=String(t),t=o.trim(t),this.isHttpUrl(t))return t;if(this.isDataUrl(t))return t;if(this.has(t)){if(!0!==n)return t;t=this.remove(t)}else if(/\?/.test(t))return t;return t+"?"+e.uniqueId()}}}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(0),o=n(66),i=n(19),r=n(8),a=n(43),s=n(2),l=n(50),c=n(314),u=n(803),d=n(804),p=n(73),h=n(21),f=n(99),g=n(805),m=n(826),y=n(827),v=n(6),_=n(828),b=n(223),C=n(32),k=n(51),w=n(3),S=n(81),x=n(205),E=n(134),I=n(74),T=n(10),O=n(55),A=n(121),N=n(12),D=n(304),B=n(117);return n(829),o.extend({className:"block-view table-view",_template:i.getTemplate("common","table_view"),_wrapperElClassName:"table-wrapper",_cellEditClassName:"cell-edit",_cellSelectedClassName:"cell-selected",_layoutElClassName:"table-layout",_layoutInnerElClassName:"table-layout-inner",_rectOnDragStart:null,_oldRangeType:null,_rending:null,_preSelectionRect:null,_isPasteAsText:!1,_OCRHighlightInfos:null,_OCRHighlightItem:null,events:{"mouseenter td":"_onCellMouseEnter","mouseleave td":"_onCellMouseLeave",mousedown:"_onMouseDown",dblclick:"_onDblclick",click:"_onClick","mouseenter a":"_onEnterLink","mouseleave a":"_onLeaveLink"},initialize:function(){o.prototype.initialize.apply(this,arguments),this._draggable=new c({el:this.el,disableDocSelection:!0}),this.bindSelectionEvents(),this._initEvents(),this._OCRHighlightInfos=[],this._OCRHighlightItem=[]},_initEvents:function(){var t=this.block,n=this._draggable,o={};e.bindAll(this,"_onAttributeChanged","_onDragging","_onStyleChange"),l.addListeners({"cell-inline-style-change":"_onCellInlineStyleChange","cell-block-style-change":"_onCellBlockStyleChange","row-height-set":"_onRowHeightSet","col-width-set":"_onColWidthSet","row-inserted":"_onRowInserted","col-inserted":"_onColInserted","row-deleted":"_onRowDeleted","col-deleted":"_onColDeleted","cell-content-change":"_onCellContentChange","content-change":"_reRenderCells","high-light":"onHighlight"},t,this),t.on("attribute-changed",e.throttle(this._onAttributeChanged),100),t.on("style-change",this._onStyleChange),o[c.DRAG_START]="_onDragStart",o[c.DRAG_END]="_onDragEnd",l.addListeners(o,n,this),n.on(c.DRAGGING,e.throttle(this._onDragging,100)),this._triggerResize=e.throttle(this._triggerResize,100)},_removeSubViews:function(){var t=this;e.each(["_cellEditView","_selectionView","_hiddenInputView"],function(e){var n=t[e];n&&(n.destroy?n.destroy():s.error("view has no destroy()",n),t[e]=null)})},_addSubViews:function(){var t,n=this,o=n._keyHandlerManager;n._removeSubViews(),n._cellEditView=g.create({table:n.block,tableView:n,styleRules:n._getStyleRules(),mapper:this._inlineStyleViewMapper}),l.addListeners({"set-cell-content":"_onSetCellContent",blur:"_onCellEditViewBlur","cell-edit-view-exit":"_onCellEditViewExit","cell-edit-view-enter":"_onCellEditViewEnter"},n._cellEditView,n),l.bubble({"cell-edit-view-selection-change":!0,"cell-edit-view-exit":!0,"cell-edit-view-history-change":!0,"cell-edit-view-command-executed":!0},n._cellEditView,n),n.addViewToInner(n._cellEditView),n._selectionView=new d({tableView:n}),n.addViewToInner(n._selectionView),n._cellResizeView=new y({tableView:n}),n.addViewToInner(n._cellResizeView),l.addListeners({"set-row-height":"_onSetRowHeight","set-col-width":"_onSetColWidth","set-cells-size":"_setCellsSize"},n._cellResizeView,n),n._hiddenInputView=m.create({}),o||(o=n._keyHandlerManager=new v({scope:"table-hidden-input"})),o.on("bind-key",function(t){var e=n._hiddenInputView;e&&e.bindKey(t)}),o.on("unbind-key",function(t){var e=n._hiddenInputView;e&&e.unbindKey(t)}),t=o.getAvailableHandlerNames(),e.each(t,function(t){o.bind(t)}),n.addView(n._hiddenInputView),l.addListeners({"key-monitor":"_onKey",copy:"_onCopy",cut:"_onCut",paste:"_onPaste","text-input":"_onTextInput"},n._hiddenInputView,n)},_onSetCellContent:function(t,e){var n=this.block.getCellById(t);n?this.trigger("command","comp.SetTableCellContent",{table:this.block,cellRect:{row:n.row,col:n.col},content:e}):s.error("Not find cell! by id:",t)},_onCellEditViewBlur:function(){},_onCellEditViewExit:function(){this._hiddenInputView.hideBehind()},_onKey:function(t,e){this._keyHandlerManager.execWithKey(t,this,e)},_onCopy:function(t){t.stopPropagation(),t.preventDefault(),this.trigger("copy",t)},_onCut:function(t){var e=this._getNoteRange();t.stopPropagation(),t.preventDefault(),this.trigger("cut",t),e.isSingleTableSelected()&&this._clearSelectCells()},_pasteBlobImg:function(t){var e,n,o,i=this;e=t.originalEvent.clipboardData.items,o=i._getRectOfNoteRange(),e&&1===e.length&&0===e[0].type.indexOf("image")&&o&&(n=e[0].getAsFile(),i.trigger("yne-blob-paste",{isImg:!0,data:n},function(t){t&&t.source&&i.trigger("command","comp.SetTableCellContent",{table:i.block,cellRect:{row:o.top,col:o.left},content:B.create({source:t.source})})}))},_onPaste:function(t){t.stopPropagation(),t.preventDefault();var e,n,o,i,r,a,s,l=this._isPasteAsText;T.IS_PC?this.trigger("yne-on-paste",l,t):(e=new D({event:t}),l?(r=e.getData("text/plain"))&&this._pastePlain(r):(n=e.getData("text/yne-json"))&&this._pasteJSON(n)||(o=e.getData("text/yne-table-json"))&&this._pasteYTableJson(o)||(i=e.getData("text/html"))&&this._pasteHTML(i)||(s=(a=this.noteView.options.editor)&&a.callMacNativeApi("macClipboardData",["image"]))&&this._pasteImages(s)||(r=e.getData("text/plain"))&&this._pastePlain(r)||this._pasteBlobImg(t))},_pasteHTML:function(t){var e=x.parseHtml(t);return this.pasteBlockList(e)},_pasteJSON:function(t){var e=x.parseJSON(t);return this.pasteBlockList(e)},_pasteYTableJson:function(t){if(e.isString(t))try{t=window.JSON.parse(t)}catch(t){return void s.error("parse ytable json  string error")}return this._pasteJSON([{blockType:w.TABLE,data:t}])},_pasteImages:function(t){var e,n=[];t=JSON.parse(t);for(var o=0;o<t.length;o++)(e=t[o])&&n.push(new S({source:e,title:""}));return this.pasteBlockList(n)},_pastePlain:function(t){var e=x.parsePlain(t);return this.pasteBlockList(e)},pasteBlockList:function(t){var e=this.block,n=[],o=[];return!(!t||!t.length)&&(1===t.length&&w.isTable(t[0])?(this.trigger("command","comp.InsertTableCells",{table:e,widths:t[0].colWidths,heights:t[0].rowHeights,cellsData:t[0].tableCells}),!0):(t.forEach(function(t){var e=E.blockToCell(t);e&&n.push(e)}),n.length>0?(n.forEach(function(t){o.push([t])}),this.trigger("command","comp.InsertTableCells",{table:e,cellsData:o}),!0):void 0))},deleteTable:function(){this.trigger("command","comp.DeleteNoteRange",{isTableDelete:!0})},isSelectAllRect:function(){var t=this._getRectRange().getRect(),e=this.block;return t.width*t.height==e.getColumnCount()*e.getRowCount()},_clearSelectCells:function(){var t=this.block;t.isEmptyContent()&&this.isSelectAllRect()?this.deleteTable():this.trigger("command","comp.InsertTableCells",{table:t})},_onTextInput:function(t){var e,n,o,i,r=this._getRectOfNoteRange();r?this.isLocked()||(e=this.block.getCell(r.top,r.left,{findMergePointIfNeeded:!0,withPosition:!0}))&&((n=e.cell)&&n.isEmpty()?(o=n.getStylesForEmpty(),(i=N.create(t,!1)).setStyles(0,i.getLength(),o)):i=N.create(t,!1),this._cellEditView.showAndEdit({row:e.row,col:e.col,content:i})):s.warn("Failed to show cellEditView",r)},moveWithDirection:function(t,e){var n,o=this.block,i=this._getRectOfNoteRange(),r=1,a=1;if(i){if(o.isMergePoint(i.top,i.left)&&(a=(n=o.getMergePointAttrAt(i.top,i.left)).height,r=n.width),t===I.UP){if(i.top-a<0)return this.trigger("move-caret",!1,e);this._setRange({top:i.top-a,left:i.left,width:1,height:1})}if(t===I.DOWN){if(i.top+a+i.height>o.getRowCount())return this.trigger("move-caret",!0,e);this._setRange({top:i.top+a,left:i.left,width:1,height:1})}if(t===I.LEFT)if(i.left-r<0){if(i.top-a<0)return this.trigger("move-caret",!1,e);this._setRange({top:i.top-a,left:o.getColumnCount()-1,width:1,height:1})}else this._setRange({top:i.top,left:i.left-r,width:1,height:1});if(t===I.RIGHT)if(i.left+r>o.getColumnCount()-1){if(o.isMergePoint(i.top,i.left)&&this._preSelectionRect&&o.getRowCount()-1===this._preSelectionRect.left&&this._preSelectionRect.top++,this._preSelectionRect&&this._preSelectionRect.top+1<o.getRowCount())return this._setRange({top:this._preSelectionRect.top+1,left:0,width:1,height:1});if(i.top+a+i.height>o.getRowCount())return this.trigger("move-caret",!0,e);this._setRange({top:i.top+a,left:0,width:1,height:1})}else o.isMergePoint(i.top,i.left)&&this._preSelectionRect?(o.getRowCount()-1===this._preSelectionRect.left&&this._preSelectionRect.top++,this._setRange({top:this._preSelectionRect.top,left:i.left+r,width:1,height:1})):this._setRange({top:i.top,left:i.left+r,width:1,height:1})}},toggleInlineStyle:function(t){this.trigger("command","comp.SetTableCellInlineStyle",{toggle:t})},clearSelectedCells:function(){this._clearSelectCells()},enterEditMode:function(){},selectAll:function(t){t&&this.trigger("select-all")},render:function(){var t=this.el;this._rending=!0,this._removeSubViews(),this._renderTemplate(),this.colgroupEl=t.querySelector("colgroup"),this.wrapperEl=t.querySelector("."+this._wrapperElClassName),this.tableEl=t.querySelector("table"),this._tableLayoutEl=t.querySelector("."+this._layoutElClassName),this._tableLayoutInnerEl=t.querySelector("."+this._layoutInnerElClassName),this._setTableStyles(),this._renderCells(),this._addSubViews(),o.prototype.render.apply(this,arguments),this._rending=!1,this._triggerResize()},addView:function(t){this._tableLayoutEl.appendChild(t.el),t.render()},addViewToInner:function(t){this._tableLayoutInnerEl.appendChild(t.el),t.render()},_renderTemplate:function(){this.$el.html(this._template())},_renderCells:function(){var t,e,n,o,i,a=this.block,l=this.tableEl,c=a.getRowCount(),u=a.getColumnCount(),d=l.querySelector("tbody"),p=[];for(r(d).hide(),o=0;o<c;o++){for(t=d.insertRow(o),i=0;i<u;i++)(e=a.getCell(o,i))||s.error("No find cell! row, col, block",o,i,a),e.isMergedCell()||(e.isAttachmentCell()&&p.push({row:o,col:i}),t.appendChild(this._renderCell(o,i)));n=a.getRowHeight(o),t.style.height=n?n+"px":""}r(d).show(),this._renderColumns(this.colgroupEl.querySelectorAll("col").length,u)},_loadCellImg:function(t,e){var n=this,o=t.querySelector("img");o&&r(o).load(function(){n._triggerResize(),e&&n._redrawRange()})},_createHighlightMark:function(){var t=this;t._clearHighlightMark(),e.each(t._OCRHighlightInfos,function(n){var o=r(t.getCellImageEl(n.cellId));if(null!=o&&0!==o.length){var a=o.position(),l=o.width()/n.width;e.each(n.pos,function(e){var n=r(i.render("common","high_light_item",{top:a.top+e.top*l-1,left:a.left+e.left*l-2,height:(e.bottom-e.top)*l,width:(e.right-e.left)*l}));n.appendTo(t.wrapperEl),t._OCRHighlightItem.push(n)})}else s.error("Failed to get TableCell by ID:",o)})},clearHighlight:function(){this._OCRHighlightInfos=[],this._clearHighlightMark()},_clearHighlightMark:function(){e.each(this._OCRHighlightItem,function(t){t.remove()}),this._OCRHighlightItem=[]},_replaceBlankToSymbol:function(t){var n=function(t){!t||t.length<1||e.forEach(t,function(t){t.children&&t.children.length>0&&n(t.children),t.childNodes[0]&&3===t.childNodes[0].nodeType&&(t.innerHTML=t.innerHTML.replace(/ /g,"&nbsp;"))})};t&&n(t.children)},_renderCell:function(t,e,n){var o,i,r,a,s,l=this.block,c=l.getCell(t,e,{findMergePointIfNeeded:!0,withPosition:!0});if(c){switch(o=c.cell,i=n||document.createElement("td"),r=o.getContent(),a=o.getType(),i.setAttribute("data-cell-id",o.getCellId()),this._setMergeCell(i,o),this._setCellStyles(i,o.getBlockStyles()),this._setBorder(i,t,e,o.getBlockStyles()),a){case f.TEXT:s=r.toHtml({styleRules:this._getStyleRules()});break;case f.IMAGE:s=_.renderImage(r,l.getExtraInfo("pcResMap"));break;case f.ATTACHMENT:s=_.renderAttachment(r)}return i.innerHTML=s,this._loadCellImg(i,n),n&&this._triggerResize(),i}},_getStyleRules:function(){var t=this._inlineStyleViewMapper;return{color:function(e){var n=e.color;return e.href!==C.getDefault("href")&&a.equals(e.color,"blue")?"#003884":null!=n&&t?t.valueToView("color",n):void 0},"font-family":function(e){var n,o=e["font-family"];return null!=o&&t&&(n=t.valueToView("font-family",o)),o!==n?n:k.getAllValueByFont(o)||o}}},_setMergeCell:function(t,e){if(e.isMergePoint()){var n=e.getMergePointAttr();n.width>0&&t.setAttribute("colspan",n.width),n.height>0&&t.setAttribute("rowspan",n.height)}},_reRenderCells:function(){var t=this.tableEl.querySelector("tbody");this._rending=!0,t.innerHTML="",this.colgroupEl.innerHTML="",this._renderCells(),this._rending=!1,this._triggerResize(),this._redrawRange()},_redrawRange:function(){var t=this._getRectOfNoteRange();this._setRange(t)},_onDownloadClick:function(t){var e,n,o,i=this.getCellElementByTarget(t.target),a=this.block;i&&(e=r(i).data("cellId"),(o=a.getCellById(e).cell)&&(n=o.getContent(),this.trigger("yne-download-attachment",n.getResource(),n.getFileName())))},_onClick:function(t){-1!==t.target.className.indexOf("attachment-download")&&this._onDownloadClick(t)},_onEnterLink:function(t){var e,n,o=r(t.target).closest("a").get(0),i=this.getCellElementByTarget(t.target),a=o.parentNode;e=r(i).data("cellId"),n=this.block.getCellById(e),!this.isOnCellEdit()&&n&&(a.innerText||"").trim()===(o.innerText||"").trim()&&(A.isNoteLinkUrl(o.href)||this.isCollabLocked()||!o||("file://"===o.origin&&r(o).click(function(){return!1}),this.trigger("link-menu-show",{linkNode:o,block:this.block,range:p.create({block:this.block,type:p.TYPES.NORMAL,rect:{width:1,height:1,left:n.col,top:n.row}})})))},_onLeaveLink:function(){this.trigger("link-menu-hide")},_onMouseDown:function(t){this.getCellElementByTarget(t)?this._handleDrag(t,c.DRAG_START,!0):this._setRange(p.TYPES.BLANK)},_onDblclick:function(){var t,e=this._getRectOfNoteRange();e&&!this.isLocked()&&(t=this.block.getCell(e.top,e.left,{findMergePointIfNeeded:!0,withPosition:!0}),this._cellEditView.showAndEdit(t))},_getTableRange:function(){var t,e=this._getNoteRange();if(e&&e.isInSingleBlock&&e.isInSingleBlock()&&(t=e.getStartBlockRange())&&t instanceof p&&t.block===this.block)return t},_getRectRange:function(){var t=this._getTableRange();if(t)return t.getAsRectRange()},_getRectOfNoteRange:function(){var t=this._getRectRange();return t&&t.getRect?t.getRect():null},_getNoteRange:function(){var t;return this.trigger("get-note-range",function(e){t=e}),t},_onDragStart:function(t){this._rectOnDragStart=null,this._handleDrag(t,c.DRAG_START)},_handleDrag:function(t,e,n){var o,i,a,l,u,d=this.getCellElementByTarget(t.target),p=t.shiftKey&&!t.ctrlKey&&!t.metaKey;if(o=r(d).data("cellId"),i=this.block.getCellById(o)){switch(this._preSelectionRect=null,l={width:1,height:1,left:i.col,top:i.row},e){case c.DRAG_START:if(p)u=this._getRectOfNoteRange(),this._rectOnDragStart=u,a=b.union(this._rectOnDragStart,l);else{if(n&&(u=this._getRectOfNoteRange(),b.contains(u,l)))return;a=this._rectOnDragStart=l}break;case c.DRAGGING:case c.DRAG_END:a=b.union(this._rectOnDragStart,l);break;default:s.error("unvalid drag type",e)}a&&this._setRange(a)}},_setRange:function(t){var e,n,o,i=p.TYPES.NORMAL;if(t)return t.width?o=t:i=t,e=p.create({block:this.block,type:i||p.TYPES.FIRST_CELL,rect:o}),n=new h({startRange:e,endRange:e}),this.trigger("set-range",n,!0,!0,!0),this._preSelectionRect=o,e},_onDragging:function(t){this._handleDrag(t,c.DRAGGING)},_onDragEnd:function(){this._handleDrag(event,c.DRAG_END),this._rectOnDragStart=null},_cancelEditMode:function(){s.log("hide cellEditView"),this._cellEditView.hide()},_setCellStyles:function(t,e){var n;n=e.textAlign,t.style.textAlign="center"===n||"right"===n||"left"===n?n:"",n=e.verticalAlign,t.style.verticalAlign="top"===n||"middle"===n||"bottom"===n?n:"",n=e.wrap,t.style.whiteSpace=!1===n||"false"===n?"nowrap":"pre-wrap",n=e.backColor,t.style.backgroundColor=n&&"inherit"!==n&&"transparent"!==n?n:""},_setBorder:function(t,e,n,o){var i,r=this.tableEl.querySelector("tbody"),a=o["border|vertical"],s=o["border|horizontal"];0===e?(i=t)&&(i.style.borderTop=s):(i=r.rows[e-1].cells[n])&&(i.style.borderBottom=s),0===n?(i=t)&&(i.style.borderLeft=a):(i=r.rows[e].cells[n-1])&&(i.style.borderRight=a)},_setRowHeight:function(t,e){var n=this._getRowElAt(t);n&&(n.style.height=e+"px",this._triggerResize())},_getRowElAt:function(t){var e=this.tableEl.tBodies[0];if(e)return e.rows[t]},getRowElHeight:function(t){var e=this._getRowElAt(t),n=0;return e?n=e.getBoundingClientRect().height:n},_renderColumns:function(t,n){if(!((t=t||0)>=n)){var o,i=this.block,r=i.getColumnCount(),a=this.colgroupEl,s=e.toArray(a.querySelectorAll("col"));for(n=n||r,o=t;o<n;++o)this._setColumnWidth(o,i.getColumnWidth(o));for(o=s.length-1;o>=r;--o)u(s[o])}},_setColumnWidth:function(t,e){var n=this._ensureColEl(t);n&&(n.style.width=e+"px",this._triggerResize())},_ensureColEl:function(t){var e,n=this._getColumnCount(),o=Math.max(t+1,n),i=this.colgroupEl,r=o-i.querySelectorAll("col").length,a=this._getColElAt(t);if(a)return a;for(e=0;e<r;++e)i.appendChild(document.createElement("col"));return this._getColElAt(t)},_getColumnCount:function(){var t=this.tableEl.rows[0];return t?t.cells.length:this.block.getColumnCount()},_getColElAt:function(t){if(!(t<0)){return this.colgroupEl.querySelectorAll("col")[t]}},getColElWidth:function(t){var e=this._getColElAt(t);return e?parseFloat(e.style.width):0},getCellElement:function(t){if(t&&t.getCellId&&(t=t.getCellId()),t)return this.$el.find('[data-cell-id="'+t+'"]:first').get(0)},getCellElementAt:function(t,e){var n=this.block.getCell(t,e,{findMergePointIfNeeded:!0});return this.getCellElement(n)},getCellTextElementAt:function(t,e){return this.getCellElementAt(t,e).querySelector(".table-cell-line > span")},getColumnIndex:function(t){var e=r(t).data("cellId"),n=this.block.getCellById(e);return n&&null!=n.col?n.col:null},getCellElementByTarget:function(t){if(t&&t.target&&(t=t.target),t)return r(t).closest("td").get(0)},getAbsoluteBoundingRectAt:function(t,e){var n=this.getBoundingRectAt(t,e),o=this._tableLayoutInnerEl.scrollLeft;if(n)return n.left-=o,n},getBoundingRectAt:function(t,e){var n=this.getCellElementAt(t,e);return this.getBoundingRect(n)},getBoundingRectByCell:function(t){var e=this.getCellElement(t);return this.getBoundingRect(e)},_triggerResize:function(){if(!this._rending){this._createHighlightMark()}},getBoundingRect:function(t){if(t){var e=this.wrapperEl.getBoundingClientRect(),n=this._tableLayoutInnerEl.scrollLeft,o=t.getBoundingClientRect();return{left:o.left-e.left-n,top:o.top-e.top,right:o.right-e.left-n,bottom:o.bottom-e.top,width:o.width,height:o.height}}},getEventBoundingRect:function(t){if(t){var e=this.wrapperEl.getBoundingClientRect();return{left:t.clientX-e.left,top:t.clientY-e.top}}},_onSetRowHeight:function(t,e){this._setCellsSize([{row:t,height:e}])},_onSetColWidth:function(t,e){this._setCellsSize([{col:t,width:e}])},_setCellsSize:function(t){this.trigger("command","comp.SetTableCellsSize",{table:this.block,sizes:t})},_onAttributeChanged:function(){this._reRenderCells()},_onRowHeightSet:function(t,e){this._setRowHeight(t,e)},_onColWidthSet:function(t,e){this._setColumnWidth(t,e)},_ensureRow:function(t){s.log("ensure the row has rendered",t)},_onColInserted:function(){this._reRenderCells()},_onColDeleted:function(){this._reRenderCells()},_onRowInserted:function(){this._reRenderCells()},_onRowDeleted:function(){this._reRenderCells()},_onCellInlineStyleChange:function(t,e){var n=this.getCellElementAt(t,e);this._renderCell(t,e,n)},_onCellBlockStyleChange:function(t,e,n,o){var i=this.getCellElementAt(t,e);i&&this._setCellStyles(i,o)},_onCellMouseEnter:function(t){this.trigger("cell-enter",t,this)},_onCellMouseLeave:function(t){this.trigger("cell-leave",t,this)},_onCellContentChange:function(t){var e,n=this.block.getCellById(t);n?(this._ensureRow(n.row),(e=this.getCellElement(t))?(this._renderCell(n.row,n.col,e),this._triggerResize()):this._reRenderCells()):s.error("unvalid cell info",n)},getHiddenInputView:function(){return this._hiddenInputView},getCellEditView:function(){return this._cellEditView},focusOutTbody:function(){this._setRange(p.TYPES.BLANK)},_setTableStyles:function(){var t=this,n=t.block.getBlockStyles();e.each(n,function(e,n){t._setTableStyle(n,e)})},_setTableStyle:function(t,e){var n=this.$el;switch(t){case"back-color":n.css("background-color",e);break;case"padding":e?n.css({padding:e,"padding-bottom":"5px","padding-top":"5px"}):n.css({padding:e,"padding-bottom":"","padding-top":""})}},_onStyleChange:function(t,e){this._setTableStyle(t,e)},getCellImageEl:function(t){var e=this.getCellElement(t);if(e)return e.querySelector("img")},getImageDomMapByTableRange:function(t){var e,n=t.tableRange,o=t.selectAll,i=this,r=i.block,a={};if(o&&(n=p.create({type:p.TYPES.ALL,block:r})),n&&(e=n.getAsRectRange()))return e.forEachCell(function(t){var e,n,o=t.getCellId();t.isImageCell()&&(e=i.getCellImageEl(o))&&(n=t.getContent(),a[r.getId()+"-"+n.getResId()]||(a[r.getId()+"-"+n.getResId()]={img:e,source:n.getSource()}))}),a},isLocked:function(){var t;return this._rending||this.trigger("get-read-only-status",function(e){t=e}),this.block.isLocked()||this.block.isReadOnly()||this._isReadOnly||t},selectTable:function(t){if(!this._selectionView)return s.error("No selectionView find!");if(t){if(this._getRectOfNoteRange())return;this._selectionView.draw(p.create({block:this.block,type:p.TYPES.ALL}))}else this._selectionView.draw()},onDrawRange:function(t){var e,n;if(!this._selectionView)return s.error("No selectionView find!");if(t&&!t.isInBlank()){if(this._selectionView.draw(t),!(e=t.getAsRectRange()))return;n=e.getRect(),this._hiddenInputView.focus(this.getAbsoluteBoundingRectAt(n.top,n.left))}else this._selectionView.draw()},convertToNativeRange:function(){var t=document.createRange(),e=this.$el.get(0);return t.setStart(e,0),t.setEnd(e,e.childNodes.length),t},parseNativeRange:function(t,e,n){var o,i,a,s,l,c=this.block,u=t.startContainer,d=t.endContainer;return t.collapsed||(i=this.getCellElementByTarget(d))&&(s=c.getCellById(r(i).data("cellId"))),(o=this.getCellElementByTarget(u))&&(a=c.getCellById(r(o).data("cellId"))),a?this._setRange({top:a.row,left:a.col,height:s?s.row-a.row:1,width:s?s.col-a.col:1}):n||O.isNodeInRange(this.wrapperEl,t)||O.isRangeInNode(this.el,t)?(l=new p({block:c,type:p.TYPES.ALL}),this._selectionView.draw(l),l):void 0},onHighlight:function(t,n,o){var i,r,a,s,l,c=this,u=c.block,d=u.getRowCount(),p=u.getColumnCount();function h(t){for(var e,i=t.getLength(),r=n.ignoreCase?t.toString().toLowerCase():t.toString(),a=s.indexOf(r,0);-1!==a;)(e=document.createRange()).setStart(l,a),e.setEnd(l,a+i),o(e),a=s.indexOf(r,a+i)}function f(o){s=o.textContent,s=n.ignoreCase?s.toLowerCase():s,l=o,e.each(t,h)}for(c._OCRHighlightInfos=[],r=0;r<d;r++)for(a=0;a<p;a++)if(!u.isMergedCell(r,a))if((i=u.getCell(r,a)).isImageCell())null!=n.images&&e.each(n.images,function(t){t.resID===i.getContent().getResId()&&(t.cellId=i.getCellId(),c._OCRHighlightInfos.push(t))});else{if(l=c.getCellTextElementAt(r,a),!i.isTextNoEmptyCell()||!l)continue;e.map(l.childNodes,f)}c._createHighlightMark()},editCellFromToolbar:function(t,e){return this._cellEditView.editFromToolbar(t,e)},isOnCellEdit:function(){var t=this._cellEditView,e=this._hiddenInputView;return t&&t.isOnEdit()||e&&e.isOnEdit()},_onCellEditViewEnter:function(t){t&&(t.blockId=this.block.getId()),this.trigger("cell-edit-view-enter",t)},setPasteAsText:function(t){this._isPasteAsText=t||!1}},{isRangeInCellEditArea:function(t){return g.isRangeIn(t)||m.isRangeIn(t)}})}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e,o=n(27),i=n(0);return e=o.extend({initialize:function(t){i.bindAll(this,"onMouseDown","onMouseMove","onMouseUp"),this.el=t.el,this.disableDocSelection=!0===t.disableDocSelection,this.document=this.el.ownerDocument,this._makeDraggable()},_makeDraggable:function(){var t=this.el;t.addEventListener("mousedown",this.onMouseDown),this._setUserSelect(t,"none")},_getUserSelect:function(t){return t.style.webkitUserSelect||t.style.mozUserSelect||t.style.msUserSelect||t.style.userSelect||""},_setUserSelect:function(t,e){t.style.webkitUserSelect=e,t.style.mozUserSelect=e,t.style.msUserSelect=e,t.style.userSelect=e},onMouseDown:function(t){if(1===t.which){var n=this.el,o=this.document;n.setCapture&&n.setCapture(),o.addEventListener("mousemove",this.onMouseMove),o.addEventListener("mouseup",this.onMouseUp),this.disableDocSelection&&(this._backupDocUserSelect=this._getUserSelect(o.body),this._setUserSelect(o.body,"none")),this.trigger(e.DRAG_START,t)}},onMouseMove:function(t){1===t.which&&this.trigger(e.DRAGGING,t)},cancel:function(){var t=this.el,e=this.document;t.releaseCapture&&t.releaseCapture(),e.removeEventListener("mousemove",this.onMouseMove),e.removeEventListener("mouseup",this.onMouseUp),this.disableDocSelection&&this._setUserSelect(e.body,this._backupDocUserSelect)},onMouseUp:function(t){1===t.which&&(this.cancel(),this.trigger(e.DRAG_END,t))}},{DRAG_START:"drag-start",DRAGGING:"dragging",DRAG_END:"drag-end"})}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e={bold:"bold",italic:"italic",strike:"strikeThrough",underline:"underline"};return{TOGGLE_INLINE_STYLES_CMD_MAP:e,INLINE_STYLES_CMD_MAP:n(0).extend({"back-color":"backColor",color:"foreColor","font-family":"fontName","font-size":"fontSize"},e)}}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){n(317),t.exports=n(519)},function(t,e,n){"use strict";(function(t){if(n(318),n(515),n(516),t._babelPolyfill)throw new Error("only one instance of babel-polyfill is allowed");t._babelPolyfill=!0;var e="defineProperty";function o(t,n,o){t[n]||Object[e](t,n,{writable:!0,configurable:!0,value:o})}o(String.prototype,"padLeft","".padStart),o(String.prototype,"padRight","".padEnd),"pop,reverse,shift,keys,values,entries,indexOf,every,some,forEach,map,filter,find,findIndex,includes,join,slice,concat,push,splice,unshift,sort,lastIndexOf,reduce,reduceRight,copyWithin,fill".split(",").forEach(function(t){[][t]&&o(Array,t,Function.call.bind([][t]))})}).call(this,n(67))},function(t,e,n){n(319),n(322),n(323),n(324),n(325),n(326),n(327),n(328),n(329),n(330),n(331),n(332),n(333),n(334),n(335),n(336),n(337),n(338),n(339),n(340),n(341),n(342),n(343),n(344),n(345),n(346),n(347),n(348),n(349),n(350),n(351),n(352),n(353),n(354),n(355),n(356),n(357),n(358),n(359),n(360),n(361),n(362),n(363),n(364),n(365),n(366),n(367),n(368),n(369),n(370),n(371),n(372),n(373),n(374),n(375),n(376),n(377),n(378),n(379),n(380),n(381),n(382),n(383),n(384),n(385),n(386),n(387),n(388),n(389),n(390),n(391),n(392),n(393),n(394),n(395),n(396),n(397),n(399),n(400),n(402),n(403),n(404),n(405),n(406),n(407),n(408),n(410),n(411),n(412),n(413),n(414),n(415),n(416),n(417),n(418),n(419),n(420),n(421),n(422),n(197),n(423),n(253),n(424),n(254),n(425),n(426),n(427),n(428),n(429),n(257),n(259),n(260),n(430),n(431),n(432),n(433),n(434),n(435),n(436),n(437),n(438),n(439),n(440),n(441),n(442),n(443),n(444),n(445),n(446),n(447),n(448),n(449),n(450),n(451),n(452),n(453),n(454),n(455),n(456),n(457),n(458),n(459),n(460),n(461),n(462),n(463),n(464),n(465),n(466),n(467),n(468),n(469),n(470),n(471),n(472),n(473),n(474),n(475),n(476),n(477),n(478),n(479),n(480),n(481),n(482),n(483),n(484),n(485),n(486),n(487),n(488),n(489),n(490),n(491),n(492),n(493),n(494),n(495),n(496),n(497),n(498),n(499),n(500),n(501),n(502),n(503),n(504),n(505),n(506),n(507),n(508),n(509),n(510),n(511),n(512),n(513),n(514),t.exports=n(45)},function(t,e,n){"use strict";var o=n(11),i=n(39),r=n(23),a=n(1),s=n(36),l=n(77).KEY,c=n(14),u=n(123),d=n(105),p=n(86),h=n(17),f=n(235),g=n(178),m=n(321),y=n(143),v=n(9),_=n(15),b=n(40),C=n(57),k=n(85),w=n(89),S=n(238),x=n(41),E=n(24),I=n(87),T=x.f,O=E.f,A=S.f,N=o.Symbol,D=o.JSON,B=D&&D.stringify,R=h("_hidden"),L=h("toPrimitive"),P={}.propertyIsEnumerable,M=u("symbol-registry"),F=u("symbols"),H=u("op-symbols"),j=Object.prototype,V="function"==typeof N,U=o.QObject,z=!U||!U.prototype||!U.prototype.findChild,G=r&&c(function(){return 7!=w(O({},"a",{get:function(){return O(this,"a",{value:7}).a}})).a})?function(t,e,n){var o=T(j,e);o&&delete j[e],O(t,e,n),o&&t!==j&&O(j,e,o)}:O,J=function(t){var e=F[t]=w(N.prototype);return e._k=t,e},W=V&&"symbol"==typeof N.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof N},$=function(t,e,n){return t===j&&$(H,e,n),v(t),e=C(e,!0),v(n),i(F,e)?(n.enumerable?(i(t,R)&&t[R][e]&&(t[R][e]=!1),n=w(n,{enumerable:k(0,!1)})):(i(t,R)||O(t,R,k(1,{})),t[R][e]=!0),G(t,e,n)):O(t,e,n)},K=function(t,e){v(t);for(var n,o=m(e=b(e)),i=0,r=o.length;r>i;)$(t,n=o[i++],e[n]);return t},Y=function(t){var e=P.call(this,t=C(t,!0));return!(this===j&&i(F,t)&&!i(H,t))&&(!(e||!i(this,t)||!i(F,t)||i(this,R)&&this[R][t])||e)},X=function(t,e){if(t=b(t),e=C(e,!0),t!==j||!i(F,e)||i(H,e)){var n=T(t,e);return!n||!i(F,e)||i(t,R)&&t[R][e]||(n.enumerable=!0),n}},q=function(t){for(var e,n=A(b(t)),o=[],r=0;n.length>r;)i(F,e=n[r++])||e==R||e==l||o.push(e);return o},Q=function(t){for(var e,n=t===j,o=A(n?H:b(t)),r=[],a=0;o.length>a;)!i(F,e=o[a++])||n&&!i(j,e)||r.push(F[e]);return r};V||(s((N=function(){if(this instanceof N)throw TypeError("Symbol is not a constructor!");var t=p(arguments.length>0?arguments[0]:void 0),e=function(n){this===j&&e.call(H,n),i(this,R)&&i(this[R],t)&&(this[R][t]=!1),G(this,t,k(1,n))};return r&&z&&G(j,t,{configurable:!0,set:e}),J(t)}).prototype,"toString",function(){return this._k}),x.f=X,E.f=$,n(90).f=S.f=q,n(125).f=Y,n(142).f=Q,r&&!n(76)&&s(j,"propertyIsEnumerable",Y,!0),f.f=function(t){return J(h(t))}),a(a.G+a.W+a.F*!V,{Symbol:N});for(var Z="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),tt=0;Z.length>tt;)h(Z[tt++]);for(var et=I(h.store),nt=0;et.length>nt;)g(et[nt++]);a(a.S+a.F*!V,"Symbol",{for:function(t){return i(M,t+="")?M[t]:M[t]=N(t)},keyFor:function(t){if(!W(t))throw TypeError(t+" is not a symbol!");for(var e in M)if(M[e]===t)return e},useSetter:function(){z=!0},useSimple:function(){z=!1}}),a(a.S+a.F*!V,"Object",{create:function(t,e){return void 0===e?w(t):K(w(t),e)},defineProperty:$,defineProperties:K,getOwnPropertyDescriptor:X,getOwnPropertyNames:q,getOwnPropertySymbols:Q}),D&&a(a.S+a.F*(!V||c(function(){var t=N();return"[null]"!=B([t])||"{}"!=B({a:t})||"{}"!=B(Object(t))})),"JSON",{stringify:function(t){for(var e,n,o=[t],i=1;arguments.length>i;)o.push(arguments[i++]);if(n=e=o[1],(_(e)||void 0!==t)&&!W(t))return y(e)||(e=function(t,e){if("function"==typeof n&&(e=n.call(this,t,e)),!W(e))return e}),o[1]=e,B.apply(D,o)}}),N.prototype[L]||n(35)(N.prototype,L,N.prototype.valueOf),d(N,"Symbol"),d(Math,"Math",!0),d(o.JSON,"JSON",!0)},function(t,e,n){t.exports=n(123)("native-function-to-string",Function.toString)},function(t,e,n){var o=n(87),i=n(142),r=n(125);t.exports=function(t){var e=o(t),n=i.f;if(n)for(var a,s=n(t),l=r.f,c=0;s.length>c;)l.call(t,a=s[c++])&&e.push(a);return e}},function(t,e,n){var o=n(1);o(o.S,"Object",{create:n(89)})},function(t,e,n){var o=n(1);o(o.S+o.F*!n(23),"Object",{defineProperty:n(24).f})},function(t,e,n){var o=n(1);o(o.S+o.F*!n(23),"Object",{defineProperties:n(237)})},function(t,e,n){var o=n(40),i=n(41).f;n(59)("getOwnPropertyDescriptor",function(){return function(t,e){return i(o(t),e)}})},function(t,e,n){var o=n(25),i=n(42);n(59)("getPrototypeOf",function(){return function(t){return i(o(t))}})},function(t,e,n){var o=n(25),i=n(87);n(59)("keys",function(){return function(t){return i(o(t))}})},function(t,e,n){n(59)("getOwnPropertyNames",function(){return n(238).f})},function(t,e,n){var o=n(15),i=n(77).onFreeze;n(59)("freeze",function(t){return function(e){return t&&o(e)?t(i(e)):e}})},function(t,e,n){var o=n(15),i=n(77).onFreeze;n(59)("seal",function(t){return function(e){return t&&o(e)?t(i(e)):e}})},function(t,e,n){var o=n(15),i=n(77).onFreeze;n(59)("preventExtensions",function(t){return function(e){return t&&o(e)?t(i(e)):e}})},function(t,e,n){var o=n(15);n(59)("isFrozen",function(t){return function(e){return!o(e)||!!t&&t(e)}})},function(t,e,n){var o=n(15);n(59)("isSealed",function(t){return function(e){return!o(e)||!!t&&t(e)}})},function(t,e,n){var o=n(15);n(59)("isExtensible",function(t){return function(e){return!!o(e)&&(!t||t(e))}})},function(t,e,n){var o=n(1);o(o.S+o.F,"Object",{assign:n(239)})},function(t,e,n){var o=n(1);o(o.S,"Object",{is:n(240)})},function(t,e,n){var o=n(1);o(o.S,"Object",{setPrototypeOf:n(182).set})},function(t,e,n){"use strict";var o=n(106),i={};i[n(17)("toStringTag")]="z",i+""!="[object z]"&&n(36)(Object.prototype,"toString",function(){return"[object "+o(this)+"]"},!0)},function(t,e,n){var o=n(1);o(o.P,"Function",{bind:n(241)})},function(t,e,n){var o=n(24).f,i=Function.prototype,r=/^\s*function ([^ (]*)/;"name"in i||n(23)&&o(i,"name",{configurable:!0,get:function(){try{return(""+this).match(r)[1]}catch(t){return""}}})},function(t,e,n){"use strict";var o=n(15),i=n(42),r=n(17)("hasInstance"),a=Function.prototype;r in a||n(24).f(a,r,{value:function(t){if("function"!=typeof this||!o(t))return!1;if(!o(this.prototype))return t instanceof this;for(;t=i(t);)if(this.prototype===t)return!0;return!1}})},function(t,e,n){var o=n(1),i=n(243);o(o.G+o.F*(parseInt!=i),{parseInt:i})},function(t,e,n){var o=n(1),i=n(244);o(o.G+o.F*(parseFloat!=i),{parseFloat:i})},function(t,e,n){"use strict";var o=n(11),i=n(39),r=n(47),a=n(184),s=n(57),l=n(14),c=n(90).f,u=n(41).f,d=n(24).f,p=n(107).trim,h=o.Number,f=h,g=h.prototype,m="Number"==r(n(89)(g)),y="trim"in String.prototype,v=function(t){var e=s(t,!1);if("string"==typeof e&&e.length>2){var n,o,i,r=(e=y?e.trim():p(e,3)).charCodeAt(0);if(43===r||45===r){if(88===(n=e.charCodeAt(2))||120===n)return NaN}else if(48===r){switch(e.charCodeAt(1)){case 66:case 98:o=2,i=49;break;case 79:case 111:o=8,i=55;break;default:return+e}for(var a,l=e.slice(2),c=0,u=l.length;c<u;c++)if((a=l.charCodeAt(c))<48||a>i)return NaN;return parseInt(l,o)}}return+e};if(!h(" 0o1")||!h("0b1")||h("+0x1")){h=function(t){var e=arguments.length<1?0:t,n=this;return n instanceof h&&(m?l(function(){g.valueOf.call(n)}):"Number"!=r(n))?a(new f(v(e)),n,h):v(e)};for(var _,b=n(23)?c(f):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),C=0;b.length>C;C++)i(f,_=b[C])&&!i(h,_)&&d(h,_,u(f,_));h.prototype=g,g.constructor=h,n(36)(o,"Number",h)}},function(t,e,n){"use strict";var o=n(1),i=n(48),r=n(245),a=n(185),s=1..toFixed,l=Math.floor,c=[0,0,0,0,0,0],u="Number.toFixed: incorrect invocation!",d=function(t,e){for(var n=-1,o=e;++n<6;)o+=t*c[n],c[n]=o%1e7,o=l(o/1e7)},p=function(t){for(var e=6,n=0;--e>=0;)n+=c[e],c[e]=l(n/t),n=n%t*1e7},h=function(){for(var t=6,e="";--t>=0;)if(""!==e||0===t||0!==c[t]){var n=String(c[t]);e=""===e?n:e+a.call("0",7-n.length)+n}return e},f=function(t,e,n){return 0===e?n:e%2==1?f(t,e-1,n*t):f(t*t,e/2,n)};o(o.P+o.F*(!!s&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!n(14)(function(){s.call({})})),"Number",{toFixed:function(t){var e,n,o,s,l=r(this,u),c=i(t),g="",m="0";if(c<0||c>20)throw RangeError(u);if(l!=l)return"NaN";if(l<=-1e21||l>=1e21)return String(l);if(l<0&&(g="-",l=-l),l>1e-21)if(n=(e=function(t){for(var e=0,n=t;n>=4096;)e+=12,n/=4096;for(;n>=2;)e+=1,n/=2;return e}(l*f(2,69,1))-69)<0?l*f(2,-e,1):l/f(2,e,1),n*=4503599627370496,(e=52-e)>0){for(d(0,n),o=c;o>=7;)d(1e7,0),o-=7;for(d(f(10,o,1),0),o=e-1;o>=23;)p(1<<23),o-=23;p(1<<o),d(1,1),p(2),m=h()}else d(0,n),d(1<<-e,0),m=h()+a.call("0",c);return m=c>0?g+((s=m.length)<=c?"0."+a.call("0",c-s)+m:m.slice(0,s-c)+"."+m.slice(s-c)):g+m}})},function(t,e,n){"use strict";var o=n(1),i=n(14),r=n(245),a=1..toPrecision;o(o.P+o.F*(i(function(){return"1"!==a.call(1,void 0)})||!i(function(){a.call({})})),"Number",{toPrecision:function(t){var e=r(this,"Number#toPrecision: incorrect invocation!");return void 0===t?a.call(e):a.call(e,t)}})},function(t,e,n){var o=n(1);o(o.S,"Number",{EPSILON:Math.pow(2,-52)})},function(t,e,n){var o=n(1),i=n(11).isFinite;o(o.S,"Number",{isFinite:function(t){return"number"==typeof t&&i(t)}})},function(t,e,n){var o=n(1);o(o.S,"Number",{isInteger:n(246)})},function(t,e,n){var o=n(1);o(o.S,"Number",{isNaN:function(t){return t!=t}})},function(t,e,n){var o=n(1),i=n(246),r=Math.abs;o(o.S,"Number",{isSafeInteger:function(t){return i(t)&&r(t)<=9007199254740991}})},function(t,e,n){var o=n(1);o(o.S,"Number",{MAX_SAFE_INTEGER:9007199254740991})},function(t,e,n){var o=n(1);o(o.S,"Number",{MIN_SAFE_INTEGER:-9007199254740991})},function(t,e,n){var o=n(1),i=n(244);o(o.S+o.F*(Number.parseFloat!=i),"Number",{parseFloat:i})},function(t,e,n){var o=n(1),i=n(243);o(o.S+o.F*(Number.parseInt!=i),"Number",{parseInt:i})},function(t,e,n){var o=n(1),i=n(247),r=Math.sqrt,a=Math.acosh;o(o.S+o.F*!(a&&710==Math.floor(a(Number.MAX_VALUE))&&a(1/0)==1/0),"Math",{acosh:function(t){return(t=+t)<1?NaN:t>94906265.62425156?Math.log(t)+Math.LN2:i(t-1+r(t-1)*r(t+1))}})},function(t,e,n){var o=n(1),i=Math.asinh;o(o.S+o.F*!(i&&1/i(0)>0),"Math",{asinh:function t(e){return isFinite(e=+e)&&0!=e?e<0?-t(-e):Math.log(e+Math.sqrt(e*e+1)):e}})},function(t,e,n){var o=n(1),i=Math.atanh;o(o.S+o.F*!(i&&1/i(-0)<0),"Math",{atanh:function(t){return 0==(t=+t)?t:Math.log((1+t)/(1-t))/2}})},function(t,e,n){var o=n(1),i=n(186);o(o.S,"Math",{cbrt:function(t){return i(t=+t)*Math.pow(Math.abs(t),1/3)}})},function(t,e,n){var o=n(1);o(o.S,"Math",{clz32:function(t){return(t>>>=0)?31-Math.floor(Math.log(t+.5)*Math.LOG2E):32}})},function(t,e,n){var o=n(1),i=Math.exp;o(o.S,"Math",{cosh:function(t){return(i(t=+t)+i(-t))/2}})},function(t,e,n){var o=n(1),i=n(187);o(o.S+o.F*(i!=Math.expm1),"Math",{expm1:i})},function(t,e,n){var o=n(1);o(o.S,"Math",{fround:n(248)})},function(t,e,n){var o=n(1),i=Math.abs;o(o.S,"Math",{hypot:function(t,e){for(var n,o,r=0,a=0,s=arguments.length,l=0;a<s;)l<(n=i(arguments[a++]))?(r=r*(o=l/n)*o+1,l=n):r+=n>0?(o=n/l)*o:n;return l===1/0?1/0:l*Math.sqrt(r)}})},function(t,e,n){var o=n(1),i=Math.imul;o(o.S+o.F*n(14)(function(){return-5!=i(4294967295,5)||2!=i.length}),"Math",{imul:function(t,e){var n=+t,o=+e,i=65535&n,r=65535&o;return 0|i*r+((65535&n>>>16)*r+i*(65535&o>>>16)<<16>>>0)}})},function(t,e,n){var o=n(1);o(o.S,"Math",{log10:function(t){return Math.log(t)*Math.LOG10E}})},function(t,e,n){var o=n(1);o(o.S,"Math",{log1p:n(247)})},function(t,e,n){var o=n(1);o(o.S,"Math",{log2:function(t){return Math.log(t)/Math.LN2}})},function(t,e,n){var o=n(1);o(o.S,"Math",{sign:n(186)})},function(t,e,n){var o=n(1),i=n(187),r=Math.exp;o(o.S+o.F*n(14)(function(){return-2e-17!=!Math.sinh(-2e-17)}),"Math",{sinh:function(t){return Math.abs(t=+t)<1?(i(t)-i(-t))/2:(r(t-1)-r(-t-1))*(Math.E/2)}})},function(t,e,n){var o=n(1),i=n(187),r=Math.exp;o(o.S,"Math",{tanh:function(t){var e=i(t=+t),n=i(-t);return e==1/0?1:n==1/0?-1:(e-n)/(r(t)+r(-t))}})},function(t,e,n){var o=n(1);o(o.S,"Math",{trunc:function(t){return(t>0?Math.floor:Math.ceil)(t)}})},function(t,e,n){var o=n(1),i=n(88),r=String.fromCharCode,a=String.fromCodePoint;o(o.S+o.F*(!!a&&1!=a.length),"String",{fromCodePoint:function(t){for(var e,n=[],o=arguments.length,a=0;o>a;){if(e=+arguments[a++],i(e,1114111)!==e)throw RangeError(e+" is not a valid code point");n.push(e<65536?r(e):r(55296+((e-=65536)>>10),e%1024+56320))}return n.join("")}})},function(t,e,n){var o=n(1),i=n(40),r=n(18);o(o.S,"String",{raw:function(t){for(var e=i(t.raw),n=r(e.length),o=arguments.length,a=[],s=0;n>s;)a.push(String(e[s++])),s<o&&a.push(String(arguments[s]));return a.join("")}})},function(t,e,n){"use strict";n(107)("trim",function(t){return function(){return t(this,3)}})},function(t,e,n){"use strict";var o=n(144)(!0);n(188)(String,"String",function(t){this._t=String(t),this._i=0},function(){var t,e=this._t,n=this._i;return n>=e.length?{value:void 0,done:!0}:(t=o(e,n),this._i+=t.length,{value:t,done:!1})})},function(t,e,n){"use strict";var o=n(1),i=n(144)(!1);o(o.P,"String",{codePointAt:function(t){return i(this,t)}})},function(t,e,n){"use strict";var o=n(1),i=n(18),r=n(190),a="".endsWith;o(o.P+o.F*n(191)("endsWith"),"String",{endsWith:function(t){var e=r(this,t,"endsWith"),n=arguments.length>1?arguments[1]:void 0,o=i(e.length),s=void 0===n?o:Math.min(i(n),o),l=String(t);return a?a.call(e,l,s):e.slice(s-l.length,s)===l}})},function(t,e,n){"use strict";var o=n(1),i=n(190);o(o.P+o.F*n(191)("includes"),"String",{includes:function(t){return!!~i(this,t,"includes").indexOf(t,arguments.length>1?arguments[1]:void 0)}})},function(t,e,n){var o=n(1);o(o.P,"String",{repeat:n(185)})},function(t,e,n){"use strict";var o=n(1),i=n(18),r=n(190),a="".startsWith;o(o.P+o.F*n(191)("startsWith"),"String",{startsWith:function(t){var e=r(this,t,"startsWith"),n=i(Math.min(arguments.length>1?arguments[1]:void 0,e.length)),o=String(t);return a?a.call(e,o,n):e.slice(n,n+o.length)===o}})},function(t,e,n){"use strict";n(37)("anchor",function(t){return function(e){return t(this,"a","name",e)}})},function(t,e,n){"use strict";n(37)("big",function(t){return function(){return t(this,"big","","")}})},function(t,e,n){"use strict";n(37)("blink",function(t){return function(){return t(this,"blink","","")}})},function(t,e,n){"use strict";n(37)("bold",function(t){return function(){return t(this,"b","","")}})},function(t,e,n){"use strict";n(37)("fixed",function(t){return function(){return t(this,"tt","","")}})},function(t,e,n){"use strict";n(37)("fontcolor",function(t){return function(e){return t(this,"font","color",e)}})},function(t,e,n){"use strict";n(37)("fontsize",function(t){return function(e){return t(this,"font","size",e)}})},function(t,e,n){"use strict";n(37)("italics",function(t){return function(){return t(this,"i","","")}})},function(t,e,n){"use strict";n(37)("link",function(t){return function(e){return t(this,"a","href",e)}})},function(t,e,n){"use strict";n(37)("small",function(t){return function(){return t(this,"small","","")}})},function(t,e,n){"use strict";n(37)("strike",function(t){return function(){return t(this,"strike","","")}})},function(t,e,n){"use strict";n(37)("sub",function(t){return function(){return t(this,"sub","","")}})},function(t,e,n){"use strict";n(37)("sup",function(t){return function(){return t(this,"sup","","")}})},function(t,e,n){var o=n(1);o(o.S,"Date",{now:function(){return(new Date).getTime()}})},function(t,e,n){"use strict";var o=n(1),i=n(25),r=n(57);o(o.P+o.F*n(14)(function(){return null!==new Date(NaN).toJSON()||1!==Date.prototype.toJSON.call({toISOString:function(){return 1}})}),"Date",{toJSON:function(t){var e=i(this),n=r(e);return"number"!=typeof n||isFinite(n)?e.toISOString():null}})},function(t,e,n){var o=n(1),i=n(398);o(o.P+o.F*(Date.prototype.toISOString!==i),"Date",{toISOString:i})},function(t,e,n){"use strict";var o=n(14),i=Date.prototype.getTime,r=Date.prototype.toISOString,a=function(t){return t>9?t:"0"+t};t.exports=o(function(){return"0385-07-25T07:06:39.999Z"!=r.call(new Date(-5e13-1))})||!o(function(){r.call(new Date(NaN))})?function(){if(!isFinite(i.call(this)))throw RangeError("Invalid time value");var t=this,e=t.getUTCFullYear(),n=t.getUTCMilliseconds(),o=e<0?"-":e>9999?"+":"";return o+("00000"+Math.abs(e)).slice(o?-6:-4)+"-"+a(t.getUTCMonth()+1)+"-"+a(t.getUTCDate())+"T"+a(t.getUTCHours())+":"+a(t.getUTCMinutes())+":"+a(t.getUTCSeconds())+"."+(n>99?n:"0"+a(n))+"Z"}:r},function(t,e,n){var o=Date.prototype,i=o.toString,r=o.getTime;new Date(NaN)+""!="Invalid Date"&&n(36)(o,"toString",function(){var t=r.call(this);return t==t?i.call(this):"Invalid Date"})},function(t,e,n){var o=n(17)("toPrimitive"),i=Date.prototype;o in i||n(35)(i,o,n(401))},function(t,e,n){"use strict";var o=n(9),i=n(57);t.exports=function(t){if("string"!==t&&"number"!==t&&"default"!==t)throw TypeError("Incorrect hint");return i(o(this),"number"!=t)}},function(t,e,n){var o=n(1);o(o.S,"Array",{isArray:n(143)})},function(t,e,n){"use strict";var o=n(46),i=n(1),r=n(25),a=n(249),s=n(192),l=n(18),c=n(193),u=n(194);i(i.S+i.F*!n(146)(function(t){Array.from(t)}),"Array",{from:function(t){var e,n,i,d,p=r(t),h="function"==typeof this?this:Array,f=arguments.length,g=f>1?arguments[1]:void 0,m=void 0!==g,y=0,v=u(p);if(m&&(g=o(g,f>2?arguments[2]:void 0,2)),null==v||h==Array&&s(v))for(n=new h(e=l(p.length));e>y;y++)c(n,y,m?g(p[y],y):p[y]);else for(d=v.call(p),n=new h;!(i=d.next()).done;y++)c(n,y,m?a(d,g,[i.value,y],!0):i.value);return n.length=y,n}})},function(t,e,n){"use strict";var o=n(1),i=n(193);o(o.S+o.F*n(14)(function(){function t(){}return!(Array.of.call(t)instanceof t)}),"Array",{of:function(){for(var t=0,e=arguments.length,n=new("function"==typeof this?this:Array)(e);e>t;)i(n,t,arguments[t++]);return n.length=e,n}})},function(t,e,n){"use strict";var o=n(1),i=n(40),r=[].join;o(o.P+o.F*(n(124)!=Object||!n(49)(r)),"Array",{join:function(t){return r.call(i(this),void 0===t?",":t)}})},function(t,e,n){"use strict";var o=n(1),i=n(181),r=n(47),a=n(88),s=n(18),l=[].slice;o(o.P+o.F*n(14)(function(){i&&l.call(i)}),"Array",{slice:function(t,e){var n=s(this.length),o=r(this);if(e=void 0===e?n:e,"Array"==o)return l.call(this,t,e);for(var i=a(t,n),c=a(e,n),u=s(c-i),d=new Array(u),p=0;p<u;p++)d[p]="String"==o?this.charAt(i+p):this[i+p];return d}})},function(t,e,n){"use strict";var o=n(1),i=n(31),r=n(25),a=n(14),s=[].sort,l=[1,2,3];o(o.P+o.F*(a(function(){l.sort(void 0)})||!a(function(){l.sort(null)})||!n(49)(s)),"Array",{sort:function(t){return void 0===t?s.call(r(this)):s.call(r(this),i(t))}})},function(t,e,n){"use strict";var o=n(1),i=n(60)(0),r=n(49)([].forEach,!0);o(o.P+o.F*!r,"Array",{forEach:function(t){return i(this,t,arguments[1])}})},function(t,e,n){var o=n(15),i=n(143),r=n(17)("species");t.exports=function(t){var e;return i(t)&&("function"!=typeof(e=t.constructor)||e!==Array&&!i(e.prototype)||(e=void 0),o(e)&&null===(e=e[r])&&(e=void 0)),void 0===e?Array:e}},function(t,e,n){"use strict";var o=n(1),i=n(60)(1);o(o.P+o.F*!n(49)([].map,!0),"Array",{map:function(t){return i(this,t,arguments[1])}})},function(t,e,n){"use strict";var o=n(1),i=n(60)(2);o(o.P+o.F*!n(49)([].filter,!0),"Array",{filter:function(t){return i(this,t,arguments[1])}})},function(t,e,n){"use strict";var o=n(1),i=n(60)(3);o(o.P+o.F*!n(49)([].some,!0),"Array",{some:function(t){return i(this,t,arguments[1])}})},function(t,e,n){"use strict";var o=n(1),i=n(60)(4);o(o.P+o.F*!n(49)([].every,!0),"Array",{every:function(t){return i(this,t,arguments[1])}})},function(t,e,n){"use strict";var o=n(1),i=n(250);o(o.P+o.F*!n(49)([].reduce,!0),"Array",{reduce:function(t){return i(this,t,arguments.length,arguments[1],!1)}})},function(t,e,n){"use strict";var o=n(1),i=n(250);o(o.P+o.F*!n(49)([].reduceRight,!0),"Array",{reduceRight:function(t){return i(this,t,arguments.length,arguments[1],!0)}})},function(t,e,n){"use strict";var o=n(1),i=n(141)(!1),r=[].indexOf,a=!!r&&1/[1].indexOf(1,-0)<0;o(o.P+o.F*(a||!n(49)(r)),"Array",{indexOf:function(t){return a?r.apply(this,arguments)||0:i(this,t,arguments[1])}})},function(t,e,n){"use strict";var o=n(1),i=n(40),r=n(48),a=n(18),s=[].lastIndexOf,l=!!s&&1/[1].lastIndexOf(1,-0)<0;o(o.P+o.F*(l||!n(49)(s)),"Array",{lastIndexOf:function(t){if(l)return s.apply(this,arguments)||0;var e=i(this),n=a(e.length),o=n-1;for(arguments.length>1&&(o=Math.min(o,r(arguments[1]))),o<0&&(o=n+o);o>=0;o--)if(o in e&&e[o]===t)return o||0;return-1}})},function(t,e,n){var o=n(1);o(o.P,"Array",{copyWithin:n(251)}),n(78)("copyWithin")},function(t,e,n){var o=n(1);o(o.P,"Array",{fill:n(196)}),n(78)("fill")},function(t,e,n){"use strict";var o=n(1),i=n(60)(5),r=!0;"find"in[]&&Array(1).find(function(){r=!1}),o(o.P+o.F*r,"Array",{find:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),n(78)("find")},function(t,e,n){"use strict";var o=n(1),i=n(60)(6),r="findIndex",a=!0;r in[]&&Array(1)[r](function(){a=!1}),o(o.P+o.F*a,"Array",{findIndex:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),n(78)(r)},function(t,e,n){n(91)("Array")},function(t,e,n){var o=n(11),i=n(184),r=n(24).f,a=n(90).f,s=n(145),l=n(126),c=o.RegExp,u=c,d=c.prototype,p=/a/g,h=/a/g,f=new c(p)!==p;if(n(23)&&(!f||n(14)(function(){return h[n(17)("match")]=!1,c(p)!=p||c(h)==h||"/a/i"!=c(p,"i")}))){c=function(t,e){var n=this instanceof c,o=s(t),r=void 0===e;return!n&&o&&t.constructor===c&&r?t:i(f?new u(o&&!r?t.source:t,e):u((o=t instanceof c)?t.source:t,o&&r?l.call(t):e),n?this:d,c)};for(var g=function(t){t in c||r(c,t,{configurable:!0,get:function(){return u[t]},set:function(e){u[t]=e}})},m=a(u),y=0;m.length>y;)g(m[y++]);d.constructor=c,c.prototype=d,n(36)(o,"RegExp",c)}n(91)("RegExp")},function(t,e,n){"use strict";n(254);var o=n(9),i=n(126),r=n(23),a=/./.toString,s=function(t){n(36)(RegExp.prototype,"toString",t,!0)};n(14)(function(){return"/a/b"!=a.call({source:"a",flags:"b"})})?s(function(){var t=o(this);return"/".concat(t.source,"/","flags"in t?t.flags:!r&&t instanceof RegExp?i.call(t):void 0)}):"toString"!=a.name&&s(function(){return a.call(this)})},function(t,e,n){"use strict";var o=n(9),i=n(18),r=n(199),a=n(147);n(148)("match",1,function(t,e,n,s){return[function(n){var o=t(this),i=null==n?void 0:n[e];return void 0!==i?i.call(n,o):new RegExp(n)[e](String(o))},function(t){var e=s(n,t,this);if(e.done)return e.value;var l=o(t),c=String(this);if(!l.global)return a(l,c);var u=l.unicode;l.lastIndex=0;for(var d,p=[],h=0;null!==(d=a(l,c));){var f=String(d[0]);p[h]=f,""===f&&(l.lastIndex=r(c,i(l.lastIndex),u)),h++}return 0===h?null:p}]})},function(t,e,n){"use strict";var o=n(9),i=n(25),r=n(18),a=n(48),s=n(199),l=n(147),c=Math.max,u=Math.min,d=Math.floor,p=/\$([$&`']|\d\d?|<[^>]*>)/g,h=/\$([$&`']|\d\d?)/g;n(148)("replace",2,function(t,e,n,f){return[function(o,i){var r=t(this),a=null==o?void 0:o[e];return void 0!==a?a.call(o,r,i):n.call(String(r),o,i)},function(t,e){var i=f(n,t,this,e);if(i.done)return i.value;var d=o(t),p=String(this),h="function"==typeof e;h||(e=String(e));var m=d.global;if(m){var y=d.unicode;d.lastIndex=0}for(var v=[];;){var _=l(d,p);if(null===_)break;if(v.push(_),!m)break;""===String(_[0])&&(d.lastIndex=s(p,r(d.lastIndex),y))}for(var b,C="",k=0,w=0;w<v.length;w++){_=v[w];for(var S=String(_[0]),x=c(u(a(_.index),p.length),0),E=[],I=1;I<_.length;I++)E.push(void 0===(b=_[I])?b:String(b));var T=_.groups;if(h){var O=[S].concat(E,x,p);void 0!==T&&O.push(T);var A=String(e.apply(void 0,O))}else A=g(S,p,x,E,T,e);x>=k&&(C+=p.slice(k,x)+A,k=x+S.length)}return C+p.slice(k)}];function g(t,e,o,r,a,s){var l=o+t.length,c=r.length,u=h;return void 0!==a&&(a=i(a),u=p),n.call(s,u,function(n,i){var s;switch(i.charAt(0)){case"$":return"$";case"&":return t;case"`":return e.slice(0,o);case"'":return e.slice(l);case"<":s=a[i.slice(1,-1)];break;default:var u=+i;if(0===u)return n;if(u>c){var p=d(u/10);return 0===p?n:p<=c?void 0===r[p-1]?i.charAt(1):r[p-1]+i.charAt(1):n}s=r[u-1]}return void 0===s?"":s})}})},function(t,e,n){"use strict";var o=n(9),i=n(240),r=n(147);n(148)("search",1,function(t,e,n,a){return[function(n){var o=t(this),i=null==n?void 0:n[e];return void 0!==i?i.call(n,o):new RegExp(n)[e](String(o))},function(t){var e=a(n,t,this);if(e.done)return e.value;var s=o(t),l=String(this),c=s.lastIndex;i(c,0)||(s.lastIndex=0);var u=r(s,l);return i(s.lastIndex,c)||(s.lastIndex=c),null===u?-1:u.index}]})},function(t,e,n){"use strict";var o=n(145),i=n(9),r=n(127),a=n(199),s=n(18),l=n(147),c=n(198),u=n(14),d=Math.min,p=[].push,h=!u(function(){RegExp(4294967295,"y")});n(148)("split",2,function(t,e,n,u){var f;return f="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(t,e){var i=String(this);if(void 0===t&&0===e)return[];if(!o(t))return n.call(i,t,e);for(var r,a,s,l=[],u=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),d=0,h=void 0===e?4294967295:e>>>0,f=new RegExp(t.source,u+"g");(r=c.call(f,i))&&!((a=f.lastIndex)>d&&(l.push(i.slice(d,r.index)),r.length>1&&r.index<i.length&&p.apply(l,r.slice(1)),s=r[0].length,d=a,l.length>=h));)f.lastIndex===r.index&&f.lastIndex++;return d===i.length?!s&&f.test("")||l.push(""):l.push(i.slice(d)),l.length>h?l.slice(0,h):l}:"0".split(void 0,0).length?function(t,e){return void 0===t&&0===e?[]:n.call(this,t,e)}:n,[function(n,o){var i=t(this),r=null==n?void 0:n[e];return void 0!==r?r.call(n,i,o):f.call(String(i),n,o)},function(t,e){var o=u(f,t,this,e,f!==n);if(o.done)return o.value;var c=i(t),p=String(this),g=r(c,RegExp),m=c.unicode,y=(c.ignoreCase?"i":"")+(c.multiline?"m":"")+(c.unicode?"u":"")+(h?"y":"g"),v=new g(h?c:"^(?:"+c.source+")",y),_=void 0===e?4294967295:e>>>0;if(0===_)return[];if(0===p.length)return null===l(v,p)?[p]:[];for(var b=0,C=0,k=[];C<p.length;){v.lastIndex=h?C:0;var w,S=l(v,h?p:p.slice(C));if(null===S||(w=d(s(v.lastIndex+(h?0:C)),p.length))===b)C=a(p,C,m);else{if(k.push(p.slice(b,C)),k.length===_)return k;for(var x=1;x<=S.length-1;x++)if(k.push(S[x]),k.length===_)return k;C=b=w}}return k.push(p.slice(b)),k}]})},function(t,e,n){"use strict";var o,i,r,a,s=n(76),l=n(11),c=n(46),u=n(106),d=n(1),p=n(15),h=n(31),f=n(92),g=n(93),m=n(127),y=n(200).set,v=n(201)(),_=n(202),b=n(255),C=n(149),k=n(256),w=l.TypeError,S=l.process,x=S&&S.versions,E=x&&x.v8||"",I=l.Promise,T="process"==u(S),O=function(){},A=i=_.f,N=!!function(){try{var t=I.resolve(1),e=(t.constructor={})[n(17)("species")]=function(t){t(O,O)};return(T||"function"==typeof PromiseRejectionEvent)&&t.then(O)instanceof e&&0!==E.indexOf("6.6")&&-1===C.indexOf("Chrome/66")}catch(t){}}(),D=function(t){var e;return!(!p(t)||"function"!=typeof(e=t.then))&&e},B=function(t,e){if(!t._n){t._n=!0;var n=t._c;v(function(){for(var o=t._v,i=1==t._s,r=0,a=function(e){var n,r,a,s=i?e.ok:e.fail,l=e.resolve,c=e.reject,u=e.domain;try{s?(i||(2==t._h&&P(t),t._h=1),!0===s?n=o:(u&&u.enter(),n=s(o),u&&(u.exit(),a=!0)),n===e.promise?c(w("Promise-chain cycle")):(r=D(n))?r.call(n,l,c):l(n)):c(o)}catch(t){u&&!a&&u.exit(),c(t)}};n.length>r;)a(n[r++]);t._c=[],t._n=!1,e&&!t._h&&R(t)})}},R=function(t){y.call(l,function(){var e,n,o,i=t._v,r=L(t);if(r&&(e=b(function(){T?S.emit("unhandledRejection",i,t):(n=l.onunhandledrejection)?n({promise:t,reason:i}):(o=l.console)&&o.error&&o.error("Unhandled promise rejection",i)}),t._h=T||L(t)?2:1),t._a=void 0,r&&e.e)throw e.v})},L=function(t){return 1!==t._h&&0===(t._a||t._c).length},P=function(t){y.call(l,function(){var e;T?S.emit("rejectionHandled",t):(e=l.onrejectionhandled)&&e({promise:t,reason:t._v})})},M=function(t){var e=this;e._d||(e._d=!0,(e=e._w||e)._v=t,e._s=2,e._a||(e._a=e._c.slice()),B(e,!0))},F=function(t){var e,n=this;if(!n._d){n._d=!0,n=n._w||n;try{if(n===t)throw w("Promise can't be resolved itself");(e=D(t))?v(function(){var o={_w:n,_d:!1};try{e.call(t,c(F,o,1),c(M,o,1))}catch(t){M.call(o,t)}}):(n._v=t,n._s=1,B(n,!1))}catch(t){M.call({_w:n,_d:!1},t)}}};N||(I=function(t){f(this,I,"Promise","_h"),h(t),o.call(this);try{t(c(F,this,1),c(M,this,1))}catch(t){M.call(this,t)}},(o=function(t){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=n(94)(I.prototype,{then:function(t,e){var n=A(m(this,I));return n.ok="function"!=typeof t||t,n.fail="function"==typeof e&&e,n.domain=T?S.domain:void 0,this._c.push(n),this._a&&this._a.push(n),this._s&&B(this,!1),n.promise},catch:function(t){return this.then(void 0,t)}}),r=function(){var t=new o;this.promise=t,this.resolve=c(F,t,1),this.reject=c(M,t,1)},_.f=A=function(t){return t===I||t===a?new r(t):i(t)}),d(d.G+d.W+d.F*!N,{Promise:I}),n(105)(I,"Promise"),n(91)("Promise"),a=n(45).Promise,d(d.S+d.F*!N,"Promise",{reject:function(t){var e=A(this);return(0,e.reject)(t),e.promise}}),d(d.S+d.F*(s||!N),"Promise",{resolve:function(t){return k(s&&this===a?I:this,t)}}),d(d.S+d.F*!(N&&n(146)(function(t){I.all(t).catch(O)})),"Promise",{all:function(t){var e=this,n=A(e),o=n.resolve,i=n.reject,r=b(function(){var n=[],r=0,a=1;g(t,!1,function(t){var s=r++,l=!1;n.push(void 0),a++,e.resolve(t).then(function(t){l||(l=!0,n[s]=t,--a||o(n))},i)}),--a||o(n)});return r.e&&i(r.v),n.promise},race:function(t){var e=this,n=A(e),o=n.reject,i=b(function(){g(t,!1,function(t){e.resolve(t).then(n.resolve,o)})});return i.e&&o(i.v),n.promise}})},function(t,e,n){"use strict";var o=n(261),i=n(95);n(150)("WeakSet",function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{add:function(t){return o.def(i(this,"WeakSet"),t,!0)}},o,!1,!0)},function(t,e,n){"use strict";var o=n(1),i=n(151),r=n(203),a=n(9),s=n(88),l=n(18),c=n(15),u=n(11).ArrayBuffer,d=n(127),p=r.ArrayBuffer,h=r.DataView,f=i.ABV&&u.isView,g=p.prototype.slice,m=i.VIEW;o(o.G+o.W+o.F*(u!==p),{ArrayBuffer:p}),o(o.S+o.F*!i.CONSTR,"ArrayBuffer",{isView:function(t){return f&&f(t)||c(t)&&m in t}}),o(o.P+o.U+o.F*n(14)(function(){return!new p(2).slice(1,void 0).byteLength}),"ArrayBuffer",{slice:function(t,e){if(void 0!==g&&void 0===e)return g.call(a(this),t);for(var n=a(this).byteLength,o=s(t,n),i=s(void 0===e?n:e,n),r=new(d(this,p))(l(i-o)),c=new h(this),u=new h(r),f=0;o<i;)u.setUint8(f++,c.getUint8(o++));return r}}),n(91)("ArrayBuffer")},function(t,e,n){var o=n(1);o(o.G+o.W+o.F*!n(151).ABV,{DataView:n(203).DataView})},function(t,e,n){n(68)("Int8",1,function(t){return function(e,n,o){return t(this,e,n,o)}})},function(t,e,n){n(68)("Uint8",1,function(t){return function(e,n,o){return t(this,e,n,o)}})},function(t,e,n){n(68)("Uint8",1,function(t){return function(e,n,o){return t(this,e,n,o)}},!0)},function(t,e,n){n(68)("Int16",2,function(t){return function(e,n,o){return t(this,e,n,o)}})},function(t,e,n){n(68)("Uint16",2,function(t){return function(e,n,o){return t(this,e,n,o)}})},function(t,e,n){n(68)("Int32",4,function(t){return function(e,n,o){return t(this,e,n,o)}})},function(t,e,n){n(68)("Uint32",4,function(t){return function(e,n,o){return t(this,e,n,o)}})},function(t,e,n){n(68)("Float32",4,function(t){return function(e,n,o){return t(this,e,n,o)}})},function(t,e,n){n(68)("Float64",8,function(t){return function(e,n,o){return t(this,e,n,o)}})},function(t,e,n){var o=n(1),i=n(31),r=n(9),a=(n(11).Reflect||{}).apply,s=Function.apply;o(o.S+o.F*!n(14)(function(){a(function(){})}),"Reflect",{apply:function(t,e,n){var o=i(t),l=r(n);return a?a(o,e,l):s.call(o,e,l)}})},function(t,e,n){var o=n(1),i=n(89),r=n(31),a=n(9),s=n(15),l=n(14),c=n(241),u=(n(11).Reflect||{}).construct,d=l(function(){function t(){}return!(u(function(){},[],t)instanceof t)}),p=!l(function(){u(function(){})});o(o.S+o.F*(d||p),"Reflect",{construct:function(t,e){r(t),a(e);var n=arguments.length<3?t:r(arguments[2]);if(p&&!d)return u(t,e,n);if(t==n){switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3])}var o=[null];return o.push.apply(o,e),new(c.apply(t,o))}var l=n.prototype,h=i(s(l)?l:Object.prototype),f=Function.apply.call(t,h,e);return s(f)?f:h}})},function(t,e,n){var o=n(24),i=n(1),r=n(9),a=n(57);i(i.S+i.F*n(14)(function(){Reflect.defineProperty(o.f({},1,{value:1}),1,{value:2})}),"Reflect",{defineProperty:function(t,e,n){r(t),e=a(e,!0),r(n);try{return o.f(t,e,n),!0}catch(t){return!1}}})},function(t,e,n){var o=n(1),i=n(41).f,r=n(9);o(o.S,"Reflect",{deleteProperty:function(t,e){var n=i(r(t),e);return!(n&&!n.configurable)&&delete t[e]}})},function(t,e,n){"use strict";var o=n(1),i=n(9),r=function(t){this._t=i(t),this._i=0;var e,n=this._k=[];for(e in t)n.push(e)};n(189)(r,"Object",function(){var t,e=this._k;do{if(this._i>=e.length)return{value:void 0,done:!0}}while(!((t=e[this._i++])in this._t));return{value:t,done:!1}}),o(o.S,"Reflect",{enumerate:function(t){return new r(t)}})},function(t,e,n){var o=n(41),i=n(42),r=n(39),a=n(1),s=n(15),l=n(9);a(a.S,"Reflect",{get:function t(e,n){var a,c,u=arguments.length<3?e:arguments[2];return l(e)===u?e[n]:(a=o.f(e,n))?r(a,"value")?a.value:void 0!==a.get?a.get.call(u):void 0:s(c=i(e))?t(c,n,u):void 0}})},function(t,e,n){var o=n(41),i=n(1),r=n(9);i(i.S,"Reflect",{getOwnPropertyDescriptor:function(t,e){return o.f(r(t),e)}})},function(t,e,n){var o=n(1),i=n(42),r=n(9);o(o.S,"Reflect",{getPrototypeOf:function(t){return i(r(t))}})},function(t,e,n){var o=n(1);o(o.S,"Reflect",{has:function(t,e){return e in t}})},function(t,e,n){var o=n(1),i=n(9),r=Object.isExtensible;o(o.S,"Reflect",{isExtensible:function(t){return i(t),!r||r(t)}})},function(t,e,n){var o=n(1);o(o.S,"Reflect",{ownKeys:n(263)})},function(t,e,n){var o=n(1),i=n(9),r=Object.preventExtensions;o(o.S,"Reflect",{preventExtensions:function(t){i(t);try{return r&&r(t),!0}catch(t){return!1}}})},function(t,e,n){var o=n(24),i=n(41),r=n(42),a=n(39),s=n(1),l=n(85),c=n(9),u=n(15);s(s.S,"Reflect",{set:function t(e,n,s){var d,p,h=arguments.length<4?e:arguments[3],f=i.f(c(e),n);if(!f){if(u(p=r(e)))return t(p,n,s,h);f=l(0)}if(a(f,"value")){if(!1===f.writable||!u(h))return!1;if(d=i.f(h,n)){if(d.get||d.set||!1===d.writable)return!1;d.value=s,o.f(h,n,d)}else o.f(h,n,l(0,s));return!0}return void 0!==f.set&&(f.set.call(h,s),!0)}})},function(t,e,n){var o=n(1),i=n(182);i&&o(o.S,"Reflect",{setPrototypeOf:function(t,e){i.check(t,e);try{return i.set(t,e),!0}catch(t){return!1}}})},function(t,e,n){"use strict";var o=n(1),i=n(141)(!0);o(o.P,"Array",{includes:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),n(78)("includes")},function(t,e,n){"use strict";var o=n(1),i=n(264),r=n(25),a=n(18),s=n(31),l=n(195);o(o.P,"Array",{flatMap:function(t){var e,n,o=r(this);return s(t),e=a(o.length),n=l(o,0),i(n,o,o,e,0,1,t,arguments[1]),n}}),n(78)("flatMap")},function(t,e,n){"use strict";var o=n(1),i=n(264),r=n(25),a=n(18),s=n(48),l=n(195);o(o.P,"Array",{flatten:function(){var t=arguments[0],e=r(this),n=a(e.length),o=l(e,0);return i(o,e,e,n,0,void 0===t?1:s(t)),o}}),n(78)("flatten")},function(t,e,n){"use strict";var o=n(1),i=n(144)(!0);o(o.P,"String",{at:function(t){return i(this,t)}})},function(t,e,n){"use strict";var o=n(1),i=n(265),r=n(149),a=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(r);o(o.P+o.F*a,"String",{padStart:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0,!0)}})},function(t,e,n){"use strict";var o=n(1),i=n(265),r=n(149),a=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(r);o(o.P+o.F*a,"String",{padEnd:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0,!1)}})},function(t,e,n){"use strict";n(107)("trimLeft",function(t){return function(){return t(this,1)}},"trimStart")},function(t,e,n){"use strict";n(107)("trimRight",function(t){return function(){return t(this,2)}},"trimEnd")},function(t,e,n){"use strict";var o=n(1),i=n(58),r=n(18),a=n(145),s=n(126),l=RegExp.prototype,c=function(t,e){this._r=t,this._s=e};n(189)(c,"RegExp String",function(){var t=this._r.exec(this._s);return{value:t,done:null===t}}),o(o.P,"String",{matchAll:function(t){if(i(this),!a(t))throw TypeError(t+" is not a regexp!");var e=String(this),n="flags"in l?String(t.flags):s.call(t),o=new RegExp(t.source,~n.indexOf("g")?n:"g"+n);return o.lastIndex=r(t.lastIndex),new c(o,e)}})},function(t,e,n){n(178)("asyncIterator")},function(t,e,n){n(178)("observable")},function(t,e,n){var o=n(1),i=n(263),r=n(40),a=n(41),s=n(193);o(o.S,"Object",{getOwnPropertyDescriptors:function(t){for(var e,n,o=r(t),l=a.f,c=i(o),u={},d=0;c.length>d;)void 0!==(n=l(o,e=c[d++]))&&s(u,e,n);return u}})},function(t,e,n){var o=n(1),i=n(266)(!1);o(o.S,"Object",{values:function(t){return i(t)}})},function(t,e,n){var o=n(1),i=n(266)(!0);o(o.S,"Object",{entries:function(t){return i(t)}})},function(t,e,n){"use strict";var o=n(1),i=n(25),r=n(31),a=n(24);n(23)&&o(o.P+n(152),"Object",{__defineGetter__:function(t,e){a.f(i(this),t,{get:r(e),enumerable:!0,configurable:!0})}})},function(t,e,n){"use strict";var o=n(1),i=n(25),r=n(31),a=n(24);n(23)&&o(o.P+n(152),"Object",{__defineSetter__:function(t,e){a.f(i(this),t,{set:r(e),enumerable:!0,configurable:!0})}})},function(t,e,n){"use strict";var o=n(1),i=n(25),r=n(57),a=n(42),s=n(41).f;n(23)&&o(o.P+n(152),"Object",{__lookupGetter__:function(t){var e,n=i(this),o=r(t,!0);do{if(e=s(n,o))return e.get}while(n=a(n))}})},function(t,e,n){"use strict";var o=n(1),i=n(25),r=n(57),a=n(42),s=n(41).f;n(23)&&o(o.P+n(152),"Object",{__lookupSetter__:function(t){var e,n=i(this),o=r(t,!0);do{if(e=s(n,o))return e.set}while(n=a(n))}})},function(t,e,n){var o=n(1);o(o.P+o.R,"Map",{toJSON:n(267)("Map")})},function(t,e,n){var o=n(1);o(o.P+o.R,"Set",{toJSON:n(267)("Set")})},function(t,e,n){n(153)("Map")},function(t,e,n){n(153)("Set")},function(t,e,n){n(153)("WeakMap")},function(t,e,n){n(153)("WeakSet")},function(t,e,n){n(154)("Map")},function(t,e,n){n(154)("Set")},function(t,e,n){n(154)("WeakMap")},function(t,e,n){n(154)("WeakSet")},function(t,e,n){var o=n(1);o(o.G,{global:n(11)})},function(t,e,n){var o=n(1);o(o.S,"System",{global:n(11)})},function(t,e,n){var o=n(1),i=n(47);o(o.S,"Error",{isError:function(t){return"Error"===i(t)}})},function(t,e,n){var o=n(1);o(o.S,"Math",{clamp:function(t,e,n){return Math.min(n,Math.max(e,t))}})},function(t,e,n){var o=n(1);o(o.S,"Math",{DEG_PER_RAD:Math.PI/180})},function(t,e,n){var o=n(1),i=180/Math.PI;o(o.S,"Math",{degrees:function(t){return t*i}})},function(t,e,n){var o=n(1),i=n(269),r=n(248);o(o.S,"Math",{fscale:function(t,e,n,o,a){return r(i(t,e,n,o,a))}})},function(t,e,n){var o=n(1);o(o.S,"Math",{iaddh:function(t,e,n,o){var i=t>>>0,r=n>>>0;return(e>>>0)+(o>>>0)+((i&r|(i|r)&~(i+r>>>0))>>>31)|0}})},function(t,e,n){var o=n(1);o(o.S,"Math",{isubh:function(t,e,n,o){var i=t>>>0,r=n>>>0;return(e>>>0)-(o>>>0)-((~i&r|~(i^r)&i-r>>>0)>>>31)|0}})},function(t,e,n){var o=n(1);o(o.S,"Math",{imulh:function(t,e){var n=+t,o=+e,i=65535&n,r=65535&o,a=n>>16,s=o>>16,l=(a*r>>>0)+(i*r>>>16);return a*s+(l>>16)+((i*s>>>0)+(65535&l)>>16)}})},function(t,e,n){var o=n(1);o(o.S,"Math",{RAD_PER_DEG:180/Math.PI})},function(t,e,n){var o=n(1),i=Math.PI/180;o(o.S,"Math",{radians:function(t){return t*i}})},function(t,e,n){var o=n(1);o(o.S,"Math",{scale:n(269)})},function(t,e,n){var o=n(1);o(o.S,"Math",{umulh:function(t,e){var n=+t,o=+e,i=65535&n,r=65535&o,a=n>>>16,s=o>>>16,l=(a*r>>>0)+(i*r>>>16);return a*s+(l>>>16)+((i*s>>>0)+(65535&l)>>>16)}})},function(t,e,n){var o=n(1);o(o.S,"Math",{signbit:function(t){return(t=+t)!=t?t:0==t?1/t==1/0:t>0}})},function(t,e,n){"use strict";var o=n(1),i=n(45),r=n(11),a=n(127),s=n(256);o(o.P+o.R,"Promise",{finally:function(t){var e=a(this,i.Promise||r.Promise),n="function"==typeof t;return this.then(n?function(n){return s(e,t()).then(function(){return n})}:t,n?function(n){return s(e,t()).then(function(){throw n})}:t)}})},function(t,e,n){"use strict";var o=n(1),i=n(202),r=n(255);o(o.S,"Promise",{try:function(t){var e=i.f(this),n=r(t);return(n.e?e.reject:e.resolve)(n.v),e.promise}})},function(t,e,n){var o=n(69),i=n(9),r=o.key,a=o.set;o.exp({defineMetadata:function(t,e,n,o){a(t,e,i(n),r(o))}})},function(t,e,n){var o=n(69),i=n(9),r=o.key,a=o.map,s=o.store;o.exp({deleteMetadata:function(t,e){var n=arguments.length<3?void 0:r(arguments[2]),o=a(i(e),n,!1);if(void 0===o||!o.delete(t))return!1;if(o.size)return!0;var l=s.get(e);return l.delete(n),!!l.size||s.delete(e)}})},function(t,e,n){var o=n(69),i=n(9),r=n(42),a=o.has,s=o.get,l=o.key,c=function(t,e,n){if(a(t,e,n))return s(t,e,n);var o=r(e);return null!==o?c(t,o,n):void 0};o.exp({getMetadata:function(t,e){return c(t,i(e),arguments.length<3?void 0:l(arguments[2]))}})},function(t,e,n){var o=n(259),i=n(268),r=n(69),a=n(9),s=n(42),l=r.keys,c=r.key,u=function(t,e){var n=l(t,e),r=s(t);if(null===r)return n;var a=u(r,e);return a.length?n.length?i(new o(n.concat(a))):a:n};r.exp({getMetadataKeys:function(t){return u(a(t),arguments.length<2?void 0:c(arguments[1]))}})},function(t,e,n){var o=n(69),i=n(9),r=o.get,a=o.key;o.exp({getOwnMetadata:function(t,e){return r(t,i(e),arguments.length<3?void 0:a(arguments[2]))}})},function(t,e,n){var o=n(69),i=n(9),r=o.keys,a=o.key;o.exp({getOwnMetadataKeys:function(t){return r(i(t),arguments.length<2?void 0:a(arguments[1]))}})},function(t,e,n){var o=n(69),i=n(9),r=n(42),a=o.has,s=o.key,l=function(t,e,n){if(a(t,e,n))return!0;var o=r(e);return null!==o&&l(t,o,n)};o.exp({hasMetadata:function(t,e){return l(t,i(e),arguments.length<3?void 0:s(arguments[2]))}})},function(t,e,n){var o=n(69),i=n(9),r=o.has,a=o.key;o.exp({hasOwnMetadata:function(t,e){return r(t,i(e),arguments.length<3?void 0:a(arguments[2]))}})},function(t,e,n){var o=n(69),i=n(9),r=n(31),a=o.key,s=o.set;o.exp({metadata:function(t,e){return function(n,o){s(t,e,(void 0!==o?i:r)(n),a(o))}}})},function(t,e,n){var o=n(1),i=n(201)(),r=n(11).process,a="process"==n(47)(r);o(o.G,{asap:function(t){var e=a&&r.domain;i(e?e.bind(t):t)}})},function(t,e,n){"use strict";var o=n(1),i=n(11),r=n(45),a=n(201)(),s=n(17)("observable"),l=n(31),c=n(9),u=n(92),d=n(94),p=n(35),h=n(93),f=h.RETURN,g=function(t){return null==t?void 0:l(t)},m=function(t){var e=t._c;e&&(t._c=void 0,e())},y=function(t){return void 0===t._o},v=function(t){y(t)||(t._o=void 0,m(t))},_=function(t,e){c(t),this._c=void 0,this._o=t,t=new b(this);try{var n=e(t),o=n;null!=n&&("function"==typeof n.unsubscribe?n=function(){o.unsubscribe()}:l(n),this._c=n)}catch(e){return void t.error(e)}y(this)&&m(this)};_.prototype=d({},{unsubscribe:function(){v(this)}});var b=function(t){this._s=t};b.prototype=d({},{next:function(t){var e=this._s;if(!y(e)){var n=e._o;try{var o=g(n.next);if(o)return o.call(n,t)}catch(t){try{v(e)}finally{throw t}}}},error:function(t){var e=this._s;if(y(e))throw t;var n=e._o;e._o=void 0;try{var o=g(n.error);if(!o)throw t;t=o.call(n,t)}catch(t){try{m(e)}finally{throw t}}return m(e),t},complete:function(t){var e=this._s;if(!y(e)){var n=e._o;e._o=void 0;try{var o=g(n.complete);t=o?o.call(n,t):void 0}catch(t){try{m(e)}finally{throw t}}return m(e),t}}});var C=function(t){u(this,C,"Observable","_f")._f=l(t)};d(C.prototype,{subscribe:function(t){return new _(t,this._f)},forEach:function(t){var e=this;return new(r.Promise||i.Promise)(function(n,o){l(t);var i=e.subscribe({next:function(e){try{return t(e)}catch(t){o(t),i.unsubscribe()}},error:o,complete:n})})}}),d(C,{from:function(t){var e="function"==typeof this?this:C,n=g(c(t)[s]);if(n){var o=c(n.call(t));return o.constructor===e?o:new e(function(t){return o.subscribe(t)})}return new e(function(e){var n=!1;return a(function(){if(!n){try{if(h(t,!1,function(t){if(e.next(t),n)return f})===f)return}catch(t){if(n)throw t;return void e.error(t)}e.complete()}}),function(){n=!0}})},of:function(){for(var t=0,e=arguments.length,n=new Array(e);t<e;)n[t]=arguments[t++];return new("function"==typeof this?this:C)(function(t){var e=!1;return a(function(){if(!e){for(var o=0;o<n.length;++o)if(t.next(n[o]),e)return;t.complete()}}),function(){e=!0}})}}),p(C.prototype,s,function(){return this}),o(o.G,{Observable:C}),n(91)("Observable")},function(t,e,n){var o=n(11),i=n(1),r=n(149),a=[].slice,s=/MSIE .\./.test(r),l=function(t){return function(e,n){var o=arguments.length>2,i=!!o&&a.call(arguments,2);return t(o?function(){("function"==typeof e?e:Function(e)).apply(this,i)}:e,n)}};i(i.G+i.B+i.F*s,{setTimeout:l(o.setTimeout),setInterval:l(o.setInterval)})},function(t,e,n){var o=n(1),i=n(200);o(o.G+o.B,{setImmediate:i.set,clearImmediate:i.clear})},function(t,e,n){for(var o=n(197),i=n(87),r=n(36),a=n(11),s=n(35),l=n(108),c=n(17),u=c("iterator"),d=c("toStringTag"),p=l.Array,h={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},f=i(h),g=0;g<f.length;g++){var m,y=f[g],v=h[y],_=a[y],b=_&&_.prototype;if(b&&(b[u]||s(b,u,p),b[d]||s(b,d,y),l[y]=p,v))for(m in o)b[m]||r(b,m,o[m],!0)}},function(t,e,n){(function(e){!function(e){"use strict";var n,o=Object.prototype,i=o.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},a=r.iterator||"@@iterator",s=r.asyncIterator||"@@asyncIterator",l=r.toStringTag||"@@toStringTag",c="object"==typeof t,u=e.regeneratorRuntime;if(u)c&&(t.exports=u);else{(u=e.regeneratorRuntime=c?t.exports:{}).wrap=b;var d="suspendedStart",p="suspendedYield",h="executing",f="completed",g={},m={};m[a]=function(){return this};var y=Object.getPrototypeOf,v=y&&y(y(N([])));v&&v!==o&&i.call(v,a)&&(m=v);var _=S.prototype=k.prototype=Object.create(m);w.prototype=_.constructor=S,S.constructor=w,S[l]=w.displayName="GeneratorFunction",u.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},u.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,S):(t.__proto__=S,l in t||(t[l]="GeneratorFunction")),t.prototype=Object.create(_),t},u.awrap=function(t){return{__await:t}},x(E.prototype),E.prototype[s]=function(){return this},u.AsyncIterator=E,u.async=function(t,e,n,o){var i=new E(b(t,e,n,o));return u.isGeneratorFunction(e)?i:i.next().then(function(t){return t.done?t.value:i.next()})},x(_),_[l]="Generator",_[a]=function(){return this},_.toString=function(){return"[object Generator]"},u.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var o=e.pop();if(o in t)return n.value=o,n.done=!1,n}return n.done=!0,n}},u.values=N,A.prototype={constructor:A,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach(O),!t)for(var e in this)"t"===e.charAt(0)&&i.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=n)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function o(o,i){return s.type="throw",s.arg=t,e.next=o,i&&(e.method="next",e.arg=n),!!i}for(var r=this.tryEntries.length-1;r>=0;--r){var a=this.tryEntries[r],s=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var l=i.call(a,"catchLoc"),c=i.call(a,"finallyLoc");if(l&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(l){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&i.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var r=o;break}}r&&("break"===t||"continue"===t)&&r.tryLoc<=e&&e<=r.finallyLoc&&(r=null);var a=r?r.completion:{};return a.type=t,a.arg=e,r?(this.method="next",this.next=r.finallyLoc,g):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),g},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),O(n),g}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var o=n.completion;if("throw"===o.type){var i=o.arg;O(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,o){return this.delegate={iterator:N(t),resultName:e,nextLoc:o},"next"===this.method&&(this.arg=n),g}}}function b(t,e,n,o){var i=e&&e.prototype instanceof k?e:k,r=Object.create(i.prototype),a=new A(o||[]);return r._invoke=function(t,e,n){var o=d;return function(i,r){if(o===h)throw new Error("Generator is already running");if(o===f){if("throw"===i)throw r;return D()}for(n.method=i,n.arg=r;;){var a=n.delegate;if(a){var s=I(a,n);if(s){if(s===g)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===d)throw o=f,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=h;var l=C(t,e,n);if("normal"===l.type){if(o=n.done?f:p,l.arg===g)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(o=f,n.method="throw",n.arg=l.arg)}}}(t,n,a),r}function C(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}function k(){}function w(){}function S(){}function x(t){["next","throw","return"].forEach(function(e){t[e]=function(t){return this._invoke(e,t)}})}function E(t){function n(e,o,r,a){var s=C(t[e],t,o);if("throw"!==s.type){var l=s.arg,c=l.value;return c&&"object"==typeof c&&i.call(c,"__await")?Promise.resolve(c.__await).then(function(t){n("next",t,r,a)},function(t){n("throw",t,r,a)}):Promise.resolve(c).then(function(t){l.value=t,r(l)},a)}a(s.arg)}var o;"object"==typeof e.process&&e.process.domain&&(n=e.process.domain.bind(n)),this._invoke=function(t,e){function i(){return new Promise(function(o,i){n(t,e,o,i)})}return o=o?o.then(i,i):i()}}function I(t,e){var o=t.iterator[e.method];if(o===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=n,I(t,e),"throw"===e.method))return g;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return g}var i=C(o,t.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,g;var r=i.arg;return r?r.done?(e[t.resultName]=r.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=n),e.delegate=null,g):r:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,g)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function O(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function A(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function N(t){if(t){var e=t[a];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,r=function e(){for(;++o<t.length;)if(i.call(t,o))return e.value=t[o],e.done=!1,e;return e.value=n,e.done=!0,e};return r.next=r}}return{next:D}}function D(){return{value:n,done:!0}}}("object"==typeof e?e:"object"==typeof window?window:"object"==typeof self?self:this)}).call(this,n(67))},function(t,e,n){n(517),t.exports=n(45).RegExp.escape},function(t,e,n){var o=n(1),i=n(518)(/[\\^$*+?.()|[\]{}]/g,"\\$&");o(o.S,"RegExp",{escape:function(t){return i(t)}})},function(t,e){t.exports=function(t,e){var n=e===Object(e)?function(t){return e[t]}:e;return function(e){return String(e).replace(t,n)}}},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){n(854),n(864);var e=window.JST={},o=n(0),i=n(19);return n(521).files.forEach(function(t){var r=n(522)("./"+t+".jst");e["common/"+t]=o.template(i.trimTempalte(r))}),n(541).files.forEach(function(t){var r=n(542)("./"+t+".jst");e["web/"+t]=o.template(i.trimTempalte(r))}),n(557)}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(t){t.exports={files:["attachment-view-attachment-container","catalogue_view","table_view","table_cell_resize","table_cell_edit","high_light_item","color_picker","handwrite-view-container","header-footer","high_light_item_image","image-title-input","image-view-image-container","link_view","list_item_view","page_break_view","paragraph_view","todo","content-load-progress"]}},function(t,e,n){var o={"./attachment-view-attachment-container.jst":523,"./catalogue_view.jst":524,"./color_picker.jst":525,"./content-load-progress.jst":526,"./handwrite-view-container.jst":527,"./header-footer.jst":528,"./high_light_item.jst":529,"./high_light_item_image.jst":530,"./image-title-input.jst":531,"./image-view-image-container.jst":532,"./link_view.jst":533,"./list_item_view.jst":534,"./page_break_view.jst":535,"./paragraph_view.jst":536,"./table_cell_edit.jst":537,"./table_cell_resize.jst":538,"./table_view.jst":539,"./todo.jst":540};function i(t){var e=r(t);return n(e)}function r(t){if(!n.o(o,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return o[t]}i.keys=function(){return Object.keys(o)},i.resolve=r,t.exports=i,i.id=522},function(t,e){t.exports='<div class="attachment-block-container">\n    <div class="attachment-container" title="<%- title %>">\n        <div class="attachment-icon svg-common <%- name %>"></div>\n        <div class="attachment-title">\n            <p class="attachment-title-name"><%- fileName %></p><p class="attachment-title-type"><%- fileType %></p>\n        </div>\n        <div class="attachment-size"><%= size %></div>\n        <div class="attachment-download svg-common"></div>\n        <div class="attachment-mask" draggable="<%-!!draggable%>">\n            <div class="attachment-icon svg-common <%- name %>"></div>\n            <div class="attachment-title">\n                <p class="attachment-title-name"><%- fileName %></p><p class="attachment-title-type"><%- fileType %></p>\n            </div>\n            <div class="attachment-size"><%= size %></div>\n            <div class="attachment-download svg-common"></div>\n        </div>\n    </div>\n</div>\n'},function(t,e){t.exports='<div class="catalogue-header cannot-edit">\n    <div class="catalogue-refresh" title="刷新">\n        <i class="svg-common src--svg--catalogue-refresh"></i>\n    </div>\n    <div class="catalogue-delete" title="删除">\n        <i class="svg-common src--svg--catalogue_remove"></i>\n    </div>\n</div>\n<div class="para-text"></div>'},function(t,e){t.exports='<div class="color-picker-panel" tabindex="0">\n    <div class="color-picker-panel-inner">\n        <div class="color-picker-panel-board">\n            <div class="color-picker-panel-board-hsv" style="background-color: rgb(255, 0, 0);">\n                <div class="color-picker-panel-board-value"></div>\n                <div class="color-picker-panel-board-saturation"></div>\n            </div>\n            <span style="left: 126px; top: 93.5px;"></span>\n        </div>\n        <div class="color-picker-panel-wrap">\n            <div class="color-picker-panel-wrap-ribbon">\n                <div class="color-picker-panel-ribbon">\n                    <span style="left: 0%;"></span>\n                </div>\n            </div>\n            <div class="color-picker-panel-wrap-alpha">\n                <div class="color-picker-panel-alpha">\n                    <div class="color-picker-panel-alpha-bg" style="background: linear-gradient(to right, rgba(57, 57, 57, 0), rgb(57, 57, 57));"></div>\n                    <span style="left: 100%;"></span>\n                </div>\n            </div>\n            <div class="color-picker-panel-wrap-preview">\n                <div class="color-picker-panel-preview">\n                    <span style="background-color: rgb(57, 57, 57); opacity: 1;"></span>\n                </div>\n            </div>\n        </div>\n        <div class="color-picker-panel-wrap" style="height: 40px; margin-top: 6px;">\n            <div class="color-picker-panel-params">\n                <div class="color-picker-panel-params-input">\n                    <input type="text" class="color-picker-panel-params-hex" maxlength="6" value="393939">\n                    <input type="number" value="57">\n                    <input type="number" value="57">\n                    <input type="number" value="57">\n                    <input type="number" value="100">\n                </div>\n                <div class="color-picker-panel-params-lable">\n                    <label class="color-picker-panel-params-lable-hex">HEX</label>\n                    <label class="color-picker-panel-params-lable-number">R</label>\n                    <label class="color-picker-panel-params-lable-number">G</label>\n                    <label class="color-picker-panel-params-lable-number">B</label>\n                    <label class="color-picker-panel-params-lable-alpha">A</label>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>\n</div>'},function(t,e){t.exports='<div class="progressbar-layer">\n    </div>\n    <div class="progressbar-mark">\n    </div>\n    <div class="progress-message">\n    <span class="progress-message-text">\n       <span class="progress-message-number"></span>  的内容已加载完成，请稍后...\n    </span>\n</div>'},function(t,e){t.exports='<div class="handwrite-container">\n    <img  src="<%= src %>"/>\n</div>\n<% if (needCopyHack) {%>\n    <p class="handwrite-copy-hack">select me</p>\n<% } %>'},function(t,e){t.exports="<div class=\"header-footer-input\" contenteditable=\"<%= readonly ? 'false' : 'true' %>\"></div>"},function(t,e){t.exports='<div class="high-light-item" style="left: <%= left %>px; top: <%= top %>px; height: <%= height %>px; width: <%= width %>px;"></div>'},function(t,e){t.exports='<div class="high-light-item-image" style="left: <%= left %>px; top: <%= top %>px; height: <%= height %>px; width: <%= width %>px;"></div>'},function(t,e){t.exports='<div class="image-title-input" contenteditable="true"\n    style="position: absolute; left: <%- left %>px; top: <%- top %>px; width: <%- width%>px; text-align: <%- textAlign%>; min-height: <%- height%>px;"><%- title %></div>\n<div class="image-title-placeholder"\n    style="position: absolute; left: <%- left %>px; top: <%- top %>px; width: <%- width%>px; text-align: <%- textAlign%>; min-height: <%- height%>px;">\n    输入标题\n</div>\n'},function(t,e){t.exports='<div class="image-block-container">\n    <div class="image-container">\n       <% if (src) { %>\n         <img <% if (width || height) { %> class="filter-blur" <% } %> src="<%= src %>"\n            <% if (width && height) { %> style="width: <%- width%>px; height: <%- height%>px;"\n            <% } else if (width) { %> style="width: <%- width%>px; height: auto;"<% } %>/>\n            <div class="resize-handle" data-corner="0"></div>\n            <div class="resize-handle" data-corner="1"></div>\n            <div class="resize-handle" data-corner="2"></div>\n            <div class="resize-handle" data-corner="3"></div>\n            <div class="menu-wrapper">\n                <div class="yne-button-group">\n                    <div class="yne-button-item yne-last" data-button-name="menu" title="快捷菜单">\n                        <span class="yne-button svg-common">快捷菜单</span>\n                        <span class="yne-arrow-down svg-common"></span>\n                    </div>\n                    <ul class="yne-popup-menu">\n                        <li class="yne-popup-item" data-cm-name="image-title"><span>标题</span></li>\n                        <li class="yne-popup-item" data-cm-name="float-left"><span>左浮动</span></li>\n                        <li class="yne-popup-item" data-cm-name="float-right"><span>右浮动</span></li>\n                        <li class="yne-popup-item" data-cm-name="clear-float"><span>清除浮动</span></li>\n                        <li class="yne-popup-item" data-cm-name="clear-resize"><span>清除缩放</span></li>\n                        <% if (hasOCR) {%>\n                            <li class="yne-popup-item" data-cm-name="image-ocr"><span>文本识别OCR</span></li>\n                        <% } %>\n                        <li class="yne-popup-item yne-popup-split"></li>\n                        <li class="yne-popup-item" data-cm-name="delete"><span>删除图片</span></li>\n                        <li class="yne-popup-item" data-cm-name="download"><span>另存为</span></li>\n                    </ul>\n                </div>\n            </div>\n        </div>\n        <div class="image-title"></div>\n        <div class="image-split"></div>\n         <% } else {\n            %>\n              <% if (isImgError) { %>\n         <div class="image_error"><div class="svg-common src--svg--image_error"></div></div>\n         <% } else {\n            %><div class="loader-wrap"  <% if (width && height) {%>style="width: <%- width%>px; height: <%- height%>px;"<% } %>></div>\n         <% } %>\n\n         <% } %>\n\n\n    <% if (needCopyHack) {%>\n        <p class="image-copy-hack">select me</p>\n    <% } %>\n</div>\n'},function(t,e){t.exports='<div class="hover-menu hover-menu-show-link">\n    <div class="hover-menu-before"></div>\n    <div class="hover-menu-body">\n        <a href="<%= link%>" target=\'_blank\'><span><%= link%></span></a>\n        <% if (!isReadOnly) { %>\n            <div class="link-button">\n                <span class="link-modify-button">编辑</span>\n                <span class="link-split">|</span>\n                <span class="link-remove-button">移除</span>\n            </div>\n        <% } %>\n    </div>\n</div>\n<div class="hover-menu hover-menu-modify-link">\n    <div class="hover-menu-before"></div>\n    <div class="hover-menu-body">\n        <span class="link-label">链接</span>\n        <input class="link-input" type="text" name="link" value="<%= link%>" />\n        <div class="link-confirm-button">\n            <span class="link-button-text">确定</span>\n        </div>\n    </div>\n</div>'},function(t,e){t.exports='<% if (isOrdered) { %>\n    <ol class="li-box"><li><div class="para-text"></div></li></ol>\n<% } else { %>\n    <ul class="li-box"><li><div class="para-text"></div></li></ul>\n<% } %>'},function(t,e){t.exports='<div class="page-break">\r\n    <span class="spanMark topSpan"></span>\r\n    <span class="spanMark middleSpan"></span>\r\n    <span class="spanMark bottomSpan"></span>\r\n</div>'},function(t,e){t.exports='<div class="para-text"></div>'},function(t,e){t.exports='<div class="cell-edit-box" contenteditable="true"></div>'},function(t,e){t.exports='<div class="resize-up"></div>\n<div class="resize-right"></div>\n<div class="resize-down"></div>\n<div class="resize-left"></div>\n'},function(t,e){t.exports='<div class="table-layout">\n    <div class="table-layout-inner" contentEditable="false">\n        <div class="table-wrapper">\n            <table>\n                <colgroup></colgroup>\n                <tbody></tbody>   \n            </table>\n            <div class="row-resize-line"></div>\n            <div class="col-resize-line"></div>\n        </div>\n    </div>\n</div>\n'},function(t,e){t.exports='<div class="todo-content">\n    <label class="todo-mark" contenteditable="false">\n        <span class="todo-inner"></span>\n    </label>\n    <div class="todo-input para-text">\n    </div>\n</div>'},function(t){t.exports={files:["toolbar-button-template","toolbar-combo-box-font-family","toolbar-combo-box-font-size","toolbar-combo-box-align","toolbar-combo-box-line-height","toolbar-combo-box-color","toolbar-combo-box-back-color","toolbar-combo-box-set-background","toolbar-combo-box-table","toolbar_view","toolbar-combo-box-show-more","toolbar-combo-box-insert-link","toolbar-combo-box-heading"],dependency:["common"]}},function(t,e,n){var o={"./toolbar-button-template.jst":543,"./toolbar-combo-box-align.jst":544,"./toolbar-combo-box-back-color.jst":545,"./toolbar-combo-box-color.jst":546,"./toolbar-combo-box-font-family.jst":547,"./toolbar-combo-box-font-size.jst":548,"./toolbar-combo-box-heading.jst":549,"./toolbar-combo-box-insert-link.jst":550,"./toolbar-combo-box-line-height.jst":551,"./toolbar-combo-box-set-background.jst":552,"./toolbar-combo-box-show-more.jst":553,"./toolbar-combo-box-table.jst":554,"./toolbar-combo-box-template.jst":555,"./toolbar_view.jst":556};function i(t){var e=r(t);return n(e)}function r(t){if(!n.o(o,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return o[t]}i.keys=function(){return Object.keys(o)},i.resolve=r,t.exports=i,i.id=542},function(t,e){t.exports='<div class="button-wrapper button-wrapper-<%=name%>">\n    <div class="button button-<%=name%> svg-common" title="<%=label%>"></div>\n</div>'},function(t,e){t.exports='<div class="combo-display-wrapper" title="<%=label%>">\n    <div class="combo-value-wrapper">\n        <span class="combo-value combo-value-<%=name%> svg-common"></span>\n    </div>\n    <div class="combo-expand-wrapper">\n        <span class="combo-expand svg-common"></span>\n    </div>\n</div>\n<div class="combo-menu-wrapper">\n    <ul class="combo-menu combo-menu-<%=name%>">\n    <% for (key in items) { %>\n        <li class="combo-item" data-value="<%=key%>">\n            <span class="combo-item-icon-<%=name%> <%=key%> svg-common">&nbsp;</span>\n            <span class="combo-item-span-<%=name%>"><%=items[key]%></span>\n        </li>\n    <% } %>\n    </ul>\n</div>'},function(t,e){t.exports='<div class="combo-display-wrapper" title="<%=label%>">\n    <div class="combo-value-wrapper">\n        <span class="combo-value svg-common combo-value-<%=name%>">\n            <span class="combo-value-buttom-color"></span>\n        </span>\n    </div>\n    <div class="combo-expand-wrapper">\n        <span class="combo-expand svg-common"></span>\n    </div>\n</div>\n<div class="combo-menu-wrapper">\n    <div class="combo-menu combo-menu-<%=name%>">\n        <div class="color-section color-section-default combo-item" data-value="<%=defaultValue%>">\n            <div class="color-cell combo-item back-color-cell-default" data-value="<%=defaultValue%>" style="background-color:<%=defaultValue%>;"></div>\n            <div class="color-label color-label-default">默认无背景色</div>\n        </div>\n        <hr class="color-section-split">\n        <div class="color-section color-section-theme">\n            <div class="color-label color-label-theme">主题颜色</div>\n            <div class="color-row">\n            <% for (key in items.theme) { %>\n                <div class="color-cell combo-item" data-value="<%=items.theme[key]%>" style="background-color:<%=items.theme[key]%>;"></div>\n            <% } %>\n            </div>\n            <div class="color-row-split"></div>\n            <div class="color-part-theme">\n            <% for (row in items.other) { %>\n                <div class="color-row">\n                <% for (key in items.other[row]) { %>\n                    <div class="color-cell combo-item" data-value="<%=items.other[row][key]%>" style="background-color:<%=items.other[row][key]%>;"></div>\n                <% } %>\n                </div>\n            <% } %>\n            </div>\n        </div>\n        <hr class="color-section-split">\n        <div class="color-section color-section-standard">\n            <div class="color-label color-label-standard">推荐颜色</div>\n            <div class="color-row">\n            <% for (key in items.standard) { %>\n                <div class="color-cell combo-item" data-value="<%=items.standard[key]%>" style="background-color:<%=items.standard[key]%>;"></div>\n            <% } %>\n            </div>\n        </div>\n        <hr class="color-section-split">\n        <div class="color-section color-section-other combo-item">\n            <div class="color-img-other"></div>\n            <div class="color-label color-label-other">其他颜色</div>\n        <div>\n    </div>\n</div>\n'},function(t,e){t.exports='<div class="combo-display-wrapper" title="<%=label%>">\n    <div class="combo-value-wrapper">\n        <span class="combo-value combo-value-<%=name%> svg-common">\n            <span class="combo-value-buttom-color"></span>\n        </span>\n    </div>\n    <div class="combo-expand-wrapper">\n        <span class="combo-expand svg-common"></span>\n    </div>\n</div>\n<div class="combo-menu-wrapper">\n    <div class="combo-menu combo-menu-<%=name%>">\n        <div class="color-section color-section-default combo-item" data-value="<%=defaultValue%>">\n            <div class="color-cell combo-item color-cell-default" data-value="<%=defaultValue%>" style="background-color:<%=defaultValue%>;"></div>\n            <div class="color-label color-label-default">默认颜色</div>\n        </div>\n        <hr class="color-section-split">\n        <div class="color-section color-section-theme">\n            <div class="color-label color-label-theme">主题颜色</div>\n            <div class="color-row">\n            <% for (key in items.theme) { %>\n                <div class="color-cell combo-item" data-value="<%=items.theme[key]%>" style="background-color:<%=items.theme[key]%>;"></div>\n            <% } %>\n            </div>\n            <div class="color-row-split"></div>\n            <div class="color-part-theme">\n            <% for (row in items.other) { %>\n                <div class="color-row">\n                <% for (key in items.other[row]) { %>\n                    <div class="color-cell combo-item" data-value="<%=items.other[row][key]%>" style="background-color:<%=items.other[row][key]%>;"></div>\n                <% } %>\n                </div>\n            <% } %>\n            </div>\n        </div>\n        <hr class="color-section-split">\n        <div class="color-section color-section-standard">\n            <div class="color-label color-label-standard">推荐颜色</div>\n            <div class="color-row">\n            <% for (key in items.standard) { %>\n                <div class="color-cell combo-item" data-value="<%=items.standard[key]%>" style="background-color:<%=items.standard[key]%>;"></div>\n            <% } %>\n            </div>\n        </div>\n        <hr class="color-section-split">\n        <div class="color-section color-section-other combo-item">\n            <div class="color-img-other"></div>\n            <div class="color-label color-label-other">其他颜色</div>\n        <div>\n    </div>\n</div>\n'},function(t,e){t.exports='<div class="combo-display-wrapper" title="<%=label%>">\n    <div class="combo-value-wrapper">\n        <span class="combo-value combo-value-<%=name%> svg-common"></span>\n    </div>\n    <div class="combo-expand-wrapper">\n        <span class="combo-expand svg-common"></span>\n    </div>\n</div>\n<div class="combo-menu-wrapper">\n    <ul class="combo-menu combo-menu-<%=name%>">\n    <% for (font in items) { %>\n        <li class="combo-item" data-value="<%=items[font].singleValue%>">\n            <span style="font-family:<%=items[font].fullValue%>;"><%=items[font].name%></span>\n        </li>\n    <% } %>\n    </ul>\n</div>\n'},function(t,e){t.exports='<div class="combo-display-wrapper" title="<%=label%>">\n    <div class="combo-value-wrapper">\n        <span class="combo-value combo-value-<%=name%> svg-common"></span>\n    </div>\n    <div class="combo-expand-wrapper">\n        <span class="combo-expand svg-common"></span>\n    </div>\n</div>\n<div class="combo-menu-wrapper">\n    <ul class="combo-menu combo-menu-<%=name%>">\n    <% for (key in items) { %>\n        <li class="combo-item" data-value="<%=key%>">\n            <span><%=items[key]%></span>\n        </li>\n    <% } %>\n    </ul>\n</div>\n'},function(t,e){t.exports='<div class="combo-display-wrapper" title="<%=label%>">\n    <div class="combo-value-wrapper">\n        <span class="combo-value combo-value-<%=name%>"></span>\n    </div>\n    <div class="combo-expand-wrapper">\n        <span class="combo-expand svg-common"></span>\n    </div>\n</div>\n<div class="combo-menu-wrapper">\n    <ul class="combo-menu combo-menu-<%=name%>">\n    <% for (key in items) { %>\n        <li class="combo-item" data-value="<%=key%>">\n            <span style="font-size: <%=items[key][\'font-size\']%>px"><%=items[key].name%></span>\n        </li>\n    <% } %>\n    </ul>\n</div>\n'},function(t,e){t.exports='<div class="combo-display-wrapper combo-link-wrapper" title="<%=label%>">\n    <div class="combo-value-wrapper combo-value-wrapper-<%=name%>">\n        <span class="combo-value combo-value-<%=name%> svg-common"></span>\n    </div>\n</div>\n<div class="combo-menu-wrapper  wrapper-<%=name%>">\n    <div class="combo-menu combo-menu-<%=name%>">\n        <span class="link-label">链接</span>\n        <input class="link-input" type="text" name="link" placeholder="输入链接" />\n        <div class="link-button">\n            <span class="link-button-text">确定</span>\n        </div>\n    </div>\n</div>\n\n'},function(t,e){t.exports='<div class="combo-display-wrapper" title="<%=label%>">\n    <div class="combo-value-wrapper">\n        <span class="combo-value combo-value-<%=name%> svg-common"></span>\n    </div>\n    <div class="combo-expand-wrapper">\n        <span class="combo-expand svg-common"></span>\n    </div>\n</div>\n<div class="combo-menu-wrapper">\n    <ul class="combo-menu combo-menu-<%=name%>">\n    <% for (idx in items) { %>\n        <li class="combo-item" data-value="<%=items[idx].key%>">\n            <span class="combo-item-icon-<%=name%> line-height-<%=idx%>">&nbsp;</span>\n            <span class="combo-item-span-<%=name%>"><%=items[idx].value%></span>\n        </li>\n    <% } %>\n    </ul>\n</div>\n\n'},function(t,e){t.exports='<div class="combo-display-wrapper" title="<%=label%>">\n    <div class="combo-value-wrapper">\n        <span class="combo-value combo-value-<%=name%> svg-common">\n        </span>\n        <span class="combo-text combo-text-<%=name%>">纸张背景</span>\n    </div>\n</div>\n<div class="combo-menu-wrapper">\n    <div class="combo-menu combo-menu-<%=name%> svg-common">\n        <div class="background-section-top">\n            <% for (row in items.normalUser) { %>\n            <div class="background-row">\n                <% for (key in items.normalUser[row]) { %>\n                    <% if (items.normalUser[row][key] === \'NoBackground\') { %>\n                        <div class="background-cell combo-item" data-value="<%=items.normalUser[row][key]%>">\n                            <svg class="background-cell-check-mark" xmlns="http://www.w3.org/2000/svg" viewBox="-16 -16 52 52"><path d="M1.05584113,8.97696545 C0.884930054,8.78831051 0.877161369,8.59965557 1.03253508,8.41100063 L1.52196226,7.7742902 C1.6617986,7.56991402 1.84047836,7.53847153 2.05800155,7.67996273 L6.39292802,10.6748599 C6.79689966,10.9421211 7.19310261,10.9185392 7.58153688,10.6041143 L19.1180347,0.982712344 C19.3044832,0.825499894 19.4831629,0.833360516 19.654074,1.00629421 L19.9104406,1.26569475 C20.0813517,1.43862845 20.0813517,1.61942277 19.9104406,1.80807771 L7.53492477,14.5187043 C7.17756524,14.880293 6.8279744,14.8881536 6.48615224,14.5422862 L1.05584113,8.97696545 Z"/></svg>\n                        </div>\n                    <% } else { %>\n                        <div class="background-cell combo-item" data-value="<%=items.normalUser[row][key]%>" style="background-image:url(\'<%=items.normalUser[row][key]%>\');">\n                            <svg class="background-cell-check-mark" xmlns="http://www.w3.org/2000/svg" viewBox="-16 -16 52 52"><path d="M1.05584113,8.97696545 C0.884930054,8.78831051 0.877161369,8.59965557 1.03253508,8.41100063 L1.52196226,7.7742902 C1.6617986,7.56991402 1.84047836,7.53847153 2.05800155,7.67996273 L6.39292802,10.6748599 C6.79689966,10.9421211 7.19310261,10.9185392 7.58153688,10.6041143 L19.1180347,0.982712344 C19.3044832,0.825499894 19.4831629,0.833360516 19.654074,1.00629421 L19.9104406,1.26569475 C20.0813517,1.43862845 20.0813517,1.61942277 19.9104406,1.80807771 L7.53492477,14.5187043 C7.17756524,14.880293 6.8279744,14.8881536 6.48615224,14.5422862 L1.05584113,8.97696545 Z"/></svg>\n                        </div>\n                    <% } %>\n                <% } %>\n                </div>\n            <% } %>\n        </div>\n        <hr class="background-section-split">\n        <div class="background-section-bottom">\n            <div class="background-label background-label-vip">会员特权</div>\n            <% for (row in items.VIP) { %>\n                <div class="background-row">\n                <% for (key in items.VIP[row]) { %>\n                    <div class="background-cell combo-item" data-value="<%=items.VIP[row][key]%>" style="background-image:url(\'<%=items.VIP[row][key]%>\');">\n                        <svg class="background-cell-check-mark" xmlns="http://www.w3.org/2000/svg" viewBox="-16 -16 52 52"><path d="M1.05584113,8.97696545 C0.884930054,8.78831051 0.877161369,8.59965557 1.03253508,8.41100063 L1.52196226,7.7742902 C1.6617986,7.56991402 1.84047836,7.53847153 2.05800155,7.67996273 L6.39292802,10.6748599 C6.79689966,10.9421211 7.19310261,10.9185392 7.58153688,10.6041143 L19.1180347,0.982712344 C19.3044832,0.825499894 19.4831629,0.833360516 19.654074,1.00629421 L19.9104406,1.26569475 C20.0813517,1.43862845 20.0813517,1.61942277 19.9104406,1.80807771 L7.53492477,14.5187043 C7.17756524,14.880293 6.8279744,14.8881536 6.48615224,14.5422862 L1.05584113,8.97696545 Z"/></svg>\n                    </div>\n                <% } %>\n                </div>\n            <% } %>\n        </div>\n    </div>\n</div>\n'},function(t,e){t.exports='<div class="toolbar-more-split"></div>\n<div class="combo-display-wrapper combo-showmore-wrapper" title="<%=label%>">\n    <div class="combo-value-wrapper combo-value-wrapper-<%=name%>">\n        <span class="combo-value combo-value-<%=name%>">更多</span>\n        <span class="combo-expand-gray svg-common"></span>\n    </div>\n</div>\n<div class="combo-menu-wrapper  wrapper-<%=name%>">\n    <div class="combo-menu combo-menu-<%=name%>">\n    </div>\n</div>\n'},function(t,e){t.exports='<div class="combo-display-wrapper" title="<%=label%>">\n    <div class="combo-value-wrapper">\n        <span class="combo-value combo-value-<%=name%> svg-common"></span>\n    </div>\n</div>\n<div class="combo-menu-wrapper">\n    <div class="combo-menu combo-menu-<%=name%>">\n    <% for (var i=0; i<maxRows; i++) { %>\n        <div class="combo-item-row">\n        <% for (var j=0; j<maxCols; j++) { %>\n            <span class="combo-item" data-row="<%=i%>" data-col="<%=j%>"></span>\n        <% } %>\n        </div>\n    <% } %>\n    <div class="combo-menu-label-<%=name%>">插入表格</div>\n    </div>\n</div>\n'},function(t,e){t.exports='<div class="combo-display-wrapper">\n    <div class="combo-value-wrapper"></div>\n    <div class="combo-expand-wrapper"></div>\n</div>\n<div class="combo-menu-wrapper"></div>\n'},function(t,e){t.exports='<div class="toolbar-container">\n    <% \n        _.each(items, function(conf, key){\n            if(conf.type === \'button\') {\n    %>\n                <button class="<%= key%>" action="<%= conf.action%>" name="<%= conf.name%>" type="button" data-yne-is-block="<%= !!conf.block%>"><%= conf.label%></button>\n    <%      \n            } else if(conf.type === \'select\') {\n    %>\n                <select class="<%= key%>" action="<%= conf.action%>" name="<%= conf.name%>" data-yne-is-block="<%= !!conf.block%>">\n    <%\n                    _.each(conf.options, function(value, key) {\n    %>\n                        <option value="<%= key%>"><%= value%></option>\n    <%                       \n                    });\n    %>\n                </select>\n    <%\n            }\n        });\n    %>\n\n</div>'},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";var a,s=this&&this.__extends||(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});o=[n,r,n(0),n(558),n(7),n(270),n(276),n(51),n(295),n(109),n(10),n(220),n(603),n(846),n(852)],void 0===(i=function(t,e,n,o,i,r,a,l,c,u,d,p,h,f,g){return function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.xml2html=function(t){return(r.fromXml(t)||new r({})).toHtml()},e.html2xml=function(t){return(r.fromHtml(t)||new r({})).toXml()},e.html2html=function(t){return(r.fromHtml(t)||new r({})).toHtml()},e.ocr2xml=function(t){return(r.fromOCR(t)||new r({})).toXml()},e.prototype.getInstance=function(){return this.coreEditor},e.prototype.initialize=function(t){var e,o=this,r=n.extend({pageType:i.PAGE_TYPE_A4,parentEl:null,removeLocalImg:!1,render:!0,sessionType:0,useHttpsConvert:!1},t);if(r.render&&!r.parentEl)throw new Error("BulbEditor need `parentEl`!");null!=localStorage&&(r.viewMode=parseInt(localStorage.getItem(d.name+":view-mode"),10)),r.viewMode=p.parseToNumber(r.viewMode,0),0!==r.viewMode&&2!==r.viewMode&&(r.viewMode=0),o.coreEditor=e=new h(r),r.render&&e.render(),n.each(g,function(t){var n="yne-"+t;e.bind(n,function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];(!o.coreEditor.isIdleTimeout()||"download-image"!==t&&"download-attachment"!==t)&&("view-mode-change"===t&&null!=localStorage&&null!=e[0]&&localStorage.setItem(d.name+":view-mode",e[0]),o.trigger.bind(o,t).apply(o,e))})})},e.FONT_NAME=u({DEFAULT:l.getFont(a["font-family"].default),LIST:l.getNames()}),e.FONT_SIZE=u({DEFAULT:a["font-size"].default,LIST:c.getAsArray()}),e}(f)}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";o=[n,r,n(559),n(560),n(204)],void 0===(i=function(t,e,n,o,i){Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(){}return t.injectToWindow=function(){window&&(window.debugTool={breakPoints:n.default,breakPointsGroup:o.default,stopHere:function(t,e){i.breakPointsLog(t,e);var o=n.default&&n.default[t];return o&&o.enable}},window.postMessage({type:"initial-break-points",from:"inspectWindow",sender:"inspectWindow",to:"devPage",payload:{breakPoints:n.default,breakPointsGroup:o.default}},"*"))},t}();e.default=r}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default={insertCode:{name:"插入代码块",enable:!1,group:["insert","code"]},insertQuote:{name:"插入引用",enable:!1,group:["insert","quote"]},insertTodo:{name:"插入代办",enable:!1,group:["insert","todo"]},insertImage:{name:"插入图片",enable:!1,group:["insert","image"]},insertLink:{name:"插入链接",enable:!1,group:["insert","link"]},insertList:{name:"插入列表",enable:!1,group:["insert","list"]},insertAttachment:{name:"插入附件",enable:!1,group:["insert","attachment"]},insertHorizontalLine:{name:"插入水平线",enable:!1,group:["insert","hr"]},insertTable:{name:"插入表格",enable:!1,group:["insert","table"]},insertCatalogue:{name:"插入目录",enable:!1,group:["insert","catalogue"]},parseNativeRange:{name:"解析原生range",enable:!1,group:["range","other"]},drawRange:{name:"绘制Range",enable:!1,group:["range","other"]},addDragHint:{name:"绘制拖拽光标",enable:!1,group:["drag","other"]},handleKey:{name:"处理key输入",enable:!1,group:["input"]},textInput:{name:"文本输入",enable:!1,group:["input"]},paste:{name:"粘贴",enable:!1,group:["paste","other"]},copy:{name:"复制",enable:!1,group:["copy","other"]},cut:{name:"剪切",enable:!1,group:["cut","other"]},dragStart:{name:"开始拖拽",enable:!1,group:["drag","other"]},dragEnd:{name:"结束拖拽",enable:!1,group:["drag","other"]},pdfPrintCSS:{name:"pdf/print样式",enable:!1,group:["style","other"]},tab:{name:"tab键",enable:!1,group:["key","other"]},codeUpdate:{name:"代码块更新",enable:!1,group:["render","code"]},codeParse:{name:"代码块解析",enable:!1,group:["code"]},codeRender:{name:"代码块渲染",enable:!1,group:["code","render"]},codeSelectAll:{name:"全选代码块",enable:!1,group:["code","style"]},pcPresentation:{name:"pc演示模式",enable:!1,group:["pc","style","other"]},scrollView:{name:"滚动视图",enable:!1,group:["scroll","other"]},setImageWidth:{name:"设置图片宽度",enable:!1,group:["image","render"]},imageHeight:{name:"图片高度溢出",enable:!1,group:["image","render"]},clickMenu:{name:"点击右键菜单",enable:!1,group:["click","menu","other"]},removeFormat:{name:"清除格式",enable:!1,group:["format","other"]},updateSelectionUI:{name:"更新选区UI",enable:!1,group:["range","render"]},execCommand:{name:"执行命令",enable:!1,group:["command","other"]},doUnapply:{name:"undo命令",enable:!1,group:["command","other"]},execEditorApi:{name:"执行api",enable:!1,group:["api","other"]}}}.apply(i,[n,i]))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default={action:["insert","input","render","other"],feature:["todo","code","quote","image","link","list","attachment","hr","table","catalogue","other"]}}.apply(i,[n,i]))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},,function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e,o=n(0),i=n(26),r=n(563),a=n(569),s=n(98),l=n(570);return e=i.extend({_mapper:{},_blackTagList:{},constructor:function(t){var e=this;e._mapper={},e._blackTagList={},o.each(t,function(t,n){!1===t?e._blackTagList[n]=!0:t&&o.isObject(t)&&e.define(n,t)})},parse:function(t,e){var n,i,a,c=new l,u=/<html[\S\s]*<\/html>/i;return t=t.replace(/<!--[\w\W]*?-->/i,""),u.test(t)&&(t=t.match(u)[0]),(n=s(t,document,!0))?i=new r(n):((n=document.createElement("div")).innerHTML=t,i=new r(n)),(a=n.getElementsByTagName("style"))&&o.each(a,function(t){c.parse(t.innerText)}),i.internalStylesParser=c,this._parseRecursively(i,this,e),i.blocks},_shouldBreak:function(t){return!t||!t.style||("none"===t.style.display||"hidden"===t.style.visibility)},_parseRecursively:function(t,e,n){var i,r,s,l,c,u=t.el;if(!0!==this._shouldBreak(u)){if(t.setup(),!0!==t.handleChildrenBySelf())for(i=u.firstChild;i;)1===i.nodeType?(c=i.tagName.toLowerCase(),this._blackTagList[c]||(s=this._findHandlers(i),l=new(s=o.isFunction(s)?s:a)(i,t,t.internalStylesParser,e,n),this._parseRecursively(l,e,n))):3===i.nodeType&&(r=i.textContent)&&t.capture({text:r,styles:t.styles,isText:!0}),i=i.nextSibling;t.finish()}},define:function(t,n,o){this._mapper[t]={Class:n,priority:o||e.PRIORITY.DEFAULT}},_findHandlers:function(t){var e=[];if(o.each(this._mapper,function(n,o){(function(t,e){if(t)return t.matches?t.matches(e):t.webkitMatchesSelector?t.webkitMatchesSelector(e):void 0})(t,o)&&e.push(n)}),0!==e.length)return e.sort(function(t,e){return e.priority-t.priority}),e[0].Class}},{PRIORITY:{HIGH:1,DEFAULT:0,LOW:-1}})}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(155),o=n(38);return e.extend({constructor:function(t){e.call(this,t,null),this.blocks=[]},setup:function(){e.prototype.setup.apply(this),this.blocks=[]},emit:function(t){t&&t instanceof o&&this.blocks.push(t)},finish:function(){this.emitBlock()},getRoot:function(){return this}})}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(0),o=n(2),i={1:12,2:13,3:16,4:18,5:24,6:32,7:48},r={b:function(t){t.bold=!0},i:function(t){t.italic=!0},u:function(t){t.underline=!0},strike:function(t){t.strike=!0},code:function(t){t["font-family"]="monospace"},mark:function(t){t["back-color"]="#ffff00",t.color="#000000"},font:function(t,e){var n,o=e.getAttribute("color"),r=e.getAttribute("face"),a=e.getAttribute("size");o&&(t.color=o),r&&(t["font-family"]=r),a&&(n=i[a])&&(t["font-size"]=n)},pre:function(t){t["white-space"]="pre"},a:function(t,e){e&&e.href&&(t.color="#003884",t.underline=!0)}},a=function(t,n){var i=r[t];i?e.each(n,function(t){r[t]||(r[t]=i)}):o.error("The tag handler for `"+t+"` does not exist!")};return e.each({h1:32,h2:24,h3:18,h4:16,h5:13,h6:12},function(t,e){r[e]=function(e){e.bold=!0,e["font-size"]=t}}),a("b",["strong"]),a("i",["em","cite","var","address","dfn"]),a("strike",["s","del"]),a("u",["ins"]),a("code",["tt","kbd","samp","pre","xmp","plaintext","listing"]),r}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(43),o=n(79),i={};return function(t,n){var r,a;if((t=o(t).trim().toLowerCase().value())&&"inherit"!==t){if(n&&"transparent"===t)return t;if(r=i[t])return"null"===r?void 0:r;if((a=e(t)).isValid())return 0===a.getAlpha()?void(i[t]="null"):(r=a.toHexString(),i[t]=r,r);i[t]="null"}}}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";o=[n,r,n(0),n(3),n(109),n(2)],void 0===(i=function(t,e,n,o,i,r){var a={align:{type:"Enum",possible:{left:!0,right:!0,center:!0,justify:!0},default:"left"},"line-height":{type:"Number",default:1.75},indent:{type:"Number",default:0},"text-indent":{type:"Number",default:0},width:{type:"Number",default:null},float:{type:"Enum",possible:{none:!0,left:!0,right:!0},default:"none"},height:{type:"Number",default:1},color:{type:"String",default:"#999999"},"back-color":{type:"String",default:""},padding:{type:"String",default:""}},s={},l={},c={};return s[o.HR]={width:{type:"Number",default:100},margin:{type:"String",default:"none"}},l[o.PARAGRAPH]=["align","indent","text-indent","line-height","back-color","padding"],l[o.LIST_ITEM]=["align","indent","text-indent","line-height","back-color","padding"],l[o.HEADING]=["align","indent","text-indent","line-height","back-color","padding"],l[o.CATALOGUE]=["align","indent","text-indent","line-height","back-color","padding"],l[o.TODO]=["align","indent","text-indent","line-height","back-color","padding"],l[o.IMAGE]=["align","width","float","height","back-color","padding"],l[o.ATTACHMENT]=["align","float","back-color","padding"],l[o.HR]=["align","width","height","color","back-color","padding","margin"],l[o.TABLE]=["back-color","padding"],l[o.QUOTE]=["line-height","back-color","padding"],l[o.CODE]=["back-color"],n.each(o.getAllBlockTypes(),function(t){l[t]||r.warn("no block style config for block["+t+"]")}),n.each(o.getAllBlockTypes(),function(t){var e={},o=l[t]||[],i=s[t];n.each(o,function(t){i&&i[t]?e[t]=i[t]:a[t]?e[t]=a[t]:r.error("no config for style named ["+t+"]")}),c[t]=e}),r.log("xml block style config",c),i(c)}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";o=[n,r,n(0),n(111),n(2),n(210),n(32)],void 0===(i=function(t,e,n,o,i,r,a){return function(){function t(t){o(r.checkValid(t)),this.char=t,this.length=t.length,this.styles={}}return t.fromJSON=function(e){if(e&&e.char){var o=new t(e.char);return n.each(e.styles,function(t,e){o.setStyle(e,t)}),o}},t.prototype.clone=function(){var e=new t(this.char);return e.styles=n.clone(this.styles),this.unknownStyles&&(e.unknownStyles=n.clone(this.unknownStyles)),e},t.prototype.getStyle=function(t,e,o){void 0===e&&(e=!0);var r,s=e&&o&&void 0!==o[t]?o[t]:null,l=a.getConfig(t);return o&&o[t]&&!this.styles[t]?r=o[t]:l?null==(r=this.styles[t])?e?null===s?l.default:s:null:(n["is"+l.type](r)||(i.warn("The value `"+r+"` of `"+t+"` is not valid type!"),r=null),e?null==r?null===s?l.default:s:r:r===l.default?l.default:r):null},t.prototype.getStyles=function(t){var e=this,o={},i=a.getAllConfig();return n.each(i,function(n,i){o[i]=e.getStyle(i,!0,t)}),o},t.prototype.getUnknownStyle=function(t){var e=this.unknownStyles;if(e)return e[t]},t.prototype.isLineBreak=function(){return"\r"===this.char||"\n"===this.char},t.prototype.removeStyles=function(){this.styles={}},t.prototype.setStyle=function(t,e,o){var r=this.styles,s=a.getConfig(t);if(s){if(e&&!n["is"+s.type](e))switch(s.type){case"Number":e=Number(e),e=isNaN(e)?s.default:e;break;case"Boolean":e=e+""=="true";break;default:i.warn("The value `"+e+"` of `"+t+"` is not valid type!"),e=null}!e||(s.equalDefault?s.equalDefault(e):e===s.default)?(delete r[t],o&&o[t]&&(r[t]=e)):r[t]=e}else i.warn("The RichText does not support `"+t+"` style!")},t.prototype.setUnknownStyle=function(t,e){a.isSupport(t)?i.warn("The RichText supports `"+t+"` style!"):(this.unknownStyles||(this.unknownStyles={}),this.unknownStyles[t]=e)},t.prototype.toJSON=function(){var t=this,e={char:t.char},o={},i=!1,r=a.getAllConfig();return n.each(r,function(e,n){var r=t.getStyle(n,!1);r&&(o[n]=r,i=!0)}),i&&(e.styles=o),e},t.prototype.toString=function(){return this.char},t}()}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(0),o=n(79),i=["normal","nowrap","pre-line"],r=function(t,e){return e&&"normal"!==e&&"nowrap"!==e?"pre-line"===e?t.replace(/[ \t]+$/g,""):t:t.replace(/[ \t\r\n]+$/g,"")},a=function(t){var n=t.styles["white-space"];return!n||e.contains(i,n)};return function(t){var n,i,s,l,c,u,d,p;for(e.each(t,function(t){var e,n;t.text=(e=t.text,(n=t.styles["white-space"])&&"normal"!==n&&"nowrap"!==n?"pre-line"===n?e.replace(/[ \t]+/g," "):e:e.replace(/[ \t\r\n]+/g," "))}),s=t.length,n=0;n<s&&((l=t[n]).text=(d=l.text,(p=l.styles["white-space"])&&"normal"!==p&&"nowrap"!==p?"pre-line"===p?d.replace(/^[ \t]+/g,""):d:d.replace(/^[ \t\r\n]+/g,"")),!l.text);n++);for(n=0,i=1;i<s;i++)c=t[n],u=t[i],a(c)&&a(u)&&(o.endsWith(c.text," ")&&o.startsWith(u.text," ")&&(u.text=u.text.slice(1)),""===u.text)||(n=i);for(n=s-1;n>=0&&((l=t[n]).text=r(l.text,l.styles["white-space"]),!l.text);n--);return t}}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){return n(96).extend({_computeStyles:function(){var t=this.parent;t&&(this.styles=t.styles)},capture:function(t){this.emit(t)}})}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(0),o=n(26),i=n(571),r=n(573),a=n(8),s=n(2);return o.extend({_internalStyles:{},constructor:function(){this._internalStyles={}},parse:function(t){var n,o,r,a={},l={};if(!0===s.DEBUG)n=i.parse(t);else try{n=i.parse(t)}catch(t){return{}}return n.cssRules?(e.each(n.cssRules,function(t){t.selectorText&&t.style&&(l={},o=t.style,e.each(o,function(t){l[t]=o[t]}),-1!==t.selectorText.indexOf(",")?(r=t.selectorText.split(","),e.each(r,function(t){t=t.trim(),a[t]={selectorText:t,style:l}})):(t.selectorText=t.selectorText.trim(),a[t.selectorText]={selectorText:t.selectorText,style:l}))}),this._internalStyles=e.extend(this._internalStyles,a),a):{}},getInternalStyles:function(){return this._internalStyles},getStylesBySpecificity:function(t,n){var o=this,i={},r=o._internalStyles,s=[],l=0;return r?(e.each(r,function(e){try{a(t).is(e.selectorText)&&s.push(e)}catch(t){}}),s.sort(function(t,e){return-1*o._specificityCompare(t.selectorText,e.selectorText)}),e.some(s,function(t){if(t.style&&e.some(t.style,function(t,o){if(l===n.length)return!0;o in i||-1===e.indexOf(n,o)||(i[o]=t,l++)}),l===n.length)return!0}),i):{}},_specificityCompare:function(t,e){return r.compare(t,e)}})}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},,,,function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(){return["maction","math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msubsup","msup","mtable","mtd","mtext","mtr","munder","munderover","semantics"]}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(){return["a","altGlyph","altGlyphDef","altGlyphItem","animate","animateColor","animateMotion","animateTransform","circle","clipPath","color-profile","cursor","defs","desc","ellipse","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","font","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignObject","g","glyph","glyphRef","hkern","image","line","linearGradient","marker","mask","metadata","missing-glyph","mpath","path","pattern","polygon","polyline","radialGradient","rect","script","set","stop","style","svg","switch","symbol","text","textPath","title","tref","tspan","use","view","vkern"]}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){return{AnchorHandler:n(577),BreakHandler:n(578),HrHandler:n(579),ImageHandler:n(288),InlineHandler:n(159),ListHandler:n(291),ListItemHandler:n(580),ParagraphHandler:n(155),TableHandler:n(581),TodoHandler:n(593)}}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(96);return e.extend({inheritStyleHandlers:{bold:!0,italic:!0,underline:!0,strike:!0,"font-family":!0,"font-size":!0,color:!0,"back-color":!0,"white-space":!0},constructor:function(t,n,o){e.call(this,t,n,o)},capture:function(t){var e=this.el.getAttribute("href");e&&"#"!==e&&0!==e.indexOf("javascript")&&t&&!0===t.isText?(t.styles.href=t.styles.href||e,this.emit(t)):this.emit(t)}})}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){return n(159).extend({inheritStyleHandlers:!1,inheritBlockStyles:{"line-height":!0,indent:!0,"text-indent":!0},finish:function(){this.emit({isBr:!0,styles:this.styles})}})}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(96),o=n(130),i=n(0),r=n(129),a=n(3);return e.extend({computeBulbStyles:function(){var t,e=this,n=e.el;"hr"===n.getAttribute("yne-bulb-block")&&(t=r.getStyleNamesOfBlock(a.HR),i.each(t,function(t){var o=n.getAttribute("yne-style-"+t);o&&(e.styles[t]=o)}))},finish:function(){var t=new o;this.styles&&t.setBlockStyles(this.styles),this.emit(t)}})}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(155),o=n(63),i=n(291);return e.extend({setup:function(){this.ownerListHandler=this._findOwnerListHandler()},captureBlock:function(t){var e=null;this.emitBlock(),!this._listed&&t.getType&&"paragraph"===t.getType()?((e=this.createBlock()).append(t.getText()),this.emit(e)):this.emit(t)},emit:function(t){t instanceof o&&(this._listed=!0),e.prototype.emit.call(this,t)},createBlock:function(){var t,n,i=this.ownerListHandler;return!this._listed&&i&&i.list?(i.increaseItemCounter(),n=i.list,t=new o({list:n}),n&&n.addItem&&n.addItem(t),t):e.prototype.createBlock.call(this)},_findOwnerListHandler:function(){for(var t=this.parent;t;){if(t instanceof i)return t;t=t.parent}}})}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(96),o=n(115),i=n(134),r=n(132),a=n(117),s=n(116),l=n(163),c=n(288),u=n(2),d=n(8),p=n(0),h=n(592),f=n(206),g=n(3),m=function(t,e,n){if(!t)return n;var o=t.getAttribute(e);return o=parseInt(o||n,10),isNaN(o)&&(o=n),o},y=function(t,e,n){if(!t)return n;var o=t.style[e];return o=parseInt(o||n,10),isNaN(o)&&(o=n),o};return e.extend({DEFAULT_HEIGHT:40,DEFAULT_WIDTH:70,_styleHandlers:{bold:{tagList:["b","strong"],styleHandler:function(t){return f.bold.action(t,{},null)}},lineThrough:{tagList:["strike","s","del"],styleHandler:function(t){return f.strike.action(t,{},null)}},underline:{tagList:["u","ins"],styleHandler:function(t){return f.underline.action(t,{},null)}},italic:{tagList:["i","em","cite","var","address","dfn"],styleHandler:function(t){return f.italic.action(t,{},null)}},fontName:function(t){var e=f["font-family"].action(t,{},null);return e||("FONT"===t.tagName?(e=t.getAttribute("face"))||null:void 0)},fontSize:function(t){var e=f["font-size"].action(t,{},null);if(e)return e+"px"},textColor:function(t){var e=f.color.action(t,{},null);return e||("FONT"===t.tagName?(e=t.getAttribute("color"))||null:void 0)},backColor:function(t){return f["back-color"].action(t,{},null)},textAlign:function(t){return f.align.action(t,{},null)}},_tableStyleHandlers:{verticalAlign:function(t){if(t)return t.style.verticalAlign||t.getAttribute("valign")||(t.tagName&&p.contains(["THEAD","TBODY","TFOOT"],t.tagName)?"middle":void 0)},textAlign:function(t){if(t)return t.style&&t.style.textAlign?t.style.textAlign:t.getAttribute("align")},textColor:function(t){return f.color.action(t,{},null)},backColor:function(t){return t.style.backgroundColor||null},bold:function(t){return t&&t.tagName&&"TH"===t.tagName?"true":f.bold.action(t,{},null)?"true":void 0},italic:function(t){if(f.italic.action(t,{},null))return"true"},underline:function(t){if(f.underline.action(t,{},null))return"true"},lineThrough:function(t){if(f.strike.action(t,{},null))return"true"},fontName:function(t){return f["font-family"].action(t,{},null)},fontSize:function(t){var e=f["font-size"].action(t,{},null);if(e)return e+"px"}},constructor:function(t,e,n,o){this.el=t,this.parent=e,this.internalStylesParser=n,this._parser=o},handleChildrenBySelf:function(){return!0},_inheritStyles:function(t,e,n){var o={};return n=n||{},p.each(this._styleHandlers,function(i,r){var a;!1!==t[r]&&(p.isFunction(i)?a=i(e):(i.styleHandler&&(a=i.styleHandler(e)),!a&&i.tagList&&(a=function(t,e){var n;if(t&&t.tagName){if((n=(t.tagName+"").toLowerCase())===e+"")return!0;if(p.contains(e,n))return!0}}(e,i.tagList))),a&&"inherit"!==a||(a=n[r]),o[r]=a)}),o},_mergeStyles:function(t,e){var n=d.trim(t.value).length;p.each(this._styleHandlers,function(o,i){0===n?e[i]?t[i]=e[i]:t[i]=!1:t[i]&&e[i]!==t[i]&&(t[i]=!1)})},_inheritTableStyles:function(t,e){var n={};return p.contains(["TABLE","THEAD","TBODY","TFOOT","TR","TD","TH"],t.tagName+"")?(e=e||{},p.each(this._tableStyleHandlers,function(o,i){var r=o(t);null!=r&&"inherit"!==r||(r=e[i]),null!=r&&(n[i]=r)}),n):{}},_parseImage:function(t,e){var n,o,i=t.getAttribute("src");if(c.isNoteLink(t))return o=t.getAttribute("alt")||"",void(e.value+=o);i&&(c.isAttachment(t)?(n=t.getAttribute("path"),e.value=s.create({source:i,resource:n,fileLength:c.getAttachmentFileLength(t),fileName:c.getAttachmentFileName(t)})):c.isImage(t)&&(e.value=a.create({source:i})))},_shouldAddLineBreak:function(t){t=(t+"").toLowerCase();return p.contains(["article","aside","blockquote","br","button","caption","col","colgroup","dd","div","dl","dt","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","hr","li","map","ol","output","p","pre","progress","section","textarea","tfoot","ul","video"],t)},_isLinkCell:function(t){if(!t)return!1;var e,n,o,i,r,a,s=t.querySelectorAll("a"),l=function(t){return!t||(1===t.nodeType?""===d.trim(t.textContent||""):3!==t.nodeType||""===d.trim(t.nodeValue||""))};if(!s||!s.length||1!==s.length)return!1;for(e=(n=s[0]).parentNode;e&&e!==t;){for(i=(o=e.childNodes).length,r=0;r<i;r++)if((a=o[r])!==n&&!l(a))return!1;e=(n=e).parentNode}return!0},_parseCell:function(t,e,n){var o,i,l,c,u,d=this,f={value:""},y=d.internalStylesParser,v=r.createBlank(),_=!1;return u=d._parser.parse(t.innerHTML),p.any(u,g.isTextBlock.bind(g))?p.each(u,function(t){g.isTextBlock(t)?v.appendRichText(t.getText()):(g.isImage(t)||g.isAttachment(t)||g.isTable(t)||g.isHr(t))&&d._blockList.push(t)}):p.each(u,function(t){(g.isTable(t)||g.isHr(t))&&d._blockList.push(t),_?(g.isImage(t)||g.isAttachment(t))&&d._blockList.push(t):g.isImage(t)?(v=a.create({source:t.getSource(),width:t.getStyles("width"),height:t.getStyles("height")}),_=!0):g.isAttachment(t)&&(v=s.create({source:t.getSource(),resource:t.getResource(),fileLength:t.getFileLength(),fileName:t.getFileName()}),_=!0)}),(o={value:v}).value&&f.link&&(o.link=f.link),n===d.DEFAULT_HEIGHT&&(o.wrap="true"),p.each(d._styleHandlers,function(t,e){!0===f[e]?o[e]="true":f[e]&&(o[e]=f[e])}),(i=m(t,"colspan",1))>1&&(o.mergeWidth=i,o.mergeHeight=o.mergeHeight||1),(i=m(t,"rowspan",1))>1&&(o.mergeHeight=i,o.mergeWidth=o.mergeWidth||1),l=d._inheritTableStyles(t,e),p.each(l,function(t,e){null==o[e]&&t&&(o[e]=t)}),c=y.getStylesBySpecificity(t,["font-size","font-family","font-style","font-weight","color","background-color","background","text-decoration","text-align","vertical-align","white-space","word-wrap","word-space"]),p.each(c,function(e,n){var o=t.style.getPropertyValue(n);null!=o&&""!==o||t.style.setProperty(n,e)}),p.each(d._tableStyleHandlers,function(e,n){var i=e(t);null==o[n]&&null!=i&&(o[n]=i)}),h(o.backColor)&&delete o.backColor,o},_isArrayFull:function(t,e){var n;if(0===e)return!1;for(n=0;n<e;n++)if(null==t[n])return!1;return!0},_parseTbodyCells:function(t,e,n){var o,i=this,a=p.filter(e.children,i._isTableRow),s=[],l=t.widths.length,c=t.heights.length,u=0;return o=i._inheritTableStyles(e,n),p.each(a,function(e){var n=p.filter(e.children,i._isTableCell),a=i._inheritTableStyles(e,o),d=u,h=s[d];if(0!==n.length){for(;h&&i._isArrayFull(h,l);)u++,h=s[++d];for(h||(h=s[d]=[]),p.each(n,function(e){for(var n,o,l,u,p,f,g,y,v,_=0,b=h[_];b;)b=h[++_];for(n=_,u=i._parseCell(e,a,t.heights[d]),h[n]=u,o=m(e,"rowspan",1),l=m(e,"colspan",1),o>c-d&&(o=c-d,u.mergeHeight=o),p=0;p<o;p++)for((v=s[g=d+p])||(v=s[g]=[]),f=0;f<l;f++)v[y=n+f]||(v[y]={mergePointDX:f,mergePointDY:p,value:r.createBlank(!0)})});h.length<l;)h.push({value:""});u++}}),s},_isTableCell:function(t){if(!t||!t.tagName)return!1;var e=t.tagName||"";return p.contains(["TD","TH"],e)},_isTableRow:function(t){return!(!t||!t.tagName)&&"TR"===t.tagName},_getTbodySize:function(t){var e,n,o,i,r,a,s=this,l=[],c=0,u=0,d=[];for(p.each(t,function(e){var n,o,i=u,r=l[i];if(0!==(n=p.filter(e.children,s._isTableCell)).length){for(;r&&s._isArrayFull(r,c);)r=l[++i];u=i,r||(r=l[i]=[],d[i]=t[i]),p.each(n,function(e,n){var a,c,u,p,h,f=m(e,"colspan",1),g=m(e,"rowspan",1),v=y(e,"width",0)||m(e,"width",0);for(o+=f,v=Math.max(Math.round(v/f),s.DEFAULT_WIDTH),p=n;null!=r[p];)p++;for(u=0;u<f;u++)r[p+u]=v;for(a=1;a<g;a++)for((h=l[c=i+a])||(h=l[c]=[],d[c]=t[c]),u=0;u<f;u++)h[p+u]=v}),o=r.length,c<o&&(c=o)}}),e=l.length,a=[],n=0;n<c;n++){for(i=(l[0]||[])[n]||s.DEFAULT_WIDTH,o=1;o<e;o++)(r=(l[o]||[])[n])&&r>i&&(i=r);a.push(i)}return{rows:e,columns:c,columnWidthList:a,compactTrList:p.compact(d)}},_createBlankRow:function(t){for(var e=[];t>0;)e.push({value:""}),t--;return e},_parseColgroup:function(t){var e=p.filter(t.children,this._isCol);return p.map(e,function(t){return parseFloat(t.style.width)})},_isCol:function(t){return!(!t||!t.tagName)&&"COL"===t.tagName},_parseTbody:function(t,e,n){var o,i,r,a,s=this,l=p.filter(t.children,s._isTableRow),c=0,u={},d=[],h=0;for(l=(a=s._getTbodySize(l)).compactTrList,u.heights=p.map(l,function(t){if(t.style.height)return parseFloat(t.style.height);var e=p.filter(t.children,s._isTableCell),n=0;return p.some(e,function(t){if(!t.getAttribute("rowspan")){var e=y(t,"height",0)||m(t,"height",0);if(e)return n=e,!0}}),n=Math.max(n,s.DEFAULT_HEIGHT)});u.heights.length<a.rows;)u.heights.push(s.DEFAULT_HEIGHT);if(h=0,p.each(a.columnWidthList,function(t){h+=t}),h<n?(i=Math.ceil((n-h)/a.columns),d=p.map(a.columnWidthList,function(t){return t+i})):d=a.columnWidthList,u.widths=d,r=(o=s._parseTbodyCells(u,t,e)).length,(c=u.heights.length)>r)for(;r<c;)o.push(s._createBlankRow(a.columns)),r++;else if(c<r)for(;c<r;)u.heights.push(s.DEFAULT_HEIGHT),c++;return u.cells=o,u},_extendBodyInfo:function(t,e){var n,o,i,r=t.cells,a=t.heights.length;if(!(t.widths.length>=e))for(n=0;n<a;n++)for(i=(o=r[n]).length;i<e;i++)o.push({value:""})},_convertToTableCells:function(t,e){var n,o,a,s,c=t.length,d=[];for(n=0;n<c;n++)for(o=t[n],d[n]=[],a=0;a<e;a++)(s=o[a])?d[n].push(i.create({content:s.value||r.createBlank(),mergeWidth:s.mergeWidth,mergeHeight:s.mergeHeight,mergePointDX:s.mergePointDX,mergePointDY:s.mergePointDY,styles:p.pick(s,l.getAllStyleNames())})):u.error("No tdInfo  at row, col: "+n+", "+a);return d},_mergeTbody:function(t){if(t&&t.length){var e,n=this,o=0,i=[],r=[],a={};return p.each(t,function(t){var n=t.widths.length;n>o&&(o=n,e=t.widths)}),p.each(t,function(t){n._extendBodyInfo(t,o)}),p.each(t,function(t){i=i.concat(t.heights),r=r.concat(t.cells)}),r=n._convertToTableCells(r,o),a.widths=e,a.heights=i,a.cells=r,a}},_parseTable:function(t){var e,n,o=this,i=p.toArray(t.children),r=["thead","tbody","tfoot"],a={thead:[],tbody:[],tfoot:[]},s=[],l=o._blockList.length,c=o._inheritTableStyles(t,{}),u=y(t,"width",0)||m(t,"width",0);o._blockList.push(0),p.each(i,function(t){var e,i=(t.tagName||"").toLowerCase();"colgroup"===i&&(n=o._parseColgroup(t)),p.contains(r,i)&&(e=o._parseTbody(t,c,u),p.extend(e.widths,n),a[i].push(e))}),p.each(r,function(t){var e=a[t];e&&e.length&&(s=s.concat(e))}),(e=o._mergeTbody(s))&&(o._blockList[l]=e)},setup:function(){this._blockList=[]},finish:function(){var t=this;t._parseTable(t.el),p.each(t._blockList,function(e){var n;e&&e.heights&&e.cells&&e.cells.length>0?n=new o({tableCells:e.cells,rowHeights:e.heights,colWidths:e.widths}):e&&(n=e),n&&t.emit(n)})}})}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";o=[n,r,n(0),n(2),n(161)],void 0===(i=function(t,e,n,o,i){return function(){function t(){}return t.renderTable=function(e,n,o){var i,r,a,s,l=e.getRowCount(),c=e.getColumnCount();for(i=(n=n||t._createTableEl()).querySelector("tbody"),t.table=e,a=0;a<l;a++){for(r=document.createElement("tr"),s=0;s<c;s++)e.getCell(a,s).isMergedCell()||r.appendChild(t._renderCell(a,s,null,{resourceMap:o}));r.style.height=e.getRowHeight(a)+"px",i.appendChild(r)}return t._renderColumns(n.querySelector("colgroup")),t.table=null,$(n).css({"border-collapse":"collapse","table-layout":"fixed","white-space":"nowrap",width:0}),n},t._createTableEl=function(){var t=document.createElement("table");return t.innerHTML="<colgroup></colgroup><tbody></tbody>",t},t._handleMergePointIfNeeded=function(t,e){if(e.isMergePoint()){var n=e.getMergePointAttr();n.width>0&&t.setAttribute("colspan",n.width),n.height>0&&t.setAttribute("rowspan",n.height)}},t._renderCell=function(e,o,r,a){r=r||document.createElement("td"),$(r).css({"font-size":14,color:"#393939",border:"1px solid #a7a7a7",overflow:"hidden","vertical-align":"middle","word-wrap":"break-word","background-color":"rgba(255, 255, 255, 0.3)"}),a=n.defaults(a||{},{withCellId:!0,resourceMap:null});var s,l=t.table.getCell(e,o),c=l.getContent();return a.withCellId&&r.setAttribute("data-cell-id",l.getCellId()),t._handleMergePointIfNeeded(r,l),t._setCellStyles(r,l.getBlockStyles(),!0),s=i.contentToHtml(c,a.resourceMap),r.innerHTML=s,r},t._renderColumns=function(e){var n=t.table;e?(e.innerHTML="",n.forEachColumn(function(t){var o=n.getColumnWidth(t),i=document.createElement("col");i.style.width=o+"px",e.appendChild(i)})):o.warn("parameter is not valid",e)},t._setCellStyles=function(t,e,n){var o;n=!1!==n,o=e.textAlign,t.style.textAlign="center"===o||"right"===o||"left"===o?o:"",o=e.verticalAlign,t.style.verticalAlign="top"===o||"middle"===o||"bottom"===o?o:"",n||"true"===e.wrap?t.style.whiteSpace="pre-wrap":t.style.whiteSpace="nowrap",o=e.backColor,t.style.backgroundColor=o&&"inherit"!==o&&"transparent"!==o?o:""},t}()}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";o=[n,r,n(109)],void 0===(i=function(t,e,n){return n({textAlign:{type:"Enum",possible:{left:!0,right:!0,center:!0,justify:!0},default:"left"},verticalAlign:{type:"Enum",possible:{top:!0,middle:!0,bottom:!0},default:"left"},wrap:{type:"Boolean",default:!1},backColor:{type:"String",default:"transparent"},"border|vertical":{type:"String",default:"1px solid #a7a7a7"},"border|horizontal":{type:"String",default:"1px solid #a7a7a7"}})}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(){return function(t,e,n,o){var i,r,a;for(i=0;i<n;i++)if(a=e?n-i-1:i,null==o){if(!1===t(a))return}else for(r=0;r<o;r++)if(!1===t(a,e?o-r-1:r))return}}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";o=[n,r,n(116),n(117)],void 0===(i=function(t,e,n,o){return{attach:n,image:o}}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";o=[n,r,n(0),n(587),n(588),n(589),n(590)],void 0===(i=function(t,e,n,o,i,r,a){var s=[o,i,r,a];return function(t){t=t||{};var e,o,i,r=JSON.parse(JSON.stringify(t)),a=s.length,l=r,c=[],u=function(t){c.push(o.name+".js: "+t)};for(e=0;e<a;e++){if(i=(o=s[e]).checkAndFix(l),n.each(i.errors,u),!0===i.stopCheck)return{errors:c,fixedData:i.fixedData};l=i.fixedData}return{errors:c,fixedData:l}}}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";o=[n,r,n(0),n(218)],void 0===(i=function(t,e,n,o){return function(){function t(){}return t.checkAndFix=function(t){var e,i,r,a=t.cells,s=a.length,l=!1,c=!1,u=[];for(e=0;e<s;e++)i=a[e],n.isObject(i)?null==(r=i.value)||n.isString(r)||(c=!0,i.value=r+""):(l=!0,a[e]=o());return l&&u.push("Some cell is NOT Object type"),c&&u.push("The value of some cell is not String type"),{errors:u,fixedData:t,stopCheck:!1}},t}()}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";o=[n,r,n(0)],void 0===(i=function(t,e,n){return function(){function t(){}return t.checkAndFix=function(e){var o=e.cells,i=e.heights,r=e.widths,a=t.IS_VALID(o,i.length,r.length),s=[];return!0!==a&&(s.push(a),n.each(o,function(t){delete t.mergeWidth,delete t.mergeHeight,delete t.mergePointDX,delete t.mergePointDY})),{errors:s,fixedData:e,stopCheck:!1}},t.IS_VALID=function(t,e,o){var i={},r="";return n.some(t,function(e,a){if(!i[a+""]){var s,l,c,u,d,p,h,f,g,m,y;if(e.mergeWidth||e.mergeHeight){if(e.mergeWidth&&!n.isNumber(e.mergeWidth))return r="The mergeWidth is not Number type",!0;if(e.mergeHeight&&!n.isNumber(e.mergeHeight))return r="The mergeHeight is not Number type",!0;if(null!=e.mergePointDX||null!=e.mergePointDY)return r="The cell data is not valid, index: "+a,!0;for(s=e.mergeWidth||1,l=e.mergeHeight||1,c=Math.floor(a/o),u=a%o,f=0;f<l;f++)for(d=c+f,h=0;h<s;h++)if(f>0||h>0){if((g=t[p=d*o+(u+h)]).mergeWidth||g.mergeHeight)return r="The merged cell should not have `mergeWidth` or `mergeHeight`, merge point cell index: "+a+", merged cell index: "+p,!0;if(g.value)return r="The `value` of merged cell should be empty string,merge point cell index: "+a+", index: "+p,!0;if(m=g.mergePointDX||0,y=g.mergePointDY||0,m!==h||y!==f)return r="The `mergePointDX` or `mergePointDY` of mergedCell is not valid, merge point cell index: "+a+",  merged cell index: "+p,!0;i[p+""]=!0}}i[a+""]=!0}}),r||!0},t}()}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";o=[n,r,n(0)],void 0===(i=function(t,e,n){return function(){function t(){}return t.checkAndFix=function(t){var e=t.cells,o=!1,i=[];return n.each(e,function(t){t.mergeWidth&&!t.mergeHeight?(t.mergeHeight=1,o=!0):t.mergeHeight&&!t.mergeWidth&&(t.mergeWidth=1,o=!0)}),o&&i.push("Some cell has no default value for mergeHeight or mergeWidth"),{errors:i,fixedData:t,stopCheck:!1}},t}()}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";o=[n,r,n(0),n(135),n(218),n(591)],void 0===(i=function(t,e,n,o,i,r){return function(){function t(){}return t.checkAndFix=function(t){if(!t.cells||!n.isArray(t.cells))return{errors:["The `cells` property is not Array type!"],fixedData:r(),stopCheck:!0};var e,a,s=t.cells,l=t.widths,c=t.heights,u=!0,d=!0,p=[];for(l&&n.isArray(l)||(u=!1,p.push("The `widths` property is not Array type!")),c&&n.isArray(c)||(d=!1,p.push("The `heights` property is not Array type!")),u||d?u?d||(c=[],0===l.length&&(l.length=5),c.length=Math.ceil(s.length/l.length)):(l=[],0===c.length&&(c.length=5),l.length=Math.ceil(s.length/c.length)):((l=[]).length=5,(c=[]).length=Math.ceil(s.length/l.length)),e=l.length*c.length,a=!1;e<s.length;)c.push(o.DEFAULT_ROW_HEIGHT),e=l.length*c.length,a=!0;for(a&&p.push("The widths.length * heights.length is less than cells.length"),e=l.length*c.length,a=!1;e>s.length;)s.push(i()),a=!0;return a&&p.push("The widths.length * heights.length is greater than cells.length"),a=!1,l=n.map(l,function(t){return t&&n.isNumber(t)?t:(a=!0,o.DEFAULT_COL_WIDTH)}),a&&p.push("The `widths` has unvalid value"),a=!1,c=n.map(c,function(t){return t&&n.isNumber(t)?t:(a=!0,o.DEFAULT_ROW_HEIGHT)}),a&&p.push("The `heights` has unvalid value"),{errors:p,fixedData:{cells:s,heights:c,widths:l},stopCheck:!1}},t}()}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";o=[n,r,n(135),n(218)],void 0===(i=function(t,e,n,o){return function(t,e){var i,r=[],a=[],s=[],l=(t=t||1)*(e=e||1);for(i=0;i<t;i++)a.push(n.DEFAULT_ROW_HEIGHT);for(i=0;i<e;i++)r.push(n.DEFAULT_COL_WIDTH);for(i=0;i<l;i++)s.push(o());return{cells:s,heights:a,widths:r}}}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(43);return function(t){return!!t&&e.equals(t,"white")}}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(0),o=n(80);return n(159).extend({finish:function(){var t,n,i=this.el;"todo"===i.getAttribute("data-media-type")&&(t=i.getAttribute("data-attr-content"),n=i.getAttribute("data-attr-checked"),e.isUndefined(t)&&e.isUndefined(n)||this.emit(new o({text:t||"",checked:"true"===n})))}})}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(155),o=n(62),i=n(63),r=n(2),a=n(0),s=n(4);return e.extend({setup:function(){var t,n,i,r,a,l,c=this.getRoot();e.prototype.setup.call(this),(t=this.el.getAttribute("style"))&&(n=/mso-list:(l\d+) (level\d+)/.exec(t))&&(r=n[1],a=n[2],(i=this._getStyles()["list "+r+":"+a])&&((l=c["mso-"+r])||(l=c["mso-"+r]=new o({type:"bullet"===i["mso-level-number-format"]?o.UNORDERED:o.ORDERED,listId:s.newGUID()})),this.list=l,this.level=Number(a.replace("level","")),this.el.querySelector('[style="mso-list:Ignore"]').remove()))},createBlock:function(){if(!this.list)return e.prototype.createBlock.call(this);var t=this.list,n=new i({list:t,level:this.level});return t&&t.addItem&&t.addItem(n),n},_getStyles:function(){var t,e=this.getRoot(),n=this.el.ownerDocument,o={};return e.msoStyles?e.msoStyles:(t=n.querySelectorAll("style"),a.each(t,function(t){var e,n,i;1===t.childNodes.length&&3===t.firstChild.nodeType&&(e=t.firstChild.textContent,n=o,null!==(i=e.match(/(@[\w_\-:\s]+)\n\s*\{(.|\n)*?\}/gm))&&i.forEach(function(t){var e=/@([\w_\-:\s]+)/.exec(t)[1].trim(),o=t.substring(t.indexOf("{")+1,t.indexOf("}")).trim(),i={};o.split(";").forEach(function(t){var e;-1!==t.indexOf(":")&&(e=t.split(":"),i[e[0].trim()]=e[1].trim())}),n[e]||(n[e]={}),a.extend(n[e],i)}))}),r.log(o),e.msoStyles=o,o)}})}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(2),o=n(0),i=n(596);return function(t,n,r,a){var s,l=[];if(t){if((s=t.split(/\r\n?|\n/))&&s.length)return o.each(s,function(t){var e=i(t,o.clone(n),o.clone(r),a);e&&l.push(e)}),e.log("to paste text",l),l;e.warn("lines do not exist or lines.length is 0!")}else e.warn("no text when paste plain text!")}}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(597),o=n(28),i=n(164),r=n(0);return function(t,n,a,s){if(null!=t){var l,c,u=new o;return s||(l=i.matchEnd(t))&&0===l.result.index&&r.extend(n||(n={}),{href:l.fullURI,underline:!0,color:"#003884"}),c=e(t,n),u.setText(c),a&&r.each(a,function(t,e){u.setBlockStyle(e,t)}),u}}}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(12);return function(t,n){var o;return t=(t+="").replace(/[\r\n]/g,""),o=new e({text:t}),n&&o.setStyles(0,o.getLength(),n),o}}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(2),o=n(0),i=n(62),r=n(112),a=n(3),s=n(599),l=n(4);return function(t,n){var c,u,d,p=[],h={},f={},g={};if(o.isString(t))try{c=window.JSON.parse(t)}catch(n){e.error("parse json string error: ",t)}else o.isArray(t)&&(c=t);if(c&&c.length)return e.log("createBlocksFromJSON array: ",c),o.each(c,function(t){var e;(e=s(t,n))&&(t.listId&&t.listType&&a.isListItem(e)&&(u=t.listId,(d=h[u])||(d=new i({type:t.listType,listId:t.listId}),h[u]=d),e.setOwnerList(d)),t.ownerId&&a.isCatalogue(e)&&(u=t.ownerId,g[u]||(g[u]=l.newGUID(),f[g[u]]=new r({id:g[u]})),d=f[g[u]],e.setOwnerList(d)),p.push(e))}),p}}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(131),o=n(3),i=n(97),r=n(128),a=n(130),s=n(81),l=n(63),c=n(28),u=n(115),d=n(80),p=n(165),h=n(82),f=n(290),g=n(2);return function(t,n){if(t&&(t.blockType||t.type)){var m,y=t.blockType||t.type;switch(y){case o.PARAGRAPH:m=c.fromJSON(t,n);break;case o.LIST_ITEM:m=l.fromJSON(t);break;case o.IMAGE:m=s.fromJSON(t);break;case o.ATTACHMENT:m=e.fromJSON(t);break;case o.TABLE:m=u.fromJSON(t,!0);break;case o.HR:m=a.fromJSON(t);break;case o.HEADING:m=r.fromJSON(t);break;case o.CATALOGUE:m=i.fromJSON(t);break;case o.TODO:m=d.fromJSON(t);break;case o.QUOTE:m=p.fromJSON(t);break;case o.CODE:m=h.fromJSON(t);break;case o.HANDWRITE:m=f.fromJSON(t);break;default:g.warn("jsonObj.blockType = "+y)}return m}g.warn("jsonObj is null or jsonObj has no `blockType` property!")}}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(2),o=n(0),i=n(12),r=n(28),a={create:function(){var t={data:{},push:function(e,n){n||(n=1),t.data[e]?t.data[e]+=n:t.data[e]=n},count:function(){return Object.keys(t.data).length},mergeKeys:function(e){var n,i,r,s,l,c=a.create(),u=t.data;return o.each(t.orderedKeys(),function(t){r&&t-r<e?(s=u[r],l=u[t],n=(r*s+t*l)/(i=s+l),c.push(n,i),r=null):(r&&c.push(r,u[r]),r=t)}),r&&c.push(r,u[r]),c.count()!==t.count()?c.mergeKeys(e):c},mostFrequencyKey:function(){var e,n=0;return o.each(t.data,function(t,o){t>=n&&(n=t,e=parseInt(o))}),e},orderedKeys:function(){return Object.keys(t.data).sort(function(t,e){return t-e})}};return t}},s=function(t,e){return"yd"===e?function(t){var e={},n=t.split(",");return e.left=parseInt(n[0]),e.top=parseInt(n[1]),e.right=parseInt(n[2]),e.bottom=parseInt(n[5]),e.width=e.right-e.left,e.height=e.bottom-e.top,e}(t):function(t){var e={},n=t.split(",");return e.left=parseInt(n[0]),e.top=parseInt(n[1]),e.width=parseInt(n[2]),e.height=parseInt(n[3]),e.right=e.left+e.width,e.bottom=e.top+e.height,e}(t)},l=function(t,e){var n,i,r=t.json,a=e.type,l=[];for(r.box=s(r.boundingBox,a),o.each(r.lines,function(t){var e,i="";t.box=s(t.boundingBox,a),"ms"===a&&(o.each(t.words,function(t){t.box=s(t.boundingBox,a),function(t){return/^[a-z][a-z\d\s.,\/#!$%\^&\*;:{}=\-_`~()]*$/i.test(t)}(t.text)&&(i+=" "),i+=t.text}),t.text=i),!function(t){var e=!1;return[/Epdf/,/For Evaluation Purposes Only/].forEach(function(n){n.test(t)&&(e=!0)}),e}(t.text)?(n&&function(t,e){var n=(e.box.bottom-t.box.top)/t.box.height,o=(e.box.bottom-t.box.top)/e.box.height;return Math.max(n,o)>.8}(t,n)&&(!function(t,e){t.box.top=t.box.top<e.box.top?t.box.top:e.box.top,t.box.bottom=t.box.bottom>e.box.bottom?t.box.bottom:e.box.bottom,t.box.left=t.box.left<e.box.left?t.box.left:e.box.left,t.box.right=t.box.right>e.box.right?t.box.right:e.box.right,t.box.height=t.box.bottom-t.box.top,t.box.width=t.box.right-t.box.left,t.words=e.words.concat(t.words),t.text=e.text+"  "+t.text}(t,n),e=r.lines.indexOf(n),l.push(e)),n=t):(e=r.lines.indexOf(t),l.push(e))}),i=l.length-1;i>=0;i-=1)r.lines.splice(l[i],1)},c=function(t,e){var n={};return n.json=t,l(n,e),e.parseParagraph?(function(t){var e,n=t.json,i=a.create(),r=a.create(),s=a.create(),l=a.create(),c={};o.each(n.lines,function(t){i.push(t.box.left),r.push(t.box.right),e&&s.push(t.box.bottom-e.box.bottom),e=t,l.push(t.box.height)}),c.baseLineHeight=s.mostFrequencyKey(),c.baseFontHeight=l.mergeKeys().mostFrequencyKey(),c.regionLeft=i.mergeKeys(c.baseFontHeight).mostFrequencyKey(),c.regionRight=r.mergeKeys(c.baseFontHeight).mostFrequencyKey(),t.stat=c}(n),function(t){var e,n,o,i,r,a,s=t.json,l=[],c=t.stat.regionLeft,u=t.stat.regionRight,d=t.stat.baseFontHeight,p=t.stat.baseLineHeight,h=!1,f=!1,g="";for(e={startLineIndex:0},r=0;r<s.lines.length;r+=1){if(h=f,c+1.5*d<(i=s.lines[r]).box.left&&r!==e.startLineIndex&&(h=!0),o&&i.box.bottom-o.box.bottom>1.5*p&&(h=!0),h){for(e.endLineIndex=r-1,e.text=g.trim(),l.push(e),n=Math.floor((i.box.bottom-o.box.bottom)/p-1),a=0;a<n;a+=1)l.push({text:""});e={startLineIndex:r},g=i.text}else g+=i.text;o=i,f=u-1.5*d>i.box.right}e.endLineIndex=r,e.text=g,l.push(e),t.paragraphs=l}(n),e.parseIndent&&function(t){var e=t.json,n=t.stat,i=t.paragraphs;o.each(i,function(t){var o,i=e.lines[t.startLineIndex];i&&(Math.ceil((i.box.left-n.regionLeft)/n.baseFontHeight)/2>=1?t.text="\t"+t.text:(t.startLineIndex+1<=t.endLineIndex&&(o=e.lines[t.startLineIndex+1]),o&&Math.ceil((i.box.left-o.box.left)/n.baseFontHeight)/2>=1&&(t.text="\t"+t.text)))})}(n)):function(t){var e,n=t.json;e={startLineIndex:0,endLineIndex:n.lines.length-1,text:""},o.each(n.lines,function(t){e.text+=t.text}),t.paragraphs=[e]}(n),n};return function(t,n){var a,s,l=[];if(o.isString(t))try{a=window.JSON.parse(t)}catch(n){e.error("parse json string error: ",t)}return a&&o.each(a,function(t){o.each(t.regions,function(t){var e=c(t,n);o.each(e.paragraphs,function(t){s=function(t){var e,n,o,a=new r;return o=t.fontSize,e=(e=t.text).replace(/[\r\n]/g,""),(n=new i({text:e})).setStyle(0,n.getLength(),"font-size",o),a.setText(n),a}(t),l.push(s)})}),l.push(new r)}),l}}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";var a,s=this&&this.__extends||(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});o=[n,r,n(0),n(27),n(2)],void 0===(i=function(t,e,n,o,i){return function(t){function e(e,o,r,a,s){var l=t.call(this,{})||this;return l.listItemNodeProps={},i.DEBUG&&(l.listItemNodeProps.debugId=n.uniqueId()),l.listItemNodeProps.level=e||0,l.listItemNodeProps.block=o,l.listItemNodeProps.start=r,l.listItemNodeProps.end=a,l.addChildNodes(s),l}return s(e,t),e.prototype.addChildNodes=function(t){var e=this;t&&(n.isArray(t)||(t=[t]),n.each(t,function(t){t.parentNode=e,e.childNodes||(e.childNodes=[]),e.childNodes.push(t)}))},e.prototype.childrenCount=function(){return this.childNodes?this.childNodes.length:0},e.prototype.getChildStartIndex=function(){var t=(this.childNodes||[])[0];return t?t.getStartIndex():1},e.prototype.getLevel=function(){return this.listItemNodeProps.level},e.prototype.getParentNode=function(){return this.parentNode},e.prototype.getStartIndex=function(){return this.listItemNodeProps.block?this.listItemNodeProps.block.getIndex():1},e.prototype.hasChildren=function(){return this.childrenCount()>0},e.prototype.isChildOrdered=function(){var t=(this.childNodes||[])[0];return!!t&&t.isOrdered()},e.prototype.isOrdered=function(){return this.listItemNodeProps.block?this.listItemNodeProps.block.isOrdered():!!this.parentNode&&this.parentNode.isOrdered()},e.prototype.toHtml=function(t){var e,o,i,r,a,s,l=this.listItemNodeProps.block,c=[];return t=!0===t,this.hasChildren()?(a=l?l.toHtml(this.listItemNodeProps.start,this.listItemNodeProps.end,t):"",c.push(a),i="<"+(e=this.isChildOrdered()?"ol":"ul")+' yne-block-type="list" style="margin:0px " ',(o=this.getChildStartIndex())>1&&(i+=' start="'+o+'"'),i+=">",c.push(i),s=this.childNodes,n.each(s,function(e){var n=e.toHtml(t);c.push(n)}),r="</"+e+">",c.push(r)):(a=l?l.toHtml(this.listItemNodeProps.start,this.listItemNodeProps.end,t):"<li></li>",c.push(a)),c.join("")},e.prototype.initialize=function(){},e}(o)}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";o=[n,r,n(0),n(131),n(97),n(128),n(130),n(81),n(63),n(28),n(165),n(115),n(80),n(82),n(293)],void 0===(i=function(t,e,n,o,i,r,a,s,l,c,u,d,p,h,f){var g={attach:o,catalogue:i,heading:r,"horizontal-line":a,image:s,"list-item":l,para:c,code:h,quote:u,table:d,todo:p,unknown:f};return n.each(g,function(t,e){t.prototype.xmlNodeName=e}),g}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";var a,s=this&&this.__extends||(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});o=[n,r,n(0),n(7),n(604),n(82),n(81),n(605),n(608),n(625),n(270),n(12),n(51),n(295),n(50),n(230),n(121),n(711),n(712),n(713),n(2),n(714),n(737),n(739),n(782),n(785),n(845),n(3)],void 0===(i=function(t,e,n,o,i,r,a,l,c,u,d,p,h,f,g,m,y,v,_,b,C,k,w,S,x,E,I,T){return function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.prototype.callMacNativeApi=function(t,e){return w.callNativeApi(t,e)},e.prototype.canRemoveFormat=function(){return this.controller.canRemoveFormat()},e.prototype.getNoteViewWrapper=function(){return this.$noteViewWrapper},e.prototype.getNoteViewFrame=function(){return this.$noteViewFrame},e.prototype.initNoteViewWrapper=function(){var t,e,n,o,i=this,r=$(i.editorProps.parentEl);i.$noteViewWrapper||(i.$noteViewWrapper=$('<div class="note-view-wrapper"></div>'),i.$noteViewFrame=$('<div class="note-view-frame"></div>'),i.$noteViewWrapper.append(i.$noteViewFrame),r.append(i.$noteViewWrapper),i.progressTracker=new I({}),null!=i.noteView&&i.noteView.setOptions({noteviewFrame:i.getNoteViewFrame(),noteviewWrapper:i.getNoteViewWrapper()})),i._updateNoteViewWrapperSize(),o=window.devicePixelRatio,t=function(){var a=!1;e!==r.width()&&(a=!0,e=r.width()),n!==r.height()&&(a=!0,n=r.height()),o!==window.devicePixelRatio&&(a=!0,o=window.devicePixelRatio),a&&i.onResize(),setTimeout(t,500)},setTimeout(t,500)},e.prototype.insertNoteLink=function(t,e){if(t&&e){var n,o,i=y.fillAsUrl(t);o=(n=new p({text:e})).getLength(),n.setStyles(0,o,{color:"rgb(0, 56, 132)",href:i,underline:!0}),this.insertText(n,!1)}},e.prototype.insertText=function(t,e){this.controller.insertText(t,e)},e.prototype.isLegacyHost=function(){var t=!0;return null!=this.getEditorProps().webVersion&&(t=!1),t},e.prototype.isSameList=function(t){return this.controller.isSameList(t)},e.prototype.onResize=function(){this._updateNoteViewWrapperSize(),this.noteView.trigger("resize")},e.prototype.render=function(){var t=this.noteView;t&&(this.toolbar.render(),$(this.editorProps.parentEl).append(this.toolbar.$el),this.toolbar.shrink(),this.initNoteViewWrapper(),this.$noteViewFrame.append(t.$el),this.$noteViewWrapper.append(this.linkView.$el),t.setOptions({pageType:this.editorProps.pageType}),this.setViewMode(this.editorProps.viewMode,!0,!1),t.render(),this.$noteViewWrapper.append(this.imgTitleInput.$el))},e.prototype.reset=function(){t.prototype.reset.call(this),this.toolbar.$el.find(".button-undo").removeClass("active"),this.toolbar.$el.find(".button-redo").removeClass("active"),this.toolbar&&(this.toolbar.reset(),this.toolbar.isRendered&&this.toolbar.show())},e.prototype.setDefaultFont=function(t,e,n){var o=h.getFontFirstValue(t),i=f.getAsArray();o&&(this.defaultFontName=o),i.indexOf(e)>-1&&(this.defaultFontSize=e),this.note&&(this.note.isEmptyContent()||n&&n.setNotEmptyContent)&&this.useDefaultFontAsEditingStyle()},e.prototype.setHtmlContent=function(t,e,n,o){this._setContent(!1,t,e,n,o)},e.prototype.setXmlContent=function(t,e,n,o){this._setContent(!0,t,e,n,o)},e.prototype.showToolbar=function(){this.toolbar&&this.toolbar.isRendered&&this.toolbar.show()},e.prototype.updateFormatPainterCursorUI=function(t){this.noteView.updateFormatPainterCursorUI(t)},e.prototype.useDefaultFontAsEditingStyle=function(){this.controller.setDefaultFont(this.defaultFontName,this.defaultFontSize)},e.prototype.setPrintNote=function(t){this.toPrintPage=t},e.prototype.getPrintNote=function(){return this.toPrintPage},e.prototype.getFirstLineTextContent=function(){var t,e=this._firstNotEmptyTextBlockIndex(),n="";return-1===e?"":((t=this.note.getBlockAt(e))instanceof r?t.getRichTexts().map(function(t){for(;n.length>100;)return n;n+=t.toString().replace(/\s+/g,"")}):n=t.toPlain(),n)},e.prototype.updateImageByOrigSrc=function(t,e){var n=this.note.getBlockById(e.blockId),o=this.noteView.getBlockViewByBlock(n);n instanceof a&&(e.exifData&&o.rotateImage(e.exifData),n.setSource(t),o.renderImageSource(t),this.trigger("yne-content-change"))},e.prototype.rotateImage=function(t,e){if(t&&e){var n=this.note.getBlockById(t),o=this.noteView.getBlockViewByBlock(n);n instanceof a&&o.rotateImage(e)}},e.prototype.bindEventsForController=function(){this.controller?(t.prototype.bindEventsForController.call(this),g.bubble(["yne-selection-change","yne-editing-state-change","yne-replace-image","yne-replace-attachment","yne-open-link","yne-download-attachment","yne-download-image","yne-get-entity","yne-preview-image","yne-get-exif-data","yne-replace-img-url","contextmenu","yne-show-words","yne-save-content","yne-blob-paste","yne-get-image-url","yne-need-paste","yne-require-innerlink","yne-request-image-rendered-src"],this.controller,this),g.bubble({find:"yne-find"},this.controller,this)):C.warn("no controller!")},e.prototype.initialize=function(e){this.editorProps=e||{},this.editorProps.theme=this.editorProps.theme||"",$(this.editorProps.parentEl).html(""),this.editorProps.theme&&$(this.editorProps.parentEl).addClass(this.editorProps.theme),m.setUseConvert(this.editorProps.useHttpsConvert),n.bindAll(this,"_updateNoteViewWrapperSize","onResize"),this.note=d.createBlank(!0),this.noteView=new E({editor:this,inlineStyleViewMapper:x,note:this.note}),this.linkView=new b({editor:this}),this.imgTitleInput=new _({editor:this}),this.controller=new u({editor:this,imgTitleInput:this.imgTitleInput,note:this.note,noteView:this.noteView,removeLocalImg:this.editorProps.removeLocalImg}),this.toolbar=new S({editor:this}),this._initContextMenu(),this._addEventListener(),t.prototype.initialize.call(this,e),this.colorpicker=new v({editor:this}),$(this.editorProps.parentEl).append(this.colorpicker.$el),g.bubble(["color-picker-show"],this,this.colorpicker)},e.prototype.updateContainerBackground=function(t){var e=this.noteView.$el;return this.currentBackground!==t&&(t&&t!==o.DEFAULT_BACKGROUND?(e.css("background-image",'url("'+t+'")'),this.currentBackground=t):(e.css("background-image",""),this.currentBackground=o.DEFAULT_BACKGROUND),!0)},e.prototype._addEventListener=function(){this.noteView.on("blur",this._onBlur.bind(this)),this.noteView.on("focus",this._onFocus.bind(this))},e.prototype._initContextMenu=function(){var t,e,o,r=this;if(!r.contextMenu&&(t=r.contextMenu=new i({editor:r}),e=n.map(k,function(t){return t()}),t.addItems(e),r.on("contextmenu",function(e){var n=l(r);t.onContextMenu(e,n)}),C.DEBUG)){if((o=(window.ynote||{}).toString())&&o.indexOf("ObjCRuntimeObject")>-1)return;r.on("yne-context-menu",function(t,e,o){var i,r,a=[];n.each(e,function(t){if(!t.isHidden)if(2!==t.type){var e=t.isDisabled?"[":" ",n=t.isDisabled?"]":" ";a.push(e+t.index+". "+t.label+n)}else a.push("------------------")}),i="context-menu: \n"+a.join("\n"),(r=window.prompt(i))&&(r=parseInt(r,10),isNaN(r)||o(r))})}},e.prototype._onBlur=function(){var t=this.controller.noteSelection;this.oldRangeWhenBlur=t.getRange()},e.prototype._onFocus=function(){var t=this.controller.noteSelection;this.oldRangeWhenBlur&&t.setRange(this.oldRangeWhenBlur)},e.prototype._setContent=function(t,e,o,i,r){var a=this,s=this,l=!0===i.isAsync,c=i.isReadOnly,u=function(t){t.isAsync=l,s.updateContentSetProgress(t),t.percent>=1&&(s.isDataFixed()&&s.trigger("yne-content-change"),s.makeReadOnly(c),null!=r&&r({resultCode:1}),a.getPrintNote()&&(window.print(),a.setPrintNote(!1)))};s.reset(),s.contentLoading=!0,s.updateContentSetProgress({percent:0,message:"加载中",isAsync:l}),null==i?s.noteProps=s.options||{}:(s.noteProps={},n.extend(s.noteProps,i)),s.controller.setOptions({note:s.note}),s.noteView.setOptions({isNoteSet:!0,note:s.note,pageType:s.editorProps.pageType}),s.setViewMode(s.editorProps.viewMode,!0,!1),s.setReadOnly(!0),s.setBackground(s.noteProps.bgImageId),!s.noteProps.isReadOnly&&s.isCollabEnabled()&&s.makeReadOnly(!0),s.controller.setDefaultFont(s.noteProps.defaultFontName,s.noteProps.defaultFontSize),s.noteView.render(),s.updateContentSetProgress({percent:.05,isAsync:l}),t?d.fromXml(e,s.note,o,{progressCallBack:u,isAsync:l}):null==d.fromHtml(e,s.note,o,{progressCallBack:u,isAsync:l})&&(d.createBlank(!0,s.note),u({percent:1})),s.notSetContent=!1},e.prototype._updateNoteViewWrapperSize=function(){var t,e=this.$noteViewWrapper,n=$(this.editorProps.parentEl);e&&(t=$(e)).height(n.height()-this.toolbar.$el.outerHeight()-t.outerHeight()+t.height())},e.prototype._firstNotEmptyTextBlockIndex=function(){var t,e,n=this.note.blocks,o=n.length,i=-1;for(t=0;t<o;t++)if(e=n[t],T.isTextOrTableBlock(e)&&!e.isEmptyContent()){i=t;break}return i},e}(c)}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";var a,s=this&&this.__extends||(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});o=[n,r,n(0),n(26),n(2),n(20)],void 0===(i=function(t,e,n,o,i,r){return function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.filterItems=function(t){var o=!1,i=[];return n.each(t,function(t){var a=t;switch(t&&t.simplify&&(a=t.simplify()),a.type){case r.TYPE.SPLIT:o||(o=!0,i.push(a));break;case r.TYPE.SUBMENU:a.isHidden||(o=!1,a=n.extend({},a,{items:e.filterItems(a.items)}),i.push(a));break;default:a.isHidden||(o=!1,i.push(a))}}),i},e.prototype.addItems=function(t){this.items=this.items.concat(t),n.each(t,this.prepareItem.bind(this))},e.prototype.onContextMenu=function(t,o){var i,r=this,a={left:t.pageX,top:t.pageY};r.resetAll(),n.invoke(r.items,"checkStatus",t,o||{}),i=e.filterItems(r.items),r.editor.trigger("yne-context-menu",a,i,function(t){r.select(t),r.resetAll()})},e.prototype.prepareItem=function(t){var e=t.keyHandlerName;t.index=this.indexArray.length,t.editor=this.editor,e&&!this.editor.getController().hasKeyHandler(e)&&i.error("The keyHandlerName ["+e+"] of ContextMenuItem ["+t.name+"] does not exist!"),this.indexArray.push(t),t.type===r.TYPE.SUBMENU&&n.each(t.items,this.prepareItem.bind(this))},e.prototype.resetAll=function(){var t;n.map(this.items,function(e){if((t=e.reset)&&n.isFunction(t))return t.apply(e)})},e.prototype.select=function(t){var e=this.indexArray[t];if(e&&!e.items&&e.select)return e.select()},e.prototype.initialize=function(t){this.editor=t.editor,this.items=[],this.indexArray=[]},e}(o)}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(3),o=n(0),i=n(79),r=n(8),a=n(21),s=n(99),l={imageBlock:function(t,n,o){var i,r=t.getNoteRange();r&&r.isInSingleBlock()&&(i=r.getStartBlockRange().block,e.isImage(i)&&(o.imgBlock=i,o.isImgAttachBlock=!0))},attachmentBlock:function(t,n,o){var i,r=t.getNoteRange();r&&r.isInSingleBlock()&&(i=r.getStartBlockRange().block,e.isAttachment(i)&&(o.attachmentBlock=i,o.isImgAttachBlock=!0))},codeBlock:function(t,n,o){var i,r=t.getNoteRange();r&&r.isInSingleBlock()&&(i=r.getStartBlockRange().block,e.isCode(i)&&(o.codeBlock=i,o.isCodeBlock=!0))},tableBlock:function(t,n,i){var r,a,l,c,u=t.getNoteRange();if(u&&u.isInSingleBlock()&&(c=(a=u.getStartBlockRange()).block,e.isTable(c))){if(!(l=a.getAsRectRange()))return;r={},l.onlyMergePointAndCell()&&(r.onlyMergePointAndCell=!0),l.isOnlyImgCell()&&o.extend(r,{cell:l.getFirstCell().cell,type:s.IMAGE}),l.isOnlyAttachCell()&&o.extend(r,{cell:l.getFirstCell().cell,type:s.ATTACHMENT}),i.tableInfo=r}},hrefInfo:function(t,e,n){var o,s,l,c,u,d,p,h,f=e.target;r(f).is(".block-view a *")&&(o=function(t,e){if(t&&t.parentNode)for(var n=t.parentNode;n;){if(n.webkitMatchesSelector&&n.webkitMatchesSelector(e))return n;n=n.parentNode}}(f,"a"))&&((s=document.createRange()).selectNodeContents(o),l=a.fromNativeRange(s,t.noteView),s.detach(),l&&l.isInSingleBlock()&&((u=(c=l.getStartBlockRange()).block)&&u.getCommonInlineStyle&&(d=u.getCommonInlineStyle("href",c)),d&&((p=function(t,e){return t=r.trim(t||""),e=r.trim(e||""),!(!t||!e)&&(t===e||i.startsWith(e,t)||i.endsWith(e,t)||i.startsWith(t,e)||i.endsWith(t,e))}(d,c.getDataAsPlain()))&&(h=u.getCommonInlineStyles(c)),n.hrefInfo={noteRange:l,href:d,hrefAsLinkText:p,commonStyles:h})))},isRangeCollapsed:function(t,e,n){var o=t.getNoteRange();o&&(n.isRangeCollapsed=o.isCollapsed())}};return function(t){var e={};return o.each(l,function(n){n(t,event,e)}),e}}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";var a,s=this&&this.__extends||(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});o=[n,r,n(0),n(26),n(2),n(44)],void 0===(i=function(t,e,n,o,i,r){return function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.create=function(t,n,o){if(n&&t)return new e({filter:o,note:n,noteRange:t});i.error("Failed to create NoteRangeWalker, unvalid parameters",t,n,o)},e.prototype.current=function(){return this.walkerProps.blockRanges[this.walkerProps.blockRangeIndex]},e.prototype.first=function(){return this.walkerProps.blockRangeIndex=0,this._getAtIndex(this.walkerProps.blockRangeIndex)},e.prototype.last=function(){if(this._getAtIndex(this.walkerProps.endIndex),this.walkerProps.blockRangeIndex=this.walkerProps.blockRanges.length-1,-1!==this.walkerProps.blockRangeIndex)return this.walkerProps.blockRanges[this.walkerProps.blockRangeIndex]},e.prototype.next=function(){return this.walkerProps.blockRangeIndex++,this._getAtIndex(this.walkerProps.blockRangeIndex)},e.prototype.previous=function(){return this.walkerProps.blockRangeIndex--,this._getAtIndex(this.walkerProps.blockRangeIndex)},e.prototype.reset=function(){this.walkerProps.blockRangeIndex=-1},e.prototype.initialize=function(t){var e,o;t=n.defaults(t||{},{filter:function(){return!0},note:null,noteRange:null}),this.walkerProps=t,e=this.walkerProps.note=t.note,o=this.walkerProps.noteRange=t.noteRange,this.walkerProps.filter=t.filter,this.walkerProps.startRange=o.getStartBlockRange(),this.walkerProps.endRange=o.getEndBlockRange(),this.walkerProps.startIndex=e.getBlockIndex(this.walkerProps.startRange.block),this.walkerProps.endIndex=e.getBlockIndex(this.walkerProps.endRange.block),this.walkerProps.blockIndex=this.walkerProps.startIndex-1,this.walkerProps.blockRanges=[],this.walkerProps.blockRangeIndex=-1},e.prototype._getAtIndex=function(t){var e,n,o,i;if(o=this.walkerProps.blockRanges[t])return o.clone(!0);if(!this._hasWalked()){for(i=this.walkerProps.blockIndex+1;i<=this.walkerProps.endIndex&&(this.walkerProps.blockIndex=i,this.walkerProps.startIndex!==this.walkerProps.endIndex?i===this.walkerProps.startIndex?(e=this.walkerProps.startRange.clone(!0)).extendToBlockEnd():i===this.walkerProps.endIndex?(e=this.walkerProps.endRange.clone(!0)).extendToBlockStart():(n=this.walkerProps.note.getBlockAt(i),e=r.createRangeByBlock({allContent:!0,block:n})):e=this.walkerProps.startRange.clone(!0),!(!0===this.walkerProps.filter(e)&&(this.walkerProps.blockRanges.push(e),o=this.walkerProps.blockRanges[t])));i++);return o}},e.prototype._hasWalked=function(){return this.walkerProps.blockIndex>=this.walkerProps.endIndex},e}(o)}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";var a,s=this&&this.__extends||(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});o=[n,r,n(0),n(115),n(223),n(26),n(2)],void 0===(i=function(t,e,n,o,i,r,a){return function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.create=function(t){if(!(!t||!t.table||null==t.left||null==t.top||!t.width||!t.height||t.left<0||t.top<0||t.width<1||t.height<1))return new e(t);a.error("Failed to create RectRange",t)},e.prototype.clone=function(){var t=this.getRect();return e.create(t)},e.prototype.equals=function(t){var e=t.getRect();return this.props.table===t.getTable()&&this.props.height===e.height&&this.props.left===e.left&&this.props.top===e.top&&this.props.width===e.width},e.prototype.forEach=function(t,e){var n=this;n.forEachRow(function(o){return n.forEachColumn(function(e){return t(o,e)},e)},e)},e.prototype.forEachCell=function(t,e){var n=this,o={};n.forEach(function(e,i){var r,a=n.props.table.getCell(e,i,{findMergePointIfNeeded:!0,withPosition:!0});if(a&&(r=a.row+"-"+a.col,!0!==o[r]))return o[r]=!0,t(a.cell,a.row,a.col)},e)},e.prototype.forEachRow=function(t,e){var n;for(n=0;n<this.props.height;n++)if(!1===t(e?this.props.top+this.props.height-n:this.props.top+n))return!1},e.prototype.forEachColumn=function(t,e){var n;for(n=0;n<this.props.width;n++)if(!1===t(e?this.props.left+this.props.width-n:this.props.left+n))return!1},e.prototype.getDataAsHtml=function(){return this._getAsNewTable().toHtml()},e.prototype.getDataAsJSON=function(t){return this._getAsNewTable().toJSON(t)},e.prototype.getDataAsPlain=function(){return this._getAsNewTable().toPlain({returnString:!0})},e.prototype.getFirstCell=function(){return this.props.table.getCell(this.props.top,this.props.left,{findMergePointIfNeeded:!0,withPosition:!0})},e.prototype.getFirstCellRect=function(){return{col:this.props.left,row:this.props.top}},e.prototype.getLastCell=function(){return this.props.table.getCell(this.props.top+this.props.height-1,this.props.left+this.props.width-1,{findMergePointIfNeeded:!0,withPosition:!0})},e.prototype.getRect=function(){var t={};return t.height=this.props.height,t.left=this.props.left,t.top=this.props.top,t.width=this.props.width,t},e.prototype.getTable=function(){return this.props.table},e.prototype.isMerge=function(){},e.prototype.isOnlyAttachCell=function(){var t,e;return!(!(t=this.props.table.getCell(this.props.top,this.props.left))||!t.isAttachmentCell())&&(t.isMergePoint()?(e=t.getMergePointAttr()).width===this.props.width&&e.height===this.props.height:1===this.props.width&&1===this.props.height)},e.prototype.isOnlyImgCell=function(){var t,e;return!(!(t=this.props.table.getCell(this.props.top,this.props.left))||!t.isImageCell())&&(t.isMergePoint()?(e=t.getMergePointAttr()).width===this.props.width&&e.height===this.props.height:1===this.props.width&&1===this.props.height)},e.prototype.onlyOneCell=function(){return 1===this.props.width&&1===this.props.height},e.prototype.overlaps=function(){},e.prototype.onlyMergePointAndCell=function(){var t,e;return!!(t=this.props.table.getCell(this.props.top,this.props.left)).isMergePoint()&&(e=t.getMergePointAttr(),this.props.width===e.width&&this.props.height===e.height)},e.prototype.toJSON=function(){return this.getRect()},e.prototype.toString=function(){var t={};return t.height=this.props.height,t.left=this.props.left,t.top=this.props.top,t.width=this.props.width,"RectRange("+n.map(t,function(t,e){return e+":"+t}).join(",")+")"},e.prototype.initialize=function(t){t=t||{},this.props=this.props||{},this.props.table=t.table,this._setRect(t),this._checkBoundary(),this._fixMerge()},e.prototype._checkBoundary=function(){var t=this.props.table,e=t.getColumnCount(),n=t.getRowCount();this.props.left<0?this.props.left=0:this.props.left>=e&&(this.props.left=e-1),this.props.top<0?this.props.top=0:this.props.top>=n&&(this.props.top=n-1),this.props.width<1&&(this.props.width=1),this.props.left+this.props.width>e&&(this.props.width=e-this.props.left),this.props.height<1&&(this.props.height=1),this.props.top+this.props.height>n&&(this.props.height=n-this.props.top)},e.prototype._fixMerge=function(){this._walkToFixMergeCells({})},e.prototype._getAsNewTable=function(){var t,e,n,i,r,a=this.props.table,s=[],l=[],c=[],u=this.props.top;for(u=0;u<this.props.height;u++)for(i=[],s.push(i),e=this.props.top+u,l.push(a.getRowHeight(e)),t=0;t<this.props.width;t++)n=this.props.left+t,0===u&&c.push(a.getColumnWidth(n)),i.push(a.getCell(e,n));return(r=new o({colWidths:c,rowHeights:l,tableCells:s})).setBlockStyles(a.getBlockStyles()),r},e.prototype._markAsWalked=function(t,e){var n,o;for(n=0;n<t.width;n++)for(o=0;o<t.height;o++)e[this._makeMarkKey(t.top+o,t.left+n)]=!0},e.prototype._makeMarkKey=function(t,e){return t+","+e},e.prototype._setRect=function(t){this.props=this.props||{},this.props.height=t.height,this.props.left=t.left,this.props.top=t.top,this.props.width=t.width},e.prototype._shouldExtend=function(t,e,n){var o,r,s,l,c=this.props.table;return(!n||!n[this._makeMarkKey(t,e)])&&((s=c.getCell(t,e,{findMergePointIfNeeded:!0,withPosition:!0}))&&s.cell?(o=(l=s.cell).isMergePoint()?{height:(r=l.getMergePointAttr()).height,left:s.col,top:s.row,width:r.width}:{height:1,left:e,top:t,width:1},this._markAsWalked(o,n),!i.contains(this.props,o)&&i.union(this.props,o)):(a.warn("no table cell at row/col",t,e),!1))},e.prototype._walkToFixMergeCells=function(t){var e=this,n=function(n){var o,i,r=n?e.props.top:e.props.top+e.props.height-1;for(i=0;i<e.props.width;i++)if(o=e._shouldExtend(r,e.props.left+i,t))return o},o=function(n){var o,i,r=n?e.props.left:e.props.left+e.props.width-1;for(i=1;i<e.props.height;i++)if(o=e._shouldExtend(e.props.top+i,r,t))return o},i=n(!0)||n(!1)||o(!0)||o(!1);i&&(e._setRect(i),e._walkToFixMergeCells(t))},e}(r)}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";var a,s=this&&this.__extends||(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),l=this&&this.__assign||Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t};o=[n,r,n(0),n(609),n(100),n(7),n(3),n(44),n(166),n(21),n(101),n(50),n(10),n(220),n(2),n(624)],void 0===(i=function(t,e,n,o,i,r,a,c,u,d,p,h,f,g,m,y){return function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isSessionInitDone=!1,e}return s(e,t),e.prototype.buildCollabProperties=function(){var t={};return null!=this.collabEngine?t=this.collabEngine.buildCollabProperties(null):t.coreEditor=this,t.isCollabEnabled=this.isCollabEnabled(),t},e.prototype.buildCollabSession=function(t,e){var n=this,o=t.collabServer,i=t.userInfo;null!=this.collabEngine&&(this.collabEngine.closeCollabSession(null,null),this.collabEngine=null),this._initCollabEngine(),t.collabServer=o.address,t.useWSS=!!o.useWSS,t.nickname=i.nickname,t.userId=i.userId,t.portraitUrl=i.portraitUrl,this.collabEngine.buildCollabSession(t,function(t){1===t.resultCode&&n.trigger("yne-session-built",t.isCollabStarted),e(t)})},e.prototype.canRemoveFormat=function(){throw new Error("should be overridden.")},e.prototype.closeCollabSession=function(t,e){null!=this.collabEngine&&this.collabEngine.closeCollabSession(t,e),this.collabEngine=null},e.prototype.getCollabId=function(){if(null!=this.collabEngine)return this.collabEngine.getCollabId()},e.prototype.getLastNotOwnExecCmd=function(){if(null!=this.collabEngine)return this.collabEngine.getLastNotOwnExecCmd()},e.prototype.getModifiers=function(t,e){return null!=this.collabEngine?this.collabEngine.getModifiers(t,e):{status:r.ERRORID_COLLAB_ENGINE_NULL}},e.prototype.getCollabContent=function(t,e){var n={status:0,resultCode:0},o=this;return null!=this.collabEngine?(e&&(this.isReadOnly()||this.makeReadOnly(!0),this.noteView.removeNote()),this.isContentLoading()?this.getCollabContentTimer=setTimeout(function(){o.getCollabContent(t,!1)},1e3):(n=this.collabEngine.getCollabContent(t)).status=n.resultCode,n):{status:r.ERRORID_COLLAB_ENGINE_NULL}},e.prototype.hasCachedDataCmd=function(){return null!=this.collabEngine&&this.collabEngine.hasCachedDataCmd()},e.prototype.isLastOwnDataCmdExecuted=function(){if(null!=this.collabEngine)return this.collabEngine.isLastOwnDataCmdExecuted()},e.prototype.isValidLocalDataCmd=function(t){if(null!=this.collabEngine)return this.collabEngine.isValidLocalDataCmd(t)},e.prototype.noteSetNotification=function(){var t=this;null!=this.collabEngine&&this.collabEngine.sendContentSetInfo(this.note.getFileVersion(),function(e){e.result===r.CJSON_INITIALIZE_DONE&&(t.isSessionInitDone=!0),t.trigger("yne-session-initialized",e.result,e)})},e.prototype.pushLocalDataCommand=function(t,e){null!=this.collabEngine&&this.collabEngine.pushLocalDataCommand(t,e)},e.prototype.saveNotification=function(t,e){null!=this.collabEngine&&this.collabEngine.saveNotification(t,e)},e.prototype.sendBlockLockInfo=function(t){null!=this.collabEngine&&this.collabEngine.sendOwnLockInfo(t)},e.prototype.sendCachedDataCommand=function(){null!=this.collabEngine&&this.collabEngine.sendCachedDataCmd(!1)},e.prototype.updateUserInfo=function(t){var e=this.getEditorProps();null!=t&&(n.extend(e.userInfo,t),null!=this.collabEngine&&this.collabEngine.updateSessionInfos(t))},e.prototype.applyCollabCmdRedoUndo=function(t){this.controller.cmdManager.applyCollabCmdRedoUndo(t)},e.prototype.buildNoteRangeFromJSON=function(t){return p.buildNoteRangeFromJSON(t,this)},e.prototype.createDataCommand=function(t,e){return this.controller.createCmd(t,e)},e.prototype.dropRedoCmd=function(){this.controller.cmdManager.dropRedoCmd()},e.prototype.dropUndoCmds=function(t,e,n){this.controller.cmdManager.dropUndoCmds(t,e,n)},e.prototype.getClientId=function(){return this.clientId},e.prototype.getDefaultNoteRange=function(){return this.controller.defaultNoteRange()},e.prototype.getInnerBlocksWithEdge=function(t){var e,n,o;return t&&u.isHeaderFooterRange(t.getStartBlockRange())?[t.getStartBlockRange().block]:(d.isNoteRange(t)&&(e=t.getStartBlockRange().block,n=t.getEndBlockRange().block,o=this.note.getInterBlocks(e,n,!0)),o)},e.prototype.getNextBlockById=function(t){var e=null,n=this.getBlockById(t);return n&&(e=this.note.getNextBlock(n)),e},e.prototype.getNoteVersion=function(){return this.note?this.note.getFileVersion():null},e.prototype.getPreBlockById=function(t){var e=null,n=this.getBlockById(t);return n&&(e=this.note.getPreBlock(n)),e},e.prototype.isListItem=function(t){return a.isListItem(t)},e.prototype.isNoteValidForCollab=function(){return this.controller.note.isValidForCollab()},e.prototype.isReadyForEdit=function(){return!0===this.isSessionInitDone},e.prototype.isContentLoading=function(){return!0===this.contentLoading},e.prototype.isTable=function(t){return a.isTable(t)},e.prototype.isTodo=function(t){return a.isTodo(t)},e.prototype.reset=function(){null!=this.getCollabContentTimer&&clearTimeout(this.getCollabContentTimer),t.prototype.reset.call(this)},e.prototype.setNoteVersion=function(t){m.log("SetNoteVersion:"+t),this.note.setFileVersion(t),this.trigger("yne-note-version-change",t)},e.prototype.buildBlockRangeFromJSON=function(t){var e,n;if(t&&t.blockId){if(e=t.blockId,n=this.getBlockById(e))return t.rangeType===a.CODE?c.createRangeByBlock(l({block:n},t)):c.createRangeByBlock({block:n,end:t.endPosition,rect:t.simpleValue1,start:t.startPosition,type:t.simpleValue2});m.log("block is NOT existing:",t)}else m.error("The blockRangeJSON.blockId is not valid!")},e.prototype.buildInnerCommandFromJSON=function(t,e){var o=t[r.CJSON_ACTION],i={};return i.collabProperties=n.clone(e.collabProperties),i.collabProperties.cmdJSON=t,this.createDataCommand(o,i)},e.prototype.getBlockById=function(t){return this.note.getBlockById(t)},e.prototype.getEditorProps=function(){return this.editorProps},e.prototype.getNoteProps=function(){return this.noteProps},e.prototype.getNote=function(){return this.note},e.prototype.isCollabEnabled=function(){return!(null==this.noteProps||!this.noteProps.isCollabEnabled)},e.prototype.isIdleTimeout=function(){return this.idleTimeout},e.prototype.isMyOwnLockedBlock=function(t){var e,n=!1,o=this._getMyOwnBlockId();return null!=t&&null!=o&&""!==o&&(d.isNoteRange(t)&&t.isInSingleBlock()?e=t.getStartBlockRange().getBlockId():c.isBlockRange(t)&&(e=t.getBlockId()),e&&e===o&&!this.isTable(this.getBlockById(e))&&(n=!0)),n},e.prototype.render=function(){t.prototype.render.call(this),this.isCollabEnabled()||this.updateNoteViewVisibility(!0)},e.prototype.setIdleTimeout=function(t){t&&(this.noteView.render(),this.setReadOnly(!0)),this.idleTimeout=t},e.prototype.updateEditorOptions=function(t){if(this.options||(this.options=t?n.clone(t):{}),t)for(var e in t)t.hasOwnProperty(e)&&("shareKey"===e&&this.options[e]!==t[e]&&(this.idleTimeout=!1),this.options[e]=t[e]);this.options.isCollabEnabled=g.parseToBoolean(this.options.isCollabEnabled,!0),this.options.isCollabEnabled||(this.idleTimeout=!1),this.options.hideAttendeeHint=g.parseToBoolean(this.options.hideAttendeeHint,!1),this.options.disableBackground=g.parseToBoolean(this.options.disableBackground,!1),this.options.useWSS=g.parseToBoolean(this.options.useWSS,!1),this.options.pageType=g.parseToPageType(this.options.pageType),this.options.sessionId||(this.options.sessionId=this.clientId),this.options.readOnly=g.parseToBoolean(this.options.readOnly,!1),this.options.hasOriginFile=g.parseToBoolean(this.options.hasOriginFile,!1),n.extend(this.editorProps,this.options)},e.prototype.notifyErrorToHost=function(t){this.trigger("yne-useraction-failed",t)},e.prototype.onDocSelectionChange=function(){m.log("onDocSelectionChange")},e.prototype.recoverFromIdleTimeout=function(){var t;this.idleTimeout&&this.isCollabEnabled()&&(t={code:0,customCode:8e3,shareKey:this.getCollabId()},this.trigger("yne-session-closed",t))},e.prototype.testSendMsgToCollabServer=function(t){null!=this.collabEngine&&this.collabEngine.sendMessageToCollabServer(t)},e.prototype.bindEventsForController=function(){var t=this,e=this.controller;e.on("command-exec",function(e,n){e&&e.name?t.isCollabEnabled()?((n=n||{}).collabProperties=n.collabProperties||{},n.collabProperties.finalNoteVersion&&t.setNoteVersion(n.collabProperties.finalNoteVersion),e&&e.effected&&(!n.collabProperties.isCollabCmd||n.collabProperties.isCollabCmd&&n.collabProperties.isOwnCmd&&!n.collabProperties.isLocalExecutedCmd)&&(t.contentChanged=!0,t.trigger("yne-content-change"))):e&&e.effected?(t.contentChanged=!0,t.trigger("yne-content-change")):m.warn("The command has no effected",e):m.error("The command is not valid",e)}),h.bubble(["redo-stack-change","undo-stack-change","selectstart","mouse-down","command-exec","esc","yne-clipboard-status","yne-clipboard-error","yne-get-clipboard","yne-clipboard-set","color-picker-show","yne-user-action-collection","cell-edit-view-enter","cell-edit-view-exit","cell-edit-view-history-change"],e,this)},e.prototype._getMyOwnBlockId=function(){var t=this.collabEngine.getMyOwnBlockIds();return null!=t&&t.length>0?t[0]:null},e.prototype._initCollabEngine=function(){var t=this;t.idleTimeout=!1,t.isSessionInitDone=!1,t.collabEngine=new o.default(t,n,m),t.collabEngine.on(i.default.WS_CLOSED,function(e){8e3===e.customCode&&f.IS_PC?t.setIdleTimeout(!0):t.trigger("yne-session-closed",e)}),t.collabEngine.on(i.default.DATACMD_FAILURE,function(e){t.trigger("yne-useraction-failed",e.message)}),t.collabEngine.on(i.default.DATACMD_SUCCESS,function(e){t.trigger("yne-datacommand-success",e.rawCollabJSON)}),t.collabEngine.on(i.default.LOCK_LOCKED,function(e){var n,o=e.sessionProps;null!=o&&null!=o.lockedBlkIds&&o.lockedBlkIds.length>0&&(n=o.lockedBlkIds[0],t._lockBlock(n,o))}),t.collabEngine.on(i.default.LOCK_RELEASED,function(e){t._unlockBlock(e.unlockedBlockId)}),t.collabEngine.on(i.default.SESSION_CHNAGED,function(e){null!=e&&e.length>0&&n.each(e,function(e){e.propUpdated&&null!=e.nickname&&null!=e.lockedBlkIds&&e.lockedBlkIds.length>0&&e.sessionId!==t.clientId&&(e.lockUpdated=!0,t._lockBlock(e.lockedBlkIds[0],e))}),t.trigger("yne-collabsession-change",e)})},e.prototype._lockBlock=function(t,e){var n=this.note,o=this.getBlockById(t);null==o||this.isTable(o)||n.lockBlock(t,e)},e.prototype._unlockBlock=function(t){this.note.unlockBlock(t)},e}(y)}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";var a,s=this&&this.__extends||(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});o=[n,r,n(610),n(611),n(612),n(613),n(614),n(615),n(616),n(119),n(617),n(65),n(618),n(619),n(620),n(54),n(100)],void 0===(i=function(t,e,n,o,i,r,a,l,c,u,d,p,h,f,g,m,y){Object.defineProperty(e,"__esModule",{value:!0});var v=function(){},_=function(t){function e(e,s,u){var d=t.call(this)||this;if(d.localCmdPerSec=0,null==s)throw new Error("Missing underscorejs");if(null==u)throw new Error("Missing logger instance");return p.ExternalLibs.setUnderscore(s),p.ExternalLibs.setLogger(u),d.isLocalCmdTooFast=!1,d.coreEditor=e,d.clientId=d.coreEditor.getClientId(),d.keyTranslator=new a.CollabKeyTranslator,d.collabPropsHandler=new o.CmdCollabPropsHandler(d.clientId,d.keyTranslator,d.coreEditor),d.wsClient=new g.WebSocketClient(d.collabPropsHandler),d.cmdMergeHandler=new i.CmdMergeHandler,d.nondataCmdHandler=new h.NonDataCmdHandler(d.wsClient),d.sessionHandler=new l.CollabSessionHandler(d.clientId,d.nondataCmdHandler),d.blockLockHandler=new n.BlockLockHandler(d.clientId,d.sessionHandler,d.nondataCmdHandler),d.conflictHandler=new r.CollabConfilctHandler(d.coreEditor,d.blockLockHandler),d.redoundoHandler=new f.RedoUndoHandler(d.coreEditor),d.dataCmdHandler=new c.DataCmdHandler(d.coreEditor,d.blockLockHandler,d.conflictHandler,d.redoundoHandler,d.cmdMergeHandler,d.keyTranslator,d.wsClient),d._createEventEmitter(),d}return s(e,t),e.prototype.buildCollabProperties=function(t){return this.collabPropsHandler.buildCollabProperties(t)},e.prototype.buildCollabSession=function(t,e){var n,o,i=this,r={resultCode:u.CustomResultCode.NO_ERROR};t.sessionId=this.clientId,e=e||v,null!=this.callbackBuildCollabSession&&(r.resultCode=u.CustomResultCode.STOP_CALL,r.message="StopPreviousCall",this.callbackBuildCollabSession(r)),this.callbackBuildCollabSession=function(t){clearTimeout(i.timeoutBuildCollabSession),i.wsClient.off(y.default.SESSION_INIT_BUILT,n),i.wsClient.off(y.default.WS_CLOSED,o),e(t)};try{o=function(t){p.loggerInst.log("WS_CLOSED Callback in buildCollabSession"),i.callbackBuildCollabSession(t)},this.wsClient.once(y.default.WS_CLOSED,o),n=function(t){p.loggerInst.log("SESSION_INIT_BUILT Callback in buildCollabSession"),i.callbackBuildCollabSession(t)},this.nondataCmdHandler.once(y.default.SESSION_INIT_BUILT,n),this.wsClient.connect(t),this.timeoutBuildCollabSession=setTimeout(function(){var t={resultCode:u.CustomResultCode.TIME_OUT,message:"TimeOut"};i.callbackBuildCollabSession(t)},5e3)}catch(t){r.resultCode=u.CustomResultCode.EXCEPTION,r.message=t.message||t,this.callbackBuildCollabSession(r)}},e.prototype.closeCollabSession=function(t,e,n){var o={resultCode:u.CustomResultCode.NO_ERROR};n=n||v;try{this.wsClient.close(t,e),this.blockLockHandler.destroy(),this.blockLockHandler=null,this.collabPropsHandler.destroy(),this.collabPropsHandler=null,this.conflictHandler.destroy(),this.conflictHandler=null,this.cmdMergeHandler.destroy(),this.cmdMergeHandler=null,this.dataCmdHandler.destroy(),this.dataCmdHandler=null,this.nondataCmdHandler.destroy(),this.nondataCmdHandler=null,this.redoundoHandler.destroy(),this.redoundoHandler=null,this.sessionHandler.destroy(),this.sessionHandler=null}catch(t){o.resultCode=u.CustomResultCode.EXCEPTION,o.message=t.message||t}n(o)},e.prototype.isLastOwnDataCmdExecuted=function(){return this.dataCmdHandler.isLastOwnCmdExecuted()},e.prototype.sendContentSetInfo=function(t,e){var n=this,o={collabId:this.wsClient.getCollabId(),isReadOnly:this.wsClient.isReadOnlySession(),nickname:this.wsClient.getNickname(),result:d.ConstValueInJSON.SESSION_INIT_DONE,resultCode:u.CustomResultCode.NO_ERROR,sessionId:this.wsClient.getSessionId(),userId:this.wsClient.getUserId()},i={};e=e||v,null!=this.callbackSendContentSetInfo&&(o.resultCode=u.CustomResultCode.STOP_CALL,o.message="StopPreviousCall",this.callbackSendContentSetInfo(o)),this.callbackSendContentSetInfo=function(t){clearTimeout(n.timeoutSendContentSetInfo),n.nondataCmdHandler.off(y.default.SESSION_INIT_DONE,n.callbackSendContentSetInfo),e(t)},this.coreEditor.isNoteValidForCollab()?(i.noteVersion=t,this.nondataCmdHandler.once(y.default.SESSION_INIT_DONE,this.callbackSendContentSetInfo),this.nondataCmdHandler.sendCollabNonDataCommand(u.CmdNames.NONDATACMD_CLINTPONG,i),this.timeoutSendContentSetInfo=setTimeout(function(){o.resultCode=u.CustomResultCode.TIME_OUT,null!=n.callbackSendContentSetInfo&&n.callbackSendContentSetInfo(o)},5e3)):(o.result=d.ConstValueInJSON.SESSION_INIT_INVALID,this.callbackSendContentSetInfo(o))},e.prototype.getCollabContent=function(t){var e=this,n={resultCode:0},o=function(n){n.resultCode===u.CustomResultCode.NO_ERROR&&(n.version=e.coreEditor.getNoteVersion(),n.content=e.coreEditor.getXmlContent(),n.sessionCount=e.sessionHandler.getSessionCount()),null!=e.callbackGetCollabContent&&e.dataCmdHandler.off(y.default.DATACMD_NO_PENDING,e.callbackGetCollabContent),e.callbackGetCollabContent=null,clearTimeout(e.timeoutGetCollabContent),t(n)};return t=t||v,this.coreEditor.isContentLoading()?(n.resultCode=0,o(n)):this.dataCmdHandler.hasPendingCmds()?this.wsClient.isOpened()?(n.resultCode=0,null==this.callbackGetCollabContent&&(this.callbackGetCollabContent=function(t){null==t&&(t={resultCode:u.CustomResultCode.NO_ERROR}),o(t)},this.dataCmdHandler.once(y.default.DATACMD_NO_PENDING,this.callbackGetCollabContent),this.timeoutGetCollabContent=setTimeout(function(){n.resultCode=u.CustomResultCode.TIME_OUT,n.message="TimeOut",null!=e.callbackGetCollabContent&&e.callbackGetCollabContent(n)},6e4))):(n.resultCode=u.WSCustomCode.COLLAB_SESSION_CLOSED,o(n)):(n.resultCode=u.CustomResultCode.NO_ERROR,o(n)),n},e.prototype.getModifiers=function(t,e){var n=this,o={status:0,resultCode:u.CustomResultCode.NO_ERROR};return e=e||v,null!=this.callbackGetModifiers&&(o.resultCode=u.CustomResultCode.STOP_CALL,o.status=2,o.message="StopPreviousCall",this.callbackGetModifiers(o)),this.callbackGetModifiers=function(t){n.nondataCmdHandler.off(y.default.NONDATACMD_MODIFIERS_RESULT,n.callbackGetModifiers),n.callbackGetModifiers=null,clearTimeout(n.timeoutGetModifiers),e(t)},0!==(o=this.nondataCmdHandler.getModifiers(t)).status?(e(o),o):(this.nondataCmdHandler.once(y.default.NONDATACMD_MODIFIERS_RESULT,this.callbackGetModifiers),this.timeoutGetModifiers=setTimeout(function(){null!=n.callbackGetModifiers&&(o.resultCode=u.CustomResultCode.TIME_OUT,o.status=2,o.message="TimeOut",n.callbackGetModifiers(o))},5e3),o)},e.prototype.saveNotification=function(t,e){var n={};n.noteVersion=t,n.isHistorySave=!!e,this.nondataCmdHandler.sendCollabNonDataCommand(u.CmdNames.NONDATACMD_NOTESAVE,n)},e.prototype.getLastNotOwnExecCmd=function(){return this.dataCmdHandler.getLastNotOwnExecCmd()},e.prototype.getMyOwnBlockIds=function(){return this.blockLockHandler.getOwnBlockIds()},e.prototype.sendOwnLockInfo=function(t){var e={};e.lockedBlockId=t,e.sessionId=this.clientId,this.nondataCmdHandler.sendCollabNonDataCommand(u.CmdNames.NONDATACMD_COLLABINFO,e)},e.prototype.sendCachedDataCmd=function(t){this.dataCmdHandler.sendCachedDataCommand(t)},e.prototype.hasCachedDataCmd=function(){return this.dataCmdHandler.hasPendingCmds()},e.prototype.pushLocalDataCommand=function(t,n){var o=u.CustomResultCode.NO_ERROR;return(o=this.dataCmdHandler.pushLocalDataCommand(t,n))===u.CustomResultCode.NO_ERROR&&1===this.dataCmdHandler.getCachedCmdCount()&&(this._checkCommandSendDelay(),this._updateCmdSpeed(!0)),o===u.CustomResultCode.NO_ERROR&&t.isLocalExecutedCmd&&(this.localCmdPerSec++,this.localCmdPerSec>e.LACAL_CMD_SPEED_LIMITATION&&(this.isLocalCmdTooFast=!0)),o},e.prototype.isValidLocalDataCmd=function(t){var e=!0,n={closeSession:!1,resultCode:u.CustomResultCode.NO_ERROR};return e&&(e=this._isLocalCommandTooFast()),e&&!1===t.isReadyToApply&&(n.message="命令不满足执行条件",n.resultCode=u.DataCmdFailureCode.LOCAL_NOT_READY_APPLY,this.emit(y.default.DATACMD_FAILURE,n),e=!1),e&&!this.wsClient.isOpened()&&(n.resultCode=u.WSCustomCode.SESSION_NOT_OPENED,n.message="协同链接已断开",this.emit(y.default.DATACMD_FAILURE,n),e=!1),e&&!this.coreEditor.isNoteValidForCollab()&&(n.resultCode=u.DataCmdFailureCode.LOCAL_INVALID_FOR_COLLAB,n.message="笔记不满足协同条件",this.emit(y.default.DATACMD_FAILURE,n),e=!1),e&&!t&&(n.message="空的本地命令，已被忽略",n.resultCode=u.DataCmdFailureCode.LOCAL_EMPTY_CMD,this.emit(y.default.DATACMD_FAILURE,n),e=!1),!e||t.isCollabRedo||t.isCollabUndo||(e=!this._isLocalCommandConflict(t)),e&&(t.isCollabRedo||t.isCollabUndo)&&!1===(e=this.redoundoHandler.ValidateLocalRedoUndo(t))&&(n.message="目标区域已经被修改，不能撤销或重做",n.resultCode=u.DataCmdFailureCode.LOCAL_DIRTY_BLOCKS,this.emit(y.default.DATACMD_FAILURE,n)),e},e.prototype.updateSessionInfos=function(t){this.nondataCmdHandler.sendCollabNonDataCommand(u.CmdNames.NONDATACMD_COLLABINFO,t)},e.prototype.sendMessageToCollabServer=function(t){this.wsClient.send(t)},e.prototype.getCollabId=function(){return this.wsClient.getCollabId()},e.prototype._sendDataCmdFailedMessage=function(t,e){var n={};n.errToClose=e,n.dataCmdErrorCode=t.toString(),this.nondataCmdHandler.sendCollabNonDataCommand(u.CmdNames.NONDATACMD_DATACMDFAILED,n)},e.prototype._createEventEmitter=function(){var t=this;t.wsClient.on(y.default.WS_CLOSED,function(e){t.emit(y.default.WS_CLOSED,e)}),t.nondataCmdHandler.on(y.default.SESSION_INIT_BUILT,function(e){t.emit(y.default.SESSION_INIT_BUILT,e)}),t.nondataCmdHandler.on(y.default.SESSION_INIT_DONE,function(e){t.emit(y.default.SESSION_INIT_DONE,e)}),t.sessionHandler.on(y.default.SESSION_CHNAGED,function(e){p.underscoreInst.each(e,function(e){if(e.propUpdated){var n=t.blockLockHandler.getLockedBlockIdsBy(e.sessionId);null!=n&&n.length>0&&(e.lockedBlkIds=n)}}),t.emit(y.default.SESSION_CHNAGED,e)}),t.blockLockHandler.on(y.default.LOCK_LOCKED,function(e){var n;e.sessionProps&&e.sessionProps.lockedBlkIds&&e.sessionProps.lockedBlkIds.length>0&&(n=e.sessionProps.lockedBlkIds[0]),null!=n&&(e.sessionId===t.wsClient.getSessionId()?t.sendOwnLockInfo(n):t.emit(y.default.LOCK_LOCKED,e))}),t.blockLockHandler.on(y.default.LOCK_RELEASED,function(e){e.sessionId!==t.wsClient.getSessionId()&&t.emit(y.default.LOCK_RELEASED,e)}),t.dataCmdHandler.on(y.default.DATACMD_FAILURE,function(e){t._sendDataCmdFailedMessage(e.resultCode,e.closeSession),t.emit(y.default.DATACMD_FAILURE,e)}),t.dataCmdHandler.on(y.default.DATACMD_SUCCESS,function(e){t.emit(y.default.DATACMD_SUCCESS,e)})},e.prototype._checkCommandSendDelay=function(){!this.isLocalCmdTooFast&&null!=this.dataCmdHandler&&this.dataCmdHandler.getCmdDelay()>e.MAX_CMD_DELAY_MILLIS?this.wsClient.close(u.WSCustomCode.FAILED_SEND_LOCAL_CMD,"ExceedMaxSendDelay"):null!=this.dataCmdHandler&&this.dataCmdHandler.getCachedCmdCount()>0&&this.wsClient.isOpened()&&window.setTimeout(this._checkCommandSendDelay.bind(this),e.MAX_CMD_DELAY_MILLIS)},e.prototype._isLocalCommandConflict=function(t){var e=!1,n=t.getStartingRange(),o=t.getCollabProps();if(n&&(e=this.conflictHandler.isNoteRangeConflict(n,t.name,o))){var i={closeSession:o.errorToClose,message:o.dataCmdError,resultCode:o.errorCode};this.emit(y.default.DATACMD_FAILURE,i)}return e},e.prototype._isLocalCommandTooFast=function(){var t=!0,e=this.dataCmdHandler.getCachedCmdCount();if(this.isLocalCmdTooFast&&e>0){t=!1;var n={closeSession:!1,message:"命令输入过快，等待执行命令个数："+(e=this.dataCmdHandler.getCachedCmdCount()),resultCode:u.DataCmdFailureCode.LOCAL_CMD_TOO_FAST};this.emit(y.default.DATACMD_FAILURE,n),this.sendCachedDataCmd(!1)}return t},e.prototype._updateCmdSpeed=function(t){var n,o=0;null!=this.dataCmdHandler&&(o=this.dataCmdHandler.getCachedCmdCount()),t&&(this.isLocalCmdTooFast=!1),o>0?((n=o/e.LACAL_CMD_SPEED_LIMITATION)<1&&(n=1),this.localCmdPerSec=0,this.wsClient.isOpened()&&window.setTimeout(this._updateCmdSpeed.bind(this,!1),1e3*n)):this.isLocalCmdTooFast=!1},e.LACAL_CMD_SPEED_LIMITATION=20,e.MAX_CMD_DELAY_MILLIS=4e3,e}(m.YEvent);e.default=_}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";var a,s=this&&this.__extends||(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});o=[n,r,n(119),n(65),n(54),n(100)],void 0===(i=function(t,e,n,o,i,r){Object.defineProperty(e,"__esModule",{value:!0});var a=function(t){function e(e,n,o){var i=t.call(this)||this;if(null==e)throw new Error("ownSID cannot be null in BlockLockHandler");return i.lockedBlocksMap={},i.sessionId=e,i.sessionHandler=n,i.nonDataCmdHandler=o,i.sessionHandler.on(r.default.SESSION_LOCK_UPDATE,i._onSessionLockChanged.bind(i)),i.sessionHandler.on(r.default.SESSION_QUIT,i._onSessionQuit.bind(i)),i.nonDataCmdHandler.on(r.default.LOCK_RELEASED,function(t){i._releaseLockOf(t.sessionId)}),i}return s(e,t),e.prototype.destroy=function(){this.lockedBlocksMap=null,this.sessionHandler=null,this.nonDataCmdHandler=null,this.removeAllListeners(null)},e.prototype.isBlockLockedBy=function(t,e){var n,o=!1;return null!=t&&null!=e&&null!=(n=this.lockedBlocksMap[t])&&n===e&&(o=!0),o},e.prototype.getOwnBlockIds=function(){var t=this,e=[];return o.underscoreInst.each(this.lockedBlocksMap,function(n,o){n===t.sessionId&&e.push(o)}),e},e.prototype.getLockedBlockIdsBy=function(t){var e=[];return o.underscoreInst.each(this.lockedBlocksMap,function(n,o){t===n&&e.push(o)}),e},e.prototype.updateLockByDataCmd=function(t){var e,n=t.getCollabProps();if(null!=(e=t.isCollabUndo?t.getStartingRange():t.getEndingRange())){var o=e.getEndBlockRange();if(null!=o){var i=o.block.getId();if(null!=i&&(this._releaseLockOf(n.cmdSessionId),null==this.lockedBlocksMap[i])){var r=this.sessionHandler.getSessionPropertiesBy(n.cmdSessionId);null!=r&&(r.lockedBlkIds=[i],this._lockBlock(r))}}}},e.prototype._releaseLockOf=function(t){var e=this,n=[];o.underscoreInst.each(this.lockedBlocksMap,function(e,o){e===t&&n.push(o)}),o.underscoreInst.each(n,function(n){e._unlockBlock(n,t)})},e.prototype._onSessionQuit=function(t){this._releaseLockOf(t.sessionId)},e.prototype._onSessionLockChanged=function(t){var e=this,n=!1;o.underscoreInst.each(t,function(t){n=!1,null!=t.lockedBlkIds&&t.lockedBlkIds.length>0&&(o.underscoreInst.some(t.lockedBlkIds,function(o){return e.lockedBlocksMap[o]!==t.sessionId&&(n=!0),n}),n&&(e._releaseLockOf(t.sessionId),e._lockBlock(t)))})},e.prototype._unlockBlock=function(t,e){delete this.lockedBlocksMap[t];var o={resultCode:n.CustomResultCode.NO_ERROR,sessionId:e,unlockedBlockId:t};this.emit(r.default.LOCK_RELEASED,o)},e.prototype._lockBlock=function(t){var e=this,n={resultCode:1,sessionId:t.sessionId,sessionProps:t},i=!1;o.underscoreInst.each(t.lockedBlkIds,function(n){e.lockedBlocksMap[n]!==t.sessionId&&(e.lockedBlocksMap[n]=t.sessionId,i=!0)}),i&&this.emit(r.default.LOCK_LOCKED,n)},e}(i.YEvent);e.BlockLockHandler=a}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";var a,s=this&&this.__extends||(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});o=[n,r,n(54)],void 0===(i=function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var o=function(t){function e(e,n,o){var i=t.call(this)||this;return i.clientId=e,i.collabKeyTranslator=n,i.coreEditor=o,i}return s(e,t),e.prototype.destroy=function(){this.removeAllListeners(null)},e.prototype.buildCollabProperties=function(t){var e,n,o,i,r={coreEditor:this.coreEditor,isCollabEnabled:this.coreEditor.isCollabEnabled()};return t?(r.cmdSessionId=t.sessionId,e=r.cmdSessionId===this.clientId,r.isOwnCmd=e,r.finalNoteVersion=parseInt(t.finalVersion,10),r.ownerName=t.cmdOwner,r.isCollabEnabled=!0,r.isCollabCmd=!0,r.isServerCmd=!1,(n=t.collabCmds).nondataCmds?i=n.nondataCmds[0]:(this.collabKeyTranslator.decode(n),o=n.dataCommands[0]),null!=i?r.isServerCmd=!0===i.isServerCmd:null!=o&&(r.isLocalExecutedCmd=!0===o.isLocalExecutedCmd,r.cmdId=o.cmdId)):r.cmdSessionId=this.clientId,r},e}(n.YEvent);e.CmdCollabPropsHandler=o}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";var a,s=this&&this.__extends||(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});o=[n,r,n(65),n(54)],void 0===(i=function(t,e,n,o){Object.defineProperty(e,"__esModule",{value:!0});var i=function(t){function e(){return t.call(this)||this}return s(e,t),e.prototype.destroy=function(){this.removeAllListeners(null)},e.prototype.mergeLocalCommands=function(t){var e,o,i=null,r=0;if(t&&t.length>0)if(1===t.length)i=t[0];else{for(i=t.shift();t.length>0&&(e=t[0],i.canBeMerged(e));)n.loggerInst.log("merge pending command:",i,e),i.mergeLocalCmd(e),t.shift(),r++;r>0&&t[0]&&t[0].isCollabUndo&&((o=n.underscoreInst.clone(i)).isLocalExecutedCmd=t[0].isLocalExecutedCmd,o.setCollabUndo(!0),o.setCollabRedo(!1),t[0]=o),t.unshift(i)}},e}(o.YEvent);e.CmdMergeHandler=i}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";var a,s=this&&this.__extends||(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});o=[n,r,n(3),n(119),n(65),n(54)],void 0===(i=function(t,e,n,o,i,r){Object.defineProperty(e,"__esModule",{value:!0});var a=function(t){function e(e,n){var o=t.call(this)||this;return o.coreEditor=e,o.lockHandler=n,o}return s(e,t),e.prototype.destroy=function(){this.lockHandler=null,this.removeAllListeners(null)},e.prototype.isConflictWithOwnLockedBlock=function(t,e,n){var r,a,s,l,c=this.lockHandler.getOwnBlockIds(),u=!1;return null!=c&&c.length>0&&(l=c[0]),i.loggerInst.log("LOCK/UNLOCK: isConflictWithOwnLockedBlock Enter"),"comp.AppendBlank"!==e&&l&&((r=this.coreEditor.getBlockById(l))&&!this.coreEditor.isTable(r)&&((a=this.coreEditor.getInnerBlocksWithEdge(t))&&0!==a.length?i.underscoreInst.some(a,function(t){return t.getId()===l&&(n.collabProperties.dataCmdError="协同命令执行失败：编辑目标段落被锁定",n.collabProperties.errorToClose=!!n.collabProperties.isLocalExecutedCmd,n.collabProperties.errorCode=o.DataCmdFailureCode.COLLAB_TARGET_BLOCK_LOCKED,u=!0),u}):i.loggerInst.warn("Failed to get the blocks from range",t)),u||null==n.dropRange||null==n.dropRange.block||(s=n.dropRange.block.getId())&&(u=s===l)&&(n.collabProperties.dataCmdError="协同命令执行失败：拖拽目标段落被锁定",n.collabProperties.errorToClose=!!n.collabProperties.isLocalExecutedCmd,n.collabProperties.errorCode=o.DataCmdFailureCode.COLLAB_TARGET_BLOCK_LOCKED)),i.loggerInst.log("LOCK/UNLOCK: isConflictWithOwnLockedBlock Exit"),u},e.prototype.isNoteRangeConflict=function(t,e,n){var r,a,s,l,c,u=this,d=!1;return i.loggerInst.log("LOCK/UNLOCK: isNoteRangeConflict Enter"),a=n.cmdSessionId,c=!n.isCollabCmd||n.isOwnCmd,"comp.AppendBlank"!==e&&"ManagerAdapter"!==e&&((r=this.coreEditor.getInnerBlocksWithEdge(t))&&0!==r.length?(i.underscoreInst.some(r,function(t){return i.loggerInst.log("LOCK/UNLOCK: "+t.getId()+" LockState:"+t.isLocked()),t.isLocked()&&(d=c||!u.lockHandler.isBlockLockedBy(t.getId(),a))&&(n.dataCmdError="目标段落已被其他用户锁定",n.isCollabCmd?(n.errorToClose=!!n.isLocalExecutedCmd,n.errorCode=o.DataCmdFailureCode.COLLAB_TARGET_BLOCK_LOCKED):n.errorCode=o.DataCmdFailureCode.LOCAL_TARGET_BLOCK_LOCKED),d}),d||(d=this._isConflictWithNeighborBlock(e,t,n))):(n.dataCmdError="目标段落不存在",n.isCollabCmd?(n.errorToClose=!0,n.errorCode=o.DataCmdFailureCode.COLLAB_BLOCKS_MISSING):n.errorCode=o.DataCmdFailureCode.LOCAL_BLOCKS_MISSING,d=!0),d||null==n.cmdJSON||null==n.cmdJSON.dropRange||((s=n.cmdJSON.dropRange.blockId)&&(l=this.coreEditor.getBlockById(s)),l&&l.isLocked()&&(d=c||!this.lockHandler.isBlockLockedBy(s,a)))),i.loggerInst.log("LOCK/UNLOCK: isNoteRangeConflict Exit"),d},e.prototype._isConflictWithNeighborBlock=function(t,e,r){var a,s,l,c,u=r.cmdSessionId,d=!1;if(!e)return i.loggerInst.warn("_isConflictWithNeighborBlock:noteRange should not be null"),!1;switch(a=e.getStartBlockRange(),s=!r.isCollabCmd||r.isOwnCmd,t){case"comp.KeyBackspace":a&&n.isTextBlock(a.block)&&0===a.start&&!this.coreEditor.isTodo(a.block)&&(l=this.coreEditor.getPreBlockById(a.getBlockId()))&&e.isCollapsed()&&!this.coreEditor.isListItem(a.block)&&0===a.block.getBlockStyle("text-indent")&&l.isLocked()&&(d=s||!this.lockHandler.isBlockLockedBy(l.getId(),u))&&(r.dataCmdError="目标段落已被其他用户锁定",r.isCollabCmd?(r.errorToClose=!0,r.errorCode=o.DataCmdFailureCode.COLLAB_TARGET_BLOCK_LOCKED):r.errorCode=o.DataCmdFailureCode.LOCAL_TARGET_BLOCK_LOCKED);break;case"comp.KeyDelete":e.isCollapsed()&&n.isTextBlock(a.block)&&a.end===a.block.getLength(!1)&&(c=this.coreEditor.getNextBlockById(a.getBlockId()))&&c.isLocked()&&(d=s||!this.lockHandler.isBlockLockedBy(c.getId(),u))&&(r.dataCmdError="目标段落已被其他用户锁定",r.isCollabCmd?(r.errorToClose=!0,r.errorCode=o.DataCmdFailureCode.COLLAB_TARGET_BLOCK_LOCKED):r.errorCode=o.DataCmdFailureCode.LOCAL_TARGET_BLOCK_LOCKED)}return d},e}(r.YEvent);e.CollabConfilctHandler=a}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";var a,s=this&&this.__extends||(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});o=[n,r,n(65),n(54)],void 0===(i=function(t,e,n,o){Object.defineProperty(e,"__esModule",{value:!0});var i=function(t){function e(){var e=t.call(this)||this;return e.KEY_MAP_DECODE={a:{key:"sessionId",type:0},b:{key:"finalVersion",type:0},c:{key:"cmdOwner",type:0},d:{key:"collabCmds",type:1},e:{key:"dataCommands",type:1},f:{key:"action",type:0},g:{key:"cmdId",type:0},h:{key:"nondataCmds",type:1},i:{key:"updateVersion",type:0},j:{key:"startNoteRange",type:1},k:{key:"startBlockRange",type:1},l:{key:"rangeType",type:0},m:{key:"startPosition",type:0},n:{key:"endPosition",type:0},o:{key:"isInSingleBlock",type:0},p:{key:"cmdNoteVersion",type:0},q:{key:"isLocalExecutedCmd",type:0},r:{key:"skipBlockLocking",type:0},s:{key:"blockId",type:0},t:{key:"richText",type:0},u:{key:"newBlkId",type:0},v:{key:"inlineStyles",type:0},w:{key:"blockStyles",type:0},x:{key:"newStartBlkId",type:0},y:{key:"newEndBlkId",type:0},z:{key:"dropRange",type:1},0:{key:"colNums",type:0},1:{key:"rowNums",type:0},2:{key:"simpleValue1",type:0},3:{key:"src",type:0},4:{key:"simpleValue2",type:0},5:{key:"recogLink",type:0},6:{key:"attachRes",type:0},7:{key:"fileName",type:0},8:{key:"fileLen",type:0},9:{key:"innerCmds",type:1},A:{key:"affectedBlockIds",type:0},B:{key:"endNoteRange",type:1},C:{key:"isCollabUndo",type:0},D:{key:"preBlockId",type:0},E:{key:"deletedBlocks",type:0},F:{key:"insertedBlocks",type:0},G:{key:"isCollabRedo",type:0},H:{key:"resIds",type:0},J:{key:"dataBefore",type:0},K:{key:"dataAfter",type:0},L:{key:"endBlockRange",type:1},N:{key:"blockIds",type:0},O:{key:"styleNameValues",type:0},P:{key:"oldStyleNameValues",type:0},Q:{key:"abstractSimpleValue1",type:0},R:{key:"indentStep",type:0},S:{key:"listId",type:0},T:{key:"listType",type:0},U:{key:"abstractSimpleValue2",type:0},V:{key:"oldLevels",type:0},W:{key:"newLevels",type:0},X:{key:"listItemIds",type:0},Y:{key:"headerFooterInfo",type:0},aa:{key:"selectWholeBlock",type:0},ab:{key:"startLineIndex",type:0},ac:{key:"startLineCharIndex",type:0},ad:{key:"endLineCharIndex",type:0},ae:{key:"endLineIndex",type:0}},e._assembleEncodeMap(),e}return s(e,t),e.prototype.destroy=function(){},e.prototype.decode=function(t){var e,o=this;if(!1!==this.isValidKeyMap){if(n.underscoreInst.isArray(t))n.underscoreInst.each(t,function(t){o.decode(t)});else if(null!==t&&"object"==typeof t)for(var i=0,r=n.underscoreInst.keys(t);i<r.length;i++){var a=r[i];t.hasOwnProperty(a)&&(a in this.KEY_MAP_DECODE&&(t[e=this.KEY_MAP_DECODE[a].key]=t[a],delete t[a],null!==t[e]&&"object"==typeof t[e]&&1===this.KEY_MAP_DECODE[a].type&&this.decode(t[e])))}}else n.loggerInst.error("KeyMap is not valid, skip decode.")},e.prototype.encode=function(t){var e,o=this;if(!1!==this.isValidKeyMap){if(n.underscoreInst.isArray(t))n.underscoreInst.each(t,function(t){o.encode(t)});else if(null!==t&&"object"==typeof t)for(var i=0,r=n.underscoreInst.keys(t);i<r.length;i++){var a=r[i];t.hasOwnProperty(a)&&(a in this.KEY_MAP_ENCODE?(t[e=this.KEY_MAP_ENCODE[a].key]=t[a],delete t[a],null!==t[e]&&"object"==typeof t[e]&&1===this.KEY_MAP_ENCODE[a].type&&this.encode(t[e])):(n.loggerInst.log("key:",typeof a),n.loggerInst.error('Key - "',a,'" does NOT exist in COLLAB_MAP_ENCODE!')))}}else n.loggerInst.error("KeyMap is not valid, skip encode.")},e.prototype._assembleEncodeMap=function(){var t,e;for(e in this.isValidKeyMap=!0,this.KEY_MAP_ENCODE={},this.KEY_MAP_DECODE)if(this.KEY_MAP_DECODE.hasOwnProperty(e)){if(t=this.KEY_MAP_DECODE[e].key,n.underscoreInst.has(this.KEY_MAP_DECODE,t)){this.isValidKeyMap=!1,n.loggerInst.error("original JSON key is conflict with encoded key, please rename it",t);break}if(n.underscoreInst.has(this.KEY_MAP_ENCODE,t)){this.isValidKeyMap=!1,n.loggerInst.error("original JSON key is duplicated, please rename them",t);break}this.KEY_MAP_ENCODE[t]={},this.KEY_MAP_ENCODE[t].key=e,this.KEY_MAP_ENCODE[t].type=this.KEY_MAP_DECODE[e].type}},e}(o.YEvent);e.CollabKeyTranslator=i}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";var a,s=this&&this.__extends||(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});o=[n,r,n(65),n(54),n(100)],void 0===(i=function(t,e,n,o,i){Object.defineProperty(e,"__esModule",{value:!0});var r=function(t){function e(e,n){var o=t.call(this)||this;return o.sessionsMap={},o.nondataCmdHandler=n,o.nondataCmdHandler.on(i.default.SESSION_CHNAGED,o._onSessionChanged.bind(o)),o.nondataCmdHandler.on(i.default.SESSION_QUIT,o._onSessionQuit.bind(o)),o}return s(e,t),e.prototype.destroy=function(){this.sessionsMap=null,this.removeAllListeners(null)},e.prototype.getSessionCount=function(){return n.underscoreInst.size(this.sessionsMap)},e.prototype.getSessionPropertiesBy=function(t){var e=this.sessionsMap[t];if(e)return n.underscoreInst.clone(e)},e.prototype._onSessionChanged=function(t){var e,o,r=this,a=[],s=[],l=!1;t.length>0&&(n.underscoreInst.each(this.sessionsMap,function(t){t.propUpdated=!1,a.push(t)}),n.underscoreInst.each(t,function(t){if(null==r.sessionsMap[t.sessionId]&&(r.sessionsMap[t.sessionId]={sessionId:t.sessionId},a.push(r.sessionsMap[t.sessionId]),l=!0),o=t.lockedBlkIds,delete t.lockedBlkIds,(e=r.sessionsMap[t.sessionId]).propUpdated=!1,n.underscoreInst.each(Object.keys(t),function(n){e[n]!==t[n]&&(e[n]=t[n],e.propUpdated=!0,l=!0)}),null!=o&&o.length>0){var i={lockedBlkIds:o,sessionId:t.sessionId};n.underscoreInst.defaults(i,e),s.push(i)}}),l&&this.emit(i.default.SESSION_CHNAGED,a),s.length>0&&this.emit(i.default.SESSION_LOCK_UPDATE,s))},e.prototype._onSessionQuit=function(t){var e=[];delete this.sessionsMap[t.sessionId],this.emit(i.default.SESSION_QUIT,t),n.underscoreInst.each(this.sessionsMap,function(t){t.propUpdated=!1,e.push(t)}),this.emit(i.default.SESSION_CHNAGED,e)},e}(o.YEvent);e.CollabSessionHandler=r}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";var a,s=this&&this.__extends||(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});o=[n,r,n(119),n(65),n(225),n(54),n(100)],void 0===(i=function(t,e,n,o,i,r,a){Object.defineProperty(e,"__esModule",{value:!0});var l=function(t){function e(e,n,o,i,r,s,l){var c=t.call(this)||this;return c.regularCmdSendIntervalMS=2e3,c.pendingSentCmdsQueue=[],c.coreEditor=e,c.blockLockHandler=n,c.conflictHandler=o,c.redoundoHandler=i,c.cmdMergeHandler=r,c.keyTranslator=s,c.wsClient=l,c.callbackWSOnMessage=c._execCollabDataCommand.bind(c),c.wsClient.on(a.default.WS_MESSAGE,c.callbackWSOnMessage),c}return s(e,t),e.prototype.destroy=function(){this.wsClient.off(a.default.WS_MESSAGE,this.callbackWSOnMessage),this.wsClient=null,this.removeAllListeners(null),this.pendingSentCmdsQueue=[]},e.prototype.getLastNotOwnExecCmd=function(){return this.lastNotOwnExecCmd},e.prototype.hasPendingCmds=function(){return this.pendingSentCmdsQueue&&this.pendingSentCmdsQueue.length>0},e.prototype.isLastOwnCmdExecuted=function(){var t=!0;return this.pendingSentCmdsQueue.length>0&&(t=this.pendingSentCmdsQueue[0].isLocalExecutedCmd),t},e.prototype.getCachedCmdCount=function(){return this.pendingSentCmdsQueue.length},e.prototype.getCmdDelay=function(){var t=this.pendingSentCmdsQueue[0],e=0;return null!=t&&null!=t.sendingToCollabServerMillis&&(e=Date.now()-t.sendingToCollabServerMillis),e},e.prototype.pushLocalDataCommand=function(t,e){var i=n.CustomResultCode.NO_ERROR;return t.isLocalExecutedCmd||0!==this.pendingSentCmdsQueue.length||(o.loggerInst.log("Process: sending non-local-executed first command"),i=this._sendCollabDataCommand(t,!1)),!e&&t.isLocalExecutedCmd&&0===this.pendingSentCmdsQueue.length&&(o.loggerInst.log("Process: delay sending local-executed first command"),this.sendCachedDataCommand(!0)),i===n.CustomResultCode.NO_ERROR&&(this.pendingSentCmdsQueue.push(t),!this.pendingSentCmdsQueue[0].sendingToCollabServerMillis&&(e||this.pendingSentCmdsQueue.length>1&&!t.isLocalExecutedCmd)&&(i=this.sendCachedDataCommand(!1)),o.loggerInst.log("Process: enqueue Command:(len:"+this.pendingSentCmdsQueue.length+")",t)),!0===t.isLocalExecutedCmd&&this.blockLockHandler.updateLockByDataCmd(t),i},e.prototype.sendCachedDataCommand=function(t){var e=n.CustomResultCode.NO_ERROR;return t?this.cmdSendingTimer=setTimeout(this._dispatchCachedDataCommand.bind(this),this.regularCmdSendIntervalMS):(clearTimeout(this.cmdSendingTimer),e=this._dispatchCachedDataCommand()),e},e.prototype._execCollabDataCommand=function(t){var e,n=t.collabCmdsJSON,i=t.collabProps,r={collabProperties:i};try{if(this.keyTranslator.decode(n),null==n.dataCommands)return null;if(null!=this.lastCmdId&&this.lastCmdId===i.cmdId)return null;null!=i.cmdId&&(this.lastCmdId=i.cmdId);var s=n.dataCommands[0],l=s.action,c=this.coreEditor.getDefaultNoteRange(),u=!1,d=void 0,p=void 0,h=void 0;d=this.coreEditor.getNoteRange(),r.collabProperties.cmdJSON=s,this._validateCollabDataCmd(n,r)&&(e=this._executeDataCommand(l,r)),!r.collabProperties.isOwnCmd&&"comp.DeleteNoteRange"===l&&r.range.isInSingleBlock()&&d.isInSingleBlock()&&(h=r.range.getStartBlockRange().block,p=d.getStartBlockRange().block,this.coreEditor.isTable(h)&&p.getId()===h.getId()&&(u=!0)),u&&c&&this.coreEditor.setNoteRange(c),this._postCollabDataCmdExecution(e,r)}catch(t){o.loggerInst.error(t)}finally{this.pendingSentCmdsQueue.length>0?this.sendCachedDataCommand(!1):this.emit(a.default.DATACMD_NO_PENDING)}return e},e.prototype._dispatchCachedDataCommand=function(){for(var t,e;this.pendingSentCmdsQueue.length>0&&(o.loggerInst.log("Process: sending cached command from queue"),t=this.pendingSentCmdsQueue[0],this.cmdMergeHandler.mergeLocalCommands(this.pendingSentCmdsQueue),(e=this._sendCollabDataCommand(t,!0))!==n.CustomResultCode.NO_ERROR)&&!t.isLocalExecutedCmd;)o.loggerInst.warn("skip failed-sent command and try next",t),this.pendingSentCmdsQueue.shift();return e},e.prototype._sendCollabDataCommand=function(t,e){var i,r,s,l,c=[],u={};if(e){if(t.sendingToCollabServerMillis)return o.loggerInst.warn("current cmd has been sent",t),n.CustomResultCode.NO_ERROR;if(t.isLocalExecutedCmd||t.isCollabRedo||t.isCollabUndo)o.loggerInst.log("Update-Range: NoUpdate");else{if(s=this._updateLocalCmdStartRange(t),!t.isValidStartNoteRange())return this.emit(a.default.DATACMD_FAILURE,n.DataCmdFailureCode.LOCAL_INVALID_STARTRANGE),n.DataCmdFailureCode.LOCAL_INVALID_STARTRANGE;if(s&&this.conflictHandler.isNoteRangeConflict(s,t.name,t.getCollabProps()))return o.loggerInst.log("Do NOT send Conflict Local Command"),t.getCollabProps().errorCode}}if(i=t.toCollabJSON())c[0]=i,u.dataCommands=c,o.loggerInst.log("_sendCollabDataCommand(original):",JSON.stringify(u)),this.keyTranslator.encode(u),r=JSON.stringify(u),o.loggerInst.log("_sendCollabDataCommand(compressd):",r),(l=this.wsClient.send(r))===n.CustomResultCode.NO_ERROR&&(t.sendingToCollabServerMillis=Date.now());else{l=n.DataCmdFailureCode.LOCAL_INVALID_CMDJSON;var d={closeSession:t.isLocalExecutedCmd,message:"无效的命令格式，无法协同",resultCode:l};this.emit(a.default.DATACMD_FAILURE,d)}return l===n.CustomResultCode.NO_ERROR&&t.isLocalExecutedCmd&&(o.loggerInst.log("Update-Range: set local command as last executed command"),this._setLastOwnExecutedCmd(t)),l},e.prototype._updateLocalCmdStartRange=function(t){var e;return this.lastOwnExecCmd?this.lastOwnExecCmd.isLocalExecutedCmd?o.loggerInst.log("Update-Range: last own executed command is local executed"):null!=(e=this.lastOwnExecCmd.getEndingRange())&&(t.setStartingRange(e),o.loggerInst.log("Update-Range: UpdateTo-",e.getStartBlockRange())):o.loggerInst.log("Update-Range: No last own executed command"),e},e.prototype._postCollabDataCmdExecution=function(t,e){var i,r=e.collabProperties.isLocalExecutedCmd,s=e.collabProperties.isOwnCmd;if(s&&(i=this.pendingSentCmdsQueue.shift()),e.collabProperties.dataCmdError){o.loggerInst.error(e.collabProperties.dataCmdError),t&&(t.effected||r)&&(e.collabProperties.errorToClose=!0);var l={closeSession:e.collabProperties.errorToClose,message:e.collabProperties.dataCmdError,resultCode:e.collabProperties.errorCode};return s&&this.emit(a.default.DATACMD_FAILURE,l),void(null==t&&this.coreEditor.setNoteVersion(e.collabProperties.finalNoteVersion))}if(t){if(s&&this.coreEditor.isReadyForEdit()&&(o.loggerInst.log("clear sendingToCollabServerMillis:",t,i),t.sendingToCollabServerMillis=null,i.sendingToCollabServerMillis=null,o.loggerInst.log("Process: Dequeue Command(len:"+this.pendingSentCmdsQueue.length+")")),t.setCmdFinalNoteVersion(this.coreEditor.getNoteVersion()),!s&&t.effected&&(this.redoundoHandler.pushNotOwnExecCmd(t),this.lastNotOwnExecCmd=t),s){var c={rawCollabJSON:e.collabProperties.rawWSMessage,resultCode:n.CustomResultCode.NO_ERROR};this.emit(a.default.DATACMD_SUCCESS,c),r||this._setLastOwnExecutedCmd(t)}this.blockLockHandler.updateLockByDataCmd(t)}else o.loggerInst.error("execCommand should NOT be null when no dataCmdError")},e.prototype._setLastOwnExecutedCmd=function(t){this.lastOwnExecCmd=t},e.prototype._executeDataCommand=function(t,e){var n=e.collabProperties.cmdJSON,i=n.isCollabUndo,r=n.isCollabRedo;return o.loggerInst.log("Executing "+t),i||r?this.redoundoHandler.applyCollabRedoUndo(t,e):this.coreEditor.execCommand(t,e)},e.prototype._validateCollabDataCmd=function(t,e){var r,a=e.collabProperties,s=a.cmdJSON,l=this.coreEditor.getNoteVersion(),c=a.finalNoteVersion,u=!this.coreEditor.isReadyForEdit(),d=a.isLocalExecutedCmd,p=s.startNoteRange,h=!0;return o.loggerInst.log("Executing Validation Enter"),u?0===c?(h=!1,o.loggerInst.log("Executing Validation - ignore cmd whose finalVersion is 0")):o.loggerInst.log("Executing Validation - executing unsaved cmd"):i.Utils.isCmdVersionMatchNoteVersion(c,l)?d||(r=this.coreEditor.buildNoteRangeFromJSON(p),a.isOwnCmd||(h=!this.conflictHandler.isConflictWithOwnLockedBlock(r,s.action,e)),h&&(s.isCollabUndo||s.isCollabRedo?(h=this.redoundoHandler.ValidateCollabRedoUndo(s.affectedBlockIds,s.cmdNoteVersion))||(a.errorToClose=!0,a.errorCode=n.DataCmdFailureCode.COLLAB_DIRTY_BLOCKS,a.dataCmdError="协同：目标区域已经被修改，不能撤销或重做"):h=!this.conflictHandler.isNoteRangeConflict(r,s.action,a))):(h=!1,a.errorToClose=!0,a.errorCode=n.DataCmdFailureCode.COLLAB_NOTEVERSION_MISMATCH,a.dataCmdError="命令对应版本和本地笔记版本不匹配:("+l+"/"+c+")"),o.loggerInst.log("Executing Validation Exit"),h},e}(r.YEvent);e.DataCmdHandler=l}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(){}return t.SESSION_INIT_DONE="done",t.SESSION_INIT_COLLABSTARTED="collabStarted",t.SESSION_INIT_TIMEOUT="timeout",t.SESSION_INIT_INVALID="notValidForCollab",t}();e.ConstValueInJSON=n}.apply(i,[n,i]))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";var a,s=this&&this.__extends||(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});o=[n,r,n(119),n(65),n(225),n(54),n(100)],void 0===(i=function(t,e,n,o,i,r,a){Object.defineProperty(e,"__esModule",{value:!0});var l=function(t){function e(e){var n=t.call(this)||this;if(n.retryIntervalMilliSec=1e3,n.retryMaxCount=2,null==e)throw new Error("wsClient should NOT be null");return n.wsClient=e,n.callbackWSOnMessage=n._execCollabNondataCommand.bind(n),n.wsClient.on(a.default.WS_MESSAGE,n.callbackWSOnMessage),n}return s(e,t),e.prototype._queueCollabCmdJSON=function(t){var e;return(e=this._sendCollabJSON(t))&&(t.sendingToCollabServerMillis=Date.now(),t.retryRemainedCount=this.retryMaxCount,this.retriableCmdsQueue.push(t),null==this.retryCollabJSONDispatcher&&(this.retryCollabJSONDispatcher=setTimeout(this._handleCollabJSONRetry.bind(this),this.retryIntervalMilliSec))),e},e.prototype.destroy=function(){this.wsClient.off(a.default.WS_MESSAGE,this.callbackWSOnMessage),this.wsClient=null,this.removeAllListeners(null)},e.prototype.getModifiers=function(t){return this.wsClient.isOpened()?this.modifiers&&1===this.modifiers.status&&this.modifiers.endVersion===t||(this.modifiers={resultCode:n.CustomResultCode.NO_ERROR,status:0},this._requestModifiers(t)||(this.modifiers.status=2)):this.modifiers={resultCode:n.WSCustomCode.SESSION_NOT_OPENED,status:2},this.modifiers},e.prototype.sendCollabNonDataCommand=function(t,e){var o,i=!0;return o=this._buildCollabCmdJSON(t,e),t===n.CmdNames.NONDATACMD_GETMODIFIERS?this._isModifiersReqeustSent(e.endNoteVersion)||(this._clearRetryQueueByAction(t),i=this._queueCollabCmdJSON(o)):i=t===n.CmdNames.NONDATACMD_COLLABINFO||t===n.CmdNames.NONDATACMD_NOTESAVE?this._queueCollabCmdJSON(o):this._sendCollabJSON(o),i},e.prototype._execCollabNondataCommand=function(t){var e,o=t.collabCmdsJSON,i=t.collabProps,r=i.cmdSessionId;if(null!=o.nondataCmds){switch((e=o.nondataCmds[0]).action){case n.CmdNames.NONDATACMD_BLOCKSELECTION:break;case n.CmdNames.NONDATACMD_COLLABCLOSE:var s={resultCode:n.CustomResultCode.NO_ERROR,sessionId:r};this.emit(a.default.SESSION_QUIT,s);break;case n.CmdNames.NONDATACMD_COLLABINFO:this._handleCollabInfo(e,i);break;case n.CmdNames.NONDATACMD_SESSIONINITIALIZED:var l={collabId:this.wsClient.getCollabId(),collabVersion:e.collabVersion,isReadOnly:this.wsClient.isReadOnlySession(),nickname:this.wsClient.getNickname(),result:e.initResult,resultCode:1,sessionId:this.wsClient.getSessionId(),userId:this.wsClient.getUserId()};this.emit(a.default.SESSION_INIT_DONE,l);break;case n.CmdNames.NONDATACMD_LOCKRELEASE:var c={resultCode:n.CustomResultCode.NO_ERROR,sessionId:r,unlockedBlockId:null};this.emit(a.default.LOCK_RELEASED,c);break;case n.CmdNames.NONDATACMD_SEVERPING:this._handleServerPing(e);break;case n.CmdNames.NONDATACMD_GETMODIFIERS:this._handleModifiers(e);break;case n.CmdNames.NONDATACMD_NOTESAVE:this._handleNoteSave(e);break;default:throw new Error("unknown nondata cmd:"+e.action)}this._removeFromRetryQueue(e.cmdId)}},e.prototype._requestModifiers=function(t){var e={};return e.endNoteVersion=t,this.sendCollabNonDataCommand(n.CmdNames.NONDATACMD_GETMODIFIERS,e)},e.prototype._handleCollabJSONRetry=function(){var t,e=this,i=!1;o.underscoreInst.each(this.retriableCmdsQueue,function(r){!0!==i&&null!=e.wsClient&&!1!==e.wsClient.isOpened()?Date.now()-r.sendingToCollabServerMillis>e.retryIntervalMilliSec&&((t=r.retryRemainedCount)>0?(o.loggerInst.log("NonDataCmd-Resend:",r),delete r.sendingToCollabServerMillis,delete r.retryRemainedCount,e._sendCollabJSON(r),r.sendingToCollabServerMillis=Date.now(),r.retryRemainedCount=t-1):(o.loggerInst.error("NondataCmd-Send Failed after retry:",r),e.wsClient&&e.wsClient.isOpened()&&e.wsClient.close(n.WSCustomCode.FAILED_RECEIVE_COLLAB_CMD,n.WSCustomCode[n.WSCustomCode.FAILED_RECEIVE_COLLAB_CMD]),i=!0)):i=!0}),i&&(this.retriableCmdsQueue=[]),this.retriableCmdsQueue.length>0?this.retryCollabJSONDispatcher=setTimeout(this._handleCollabJSONRetry.bind(this),this.retryIntervalMilliSec):(clearTimeout(this.retryCollabJSONDispatcher),this.retryCollabJSONDispatcher=null)},e.prototype._sendCollabJSON=function(t){return null!=t&&this.wsClient.send(JSON.stringify(t)),!0},e.prototype._isModifiersReqeustSent=function(t){var e,i;return o.underscoreInst.some(this.retriableCmdsQueue,function(o){return(e=o.nondataCmds[0]).action===n.CmdNames.NONDATACMD_GETMODIFIERS&&e.endVersion===t&&(i=!0,!0)}),i},e.prototype._buildCollabCmdJSON=function(t,e){var o,r=[],a={};switch(o={action:t,cmdId:i.Utils.newGUID()},r.push(o),a.nondataCmds=r,t){case n.CmdNames.NONDATACMD_BLOCKSELECTION:o.blockId=e.selectedBlockId;break;case n.CmdNames.NONDATACMD_COLLABINFO:var s={sessionId:e.sessionId};void 0!==e.nickname&&(s.nickname=e.nickname),void 0!==e.lockedBlockId&&(s.lockedBlkIds=[],s.lockedBlkIds.push(e.lockedBlockId)),void 0!==e.portraitUrl&&(s.portraitUrl=e.portraitUrl),this._buildSessionInfoJSON(o,s);break;case n.CmdNames.NONDATACMD_DATACMDFAILED:o.dataCmdError=e.dataCmdErrorCode,o.errToClose=!!e.errToClose;break;case n.CmdNames.NONDATACMD_CLINTPONG:o.versionUpdate=e.noteVersion;break;case n.CmdNames.NONDATACMD_GETMODIFIERS:o.endVersion=e.endNoteVersion;break;case n.CmdNames.NONDATACMD_NOTESAVE:o.versionUpdate=e.noteVersion,o.isHistorySave=e.isHistorySave;break;default:throw a=null,new Error("Unsupported NondataCmd:"+t)}return a},e.prototype._buildSessionInfoJSON=function(t,e){var n={sessionId:e.sessionId};null!=e.nickname&&(n.nickname=e.nickname),null!=e.portraitUrl&&(n.portraitUrl=e.portraitUrl),null!=e.lockedBlkIds&&e.lockedBlkIds.length>0&&(n.lockedBlkId=e.lockedBlkIds[0]),t.sessionProp=[],t.sessionProp.push(n)},e.prototype._handleCollabInfo=function(t,e){var n=t.sessionProp,i=[];o.underscoreInst.each(n,function(t){var n={sessionId:null};null!=t.lockedBlkId&&(n.lockedBlkIds=[t.lockedBlkId],delete t.lockedBlkId),o.underscoreInst.extend(n,t),null==n.sessionId&&(n.sessionId=e.cmdSessionId),i.push(n)}),this.emit(a.default.SESSION_CHNAGED,i)},e.prototype._handleServerPing=function(t){if(null!=t.collabNoteReady){var e={isCollabStarted:t.collabNoteReady,resultCode:n.CustomResultCode.NO_ERROR,sessionId:this.wsClient.getSessionId()};this.emit(a.default.SESSION_INIT_BUILT,e)}},e.prototype._handleModifiers=function(t){var e=this;this.modifiers.status=1,this.modifiers.startVersion=t.startVersion,this.modifiers.endVersion=t.endVersion,this.modifiers.modifiers=[],o.underscoreInst.each(t.modifiers,function(t){var n={userId:t.userId};e.modifiers.modifiers.push(n)}),this._clearRetryQueueByAction(n.CmdNames.NONDATACMD_GETMODIFIERS),this.emit(a.default.NONDATACMD_MODIFIERS_RESULT,this.modifiers)},e.prototype._clearRetryQueueByAction=function(t){this.retriableCmdsQueue=o.underscoreInst.reject(this.retriableCmdsQueue,function(e){return e.nondataCmds[0].action===t&&(o.loggerInst.log("remove cmd from retryQueue by actionName:",t),!0)})||[]},e.prototype._removeFromRetryQueue=function(t){this.retriableCmdsQueue=o.underscoreInst.reject(this.retriableCmdsQueue,function(e){return e.nondataCmds[0].cmdId===t&&(o.loggerInst.log("remove cmd from retryQueue:",t),!0)})||[]},e.prototype._handleNoteSave=function(t){o.loggerInst.log("SaveNotification:",t)},e}(r.YEvent);e.NonDataCmdHandler=l}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";var a,s=this&&this.__extends||(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});o=[n,r,n(65),n(54)],void 0===(i=function(t,e,n,o){Object.defineProperty(e,"__esModule",{value:!0});var i=function(t){function e(e){var n=t.call(this)||this;return n.coreEditor=e,n.executedNotOwnCmdQueue=[],n}return s(e,t),e.prototype.destroy=function(){this.removeAllListeners(null)},e.prototype.applyCollabRedoUndo=function(t,e){var n,o=e.collabProperties.cmdJSON,i=o.isCollabUndo,r=o.isCollabRedo;return i?(e.collabProperties.isCollabUndo=!0,e.collabProperties.isCollabRedo=!1):r&&(e.collabProperties.isCollabUndo=!1,e.collabProperties.isCollabRedo=!0),(n=this.coreEditor.createDataCommand(t,e))&&(n.isOriginalCmd=!0,this.coreEditor.applyCollabCmdRedoUndo(n)),n},e.prototype.pushNotOwnExecCmd=function(t){this.executedNotOwnCmdQueue.push(t)},e.prototype.ValidateLocalRedoUndo=function(t){var e,o=!0,i=!1;return t.isCollabUndo?e=this.lastValidUndoCmd:t.isCollabRedo&&(e=this.lastValidRedoCmd),o&&((o=!this._isConflicted(t.getAffectedBlockIds(),t.getCmdFinalNoteVersion()))||(i=!0)),o&&e&&e.cmdId===t.cmdId&&(o=!1,n.loggerInst.warn("skip duplicated redo/undo command")),o?t.isCollabRedo?(this.lastValidRedoCmd=t,this.lastValidUndoCmd=null):t.isCollabUndo&&(this.lastValidUndoCmd=t,this.lastValidRedoCmd=null):(n.loggerInst.warn("Skip invalid Redo/Undo"),i&&(n.loggerInst.warn("Drop invalid Redo/Undo"),t.isCollabRedo?this.coreEditor.dropRedoCmd():t.isCollabUndo&&this.coreEditor.dropUndoCmds(null,null,null))),o},e.prototype.ValidateCollabRedoUndo=function(t,e){return!this._isConflicted(t,e)},e.prototype._isConflicted=function(t,e){var o,i,r=this,a=!1;return(i=(i=n.underscoreInst.filter(this.executedNotOwnCmdQueue,function(t){return t.getCmdFinalNoteVersion()>e}))||[]).length>0&&n.underscoreInst.some(i,function(e){if(r._isNoteRangeOverlap(t,e.getAffectedBlockIds()))return a=!0,o=e.getCollabProps(),n.loggerInst.log("Conflict: data has been edited by "+o.ownerName),!0}),a},e.prototype._isNoteRangeOverlap=function(t,e){var o=!1;return t&&t.length>0&&e&&e.length>0&&n.underscoreInst.some(t,function(t){return n.underscoreInst.some(e,function(e){return t===e&&(o=!0),o}),o}),o},e}(o.YEvent);e.RedoUndoHandler=i}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){(function(o){var i,r;void 0===(r=function(e,a){"use strict";var s,l=this&&this.__extends||(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}s(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});i=[n,a,n(119),n(65),n(225),n(54),n(100)],void 0===(r=function(t,e,i,r,a,s,c){Object.defineProperty(e,"__esModule",{value:!0});var u,d="buildVersion",p="collabId",h="nickname",f="portraitUrl",g="sessionId",m="sessionType",y="userId";!function(t){t[t.normal=0]="normal",t[t.readonly=1]="readonly",t[t.owner=2]="owner"}(u||(u={}));var v=function(t){function e(e){var i=t.call(this)||this;"undefined"==typeof window&&void 0!==o&&(o.WebSocket=n(621).w3cwebsocket);return i.collabPropsHandler=e,i}return l(e,t),e.prototype.connect=function(t){var e,n=t.useWSS?"wss":"ws";if("undefined"==typeof WebSocket)throw new Error("There is NO WebSocket type in Context.");if(null==t.collabServer)throw new Error("Param of options.collabServer should not be null");if(null==t.shareKey)throw new Error("Param of options.shareKey should not be null");if(null==t.nickname)throw new Error("Param of options.nickname should not be null");if(null==t.portraitUrl)throw new Error("Param of options.portraitUrl should not be null");if(null==t.userId)throw new Error("Param of options.userId should not be null");if(null==t.sessionId)throw new Error("Param of options.sessionId should not be null");if(null==t.sessionType)throw new Error("Param of options.sessionType should not be null");if(null==t.buildVersion)throw new Error("Param of options.buildVersion should not be null");e=n+"://"+t.collabServer+"?"+p+"="+t.shareKey+"&"+h+"="+t.nickname+"&"+f+"="+t.portraitUrl+"&"+y+"="+t.userId+"&"+m+"="+t.sessionType+"&"+g+"="+t.sessionId+"&"+d+"="+t.buildVersion,this.sessionOptions=t,r.loggerInst.log("Connect to",e),this.wsInst=new WebSocket(e),this.wsInst.onopen=this._onOpen.bind(this),this.wsInst.onclose=this._onClose.bind(this),this.wsInst.onmessage=this._onMessage.bind(this),this.wsInst.onerror=this._onError.bind(this)},e.prototype.getSessionId=function(){return this.sessionOptions.sessionId},e.prototype.getNickname=function(){return this.sessionOptions.nickname},e.prototype.getPortraitUrl=function(){return this.sessionOptions.portraitUrl},e.prototype.getUserId=function(){return this.sessionOptions.userId},e.prototype.getCollabId=function(){return this.sessionOptions.shareKey},e.prototype.isReadOnlySession=function(){return this.sessionOptions.sessionType===u.readonly},e.prototype.isOpened=function(){return null!=this.wsInst&&this.wsInst.readyState===this.wsInst.OPEN},e.prototype.send=function(t){var e,n=i.CustomResultCode.NO_ERROR;return e=2*t.length/1024,a.Utils.isMessageTooLarge(e)?n=i.WSCustomCode.MESSAGE_TOO_BIG:this.wsInst&&this.wsInst.readyState===WebSocket.OPEN?(r.loggerInst.log("sending message:",t),this.wsInst.send(t)):n=i.WSCustomCode.SESSION_NOT_OPENED,n},e.prototype.close=function(t,e){this.wsInst&&this.wsInst.readyState===WebSocket.OPEN&&(this.wsInst.onopen=null,this.wsInst.onclose=null,this.wsInst.onmessage=null,this.wsInst.onerror=null,this.wsInst.close(t,e),t!==i.WSCustomCode.CLOSED_BY_HOST&&this.emit(c.default.WS_CLOSED,this._assembleSessionError(t,t)))},e.prototype.sendDataCmdErrorCode=function(t){this.send(t.toString())},e.prototype._onOpen=function(t){r.loggerInst.log("Connection is opened.");var e={resultCode:i.CustomResultCode.NO_ERROR};this.emit(c.default.WS_OPENED,e)},e.prototype._onClose=function(t){r.loggerInst.log("Connection is closed."),this.emit(c.default.WS_CLOSED,this._assembleSessionError(t.code,parseInt(t.reason,10)))},e.prototype._onMessage=function(t){r.loggerInst.log("Received Message in WSClient:",t.data);try{if(null!=t.data&&""!==t.data){var e=JSON.parse(t.data),n=this.collabPropsHandler.buildCollabProperties(e);n.rawWSMessage=t.data;var o={collabCmdsJSON:e.collabCmds,collabProps:n,resultCode:i.CustomResultCode.NO_ERROR};this.emit(c.default.WS_MESSAGE,o)}}catch(t){r.loggerInst.error("Exception in WebSocketClient._onMessage:",t)}},e.prototype._onError=function(t){r.loggerInst.log("Caught Error:",t)},e.prototype._assembleSessionError=function(t,e){var n;switch(r.underscoreInst.isNaN(e)&&(e=1006===t?i.WSCustomCode.COLLAB_SERVER_UNREACHABLE:1005===t?i.WSCustomCode.COLLAB_SERVER_SHUTDOWN:1001===t?i.WSCustomCode.COLLAB_SESSION_CLOSED:t),e){case 2e3:n="连接总数超过上限";break;case 2001:n="单个文件连接总数超过上限";break;case 2002:n="重复的session链接";break;case 2003:n="所有者链接超过上限";break;case 3e3:n="转发命令失败";break;case 3001:n="添加链接失败";break;case 3003:n="命令转发进程无响应";break;case 3004:n="创建链接失败";break;case 3005:n="创建命令转发进程失败";break;case 3006:n="广播命令失败";break;case 3007:n="初始化链接失败";break;case 3008:n="未转发命令总数超上限";break;case 4001:n="等待命令返回超时";break;case 4002:n="发送命令失败";break;case 8e3:n="笔记长时间无操作";break;case 9e3:n="链接协同服务器失败";break;case 9003:n="协同服务器被强制关闭";break;case 9004:n="协同链接异常关闭，请检测session是否初始化成功";break;case 9100:n="当前编辑器版本太低";break;case 9101:n="链接被主动强制关闭";break;case 9102:n="协同命令执行失败";break;case 9103:n="重连次数超限";break;default:n="未知错误"}return{code:t,customCode:e,reason:n,resultCode:t,shareKey:this.sessionOptions.shareKey}},e}(s.YEvent);e.WebSocketClient=v}.apply(a,i))||(t.exports=r)}.apply(e,i=[n,e]))||(t.exports=r)}).call(this,n(67))},function(t,e,n){var o=function(){return this}(),i=o.WebSocket||o.MozWebSocket,r=n(622);function a(t,e){return e?new i(t,e):new i(t)}i&&["CONNECTING","OPEN","CLOSING","CLOSED"].forEach(function(t){Object.defineProperty(a,t,{get:function(){return i[t]}})}),t.exports={w3cwebsocket:i?a:null,version:r}},function(t,e,n){t.exports=n(623).version},function(t){t.exports={_args:[["websocket@1.0.28","/Users/lly/yd/bulb-pc/bulbeditor"]],_from:"websocket@1.0.28",_id:"websocket@1.0.28",_inBundle:!1,_integrity:"sha512-00y/20/80P7H4bCYkzuuvvfDvh+dgtXi5kzDf3UcZwN6boTYaKvsrtZ5lIYm1Gsg48siMErd9M4zjSYfYFHTrA==",_location:"/websocket",_phantomChildren:{},_requested:{type:"version",registry:!0,raw:"websocket@1.0.28",name:"websocket",escapedName:"websocket",rawSpec:"1.0.28",saveSpec:null,fetchSpec:"1.0.28"},_requiredBy:["/","/ycollablib"],_resolved:"https://registry.npmjs.org/websocket/-/websocket-1.0.28.tgz",_spec:"1.0.28",_where:"/Users/lly/yd/bulb-pc/bulbeditor",author:{name:"Brian McKelvey",email:"theturtle32@gmail.com",url:"https://github.com/theturtle32"},browser:"lib/browser.js",bugs:{url:"https://github.com/theturtle32/WebSocket-Node/issues"},config:{verbose:!1},contributors:[{name:"Iñaki Baz Castillo",email:"ibc@aliax.net",url:"http://dev.sipdoc.net"}],dependencies:{debug:"^2.2.0",nan:"^2.11.0","typedarray-to-buffer":"^3.1.5",yaeti:"^0.0.6"},description:"Websocket Client & Server Library implementing the WebSocket protocol as specified in RFC 6455.",devDependencies:{"buffer-equal":"^1.0.0",faucet:"^0.0.1",gulp:"git+https://github.com/gulpjs/gulp.git#4.0","gulp-jshint":"^2.0.4",jshint:"^2.0.0","jshint-stylish":"^2.2.1",tape:"^4.9.1"},directories:{lib:"./lib"},engines:{node:">=0.10.0"},homepage:"https://github.com/theturtle32/WebSocket-Node",keywords:["websocket","websockets","socket","networking","comet","push","RFC-6455","realtime","server","client"],license:"Apache-2.0",main:"index",name:"websocket",repository:{type:"git",url:"git+https://github.com/theturtle32/WebSocket-Node.git"},scripts:{gulp:"gulp",install:"(node-gyp rebuild 2> builderror.log) || (exit 0)",test:"faucet test/unit"},version:"1.0.28"}},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";var a,s=this&&this.__extends||(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});o=[n,r,n(0),n(4),n(7),n(53),n(32),n(50),n(10),n(220),n(27),n(2),n(278)],void 0===(i=function(t,e,n,o,i,r,a,l,c,u,d,p,h){return function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.currentBackground=i.DEFAULT_BACKGROUND,e}return s(e,t),e.prototype.canUndo=function(){return this.controller.canUndo()},e.prototype.canRedo=function(){return this.controller.canRedo()},e.prototype.clearHighlight=function(){this.note&&this.note.highlight([""]),this.note.clearHighlight()},e.prototype.countWords=function(t){var e=this.getNoteRange();return this.note.countWords(e,t)},e.prototype.execCommandByToolbar=function(t,e){var n,o,i=this.getNoteRange(),r=this.getTableOnCellEdit(i);r&&(n=this.noteView.getBlockViewByBlock(r))&&n.editCellFromToolbar&&(o=n.editCellFromToolbar(t,e)),o||("undo"===t?this.undo():"redo"===t?this.redo():this.execCommand(t,e))},e.prototype.execCommand=function(t,e){return this.controller.execCommand(t,e)},e.prototype.focus=function(){this.noteView.$el.focus()},e.prototype.getController=function(){return this.controller},e.prototype.getNoteView=function(){return this.noteView},e.prototype.getHtmlContent=function(t,e,n){var o;if(null!=this.getHtmlContentTimer&&(clearTimeout(this.getHtmlContentTimer),this.getHtmlContentTimer=null),!this.contentLoading||null==e)return o=this.note.toHtml(null,!0===t),null!=e&&e({status:1,content:o}),o;n&&(this.isReadOnly()||this.makeReadOnly(!0),this.noteView.removeNote()),this.getHtmlContentTimer=setTimeout(this.getHtmlContent.bind(this,t,e,n),100)},e.prototype.getNoteRange=function(){return this.controller.getNoteRange()},e.prototype.getPlainContent=function(){return this.note.toPlain()},e.prototype.getSchemaVersion=function(){return this.note.getSchemaVersion()},e.prototype.getXmlContent=function(t,e){var n;if(null!=this.getXmlContentTimer&&(clearTimeout(this.getXmlContentTimer),this.getXmlContentTimer=null),!this.contentLoading||null==t)return n=this.note.toXml(),null!=t&&t({status:1,content:n}),n;e&&(this.isReadOnly()||this.makeReadOnly(!0),this.noteView.removeNote()),this.getXmlContentTimer=setTimeout(this.getXmlContent.bind(this,t,e),100)},e.prototype.hasHandWriteBlock=function(){return this.note.hasHandWriteBlock()},e.prototype.highlight=function(t,e){this.note&&this.note.highlight(t,e)},e.prototype.insertImage=function(t){return this.controller.insertImage(t)},e.prototype.insertAttachment=function(t){return this.controller.insertAttachment(t)},e.prototype.isNotSetContent=function(){return this.notSetContent},e.prototype.isReadOnly=function(){return this.controller.isReadOnly()},e.prototype.nextHighlight=function(){this.note&&this.note.nextHighlight()},e.prototype.preHighlight=function(){this.note&&this.note.preHighlight()},e.prototype.getNoteContentStatus=function(){return!!this.note&&this.note.getContentStatus()},e.prototype.querySelectionInlineStyle=function(t){return this.controller.querySelectionInlineStyle(t)},e.prototype.querySelectionBlockStyle=function(t){return this.controller.querySelectionBlockStyle(t)},e.prototype.querySelectionInlineStyles=function(){return this.controller.querySelectionInlineStyles()},e.prototype.querySelectionBlockStyles=function(){return this.controller.querySelectionBlockStyles()},e.prototype.redo=function(){return this.controller.redo()},e.prototype.render=function(){null!=this.noteProps&&(this.noteProps.sessionType?(this.noteProps.sessionType=parseInt(this.noteProps.sessionType,10),1===this.noteProps.sessionType?this.setReadOnly(!0):this.setReadOnly(!1)):this.noteProps.readOnly?this.setReadOnly(!0):this.setReadOnly(!1))},e.prototype.rerenderNoteView=function(){this.noteView.render()},e.prototype.resetEditingInlineStates=function(){return this.controller.resetEditingInlineStates()},e.prototype.setEditingInlineStyles=function(t){return this.controller.setEditingInlineStyles(t)},e.prototype.reset=function(){var t=this.getNoteViewWrapper();this.controller&&this.controller.reset(),this.noteView&&this.noteView.reset(),this.note&&this.note.reset(),this.note.removeEntityCache(),h.reset(),this.notSetContent=!0,t&&this.noteView.isInPageMode()&&t.find(".page-break").remove(),null!=this.getHtmlContentTimer&&(clearTimeout(this.getHtmlContentTimer),this.getHtmlContentTimer=null),null!=this.getXmlContentTimer&&(clearTimeout(this.getXmlContentTimer),this.getXmlContentTimer=null),this.contentChanged=!1,this.contentLoading=!1,this.currentBackground=i.DEFAULT_BACKGROUND},e.prototype.resetFont=function(){r.resetCssRules(),a.reset(),this.noteView.reRenderTextBlockView()},e.prototype.selectAll=function(){return this.controller.selectAll()},e.prototype.setAllBackgrounds=function(t,e){this.trigger("set-all-backgrounds",n.clone(t),e),this.currentBackground=i.DEFAULT_BACKGROUND},e.prototype.setBackground=function(t){var e=this.currentBackground;this.updateContainerBackground(t)&&this.trigger("set-background",e,t)},e.prototype.setFont=function(t,e){if(t||e){var n,o={};t&&(n=a.getDefault("font-size"),o["font-size"]=function(e){var o=e["font-size"];if(null!=o)return Math.round(t*o/n)+"px"},r.setCssRules(o)),e&&(a.setDefault("font-family",e),r.resetInlineStyleDefaultForHtml("font-family")),this.noteView.reRenderTextBlockView()}},e.prototype.setNoteRange=function(t){this.controller.noteSelection.setRange(t)},e.prototype.setPasteAsText=function(t){this.controller.setPasteAsText(t)},e.prototype.setEntity=function(t,e){var n=this;this.controller.setEntity(t,e),setTimeout(function(){n.trigger("yne-content-change")})},e.prototype.setReadOnly=function(t){t=!!t,this.noteProps.isReadOnly=t,this.makeReadOnly(t)},e.prototype.setDragProhibited=function(t){t=!!t,this.noteProps.isDragProhibited=t,this.controller.setDragProhibited(t)},e.prototype.setCopyProhibited=function(t){t=!!t,this.noteProps.isCopyProhibited=t,this.controller.setCopyProhibited(t)},e.prototype.setViewMode=function(t,e,n){t=c.IS_PC?u.parseToNumber(t,1):u.parseToNumber(t,0),this.updateEditorProps({viewMode:t}),c.IS_PC&&(1===t?$(this.getNoteViewWrapper()).toggleClass("read-mode",!0):$(this.getNoteViewWrapper()).toggleClass("read-mode",!1)),this.noteView.setViewMode(t,!this.isNotSetContent()),!0===e&&this.trigger("view-mode-change",t),!0===n&&this.trigger("yne-view-mode-change",t),this.controller.resizeSpecialBlock()},e.prototype.undo=function(){return this.controller.undo()},e.prototype.updateBackground=function(t){var e=this.currentBackground;this.updateContainerBackground(t)&&(e||(e=i.DEFAULT_BACKGROUND),this.trigger("yne-background-changed",e,t))},e.prototype.updateEditorProps=function(t){null==this.editorProps&&(this.editorProps={}),n.extend(this.editorProps,t),n.extend(this.options,t)},e.prototype.updateNoteViewVisibility=function(t){t?this.noteView.$el.css("visibility","visible"):this.noteView.$el.css("visibility","hidden")},e.prototype.setInputType=function(t){this.controller.setInputType(t)},e.prototype.getInputType=function(){return this.controller.getInputType()},e.prototype.getOutputType=function(t){return this.hasHandWriteBlock()?"html":this.controller.getOutputType(t)},e.prototype.setDataFixed=function(t){this.controller.setDataFixed(t)},e.prototype.isDataFixed=function(){return this.controller.isDataFixed()},e.prototype.initialize=function(t){var e=this;this.clientId=o.newGUID(),this.notSetContent=!0,this.bindEventsForController(),this.on("background-failed-update",function(t,n){null!=n&&e.updateContainerBackground(n),0===t&&e.trigger("yne-background-failed-update",t)}),this.contentChanged=!1,this.contentLoading=!1},e.prototype.makeReadOnly=function(t){this.controller.setReadOnly(t),c.IS_PC?t?this.toolbar.toggleToolbar(!1):this.toolbar.toggleToolbar(!0):t?this.toolbar.disable():this.toolbar.enable()},e.prototype.bindEventsForController=function(){var t=this,e=this.controller;e.on("command-exec",function(e,n){e&&e.name?e&&e.effected?(t.contentChanged=!0,t.trigger("yne-content-change")):p.warn("The command has no effected",e):p.error("The command is not valid",e)}),l.bubble(["redo-stack-change","undo-stack-change","selectstart","mouse-down","command-exec","esc","yne-clipboard-status","yne-clipboard-error","yne-get-clipboard","yne-clipboard-set","color-picker-show","yne-user-action-collection","cell-edit-view-enter","cell-edit-view-exit","cell-edit-view-history-change"],e,this)},e.prototype.updateContentSetProgress=function(t){!0===this.contentLoading&&(t.isAsync&&this.progressTracker.updateContentSetProgress(t),n.isNumber(t.percent)&&t.percent>=1&&(this.isLegacyHost()&&!this.noteProps.isReadOnly&&this.makeReadOnly(!1),this.contentLoading=!1))},e.prototype.getTableOnCellEdit=function(t){var e;if(t&&t.isSingleTableSelected())return(e=t.getStartBlockRange())&&e.isOnCellEdit&&e.isOnCellEdit()?e.block:void 0},e}(d)}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";var a,s=this&&this.__extends||(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});o=[n,r,n(0),n(79),n(4),n(63),n(55),n(289),n(50),n(10),n(27),n(2),n(205),n(626),n(674),n(7),n(3),n(28),n(12),n(129),n(32),n(163),n(6),n(44),n(21),n(675),n(303),n(304),n(305),n(30),n(677)],void 0===(i=function(t,e,n,o,i,r,a,l,c,u,d,p,h,f,g,m,y,v,_,b,C,k,w,S,x,E,I,T,O,A){return function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.inputType="xml",e.dataFixed=!1,e}return s(e,t),e.prototype.addDragHint=function(t,e){var n,o,i=this.getRangeByPoint(t,e),r=this.noteView.parseNativeRange(i)[0];return this.getNoteRange()?(n=this.getNoteRange().getStartBlockRange())&&r?!(r.block===n.block&&r.start>=n.start&&r.start<n.end)&&(this.lastDragOver?o=this.lastDragSpace.parentNode.removeChild(this.lastDragSpace):((o=document.createElement("span")).id="drop-hint",this.lastDragOver={}),this.lastDragOver.x=t,this.lastDragOver.y=e,this.lastDragSpace=o,void i.insertNode(o)):(p.error("addDragHint:startRange and dragRange should not be null",n,r),!1):(p.error("addDragHint:Failed to get NoteRange"),!1)},e.prototype.canRemoveFormat=function(){var t=this.getNoteRange();return t&&!t.isCollapsed()},e.prototype.canUndo=function(){return this.cmdManager.canUndo()},e.prototype.canRedo=function(){return this.cmdManager.canRedo()},e.prototype.createCmd=function(t,e){return this._createCmd(t,e)},e.prototype.defaultNoteRange=function(){var t,e,n=this.note;if(n&&(t=n.getBlockAt(0)))return e=S.createRangeByBlock({allContent:!1,block:t,collapseToStart:!0}),new x({endRange:e,startRange:e})},e.prototype.execBackTab=function(){this.execCommand("comp.KeyTab",{inlineStyles:this.editingInlineStates,withShiftKey:!0})},e.prototype.execCommand=function(t,e){var o,r,a=this;if(r=(e=n.defaults(e||{},{collabProperties:a.editor.buildCollabProperties()})).collabProperties.isCollabCmd,!a.isReadOnly()||r)if(e.isOriginalCmd=!0,(o=a._createCmd(t,e))&&!o.cmdError){if(!i.isInlineStateSetCommand(o))return a.isCollabEnabled()?(o.isOriginalCmd=!0,r?a._executeCollabCmd(o,e):a._handleLocalCmdInCollabMode(o,e),e.collabProperties.dataCmdError&&p.error(e.collabProperties.dataCmdError),o):a._executeLocalCmd(o,e);n.each(e.inlineStyles,function(t,e){a.setEditingInlineState(e,t)})}else p.error("Failed to create/initialize command:"+t);else a.editor.notifyErrorToHost(m.INVALIDACTION_EDIT_READ_ONLY)},e.prototype.execCmdByShortCut=function(t,e){this.editor.execCommandByToolbar(t,e)},e.prototype.execDeleteBackward=function(t){var e,n;n=(e=(t=t||this.getNoteRange()).getStartBlockRange()).block,t?(y.isHeading(n)&&t.isCollapsed()&&e.isCollapsed()&&0===e.start?this.resetEditingInlineStates():n.isEmpty()||this._updateDeleteInlineStates(this.queryBackwardFirstInlineStyles(t)),this.execCommand("comp.KeyBackspace",{inlineStyles:this.editingInlineStates})):p.error("noteRange not found")},e.prototype.execDeleteForward=function(){var t=this.getNoteRange();t?(this._updateDeleteInlineStates(this.queryForwardFirstInlineStyles(t)),this.execCommand("comp.KeyDelete")):p.error("noteRange not found")},e.prototype.execDeleteToEnd=function(){var t,e=this.getNoteRange();if(e){if(!e.isCollapsed())return this._onDeleteSelection();t=e.clone(!0),e.getEndBlockRange().expandToEnd(),this.execDeleteBackward(t)}},e.prototype.execInsertDate=function(){var t,e=new Date,n=function(t){return o.pad(t,2,"0","left")};t=" "+e.getFullYear()+"/"+n(e.getMonth()+1)+"/"+n(e.getDate())+" "+n(e.getHours())+":"+n(e.getMinutes())+" ",this.insertText(t,!1)},e.prototype.execKeyHandler=function(t){this.keyHandlerManager.execWithName(t,this,{})},e.prototype.getDefaultFont=function(){return this.defaultFont},e.prototype.getEditingInlineState=function(t){var e=this.editingInlineStates||{};return t?e[t]:e},e.prototype.getNextCaretBlockRange=function(){var t,e,n,o=this.getNoteRange().getStartBlockRange().block;return y.isTextOrTableBlock(o)||(t=this._getNextCaretBlock(o))&&(e=S.createRangeByBlock({allContent:!1,block:t,collapseToStart:!0}),n=new x({endRange:e,startRange:e}),this.noteSelection.setRange(n)),n},e.prototype.getNoteRange=function(){var t=this.noteSelection.getRange();return t||(t=this.defaultNoteRange()),t},e.prototype.getRangeByPoint=function(t,e){var n,o;return n=document.caretRangeFromPoint(t,e),(o=document.createRange()).setStart(n.startContainer,n.startOffset),o},e.prototype.hasKeyHandler=function(t){return this.keyHandlerManager.hasHandler(t)},e.prototype.innerGoto=function(t){var e,n;if(e=document.getElementById(t),this.pageViewManager&&!e&&(this.pageViewManager.activePageByBlockId(t),e=document.getElementById(t)),!e)return p.warn("No find the block!");window.location.hash="#"+t,(n=document.createRange()).setStart(e.lastChild,1),n.setEnd(e.lastChild,1),a.setRange(n,window),window.location.hash=""},e.prototype.insertAttachment=function(t){var e,n=this.getNoteRange();if(!t||!t.src)return p.log("Error: attachment data is invald! "+t);switch(e=t.resource&&t.fileName?"attachment":"image",this.noteSelection.setRange(n),e){case"attachment":this.execCommand("comp.InsertAttachment",{fileLength:t.fileLength,fileName:t.fileName,resource:t.resource,src:t.src});break;case"image":this.insertImage(t.src)}},e.prototype.insertImage=function(t){var e=this.getNoteRange();t&&(this.noteSelection.setRange(e),this.execCommand("comp.InsertImage",{src:t}))},e.prototype.insertText=function(t,e){var o,i,r=C.getAllDefault();t instanceof _?o=t:(i=this.editingInlineStates,o=new _({text:t}),n.isEqual(r,i)||o.setStyles(0,o.getLength(),i)),this.execCommand("comp.KeyTextInput",{recogLink:e,text:o})},e.prototype.isDragProhibited=function(){return this.dragProhibited},e.prototype.isCopyProhibited=function(){return this.isCopyProhibited},e.prototype.isCollabEnabled=function(){return null!=this.editor&&this.editor.isCollabEnabled&&this.editor.isCollabEnabled()},e.prototype.isReadOnly=function(){return this.readOnly},e.prototype.isSameList=function(t){var e=this.note,n=this.getNoteRange();return!!n&&e.isSameList(n,t)},e.prototype.isValidNoteRange=function(t){var e=this,n=function(t){var n;return!(!t||!t.block)&&(n=t.block,e.note.getBlockIndex(n)>-1)};return!!t&&(e.isValidHeaderFooterRange(t)||n(t.getStartBlockRange())&&n(t.getEndBlockRange()))},e.prototype.isValidHeaderFooterRange=function(t){var e=this.note,o=t.getStartBlockRange(),i=t.getEndBlockRange();return n.all([o,i],function(t){if(!t||!t.block)return!1;var n=t.block;return e.getHeaderFooter(!0)===n||e.getHeaderFooter(!1)===n})},e.prototype.moveCaretWithDirection=function(t,e){this._onMoveCaretWithDirection(t,e)},e.prototype.lockBlockById=function(t){this.isCollabEnabled()&&this._sendBlockLockInfo(t)},e.prototype.onCommand=function(t,e){this.execCommand(t,e)},e.prototype.onUpdateSelection=function(t,e,n){var o;n&&n.inlineStyles&&(o=n.inlineStyles),this.noteSelection.setRange(t,I.createCommandTypeEvent(e),o)},e.prototype.onPaste=function(t){var e,n,o,i,r,a,s;if(t.preventDefault(),u.IS_MAC)this._pasteForMac();else{if(e=new T({event:t}),this.isPasteAsText)return s=e.getData("text/plain"),void this._pastePlain(s,this.isPasteAsText);n=e.getData("text/yne-json"),o=e.getData("text/yne-image-json"),r=e.getData("text/yne-note-id"),n&&this._pasteJSON(n,o,r)||(i=e.getData("text/yne-table-json"))&&this.pasteYTableJson(i)||((a=e.getData("text/html"))&&this._pasteHTML(a)?p.log("paste html ok"):(s=e.getData("text/plain"))?this._pastePlain(s,this.isPasteAsText):this._pasteBlobImg(t))}},e.prototype.pasteForTable=function(t){var e,n=this.getNoteRange(),o=n.getStartBlockRange(),i=n.getEndBlockRange(),r=o.block,a=i.block,s=this.noteView;return!(!y.isTable(r)||r.getId()!==a.getId())&&(!(!(e=s.getBlockViewByBlock(r))||!e.pasteBlockList)&&e.pasteBlockList(t))},e.prototype.queryBackwardFirstInlineStyles=function(t,e){var n,o,i,r,a,s=C.getAllDefault();if(t=t||this.getNoteRange()){if(o=(n=t.getStartBlockRange()).block,y.isTextBlock(o))return o.isEmptyContent()?o.getInlineStylesForEmpty()||e||this.getDefaultFont()||s:(r=n.start,a=o.getLength(),(t.isCollapsed()||r>=a)&&(r=r>0?r-1:0),i=o.getTextStylesAtIndex(r),this._omitLinkStylesIfNeeded(i,t))}else p.warn("noteRange is null")},e.prototype.queryForwardFirstInlineStyles=function(t){var e,n,o,i,r;if(t=t||this.getNoteRange()){if(n=(e=t.getEndBlockRange()).block,y.isTextBlock(n))return n.isEmptyContent()?n.getInlineStylesForEmpty()||C.getAllDefault():(i=e.end,r=n.getLength(),(!t.isCollapsed()||i>=r)&&(i=i>0?i-1:0),o=n.getTextStylesAtIndex(i),this._omitLinkStylesIfNeeded(o,t))}else p.error("noteRange is null")},e.prototype.querySelectionCodeInfo=function(t){if(t=t||this.getNoteRange()){var e=t.getStartBlockRange().block;return{"code-theme":e.getTheme(),"code-language":e.getLanguage()}}p.warn("noteRange not found")},e.prototype.querySelectionInlineStyle=function(t,e){var n=this.note;if(e=e||this.getNoteRange())return n.getCommonInlineStyle(e,t);p.warn("noteRange not found")},e.prototype.querySelectionBlockStyle=function(t,e){var n=this.note;if(e=e||this.getNoteRange())return n.getRangeBlockStyle(e,t);p.warn("noteRange not found")},e.prototype.querySelectionInlineStyles=function(t){var e,o,i,r,a=this,s={},l=C.getStyleNames();if(t=t||a.getNoteRange())return e=t.getStartBlockRange(),t.isSingleTableSelected()&&e.isOnCellEdit()&&(o=e.block,i=a.noteView.getBlockViewByBlock(o))?(r=i.getCellEditView(),s=r.queryInlineStylesForBulb()):(n.each(l,function(e){s[e]=a.querySelectionInlineStyle(e,t)}),s);p.warn("noteRange not found")},e.prototype.querySelectionBlockStyles=function(t){var e,o,i=this,r={};if(t=t||i.getNoteRange())return e=b.getAllStyleNames(),o=k.getAllStyleNames(),e=e.concat(o),n.each(e,function(e){r[e]=i.querySelectionBlockStyle(e,t)}),r;p.warn("noteRange not found")},e.prototype.redo=function(){var t=this.cmdManager;if(!this.isCollabEnabled())return t.redo();var e={collabProperties:{coreEditor:this.editor,isCollabRedo:!0}};return this._redoUndoLocalCmdInCollabMode(e)},e.prototype.removeDragHint=function(){this.lastDragSpace&&this.lastDragSpace.parentNode&&this.lastDragSpace.parentNode.removeChild(this.lastDragSpace),this.lastDragOver=this.lastDragSpace=null},e.prototype.removeShortCut=function(t){var e=this.keyHandlerManager;e&&e.unbind(t)},e.prototype.reset=function(){this.cmdManager&&this.cmdManager.reset(),this.noteSelection&&this.noteSelection.reset(),this.resetEditingInlineStates(),this.defaultFont=null,this.readOnly=!1},e.prototype.resetEditingInlineStates=function(){var t=C.getAllDefault();this.setEditingInlineStates(null),this.trigger("yne-editing-state-change",t)},e.prototype.setEditingInlineStyles=function(t){this.setEditingInlineStates(t),t||(t=C.getAllDefault()),this.trigger("yne-editing-state-change",t)},e.prototype.resizeSpecialBlock=function(){var t=this.note;n.each(t.blocks,function(t){(y.isTable(t)||y.isImage(t))&&t.trigger("view-resize")})},e.prototype.selectAll=function(){return this.noteView.onSelectAll()},e.prototype.setDefaultFont=function(t,e){this.defaultFont=this.defaultFont||{},t&&(this.defaultFont["font-family"]=t,this.setEditingInlineState("font-family",t)),e&&(this.defaultFont["font-size"]=e,this.setEditingInlineState("font-size",e))},e.prototype.setEditingInlineState=function(t,e){var n={};this.isReadOnly()||(this.editingInlineStates||(this.editingInlineStates={}),this.editingInlineStates[t]=e,n[t]=e,this.trigger("yne-editing-state-change",n),this.isLinkStylesChanged=this._isLinkStyles(t))},e.prototype.setEditingInlineStates=function(t){this.editingInlineStates=t,this.isLinkStylesChanged=!1},e.prototype.setOptions=function(t){var e;this.reset(),this.readOnly=t.isReadOnly,e=this.note=t.note,c.bubble(["color-picker-show","yne-user-action-collection"],e,this,!0),c.addListeners({"get-block-view":"_onGetBlockView","get-default-set-font":"_onGetDefaultSetFont"},e,this,!0)},e.prototype.setPasteAsText=function(t){this.isPasteAsText=t},e.prototype.setEntity=function(t,e){this.note.setEntityCache(t),this.note.setEntity(t,e)},e.prototype.setDragProhibited=function(t){t=!!t,this.dragProhibited=t,this.note.setDragProhibited(t)},e.prototype.setCopyProhibited=function(t){t=!!t,this.note.setCopyProhibited(t)},e.prototype.setReadOnly=function(t){var e=this;t=!!t,e.isReadOnly()!==t&&(e.readOnly=t,n.each(["note"],function(n){var o=e[n];o&&o.setReadOnly&&o.setReadOnly(t)}))},e.prototype.toggleInlineStyle=function(t){var e,n=this.getNoteRange(),o={};n?(e=n.isCollapsed()?!this.editingInlineStates[t]:!0!==(e=this.querySelectionInlineStyle(t)),o[t]=e,this.execCommand("comp.ApplyStyles",{inlineStyles:o})):p.warn("noteRange not found")},e.prototype.undo=function(){var t=this.cmdManager;if(!this.isCollabEnabled())return t.undo();var e={collabProperties:{coreEditor:this.editor,isCollabUndo:!0}};return this._redoUndoLocalCmdInCollabMode(e)},e.prototype.updateShortCut=function(t,e){var n=this.keyHandlerManager;n&&n.updateKey(t,e)},e.prototype.zoomInEditor=function(){this.editor.setZoomPercent(1)},e.prototype.zoomOutEditor=function(){this.editor.setZoomPercent(-1)},e.prototype.zoomEditor=function(){this.editor.zoomEditor(1,!0)},e.prototype.setInputType=function(t){this.inputType="html"===t||"json"===t?t:"xml"},e.prototype.getInputType=function(){return this.inputType},e.prototype.setDataFixed=function(t){this.dataFixed=t},e.prototype.isDataFixed=function(){return this.dataFixed},e.prototype.getOutputType=function(t){var e,n=this.inputType;if("string"==typeof t&&["xml","html","json"].indexOf(t)>-1)return t;if("string"==typeof t)try{t=JSON.parse(t)}catch(t){return"xml"}return t&&(e=t[n]),e&&["xml","html","json"].indexOf(e)>-1?e:"xml"},e.prototype.getRangeData=function(t){var e=this.note,n={"text/yne-json":t.getDataAsJSON(e),"text/html":'<meta charset="utf-8">'+t.getDataAsHtml(e),"text/plain":t.getDataAsPlain(e),"text/yne-note-id":e.getNoteId()},o=this._getImgDomInRange(t);return n["text/yne-image-json"]=this._getImageDataAsJson(o),this._addYneTableData(e,t,n),n},e.prototype.initialize=function(t){var e=t.noteView;this.cmdManager=new g(t),this.cmdFactory=new f(t),this.removeLocalImg=t.removeLocalImg||!1,this.setOptions(t),this.noteView=e,this.noteSelection=new E({noteView:this.noteView}),this._initKeyHandlerManager(t.keyHandlerNames),this.editor=t.editor,this.imgTitleInput=t.imgTitleInput,this._bindEvents()},e.prototype.pasteYTableJson=function(t){if(n.isString(t))try{t=JSON.parse(t)}catch(t){return void p.error("parse ytable json  string error")}return this._pasteJSON([{blockType:y.TABLE,data:t}])},e.prototype._addYneTableData=function(t,e,n){if(e.isSingleTableSelected()){var o=e.getStartBlockRange().getDataAsJSON(!0);o&&(n["text/yne-table-json"]=JSON.stringify(o))}},e.prototype._bindEvents=function(){var t=this,e=t.cmdManager,n=t.noteView;c.addListeners({"update-selection":"onUpdateSelection","command-exec":"_onCommandExec"},e,t),c.bubble(["redo-stack-change","undo-stack-change"],e,t),c.addListeners({"selection-change":"_onSelectionChange"},t.noteSelection,t),c.bubble({contextmenu:!0,selectstart:!0,"mouse-down":!0,"yne-replace-image":!0,"yne-replace-attachment":!0,"yne-download-image":!0,"yne-preview-image":!0,"yne-get-exif-data":!0,"yne-download-attachment":!0,"yne-get-entity":!0,"yne-replace-img-url":!0,"yne-mac-preview":!0,"yne-open-image":!0,"yne-open-attachment":!0,"yne-on-paste":!0,"yne-blob-paste":!0,"open-link":"yne-open-link","cell-edit-view-exit":!0,"cell-edit-view-history-change":!0,"yne-image-ocr":!0},n,t),c.bubble(["link-menu-hide","locked-change"],n,t.editor.linkView),c.addListeners({"delete-selection":"_onDeleteSelection","text-input":"_onTextInput","key-pressed":"_onKey",command:"onCommand",copy:"_onCopy",cut:"_onCut",paste:"onPaste",dragstart:"_onDragStart",dragover:"_onDragOver",drop:"_onDrop",dragend:"_onDragEnd","note-append-blankparagraph":"_onAppendBlankParagraph",onCompositionStart:"_onCompositionStart","inner-goto":"innerGoto","header-footer-view-text-change":"_onHeaderFooterViewTextChange","backup-drag-range":"_onBackupDragRange","get-note-range":"_onGetNoteRange","move-caret":"_onMoveCaretWithDirection","global-redo":"redo","global-undo":"undo","cell-edit-view-enter":"_onEnterTableEdit","cell-edit-view-selection-change":"_onCellEditViewSelectionChange","cell-edit-view-command-executed":"_onCellEditViewSelectionChange","save-content":"_onSaveContent"},n,t),n.on("get-editing-styles",function(e){e(t.editingInlineStates)}),n.on("get-entity",t._getEntity),n.on("replace-img-url",t._requestImagSrc),n.on("get-exif-data",t._getExifData),t.editor&&t.editor.onDocSelectionChange&&t.noteSelection.on("doc-change-selection",t.editor.onDocSelectionChange,t.editor),n.on("yne-click",function(){t.editor.recoverFromIdleTimeout(),t.trigger("yne-click")}),n.on("link-menu-show",function(e){t.editor.linkView.trigger("link-menu-show",e)}),n.on("get-image-items",t._getImgItems),t.imgTitleInput&&c.bubble(["img-title-edit-start","img-title-edit-end","img-title-edit-focus","img-title-edit-exit","img-title-edit-update","locked-change"],n,t.imgTitleInput)},e.prototype._createCmd=function(t,e){var n=this.cmdFactory;return e.range||i.isCollabCommand(e)||(e.range=this.getNoteRange()||x.createMock()),n.create(t,this.note,e)},e.prototype._executeCollabCmd=function(t,e){var n=this.getNoteRange();!1===this.cmdManager.exec(t,n,e)&&e.collabProperties.isOwnCmd&&this.editor.notifyErrorToHost(m.INVALIDACTION_FAILED_COLLABCMD)},e.prototype._executeLocalCmd=function(t,e){var n;if(!t||!1!==t.isReadyToApply)return n=this.getNoteRange(),this.cmdManager.exec(t,n,e)},e.prototype._getImgDomInRange=function(t){var e,o,i,r,a=this.note,s=this.noteView,l=t.getStartBlockRange(),c=t.getEndBlockRange(),u=a.getBlockIndex(l.block),d=a.getBlockIndex(c.block),p={};for(e=u;e<=d;e++)o=null,i=a.getBlockAt(e),y.isImage(i)&&(r=s.blockViews[e].getImgElement(),p[i.getId()]={img:r,source:i.getSource()}),y.isTable(i)&&(e===u&&(o=l),e===d&&(o=c),n.extend(p,s.blockViews[e].getImageDomMapByTableRange({selectAll:!o,tableRange:o})));return p},e.prototype._getImageDataAsJson=function(t){var e=l.getBase64Data(t);return JSON.stringify(e)},e.prototype._getNextCaretBlock=function(t){for(var e=this.note.getNextBlock(t);e&&(!this._isCaretBlock(e)||e.isLocked());)e=this.note.getNextBlock(e);return e},e.prototype._getImgItems=function(t){var e=this.note.blocks,o=[],i=0;n.each(e,function(e){if(e&&y.isImage(e)){var n=e.getSource().replace(location.protocol+"//"+location.hostname,"");t===e&&(i=o.length),o.push({index:o.length,name:e.getTitle(),preSrc:n,src:n})}}),this.trigger("yne-preview-image",[i,o])},e.prototype._getEntity=function(t,e){var n;if(this.note.entityExistInCache(e)){if((n=this.note.getBlockById(t))&&n instanceof v){var o=this.note.getEntityCache(e);n.setEntity(o)}}else this.trigger("yne-get-entity",e,t)},e.prototype._requestImagSrc=function(t){var e=this;t.noteId=this.note.getNoteId(),setTimeout(function(){e.trigger("yne-replace-img-url",t)})},e.prototype._getExifData=function(t){var e=this;setTimeout(function(){e.trigger("yne-get-exif-data",t)})},e.prototype._getPreCaretBlock=function(t){for(var e=this.note.getPreBlock(t);e&&(!this._isCaretBlock(e)||e.isLocked());)e=this.note.getPreBlock(e);return e},e.prototype._getUploadData=function(t,e,o){var i,r=0,a=[],s={},c={};if(!(n.isEmpty(t)||n.isEmpty(e)&&n.isEmpty(o)))return i=l.setBlockIds(o,t),n.each(t,function(t,e){t.base64&&(a.push({id:r,url:e,blob:l.base64ToBlob(t.base64),isGroup:u.isFromWebGroup(e)}),s[r]=t.imgBlockIds,r++)}),n.each(e,function(t){var e=t.getSource(),o=e+"_"+t.getResource(),i=t.getId();n.isUndefined(c[o])?(c[o]=r,s[r]=[i],a.push({id:r,source:e,resource:t.getResource(),isGroup:u.isFromWebGroup(e)}),r++):s[c[o]].push(i)}),{data:a,map:s,replaceImgList:i}},e.prototype._handleLocalCmdInCollabMode=function(t,e){var n,o,i,r=!0;n=this.getNoteRange(),t.setCmdOriginalNoteVersion(this.note.getFileVersion()),this.editor.isValidLocalDataCmd(t)?(o=this.noteView.isOnComposition&&"comp.KeyBackspace"===t.name,i=t.isSingleBlockAffected()&&this.editor.isMyOwnLockedBlock(e.range)&&this.editor.isLastOwnDataCmdExecuted(),o||i?!1===this.cmdManager.exec(t,n,e)?(r=!1,this.editor.notifyErrorToHost(m.INVALIDACTION_FAILED_LOCALCMD)):t.effected?t.isLocalExecutedCmd=!0:r=!1:t.isLocalExecutedCmd=!1,r?this.editor.pushLocalDataCommand(t,o):p.warn("NotReadyToSend:",t)):p.warn("skip invalid local command")},e.prototype._initKeyHandlerManager=function(t){var e=this,o=e.keyHandlerManager=new w({});o.on("bind-key",function(t){var n=e.noteView;n&&n.bindKey(t)}),o.on("unbind-key",function(t){var n=e.noteView;n&&n.unbindKey(t)}),t=t||o.getAvailableHandlerNames(),n.each(t,function(t){o.bind(t)})},e.prototype._isCaretBlock=function(t){return y.isTextBlock(t)||y.isImage(t)||y.isAttachment(t)||y.isTable(t)},e.prototype._isLinkStyles=function(t){return n.contains(["color","underline"],t)},e.prototype._isPartlyOverlapWithAnchor=function(t){var e,n,o,i,r,a,s;return!(!t||!t.isInSingleBlock())&&((n=(e=t.getStartBlockRange()).block)instanceof v&&((o=e.start)===(i=e.end)?(o>0&&(a=n.getTextStyle("href",o-1,o)[0]),o<n.getLength()&&(s=n.getTextStyle("href",o,o+1)[0]),(a||s)&&a!==s):(r=n.getCommonInlineStyle("href",{end:i,start:o}))&&r===m.INTERM))},e.prototype._onMoveCaretWithDirection=function(t,e){var n,o,i,r,a,s;(n=this.getNoteRange())?n.canDrawedByNative()?p.log("The noteRange can be drawed by native selection!"):(o=n.getStartBlockRange().block,(y.isImage(o)||y.isAttachment(o)||y.isTable(o)||y.isHr(o)||y.isUnknown(o)||y.isHandWrite(o))&&(t?(i=this._getNextCaretBlock(o),r=!0):(i=this._getPreCaretBlock(o),r=!1),i?(a=S.createRangeByBlock({allContent:!1,block:i,collapseToStart:r}),s=new x({endRange:a,startRange:a}),this.noteSelection.setRange(s),e&&e.preventDefault()):t&&this.noteView.focusLastBlankLine())):p.log("The noteRange is null!")},e.prototype._notifyEditingStatesChange=function(){var t,e,o,i=this,r=i.getNoteRange(),a=i.editingInlineStates||{},s=!1;!i.isReadOnly()&&r&&(t=r.getStartBlockRange(),r.isInSingleBlock()&&y.isTextBlock(t.block)&&t.block.getLength()<t.start&&(s=!0),(s||a&&r.isCollapsed())&&(!r.isSingleTableSelected()||t.getAsRectRange())||(a=i.querySelectionInlineStyles(r)||{}),o=n.clone(a),(e=r.clone(!0)).collapse(!0),n.each(["font-family","font-size"],function(t){var n;a[t]===m.INTERM&&(n=i.querySelectionInlineStyle(t,e),a[t]=n)}),y.isCode(t.block)&&Object.assign(a,i.querySelectionCodeInfo(r)),a.heading=null,i.trigger("yne-editing-state-change",a,o))},e.prototype._onAppendBlankParagraph=function(){this.execCommand("comp.AppendBlank",{inlineStyles:this.editingInlineStates})},e.prototype._onCellEditViewSelectionChange=function(){var t,e=this.getNoteRange().getStartBlockRange().block,n=this.noteView.getBlockViewByBlock(e);n&&(t=n.getCellEditView().queryInlineStylesForBulb(),this.trigger("yne-editing-state-change",t))},e.prototype._onCommandExec=function(t,e){this.trigger("command-exec",t,e)},e.prototype._onCompositionStart=function(t){var e,o,i=this,r=i.getNoteRange(),a=[],s=!1;if(r){if(i.isCollabEnabled()){if(o=i.note.getInterBlocks(r.getStartBlockRange().block,r.getEndBlockRange().block,!0),n.each(o,function(t){var e=i.noteView.getBlockViewByBlock(t);a.push(e),e.isCollabLocked()&&(s=!0)}),t(s,a),s)return;(e=r.getStartBlockRange())&&r.isInSingleBlock()&&y.isTextBlock(e.block)&&!i.editor.isMyOwnLockedBlock(e)&&(i.editor.sendCachedDataCommand(),i._sendBlockLockInfo(e.block.getId()))}}else p.error("_onCompositionStart:noteRange should not be null")},e.prototype._omitLinkStylesIfNeeded=function(t,e){return t&&t.href&&this._isPartlyOverlapWithAnchor(e)&&(t.href=void 0,this.isLinkStylesChanged||(t.color="#393939",t.underline=!1)),t},e.prototype._onCut=function(t){var e=this.getNoteRange();t.preventDefault(),p.log("on cut!"),this._setClipboardByRange(e,t),!e||e.isCollapsed()||e.isSingleTableSelected()||this.execCommand("comp.DeleteNoteRange",{range:e})},e.prototype._onCopy=function(t){var e=this.getNoteRange();p.DEBUG&&(p.profile("on-copy"),p.time("on-copy")),t.preventDefault(),p.log("on copy!"),this._setClipboardByRange(e,t),p.DEBUG&&(p.timeEnd("on-copy"),p.profileEnd("on-copy"))},e.prototype._onDeleteSelection=function(){var t=this.getNoteRange();t&&!t.isCollapsed()&&this.execDeleteBackward(t)},e.prototype._onGetDefaultSetFont=function(t){t(this.getDefaultFont())},e.prototype._onKey=function(t,e){var n=this.noteView,o=this.keyHandlerManager;n&&(n.directionKeyJustMoved=!1),o.execWithKey(t,this,e)},e.prototype._onBackupDragRange=function(){var t=this.getNoteRange();t&&!t.isCollapsed()&&(this.dragTextRange=t)},e.prototype._onDragStart=function(t,e){var n,o,i,r=this.getNoteRange().getStartBlockRange();n=y.isTextBlock(e,r)?this.dragTextRange:this.getNoteRange(),this.startNoteRange=n,n&&!n.isCollapsed()?(i=new O({event:t}),o={"text/html":n.getDataAsHtml(this.note),"text/plain":n.getDataAsPlain(this.note),"text/yne-json":n.getDataAsJSON(this.note)},i.setDataMap(o),i.clearData("text/uri-list"),i.setProperty("effectAllowed","move")):p.log("no note range or note range is collapsed!")},e.prototype._onDragOver=function(t,e){var o=t.clientX,i=t.clientY,r=t.dataTransfer.types;if(!n.contains(r,"text/yne-json"))return n.contains(r,"Files")&&(t.preventDefault(),t.stopPropagation()),!0;if(t.preventDefault(),t.stopPropagation(),!this.lastDragOver||this.lastDragOver.x!==o||this.lastDragOver.y!==i){if(!y.isTextBlock(e)&&!y.isListItem(e))return t.dataTransfer.dropEffect="none",void this.removeDragHint();t.dataTransfer.dropEffect="move",!1===this.addDragHint(o,i)&&(t.dataTransfer.dropEffect="none")}},e.prototype._onDrop=function(t){var e,o,r,a,s,l=t.dataTransfer,c=l.types,d=this.noteView;t.preventDefault(),t.stopPropagation(),s=d.getBlock(t.target),(u.IS_MAC||A.isSafari())&&s&&y.isTable(s)?((r=document.createRange()).setStart(t.target,0),r.collapse()):r=this.getRangeByPoint(t.clientX,t.clientY),n.contains(c,"text/yne-json")&&(e=l.getData("text/yne-json"),o=h.parseJSON(e),n.map(o,function(t){t.setId(i.newGUID())}),(a=d.parseNativeRange(r)[0])&&a.isCollapsed()&&d.trigger("command","comp.DragBlocks",{blocks:o,dropRange:a,range:this.startNoteRange})),n.contains(c,"Files")&&this.noteSelection.setRange(r),this.removeDragHint()},e.prototype._onDragEnd=function(){this.removeDragHint()},e.prototype._onHeaderFooterViewTextChange=function(t,e){this.onCommand("comp.SetHeaderFooter",{content:t,headerFooter:e,range:x.createForHeaderFooter(e)})},e.prototype._onGetNoteRange=function(t){t(this.getNoteRange())},e.prototype._onGetBlockView=function(t,e){var n=this.noteView;n&&e(n.getBlockViewByBlock(t))},e.prototype._onEnterTableEdit=function(t){t.blockId&&(this.editor.sendCachedDataCommand(),this._sendBlockLockInfo(t.blockId)),this.trigger("cell-edit-view-enter",t)},e.prototype._onSaveContent=function(){this.trigger("yne-save-content")},e.prototype._onSelectionChange=function(t,e){this.lastDeleteInlineStates?(this.setEditingInlineStates(this.lastDeleteInlineStates),this.lastDeleteInlineStates=null):this._shouldKeepEditingStates(t)||this._updateEditingStates(e),this._notifyEditingStatesChange(),this.trigger("yne-selection-change")},e.prototype._onTextInput=function(t){this.insertText(t,!1)},e.prototype._pasteBlobImg=function(t){var e,n,o=this;(e=t.originalEvent.clipboardData.items)&&1===e.length&&0===e[0].type.indexOf("image")&&(n=e[0].getAsFile(),o.trigger("yne-blob-paste",{data:n,isImg:!0},function(t){t&&t.source&&o.insertImage(t.source)}))},e.prototype._pasteForMac=function(){var t,e,o,i,r,a,s,l=this,c=l.editor,u=window.ynote;if(u&&u.macClipboardData||p.error("YNote does not exist!"),l.isPasteAsText)return t=c.callMacNativeApi("macClipboardData",["text/plain"]),void l._pastePlain(t,l.isPasteAsText);if(!((e=c.callMacNativeApi("macClipboardData",["text/yne-table-json"]))&&l.pasteYTableJson(e)||(o=c.callMacNativeApi("macClipboardData",["text/yne-json"]),i=c.callMacNativeApi("macClipboardData",["text/yne-image-json"]),r=c.callMacNativeApi("macClipboardData",["text/yne-note-id"]),o&&l._pasteJSON(o,i,r))))if((a=c.callMacNativeApi("macClipboardData",["text/html"]))&&l._pasteHTML(a))p.log("mac paste html ok");else{if(s=c.callMacNativeApi("macClipboardData",["image"]))return s=JSON.parse(s),void n.each(s,function(t){l.insertImage(t)});(t=c.callMacNativeApi("macClipboardData",["text/plain"]))&&l._pastePlain(t,l.isPasteAsText)}},e.prototype._pasteJSON=function(t,e,o){p.log("Paste JSON\n",t);var a,s,c=this,u={},d=this.getNoteRange();d.isInSingleBlock()&&y.isCode(d.getStartBlockRange().block)&&(s=!0);var f,g=l.parseImageJson(e),m=h.parseJSON(t,s),v=[],_=[],b={},C={};return n.each(m,function(t){y.isHeading(t)&&(b[t.getId()]=t)}),n.each(m,function(t){var e,n;y.isCatalogue(t)?(e=b[t.getHref()])&&(t.setIndent(e.getLevel()-1),n=i.newGUID(),C[n]=!0,e.setId(n),t.setHref(n)):y.isHeading(t)||(t.setId(i.newGUID()),y.isListItem(t)?(a=t.getListId(),u[a]||(u[a]=r.getOrCreateListById(c.note.getAllBlocks(),a,t.getListType())),t.setOwnerList(u[a])):y.isAttachment(t)?v.push(t):y.isImage(t)&&_.push(t))}),n.each(b,function(t){C[t.getId()]||t.setId(i.newGUID())}),c.note.isSameNote(o)||(f=c._uploadImageData(g||{},v,_)),c._pasteBlockList(m,f)},e.prototype._pasteHTML=function(t){p.log("Paste HTML\n",t);var e=this,o={},r={},a=h.parseHtml(t);return n.each(a,function(t){y.isHeading(t)&&(o[t.getId()]=t)}),n.each(a,function(t){var n,a;if(y.isCatalogue(t)&&(n=o[t.getHref()])&&(t.setIndent(n.getLevel()-1),a=i.newGUID(),r[a]=!0,n.setId(a),t.setHref(a)),y.isTextBlock(t)){var s=e.getNoteRange().getStartBlockRange().block;t.setBlockStyles(s.getBlockStyles())}}),n.each(o,function(t){r[t.getId()]||t.setId(i.newGUID())}),e._pasteBlockList(a)},e.prototype._pastePlain=function(t,e){var o,i,r,a=this,s=a.getNoteRange();return e&&(i=null,r=a.querySelectionBlockStyles(s)),o=h.parsePlain(t,i,r,e),n.each(o,function(t){if(y.isTextBlock(t)){var e=a.getNoteRange().getStartBlockRange().block;t.setBlockStyles(e.getBlockStyles())}}),a._pasteBlockList(o)},e.prototype._pasteBlockList=function(t,e){var o;if(t&&t.length&&(!0===this.removeLocalImg&&(t=n.filter(t,function(t){var o=/^(http:\/\/|https:\/\/|\/\/)/i;return t.getBlockStyle("back-color")&&t.setBlockStyle("back-color",""),y.isImage(t)&&-1===n.indexOf(e||[],t)?o.test(t.getSource())||/^data:.+;base64/i.test(t.getSource()):!y.isAttachment(t)||o.test(t.getResource())})),t&&t.length))return o=this.editingInlineStates,this.editingInlineStates=null,this.execCommand("comp.InsertBlocks",{blocks:t}),this.editingInlineStates=o,!0},e.prototype._redoUndoLocalCmdInCollabMode=function(t){var e;t.collabProperties.isCollabUndo?e=this.cmdManager.getUndoCmd():t.collabProperties.isCollabRedo&&(e=this.cmdManager.getRedoCmd()),e?((e=n.clone(e)).setCmdOriginalNoteVersion(this.note.getFileVersion()),e.isLocalExecutedCmd=!1,t.collabProperties.isCollabUndo?(e.setCollabUndo(!0),e.setCollabRedo(!1)):t.collabProperties.isCollabRedo&&(e.setCollabRedo(!0),e.setCollabUndo(!1)),this.editor.isValidLocalDataCmd(e)?i.isInlineStateSetCommand(e)||this.editor.pushLocalDataCommand(e,!0):p.warn("skip invalid redo/undo local command")):p.warn("skip empty redo/undo local command")},e.prototype._setClipboardByRange=function(t,e){var n,o;t&&!t.isCollapsed()?(n=this.getRangeData(t),new T({event:e}).setDataMap(n),o=t.isInSingleBlock()&&y.isAttachment((t.getStartBlockRange()||{}).block),this.trigger("yne-clipboard-set",o)):p.log("no note range or note range is collapsed!")},e.prototype._sendBlockLockInfo=function(t){this.editor.hasCachedDataCmd()?window.setTimeout(this._sendBlockLockInfo.bind(this,t),100):this.editor.sendBlockLockInfo(t)},e.prototype._shouldKeepEditingStates=function(t){var e,o,i;return!!(t&&t.isCommandType&&t.isCommandType())&&(o=(e=t.getData()||{}).cmdType,i=e.cmdName,n.contains({do:["key.Space","key.Enter","comp.ApplyStyles","comp.IndentOutdent","comp.InsertAttachment","comp.InsertHorizontalRule","comp.InsertImage","comp.InsertList","comp.InsertTable","comp.KeyTab","comp.KeyTextInput"],redo:["comp.ApplyStyles","comp.IndentOutdent","comp.InsertList"],undo:["comp.ApplyStyles","comp.IndentOutdent","comp.InsertList"]}[o],i))},e.prototype._updateDeleteInlineStates=function(t){t&&t.href&&(t=null),this.lastDeleteInlineStates=t},e.prototype._updateEditingStates=function(t){var e=this.getNoteRange(),n=this.queryBackwardFirstInlineStyles(e,t);this.setEditingInlineStates(n)},e.prototype._uploadImageData=function(t,e,o){if(!(n.isEmpty(t)||n.isEmpty(e)&&n.isEmpty(t.data))){var i,r,a,s,l=this,c=t.data,u=l.note,d=l.editor;if(a=l._getUploadData(c,e,o))return i=a.data,r=a.map,s=a.replaceImgList,d.trigger("yne-upload-image",{data:i,isImg:!0},function(t){setTimeout(function(){var e=[],o=[];n.each(t,function(t,i){n.each(r[i],function(i){var r=u.getBlockById(i);r&&(e.push(r),y.isImage(r)?o.push(n.defaults(t,{source:r.getSource()||"uploadfail"})):y.isAttachment(r)&&o.push(n.defaults(t,{resource:r.getResource(),source:r.getSource()})))})}),e.length>0&&(l.execCommand("comp.ReplaceResource",{ignoreUndoRedo:!0,resProps:o,resources:e}),n.each(e,function(t){t.trigger("content-change")}))})},function(){n.each(n.union(e,s),function(t){t.setFakeLoading(!0)})}),s}},e}(d)}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(26),o=n(2),i=n(5),r=n(21),a=n(4);return n(627),e.extend({_editor:null,initialize:function(t){this._editor=t.editor},create:function(t,e,n){var s,l=null;if(n.collabProperties=n.collabProperties||{},t+="",s=i.get(t)){if(l=new s({note:e,args:n}),!this._editor.isCollabEnabled())return l.isSimple||l.setStartingRange(n.range),l;if(n.collabProperties.dataCmdError)return o.error(n.collabProperties.dataCmdError),null;if(l.isSimple)return l;!a.isCollabCommand(n)&&l.isOriginalCmd&&(r.isNoteRange(n.range)?l.setStartingRange(n.range):(n.collabProperties.dataCmdError="original cmd args.range should be noteRange",l=null))}else o.warn("No class for `"+t+"` command");return l}})}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){n(296),n(628),n(629),n(630),n(631),n(632),n(633),n(634),n(635),n(636),n(637),n(638),n(639),n(640),n(642),n(643),n(645),n(646),n(647),n(648),n(649),n(650),n(651),n(652),n(653),n(654),n(656),n(657),n(658),n(660),n(662),n(664),n(666),n(667),n(669),n(671),n(672),n(673)}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e,o=n(13),i=n(5),r=n(16),a=n(33),s=n(101),l=n(4);return e=o.extend({name:"comp.AppendBlank",_cmdArgs:null,_note:null,_newBlkId:null,_preBlkId:null,_preBlock:null,initialize:function(){this._note=this.options.note,this._cmdArgs=this.options.args||{},l.isCollabCommand(this._cmdArgs)||(this._newBlkId=l.newGUID(),this._preBlock=this._note.getLastBlock(),this._preBlock&&(this._preBlkId=this._preBlock.getId())),e.__super__.initialize.apply(this,arguments)},apply:function(){var t,e;return t=r.createNewParagraph(this._preBlock,this._newBlkId,""),r.setBlockStyle(t,this._cmdArgs.inlineStyles),!1!==this.executeAtomicCommand(new a({note:this._note,newBlks:[t],preBlk:this._preBlock}))&&(e=s.buildNoteRangeFromParagraph(t,0,0),this.setEndingRange(e),!0)},fromCollabJSON:function(){var t=this.options.args.collabProperties.cmdJSON;t&&(this._newBlkId=t.newBlkId,t.preBlkId&&(this._preBlock=this._note.getBlockById(t.preBlkId))),e.__super__.fromCollabJSON.apply(this)},toCollabJSON:function(){var t;return this.rangeIsRequired=!1,this.resetAffectedBlockIds(),(t=e.__super__.toCollabJSON.apply(this)).newBlkId=this._newBlkId,this._preBlkId&&(t.preBlkId=this._preBlkId),t}}),i.add(e),e}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e,o=n(13),i=n(5),r=n(2),a=n(0),s=n(16),l=n(4);return e=o.extend({name:"comp.ApplyStyles",_note:null,_cmdArgs:null,_blockStyleNameValues:null,_inlineStyleNameValues:null,initialize:function(){var t;if(this._note=this.options.note,this._cmdArgs=this.options.args,t=this._cmdArgs.range,e.__super__.initialize.apply(this),!l.isCollabCommand(this._cmdArgs)){if(!t)return r.error("note range should NOT be null:",this.name),void(this.isReadyToApply=!1);this._blockStyleNameValues=this._cmdArgs.blockStyles,this._inlineStyleNameValues=this._cmdArgs.inlineStyles}},apply:function(){var t=this._cmdArgs.range;return!s.setStylesOnNoteRange(this,this._note,t,a.clone(this._blockStyleNameValues),a.clone(this._inlineStyleNameValues))&&(this.setEndingRange(t),!0)},fromCollabJSON:function(){var t=this._cmdArgs.collabProperties.cmdJSON;t&&(t.blockStyles&&(this._blockStyleNameValues=t.blockStyles),t.inlineStyles&&(this._inlineStyleNameValues=t.inlineStyles)),e.__super__.fromCollabJSON.apply(this)},isInlineStateSet:function(){var t=this._cmdArgs.range,e=!1;return t&&t.isCollapsed()&&(!this._blockStyleNameValues||a.isEmpty(this._blockStyleNameValues))&&this._inlineStyleNameValues&&!a.isEmpty(this._inlineStyleNameValues)&&(e=!0),e},toCollabJSON:function(){var t=e.__super__.toCollabJSON.apply(this);return t&&(this._blockStyleNameValues&&!a.isEmpty(this._blockStyleNameValues)&&(t.blockStyles=this._blockStyleNameValues),this._inlineStyleNameValues&&!a.isEmpty(this._inlineStyleNameValues)&&(t.inlineStyles=this._inlineStyleNameValues)),t}}),i.add(e),e}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e,o=n(299),i=n(5),r=n(2),a=n(4);return e=o.extend({name:"comp.DeleteNoteRange",_cmdArgs:null,_note:null,initialize:function(){var t;if(this._note=this.options.note,this._cmdArgs=this.options.args,e.__super__.initialize.apply(this),!a.isCollabCommand(this._cmdArgs)){if(!(t=this._cmdArgs.range))return this.isReadyToApply=!1,void r.error("note range should NOT be null",this.name);if(t.isCollapsed()&&!this._cmdArgs.isTableDelete&&!this._cmdArgs.isCodeDelete)return this.isReadyToApply=!1,r.error("should NOT trigger the cmd when NoteRange is collapsed",t),!1}},isSingleBlockAffected:function(){var t,n,o=this._args.range,i=e.__super__.isSingleBlockAffected.apply(this),r=0;return i&&o&&o.isCollapsed()&&(t=(n=o.getStartBlockRange()).block,r=n.start,this._note.getNextBlock(t)&&r===t.getEndOffset()&&(i=!1)),i}}),i.add(e),e}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e,o=n(13),i=n(5),r=n(2),a=n(0),s=n(3),l=n(82),c=n(12),u=n(16),d=n(21),p=n(33),h=n(102),f=n(137),g=n(83),m=n(34),y=n(44),v=n(170),_=n(4);return e=o.extend({name:"comp.DragBlocks",_note:null,_cmdArgs:null,_dropBlockRange:null,_insertedBlocks:null,_newEndBlankParaId:null,_insertedBlocksJSON:null,initialize:function(){var t,n=this;if(n._note=n.options.note,n._cmdArgs=n.options.args,e.__super__.initialize.apply(n),!_.isCollabCommand(n._cmdArgs)){if(!(t=n._cmdArgs.range))return r.error(n.name+":note range should NOT be null"),void(n.isReadyToApply=!1);if(n._dropBlockRange=n._cmdArgs.dropRange,n._insertedBlocks=[],n._insertedBlocksJSON=[],a.each(n._cmdArgs.blocks,function(t){n._insertedBlocks.push(t),n._insertedBlocksJSON.push(t.toCollabJSON())}),n._newEndBlankParaId=_.newGUID(),!(n._dropBlockRange&&n._dropBlockRange.block&&s.isTextBlock(n._dropBlockRange.block)&&n._dropBlockRange.isCollapsed()))return n.isReadyToApply=!1,void r.error("drag destination should be a single pos in text block",n._dropBlockRange);if(n._isDropRangeInStartNoteRange(n._dropBlockRange))return n.isReadyToApply=!1,void r.error("dropBlockRange should not be in the startNoteRange",t,n._dropBlockRange)}},apply:function(){var t;return t=y.createRangeByBlock({block:this._dropBlockRange.block,start:this._dropBlockRange.start,end:this._dropBlockRange.end}),this._dropBlockRange.hasOwnProperty("startLineCharIndex")&&(t=this._dropBlockRange.clone()),t=this._handleStartNoteRangeData(t),this._insertDraggedData(t),!0},_handleStartNoteRangeData:function(t){var e,n,o,i,r,l,c,d=this._cmdArgs.range,p=[];if(n=(e=d.getStartBlockRange()).block,i=(o=d.getEndBlockRange()).block,c=this._isFullSelectionInTextBlock(e),d.isCollapsed()||e.selectWholeBlock||u.deleteSelectedContent(this,this._note,d),d.isInMultiBlock())s.isTextBlock(n)&&!n.isEmpty()||(p.push(n),n=null),s.isTextBlock(i)&&!i.isEmpty()||(p.push(i),i=null),a.isEmpty(p)&&(t.block.getId()===i.getId()&&(t=this._rebuildDropRangeWhenNoteRangeMerge(e,o,t)),s.isCode(n)||s.isCode(i)||(this.executeAtomicCommand(new h({block:n,start:n.getLength(),text:i.getText()})),p.push(i))),p.length&&this.executeAtomicCommand(new m({note:this._note,blocks:p}));else if(s.isTextBlock(n,e))c&&(r=this._note.getPreBlock(n),l=this._note.getNextBlock(n),s.isImage(r)||s.isImage(l)||s.isAttachment(r)||s.isAttachment(l)||s.isTable(r)||s.isTable(l)||(this.executeAtomicCommand(new m({note:this._note,blocks:[n]})),n=null));else{if(s.isCode(n)&&u.replaceBlockWithParagraph(this,this._note,n,""),s.isCode(t.block))return t;u.replaceBlockWithParagraph(this,this._note,n,""),n=null}return t},_insertDraggedData:function(t){var e,n,o,i,r,l,c=this._cmdArgs.range,f=this._insertedBlocks[0],v=a.last(this._insertedBlocks),_=t.block;(e=c.getStartBlockRange()).block.getId(),(n=c.getEndBlockRange()).block.getId(),this._tuneDropBlockRange(t,e,n),s.isCode(t.block)?this._handleInCode(t):(s.isTextBlock(f,e)&&!s.isHeading(f)?(this._insertedBlocks.shift(),this.executeAtomicCommand(new h({block:t.block,start:t.start,text:f.getText()})),l=r=y.createRangeByBlock({block:t.block,start:t.start,end:t.start+f.getLength()}),t.start+=f.getLength(),t.end=t.start):l=r=y.createRangeByBlock({block:this._insertedBlocks[0]}),a.isEmpty(this._insertedBlocks)||(o=t.block.sliceText(t.start,t.block.getLength()),c.isInMultiBlock()&&(l=s.isTextBlock(v)?y.createRangeByBlock({block:v,start:0,end:v.getLength()}):y.createRangeByBlock({block:v})),0===t.start?(_=this._note.getPreBlock(t.block),s.isTextBlock(v,n)?(v.append(o),this.executeAtomicCommand(new m({note:this._note,blocks:[t.block]}))):0===t.block.getLength()&&this.executeAtomicCommand(new m({note:this._note,blocks:[t.block]}))):t.start<t.block.getLength()&&(this.executeAtomicCommand(new g({block:t.block,start:t.start,end:t.block.getLength()})),s.isTextBlock(v,n)?(v.append(o),s.isCode(v)&&(this._insertedBlocks.pop(),v=u.createNewParagraph(t.block,null,v.getText()),this._insertedBlocks.push(v))):(i=s.isListItem(t.block)?u.createNewListItem(t.block,this._newEndBlankParaId,o):s.isHeading(t.block)?u.createNewHeading(t.block,this._newEndBlankParaId,o,t.block.getLevel()):s.isTodo(t.block)?u.createNewTodo(t.block,{id:this._newEndBlankParaId,text:o,checked:t.block.getChecked()}):s.isQuote(t.block)?u.createNewQuote(t.block,{id:this._newEndBlankParaId,text:o}):s.isCode(t.block)?u.createNewCode(t.block,{id:this._newEndBlankParaId,text:t.block.getText()}):u.createNewParagraph(t.block,this._newEndBlankParaId,o),this._insertedBlocks.push(i),c.isInMultiBlock()&&(l=y.createRangeByBlock({block:i,start:0,end:0})))),this.executeAtomicCommand(new p({note:this._note,newBlks:this._insertedBlocks,preBlk:_}))),this.setEndingRange(d.create({startRange:r,endRange:l})))},_isDropRangeInStartNoteRange:function(t){var e,n=this._cmdArgs.range,o=n.getStartBlockRange(),i=n.getEndBlockRange(),r=t,s=r.block.getId(),l=!1;return s===o.block.getId()&&r.start>=o.start&&r.start<=o.end&&(l=!0),!l&&n.isInMultiBlock()&&(s===i.block.getId()&&r.start>=i.start&&r.start<=i.end?l=!0:(e=this._note.getInterBlocks(o.block,i.block),a.some(e,function(t){return s===t.getId()&&(l=!0),l}))),l},_isFullSelectionInTextBlock:function(t){var e=!1,n=0;return s.isTextBlock(t.block)&&(n=t.block.getLength()),n>0&&0===t.start&&t.end===n&&(e=!0),e},_handleInCode:function(t){var e,n=t,o=[];a.each(this._insertedBlocks,function(t){s.isTextBlock(t)&&o.push(t.getText().toString())}),o.length&&(this.executeAtomicCommand(new f({block:n.block,startBlockRange:n,text:new c({text:o.join(l.LINE_BREAK)})})),(e=o.reduce(function(t,e){var n=e.split(l.LINE_BREAK);return e.length>0&&e[e.length-1]===l.LINE_BREAK&&n.pop(),t.concat(n)},[])).length>1?u.expandCodeRange(this,n,e[e.length-1].length,e.length-1):u.expandCodeRange(this,n,e[0].length))},_rebuildDropRangeWhenNoteRangeMerge:function(t,e,n){var o;return o=n.start+t.start-e.end,y.createRangeByBlock({block:t.block,start:o,end:o})},_tuneDropBlockRange:function(t,e,n){var o=e.block.getId(),i=n.block.getId();t.block.getId()===o&&t.start>e.end&&(t.start-=e.end-e.start,t.end-=t.start),o!==i&&t.block.getId()===i&&t.start>n.end&&(t.start-=n.end-n.start,t.end-=t.start)},fromCollabJSON:function(){var t=this,n=t.options.args,o=n.collabProperties.cmdJSON,i=n.collabProperties.coreEditor;e.__super__.fromCollabJSON.apply(t),o&&(t._newEndBlankParaId=o.newEndBlkId,t._dropBlockRange=i.buildBlockRangeFromJSON(o.dropRange),t._insertedBlocks=[],a.each(o.insertedBlocks,function(e){t._insertedBlocks.push(v.buildBlockFromJSON(e,i))}))},isSingleBlockAffected:function(){var t=this._cmdArgs.range,e=t.getStartBlockRange();return!(!t.isInSingleBlock()||this._dropBlockRange.block.getId()!==e.block.getId())},toCollabJSON:function(){var t=e.__super__.toCollabJSON.apply(this);return t&&(t.newEndBlkId=this._newEndBlankParaId,t.dropRange=this._dropBlockRange.toCollabJSON(),t.insertedBlocks=this._insertedBlocksJSON),t}}),i.add(e),e}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e,o=n(13),i=n(5),r=n(16),a=n(7),s=n(0),l=n(2),c=n(4);return e=o.extend({name:"comp.FormatPainter",_cmdArgs:null,_note:null,_inlineStyles:null,_blockStyles:null,initialize:function(){var t;if(this._note=this.options.note,this._cmdArgs=this.options.args||{},t=this._cmdArgs.range,e.__super__.initialize.apply(this,arguments),!c.isCollabCommand(this._cmdArgs)){if(!t)return l.error(this.name+":note range should NOT be null"),void(this.isReadyToApply=!1);this._inlineStyles=this._cmdArgs.data.inlineStyles,this._blockStyles=this._cmdArgs.data.blockStyles}},apply:function(){var t=this._cmdArgs.range,e={},n={};return!!t.isCollapsed()||(s.each(this._inlineStyles,function(t,n){"href"!==n&&t!==a.INTERM&&null!=t&&(e[n]=t)}),s.each(this._blockStyles,function(t,e){t!==a.INTERM&&null!=t&&(n[e]=t)}),r.resetAllStyles(this,this._note,t),r.setStylesOnNoteRange(this,this._note,t,n,e),this.setEndingRange(t),!0)},fromCollabJSON:function(){var t=this._cmdArgs.collabProperties.cmdJSON;t&&(this._inlineStyles=t.inlineStyles,this._blockStyles=t.blockStyles),e.__super__.fromCollabJSON.apply(this)},toCollabJSON:function(){var t;return(t=e.__super__.toCollabJSON.apply(this)).inlineStyles=this._inlineStyles,t.blockStyles=this._blockStyles,t}}),i.add(e),e}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e,o=n(13),i=n(5),r=n(3),a=n(16),s=n(2),l=n(172),c=n(4);return e=o.extend({name:"comp.IndentOutdent",_cmdArgs:null,_note:null,_indentStep:null,initialize:function(){var t,n;if(this._note=this.options.note,this._cmdArgs=this.options.args||{},e.__super__.initialize.apply(this,arguments),!c.isCollabCommand(this._cmdArgs)){if(t=this._cmdArgs.range,this._indentStep=this._cmdArgs.indentStep,!t||!t.canDrawedByNative())return s.error(this.name+":note range should NOT be null or cannot be Drawed by native"),void(this.isReadyToApply=!1);if(n=t.getStartBlockRange().block,t.isInSingleBlock()&&!r.isTextBlock(n))return void(this.isReadyToApply=!1)}},apply:function(){var t,e,n,o=this._cmdArgs.range;return t=o.getStartBlockRange().block,e=o.getEndBlockRange().block,o.isInMultiBlock()?(n=this._note.getInterBlocks(t,e,!0),a.isInSameList(n)?this._isFirstListItem(n[0])?a.updateBlocksIndentLevel(this,n[0].getOwnerList().getItems(),this._indentStep):this.executeAtomicCommand(new l({listItems:n,deltaLevel:this._indentStep})):a.updateBlocksIndentLevel(this,n,this._indentStep),this.setEndingRange(o),!0):(r.isListItem(t)?this._isFirstListItem(t)?a.updateBlocksIndentLevel(this,t.getOwnerList().getItems(),this._indentStep):this.executeAtomicCommand(new l({listItems:[t],deltaLevel:this._indentStep})):a.updateBlocksIndentLevel(this,[t],this._indentStep),this.setEndingRange(o),!0)},_isFirstListItem:function(t){return 1===t.getLevel()&&1===t.getIndex()},fromCollabJSON:function(){var t=this._cmdArgs.collabProperties.cmdJSON;t&&(this._indentStep=t.indentStep),e.__super__.fromCollabJSON.apply(this)},toCollabJSON:function(){var t;return(t=e.__super__.toCollabJSON.apply(this))&&(t.indentStep=this._indentStep),t}}),i.add(e),e}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e,o=n(138),i=n(5),r=n(3),a=n(131),s=n(116),l=n(33),c=n(120),u=n(4),d=n(16);return e=o.extend({name:"comp.InsertAttachment",_cmdArgs:null,_note:null,_attachBlkId:null,_attachSrc:null,_attachRes:null,_attachFileName:null,_attchFileLen:null,initialize:function(){this._note=this.options.note,this._cmdArgs=this.options.args||{},e.__super__.initialize.apply(this,arguments),u.isCollabCommand(this._cmdArgs)||(this._attachBlkId=u.newGUID(),this._attachSrc=this._cmdArgs.src,this._attachRes=this._cmdArgs.resource,this._attachFileName=this._cmdArgs.fileName,this._attchFileLen=this._cmdArgs.fileLength)},insertResource:function(t,e,n){var o,i=this._cmdArgs.range,s=[];return r.isTable(t)&&i.isSingleTableSelected()?this._insertAttachmentInTable(t):(o=new a({source:this._attachSrc,resource:this._attachRes,fileName:this._attachFileName,fileLength:this._attchFileLen}),d.setResourceBlockStyleByPreBlock(o,t),e&&s.push(e),s.push(o),n&&s.push(n),o.setId(this._attachBlkId),this.executeAtomicCommand(new l({note:this._note,newBlks:s,preBlk:t})),o)},_insertAttachmentInTable:function(t){var e,n=this._cmdArgs.range.getStartBlockRange().getAsRectRange();if(n)return e=n.getFirstCellRect(),this.executeAtomicCommand(new c({table:t,cellRect:e,content:new s({source:this._attachSrc,resource:this._attachRes,fileName:this._attachFileName,fileLength:this._attchFileLen})})),t},fromCollabJSON:function(){var t=this._cmdArgs.collabProperties.cmdJSON;e.__super__.fromCollabJSON.apply(this),t&&(this._attachBlkId=t.newBlkId,this._attachSrc=t.src,this._attachRes=t.attachRes,this._attachFileName=t.fileName,this._attchFileLen=t.fileLen)},toCollabJSON:function(){var t;return(t=e.__super__.toCollabJSON.apply(this))&&(t.newBlkId=this._attachBlkId,t.src=this._attachSrc,t.attachRes=this._attachRes,t.fileName=this._attachFileName,t.fileLen=this._attchFileLen),t}}),i.add(e),e}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e,o=n(13),i=n(5),r=n(2),a=n(0),s=n(3),l=n(16),c=n(21),u=n(33),d=n(102),p=n(137),h=n(34),f=n(83),g=n(227),m=n(44),y=n(170),v=n(12),_=n(82),b=n(4);return e=o.extend({name:"comp.InsertBlocks",_note:null,_cmdArgs:null,_insertedBlocks:null,_newEndBlankParaId:null,_insertedBlocksJSON:null,initialize:function(){var t=this;if(t._note=t.options.note,t._cmdArgs=t.options.args,e.__super__.initialize.apply(t),!b.isCollabCommand(t._cmdArgs)){if(!t._cmdArgs.range)return r.error(t.name+":note range should NOT be null"),void(t.isReadyToApply=!1);t._insertedBlocks=[],t._insertedBlocksJSON=[],a.each(t._cmdArgs.blocks,function(e){t._insertedBlocks.push(e),t._insertedBlocksJSON.push(e.toCollabJSON())}),t._newEndBlankParaId=b.newGUID()}},apply:function(){var t,e,n,o=this,i=o._note,r=o._cmdArgs.range,c=r.getStartBlockRange(),u=c.block,d=u.getBlockStyles(),p=a.last(o._insertedBlocks);return o._getCollabRequiredData(o._insertedBlocks),o._insertedBlocks=o._insertedBlocks.map(function(t){return d&&d["back-color"]&&t.setBlockStyle("back-color",d["back-color"]),t}),s.isTextBlock(p)?e=m.createRangeByBlock({block:p,start:p.getLength(),end:p.getLength()}):(n=i.getNextBlock(o.startingRange.getEndBlockRange().block),s.isTextBlock(n)&&(e=m.createRangeByBlock({block:n,start:n.getLength(),end:n.getLength()}))),r.isCollapsed()||s.isCode(u)||l.deleteSelectedContent(o,o._note,r),s.isCode(u)&&!c.selectWholeBlock?(o._handleInCode(),!0):(o._insertedBlocks=o._insertedBlocks.reduce(function(t,e,n){var i;return 0!==n&&n!==o._insertedBlocks.length-1||e.isSelectedBlock?t.push(e):(i=l.convertCodeToPara(e),Array.isArray(i)?i.map(function(e){t.push(e)}):t.push(i)),t},[]),t=r.isInMultiBlock()?o._handleMultiBlockSelection(e):o._handleSingleBlockSelection(e),o.setEndingRange(t),!0)},_handleMultiBlockSelection:function(t){var e=this._cmdArgs.range,n=e.getStartBlockRange(),o=n.block,i=e.getEndBlockRange(),r=i.block,a=this._insertedBlocks[0];return 1===this._insertedBlocks.length&&s.isTextBlock(a)&&s.isTextBlock(o)&&s.isTextBlock(r)?(this._insertedBlocks.shift(),t=m.createRangeByBlock({block:o,start:o.getLength()+a.getLength(),end:o.getLength()+a.getLength()}),a.append(r.getText()),this.executeAtomicCommand(new h({note:this._note,blocks:[r]})),this.executeAtomicCommand(new d({block:o,start:o.getLength(),text:a.getText()}))):t=this._insertBlocksBetweenStartEndBlock(n,i,t),c.create({startRange:t,endRange:t})},_getCollabRequiredData:function(t){var e=[];t&&t.length>0&&a.each(t,function(t){e.push(t.getId())}),e.push(this._newEndBlankParaId),this.pushAffectedBlockIds(e)},_handleSingleBlockSelection:function(t){var e,n=this,o=n._cmdArgs.range.getStartBlockRange(),i=o.block;return e=s.isTextBlock(i,o)?n._handleSingleTextStartBlock(i,t):n._handleSingleNonTextStartBlock(i,t),a.isEmpty(n._insertedBlocks)||(e.needToRebuildLIs&&n._rebuildListItems(n._insertedBlocks,e.refBlockForInsert,e.deltaLevel),s.isQuote(e.refBlockForInsert)&&(n._insertedBlocks=n._insertedBlocks.map(function(t){return s.isParagraph(t)?new l.createNewQuote(t,{id:t.getId(),text:t.getText(),checked:n._checked}):t})),n.executeAtomicCommand(new u({note:n._note,newBlks:n._insertedBlocks,preBlk:e.refBlockForInsert}))),c.create({startRange:e.newEndBlockRange,endRange:e.newEndBlockRange})},_handleSingleNonTextStartBlock:function(t,e){var n=this._insertedBlocks[0],o=a.last(this._insertedBlocks),i=this._note.getPreBlock(t),r=this._note.getNextBlock(t),c={};return c.refBlockForInsert=i,c.newEndBlockRange=e,c.needToRebuildLIs=!1,this.executeAtomicCommand(new h({note:this._note,blocks:[t]})),s.isTextBlock(n)||s.isTextBlock(i)||this._insertedBlocks.unshift(l.createNewParagraph(t,t.getId(),"")),s.isTextBlock(o)||s.isTextBlock(r)||(this._insertedBlocks.push(l.createNewParagraph(t,this._newEndBlankParaId,"")),c.newEndBlockRange=m.createRangeByBlock({block:a.last(this._insertedBlocks),start:0,end:0})),c},_handleSingleTextStartBlock:function(t,e){var n,o=this._cmdArgs.range.getStartBlockRange(),i=this._note.getPreBlock(t),r=this._note.getNextBlock(t),l=this._insertedBlocks[0],c=a.last(this._insertedBlocks),u="",p=1===this._insertedBlocks.length,y={};return y.refBlockForInsert=t,y.newEndBlockRange=e,y.needToRebuildLIs=!1,y.deltaLevel=0,o.start<t.getLength()&&(u=t.sliceText(o.start,t.getLength())),p&&s.isTextBlock(l)&&!s.isCode(l)||(s.isTextBlock(c)&&!s.isCode(l)?(n=u instanceof v?u:v.createBlank(),c.append(n),this.executeAtomicCommand(new f({block:t,start:o.start,end:t.getLength()}))):""===u&&s.isTextBlock(r)?y.newEndBlockRange=m.createRangeByBlock({block:r,start:0,end:0}):(this._insertedBlocks.push(this._buildNewBlockFromStartBlock(t,this._newEndBlankParaId,u)),y.newEndBlockRange=m.createRangeByBlock({block:a.last(this._insertedBlocks),start:0,end:0}),this.executeAtomicCommand(new f({block:t,start:o.start,end:t.getLength()})))),s.isTextBlock(l)&&!s.isCode(l)?t.getLength()>0||s.isListItem(t)||!s.isListItem(l)&&!s.isHeading(l)&&!s.isCatalogue(l)&&!s.isTodo(l)&&!s.isQuote(l)?(this._insertedBlocks.shift(),p&&(y.newEndBlockRange=m.createRangeByBlock({block:t,start:o.start+l.getLength(),end:o.start+l.getLength()})),this.executeAtomicCommand(new g({blocks:[t],styleNameValues:l.getBlockStyles()})),this.executeAtomicCommand(new d({block:t,start:o.start,text:l.getText()})),s.isListItem(t)&&s.isListItem(this._insertedBlocks[0])&&(y.needToRebuildLIs=!0,s.isListItem(l)&&(y.deltaLevel=this._insertedBlocks[0].getLevel()-l.getLevel()))):(y.refBlockForInsert=i,this.executeAtomicCommand(new h({note:this._note,blocks:[t]})),s.isListItem(i)&&s.isListItem(l)&&(y.needToRebuildLIs=!0,y.deltaLevel=1-i.getLevel())):0===t.getLength()&&s.isTextBlock(i)&&(y.refBlockForInsert=i,this.executeAtomicCommand(new h({note:this._note,blocks:[t]}))),y},_handleInCode:function(){var t,e=this._cmdArgs.range,n=e.getStartBlockRange(),o=[];a.each(this._insertedBlocks,function(t){s.isTextBlock(t)&&o.push(t.getText().toString())}),e.isCollapsed()||l.deleteSelectedContent(this,this._note,e),o.length&&(this.executeAtomicCommand(new p({block:n.block,startBlockRange:n,text:new v({text:o.join(_.LINE_BREAK)})})),(t=o.reduce(function(t,e){var n=e.split(_.LINE_BREAK);return e.length>0&&e[e.length-1]===_.LINE_BREAK&&n.pop(),t.concat(n)},[])).length>1?l.setCodeBlockAsEndingRange(this,n,t[t.length-1].length,t.length-1):l.setCodeBlockAsEndingRange(this,n,t[0].length))},_buildNewBlockFromStartBlock:function(t,e,n){return s.isHeading(t)?l.createNewHeading(t,e,n,t.getLevel()):s.isCatalogue(t)?l.createNewCatalogue(t,{paraId:e,text:n,href:t.getHref()}):s.isListItem(t)?l.createNewListItem(t,e,n):s.isTodo(t)?l.createNewTodo(t,{id:e,text:n,checked:t.getChecked()}):s.isQuote(t)?l.createNewQuote(t,{id:e,text:n}):l.createNewParagraph(t,e,n)},_insertBlocksBetweenStartEndBlock:function(t,e,n){var o=t.block,i=e.block,r=this._note.getPreBlock(o),c=this._note.getNextBlock(i),u=this._insertedBlocks[0],p=a.last(this._insertedBlocks),f=o,g=[],y=0;return s.isTextBlock(i)?s.isTextBlock(p)?(g.push(i),p.append(i.getText())):s.isTextBlock(p)||(n=m.createRangeByBlock({block:i,start:0,end:0})):(g.push(i),s.isTextBlock(c)||s.isTextBlock(p)?s.isTextBlock(p)||(n=m.createRangeByBlock({block:c,start:0,end:0})):(this._insertedBlocks.push(l.createNewParagraph(i,i.getId(),"")),n=m.createRangeByBlock({block:a.last(this._insertedBlocks),start:0,end:0}))),s.isTextBlock(o)?s.isTextBlock(u)?o.getLength()>0||s.isListItem(o)||!s.isListItem(u)?(this._insertedBlocks.shift(),this.executeAtomicCommand(new d({block:o,start:o.getLength(),text:u.getText()})),s.isListItem(u)&&s.isListItem(this._insertedBlocks[0])&&(y=this._insertedBlocks[0].getLevel()-u.getLevel())):(f=r,this.executeAtomicCommand(new h({note:this._note,blocks:[o]}))):0===o.getLength()&&s.isTextBlock(r)&&(f=r,this.executeAtomicCommand(new h({note:this._note,blocks:[o]}))):(g.push(o),f=r,s.isTextBlock(r)||s.isTextBlock(u)||this._insertedBlocks.unshift(l.createNewParagraph(o,o.getId(),""))),a.isEmpty(g)||this.executeAtomicCommand(new h({note:this._note,blocks:g})),this._insertedRemainedBlocks(f,y),n},_insertedRemainedBlocks:function(t,e){a.isEmpty(this._insertedBlocks)||(s.isListItem(this._insertedBlocks[0])&&s.isListItem(t)&&this._rebuildListItems(this._insertedBlocks,t,e),this.executeAtomicCommand(new u({note:this._note,newBlks:this._insertedBlocks,preBlk:t})))},_rebuildListItems:function(t,e,n){var o,i,r,l=t[0];isNaN(n)&&(n=0),i=l.listId,o=e.getOwnerList(),r=e.getLevel()-l.getLevel()+n,a.chain(t).groupBy(function(t){if(s.isListItem(t))return t.listId}).each(function(t,e){t.length>0&&e===i&&a.each(t,function(t){0!==r&&t.setLevel(t.getLevel()+r),t.setOwnerList(o)})})},fromCollabJSON:function(){var t=this,n=t.options.args,o=n.collabProperties.cmdJSON,i=n.collabProperties.coreEditor;e.__super__.fromCollabJSON.apply(t),o&&(t._newEndBlankParaId=o.newEndBlkId,t._insertedBlocks=[],a.each(o.insertedBlocks,function(e){t._insertedBlocks.push(y.buildBlockFromJSON(e,i))}))},toCollabJSON:function(){var t=e.__super__.toCollabJSON.apply(this);return t&&(t.newEndBlkId=this._newEndBlankParaId,t.insertedBlocks=this._insertedBlocksJSON),t}}),i.add(e),e}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e,o=n(0),i=n(138),r=n(5),a=n(97),s=n(112),l=n(7),c=n(16),u=n(33),d=n(4);return e=i.extend({name:"comp.InsertCatalogue",_cmdArgs:null,_note:null,_blkId:null,_ownerId:null,initialize:function(){this._note=this.options.note,this._cmdArgs=this.options.args||{},e.__super__.initialize.apply(this,arguments),this._initBlocks()},_initBlocks:function(){var t,e,n=this,i=n._note.blocks,r=[],u=[];n._ownerId=n._ownerId||d.newGUID(),e=new s({id:n._ownerId}),o.each(i,function(t){c.isForCatalogueBlock(t)&&r.push(t)}),n._catalogueIds=n._catalogueIds||[],o.each(r,function(o,i){t=new a({indent:o.getLevel()-1,text:o.getText().toString().trim(),href:o.getId(),ownerList:e}),u.push(t),n._catalogueIds[i]?t.setId(n._catalogueIds[i]):n._catalogueIds[i]=t.getId()}),0===r.length&&(t=new a({indent:0,text:l.INSERT_BLANK_CATALOGUE_TEXT,ownerList:e}),u.push(t),n._catalogueIds[0]?t.setId(n._catalogueIds[0]):n._catalogueIds[0]=t.getId()),n._newCatalogues=u},insertResource:function(t,e,n){var i=this._newCatalogues,r=i[i.length-1];return o.each(i,function(e){c.setResourceBlockStyleByPreBlock(e,t)}),i.length<1?t:(e&&i.unshift(e),n&&i.push(n),this.executeAtomicCommand(new u({note:this._note,newBlks:i,preBlk:t})),r)},fromCollabJSON:function(){var t=this._cmdArgs.collabProperties.cmdJSON;e.__super__.fromCollabJSON.apply(this),t&&(this._ownerId=t.listId,this._catalogueIds=t.blockIds)},toCollabJSON:function(){var t;return(t=e.__super__.toCollabJSON.apply(this))&&(t.listId=this._ownerId,t.blockIds=this._catalogueIds),t}}),r.add(e),e}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e,o=n(13),i=n(16),r=n(5),a=n(21),s=n(44),l=n(4),c=n(3);return e=o.extend({name:"comp.InsertHeading",_cmdArgs:null,_note:null,_blkId:null,_level:null,initialize:function(){this._note=this.options.note,this._cmdArgs=this.options.args||{},this._level=this._cmdArgs.level,e.__super__.initialize.apply(this,arguments),l.isCollabCommand(this._cmdArgs)||(this._blkId=l.newGUID())},apply:function(){var t,e,n,o=this,r=o._cmdArgs.range,l=r.getStartBlockRange(),u=r.getEndBlockRange(),d=l.block,p=u.block;if(r.isInMultiBlock())(n=o._note.getInterBlocks(d,p,!0)).forEach(function(i,r){0!==r?r!==n.length-1?o._helpSetBlock(i):e=o._helpSetBlock(i):t=o._helpSetBlock(i)}),o.setEndingRange(new a({startRange:s.createRangeByBlock({block:t,start:l.start,end:l.end}),endRange:s.createRangeByBlock({block:e,start:u.start,end:u.end})}));else{if(!c.isTextBlock(p))return!1;e=o._helpSetBlock(p),i.setTextBlockAsEndingRange(o,e,u.start,u.end)}},_helpSetBlock:function(t){return c.isTextBlock(t)?"default"===this._level||c.isHeading(t)&&t.getLevel()===this._level?i.replaceBlockWithParagraph(this,this._note,t,t.getText(),"",!0):i.replaceBlockWithHeading(this,this._note,t,t.getText(),this._level):t},fromCollabJSON:function(){var t=this._cmdArgs.collabProperties.cmdJSON;e.__super__.fromCollabJSON.apply(this),t&&(this._blkId=t.blockId,this._level=t.listType)},toCollabJSON:function(){var t;return(t=e.__super__.toCollabJSON.apply(this))&&(t.blockId=this._blkId,t.listType=this._level),t}}),r.add(e),e}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e,o=n(138),i=n(5),r=n(130),a=n(33),s=n(4);return e=o.extend({name:"comp.InsertHorizontalRule",_cmdArgs:null,_note:null,_hLineBlkId:null,initialize:function(){this._note=this.options.note,this._cmdArgs=this.options.args||{},e.__super__.initialize.apply(this,arguments),s.isCollabCommand(this._cmdArgs)||(this._hLineBlkId=s.newGUID())},insertResource:function(t,e,n){var o,i,s=[];return(o=new r).setId(this._hLineBlkId),t&&((i=t.getBlockStyles())["back-color"]&&o.setBlockStyle("back-color",i["back-color"]),i.padding&&o.setBlockStyle("padding",i.padding)),e&&s.push(e),s.push(o),n&&s.push(n),this.executeAtomicCommand(new a({note:this._note,newBlks:s,preBlk:t})),o},fromCollabJSON:function(){var t=this._cmdArgs.collabProperties.cmdJSON;e.__super__.fromCollabJSON.apply(this),t&&(this._hLineBlkId=t.newBlkId)},toCollabJSON:function(){var t;return(t=e.__super__.toCollabJSON.apply(this))&&(t.newBlkId=this._hLineBlkId),t}}),i.add(e),e}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e,o=n(138),i=n(5),r=n(3),a=n(117),s=n(81),l=n(33),c=n(120),u=n(4),d=n(16);return e=o.extend({name:"comp.InsertImage",_cmdArgs:null,_note:null,_imgBlkId:null,_imgSrc:null,initialize:function(){this._note=this.options.note,this._cmdArgs=this.options.args||{},e.__super__.initialize.apply(this,arguments),u.isCollabCommand(this._cmdArgs)||(this._imgBlkId=u.newGUID(),this._imgSrc=this._cmdArgs.src)},insertResource:function(t,e,n){var o,i,a=this._cmdArgs.range,c=[];return r.isTable(t)&&a.isSingleTableSelected()?this._insertImageInTable(t):(i=new s({source:this._imgSrc}),t&&((o=t.getBlockStyles())["back-color"]&&i.setBlockStyle("back-color",o["back-color"]),o.padding&&i.setBlockStyle("padding",o.padding)),d.setResourceBlockStyleByPreBlock(i,t),e&&c.push(e),c.push(i),n&&c.push(n),i.setId(this._imgBlkId),this.executeAtomicCommand(new l({note:this._note,newBlks:c,preBlk:t})),i)},_insertImageInTable:function(t){var e,n=this._cmdArgs.range.getStartBlockRange().getAsRectRange();if(n)return e=n.getFirstCellRect(),this.executeAtomicCommand(new c({table:t,cellRect:e,content:new a({source:this._imgSrc})})),t},fromCollabJSON:function(){var t=this._cmdArgs.collabProperties.cmdJSON;e.__super__.fromCollabJSON.apply(this),t&&(this._imgBlkId=t.newBlkId,this._imgSrc=t.src)},toCollabJSON:function(){var t;return(t=e.__super__.toCollabJSON.apply(this))&&(t.newBlkId=this._imgBlkId,t.src=this._imgSrc),t}}),i.add(e),e}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e,o=n(13),i=n(5),r=n(12),a=n(16),s=n(2),l=n(0),c=n(3),u=n(136),d=n(102),p=n(226),h=n(641),f=n(120),g=n(4);return e=o.extend({name:"comp.InsertLink",_cmdArgs:null,_note:null,_linkSrc:null,initialize:function(){var t,n;if(this._note=this.options.note,this._cmdArgs=this.options.args,e.__super__.initialize.apply(this,arguments),!g.isCollabCommand(this._cmdArgs)){if(n=(t=this._cmdArgs.range).getStartBlockRange().block,!this._cmdArgs.src)return void(this.isReadyToApply=!1);if(!c.isTable(n)){if(!t||!t.canDrawedByNative())return s.error(this.name+":note range should NOT be null or cannot be Drawed by native"),void(this.isReadyToApply=!1);if(t.isInMultiBlock()||!c.isTextBlock(n))return this.isReadyToApply=!1,void s.error("Cannot be executed in multi-selected blocks or non-text blocks:",this.name)}this._linkSrc=u.completeUrl(this._cmdArgs.src||""),this._linkStyles=this._cmdArgs.styles||{}}},apply:function(){var t,e,n,o,i,u=this._cmdArgs.range,f=l.extend(this._linkStyles,{color:"#003884",underline:!0,href:this._linkSrc});return(t=u.getStartBlockRange())?(e=t.block,c.isTable(e)?(this._setTableBlock(f,u),void this.setEndingRange(u)):c.isCatalogue(e)?(0===e.getLength()?(n=new r({text:this._linkSrc}),o=n.getLength(),this.executeAtomicCommand(new d({block:e,start:t.start,text:n})),this.executeAtomicCommand(new h({block:e,href:this._linkSrc})),a.setTextBlockAsEndingRange(this,e,o,o)):(this.executeAtomicCommand(new h({block:e,href:this._linkSrc})),this.setEndingRange(u)),!0):(t.isCollapsed()?(n=new r({text:this._linkSrc}),o=n.getLength(),n.setStyle(0,o,"href",this._linkSrc),l.each(f,function(t,e){n.setStyle(0,o,e,t)}),i=t.start+o,this.executeAtomicCommand(new d({block:e,start:t.start,text:n})),a.setTextBlockAsEndingRange(this,e,i,i)):(f.href=this._linkSrc,this.executeAtomicCommand(new p({blocks:[e],styleNameValues:f,start:t.start,end:t.end})),this.setEndingRange(u)),!0)):(s.error(this.name+":startBlockRange should not be null"),!1)},_setTableBlock:function(t,e){var n=this,o=n._linkSrc,i=e.getStartBlockRange(),a=i.block,s=i.getAsRectRange();s&&s.forEach(function(e,i){var s,l,c,u,d;(c=a.getCell(e,i)).isMergedCell()||(s=c.getContent(e,i),c.isTextNoEmptyCell()&&(d=(l=s.toRichText()).getLength()),d=d||o.length,(u=l||new r({text:o})).setStyles(0,d,t),n.executeAtomicCommand(new f({table:a,content:u,cellRect:{row:e,col:i}})))})},fromCollabJSON:function(){var t=this.options.args.collabProperties.cmdJSON;e.__super__.fromCollabJSON.apply(this),t&&(this._linkSrc=t.src,this._linkStyles=t.inlineStyles)},toCollabJSON:function(){var t=e.__super__.toCollabJSON.apply(this);return t&&(t.src=this._linkSrc,t.inlineStyles=this._linkStyles),t}}),i.add(e),e}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e,o=n(22),i=n(5),r=n(4);return e=o.extend({name:"atom.SetCatalogueHref",_href:null,_block:null,_oldHref:null,initialize:function(){var t=this.options,n=t.args;r.isCollabCommand(n)||(this._block=t.block||n.block,this._href=t.href||n.href),e.__super__.initialize.apply(this,arguments)},apply:function(){var t=this._href,e=this._block;e.setHref&&(this._oldHref=e.getHref(),e.setHref(t))},doUnapply:function(){this._block.setHref(this._oldHref)},getEndingRange:function(){return this.options.args.range},fromCollabJSON:function(){var t,n=this.options.args.collabProperties,o=n.cmdJSON;e.__super__.fromCollabJSON.apply(this),t=n.coreEditor.getNote(),o&&(this._block=t.getBlockById(o.blockId),this._href=o.styleNameValues,this._oldHref=o.oldStyleNameValues)},toCollabJSON:function(){var t;return(t=e.__super__.toCollabJSON.apply(this))&&(t.blockId=this._block.getId(),t.styleNameValues=this._href,t.oldStyleNameValues=this._oldHref),t}}),i.add(e),e}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e,o=n(13),i=n(5),r=n(118),a=n(28),s=n(12),l=n(33),c=n(34),u=n(4),d=n(16),p=n(3);return e=o.extend({name:"comp.InsertCode",_cmdArgs:null,_note:null,newBlkId:null,multiResult:null,splitCodeResult:null,convertToCodeResult:null,_checked:!1,initialize:function(){this._note=this.options.note,this._cmdArgs=this.options.args||{},e.__super__.initialize.apply(this,arguments),this.options.args.range&&this.calculateNewBlocks()},apply:function(){var t,e,n,o=this._cmdArgs.range,i=o.getStartBlockRange(),a=o.getEndBlockRange(),s=i.block,u=a.block,h=this._note.getPreBlock(s);if(this.multiResult||this.splitCodeResult||this.convertToCodeResult||this.calculateNewBlocks(),o.isInMultiBlock())return t=this.multiResult.selectedBlocks,n=this.multiResult.willBeInsertedBlocks,this.executeAtomicCommand(new c({note:this._note,blocks:t})),this.executeAtomicCommand(new l({note:this._note,newBlks:n,preBlk:h})),p.isCode(n[0])?(e=r.createBeginRange(n[0]),d.setCodeBlockAsEndingRange(this,e,i.start,0)):d.setTextBlockAsEndingRange(this,n[0],0,0),!0;this.handleInSingleBlock(u)},calculateNewBlocks:function(){var t,e=this.options.args.range;e&&(t=e.getEndBlockRange().block),e&&e.isInMultiBlock()?this.multiResult=this.handleInMultiBlock():p.isCode(t)?this.splitCodeResult=this.splitCodeBlock(t):this.convertToCodeResult=this.convertToCode(t)},handleInSingleBlock:function(t){var e,n,o=this._note,i=this._note.getPreBlock(t),a=this._cmdArgs.range.getStartBlockRange(),s=0;p.isCode(t)?(this.executeAtomicCommand(new c({note:this._note,blocks:[t]})),e=this.splitCodeResult,this.executeAtomicCommand(new l({note:o,newBlks:e,preBlk:i})),d.setTextBlockAsEndingRange(this,e[a.startLineIndex-1],a.startLineCharIndex,a.startLineCharIndex)):(this.executeAtomicCommand(new c({note:o,blocks:[t]})),this.executeAtomicCommand(new l({note:o,newBlks:this.convertToCodeResult.newBlocks,preBlk:i})),p.isTextBlock(a.block)&&(s=a.start),n=r.createBeginRange(this.convertToCodeResult.newCode),d.setCodeBlockAsEndingRange(this,n,s,0))},handleInMultiBlock:function(){var t,e,n,o=this,i=o._cmdArgs.range,r=i.getStartBlockRange(),l=i.getEndBlockRange(),c=r.block,u=l.block,h=o._note.getNextBlock(u);if(i.isInMultiBlock())return e=(t=o._note.getInterBlocks(c,u,!0)).map(function(t){return p.isTextBlock(t)?t.getText():t}),n=(n=e.reduce(function(e,n,i){var r,a=0===e.length?null:e[e.length-1];return n instanceof s?a&&p.isCode(a)?a.pushNewLineText(n):((r=d.createNewCode(t[i],{id:t[i].getId(),checked:o._checked})).pushNewLineText(n),e.push(r)):e.push(n),e},[])).reduce(function(t,e,o){var i=o+1<n.length?n[o+1]:h;return p.isCode(e)?(t.push(e),(!i||i&&!p.isTextBlock(i))&&t.push(a.createBlank())):t.push(e),t},[]),o.handleNewBlockIds(n),{selectedBlocks:t,willBeInsertedBlocks:n}},splitCodeBlock:function(t){var e;return e=t.getRichTexts().map(function(e){return d.createNewParagraph(t,null,e)}),this.handleNewBlockIds(e),e},convertToCode:function(t){var e,n=t.getId(),o=this._note.getPreBlock(t),i=this._note.getNextBlock(t),r=[];return e=d.createNewCode(t,{id:n,checked:this._checked}),p.isTextBlock(t)?e.pushNewLineText(t.getText()):e.pushNewLineText(""),r.push(e),!p.isCode(i)&&p.isTextBlock(i)||r.push(a.createBlank()),o&&p.isTextBlock(o)&&!p.isCode(o)||r.unshift(a.createBlank()),this.handleNewBlockIds(r),{newBlocks:r,newCode:e}},handleNewBlockIds:function(t){var e=this;e.newBlkId||(e.newBlkId=[]),e.newBlkId.length?t.forEach(function(t){t.setId(e.newBlkId.shift())}):t.forEach(function(t){var n=u.newGUID();e.newBlkId.push(n),t.setId(n)})},fromCollabJSON:function(){var t=this._cmdArgs.collabProperties.cmdJSON;e.__super__.fromCollabJSON.apply(this),t&&(this.newBlkId=t.newBlkId)},toCollabJSON:function(){var t;return(t=e.__super__.toCollabJSON.apply(this))&&(t.newBlkId=this.newBlkId),t}}),i.add(e),e}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e,o=n(13),i=n(5),r=n(16),a=n(2),s=n(3),l=n(0),c=n(21),u=n(44),d=n(62),p=n(63),h=n(34),f=n(33),g=n(644),m=n(4);return e=o.extend({name:"comp.InsertList",_cmdArgs:null,_note:null,_listType:null,_listId:null,initialize:function(){var t,n;if(this._note=this.options.note,this._cmdArgs=this.options.args,t=this._cmdArgs.range,e.__super__.initialize.apply(this,arguments),!m.isCollabCommand(this._cmdArgs)){if(!t)return this.isReadyToApply=!1,void a.error(this.name+":note range should NOT be null");if(n=t.getStartBlockRange().block,t.isInSingleBlock()&&!s.isTextBlock(n))return this.isReadyToApply=!1,void a.error("Single Block must be text block:",this.name,t);if(t.isInSingleBlock()&&s.isListItem(n)&&l.some(n.getOwnerList().getItems(),function(t){return t.isLocked()}))return void(this.isReadyToApply=!1);this._listType=this._cmdArgs.type,this._listId=m.newGUID()}},apply:function(){return this._cmdArgs.range.isInSingleBlock()?this._handleSingleBlockSelection():this._handleMultiBlockSelection(),!0},_handleMultiBlockSelection:function(){var t,e,n,o,i,a,g,m,y=this._cmdArgs.range,v=y.getStartBlockRange(),_=v.block,b=this._note.getPreBlock(_),C=y.getEndBlockRange(),k=C.block,w=this._note.getInterBlocks(_,k,!0),S=[],x=!0;for(o=0;o<w.length;++o)if(t=w[o],s.isListItem(t)){if(e=t.getOwnerList(),n&&n.getId()!==e.getId()){x=!1;break}n=e}else if(s.isTextBlock(t)){x=!1;break}x&&n.getType()===this._listType?l.each(w,function(t){"getLevel"in t&&t.getLevel()&&t.setBlockStyle("indent",t.getLevel()-1),s.isTextBlock(t)?S.push(r.createNewParagraph(t,t.getId(),t.getText())):S.push(t)}):(a=s.isListItem(b)&&b.getType()===this._listType?b.getOwnerList():new d({type:this._listType,listId:this._listId}),l.each(w,function(t){t.resetLockState(),s.isTextBlock(t)?s.isListItem(t)?((i=new p({id:t.getId(),level:t.getLevel(),list:a,text:t.getText()})).setBlockStyles(t.getBlockStyles()),S.push(i)):((i=new p({id:t.getId(),level:1,list:a,text:t.getText()})).setBlockStyles(t.getBlockStyles()),g=i.getBlockStyle("indent")||0,m=i.getBlockStyle("text-indent")||0,0!==g&&(i.setLevel(g+i.getLevel()),i.setBlockStyle("indent",0)),0!==m&&(i.setLevel(m+i.getLevel()),i.setBlockStyle("text-indent",0)),S.push(i)):S.push(t)})),l.isEmpty(S)||(this.executeAtomicCommand(new h({note:this._note,blocks:w})),this.executeAtomicCommand(new f({note:this._note,newBlks:S,preBlk:b})),s.isTextBlock(v.block)&&(v=u.createRangeByBlock({block:S[0],start:v.start,end:v.end})),C=S.length>1&&s.isTextBlock(C.block)?u.createRangeByBlock({block:l.last(S),start:C.start,end:C.end}):v,y=c.create({startRange:v,endRange:C})),this.setEndingRange(y)},_handleSingleBlockSelection:function(){var t,e,n,o,i=this._cmdArgs.range,a=i.getStartBlockRange().block;s.isListItem(a)?(n=a.getOwnerList()).getType()!==this._listType?(this.executeAtomicCommand(new g({lists:[n],isToggle:!0})),this.setEndingRange(i)):(o=r.replaceBlockWithParagraph(this,this._note,a,a.getText()),r.setTextBlockAsEndingRange(this,o,o.getLength(),o.getLength())):(t=this._note.getPreBlock(a),e=this._note.getNextBlock(a),t&&s.isListItem(t)&&t.getOwnerList().getType()===this._listType?o=r.replaceBlockWithListItem(this,this._note,t,a,a.getText(),t):e&&s.isListItem(e)&&e.getOwnerList().getType()===this._listType?o=r.replaceBlockWithListItem(this,this._note,e,a,a.getText(),t):(n=new d({type:this._listType,listId:this._listId}),(o=new p({id:a.getId(),level:1,list:n,text:a.getText()})).setBlockStyles(a.getBlockStyles()),this.executeAtomicCommand(new h({note:this._note,blocks:[a]})),this.executeAtomicCommand(new f({note:this._note,newBlks:[o],preBlk:t}))),r.setTextBlockAsEndingRange(this,o,o.getLength(),o.getLength()))},fromCollabJSON:function(){var t=this.options.args.collabProperties.cmdJSON;e.__super__.fromCollabJSON.apply(this),t&&(this._listId=t.listId,this._listType=t.listType)},toCollabJSON:function(){var t=e.__super__.toCollabJSON.apply(this);return t&&(t.listId=this._listId,t.listType=this._listType),t}}),i.add(e),e}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e,o=n(22),i=n(5),r=n(0),a=n(62),s=n(3),l=n(4);return e=o.extend({name:"atom.SetListType",_lists:null,_newTypes:null,_oldTypes:null,initialize:function(){var t=this,n=t.options,o=n.args;e.__super__.initialize.apply(t),l.isCollabCommand(o)||(t._lists=n.lists,t._newTypes={},n.newType?r.each(t._lists,function(e,o){t._newTypes[o]=n.newType}):n.isToggle&&r.each(t._lists,function(e,n){t._newTypes[n]=e.isOrdered()?a.UNORDERED:a.ORDERED}))},apply:function(){var t=this;return t._oldTypes={},r.each(t._newTypes,function(e,n){t._oldTypes[n]=t._lists[n].getType(),e!==t._lists[n].getType()&&t._lists[n].setType(e)}),!0},doUnapply:function(){var t=this;return r.each(t._oldTypes,function(e,n){t._lists[n].getType()!==e&&t._lists[n].setType(e)}),!0},fromCollabJSON:function(){var t,n=this.options.args,o=n.collabProperties.cmdJSON;o&&(t=n.collabProperties.coreEditor.getNote(),o.dataBefore&&(this._oldTypes=o.dataBefore),this._newTypes=o.dataAfter,this._lists=this._getListByIds(t,o.listId)),e.__super__.fromCollabJSON.apply(this)},toCollabJSON:function(){var t=[],n=e.__super__.toCollabJSON.apply(this);return this._oldTypes&&(n.dataBefore=this._oldTypes),n.dataAfter=this._newTypes,r.each(this._lists,function(e){t.push(e.getId())}),n.listId=t,n},_getListByIds:function(t,e){var n=[];return r.some(t.getAllBlocks(),function(t){return s.isListItem(t)&&t.getOwnerList()&&r.contains(e,t.getOwnerList().getId())&&n.push(t.getOwnerList()),n.length===e.length}),n}}),i.add(e),e}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e,o=n(138),i=n(5),r=n(115),a=n(33),s=n(4),l=n(135),c=n(16);return e=o.extend({name:"comp.InsertTable",_cmdArgs:null,_note:null,_tableBlkId:null,_columnNums:null,_rowNums:null,initialize:function(){this._note=this.options.note,this._cmdArgs=this.options.args||{},e.__super__.initialize.apply(this,arguments),s.isCollabCommand(this._cmdArgs)||(this._tableBlkId=s.newGUID(),this.skipBlockLocking=!0,this._columnNums=1,this._rowNums=1,this._cmdArgs.cols&&(this._columnNums=this._cmdArgs.cols),this._cmdArgs.rows&&(this._rowNums=this._cmdArgs.rows))},insertResource:function(t,e,n){var o,i=[];return o=r.createBlankTable(this._columnNums,this._rowNums,this._tableBlkId,l.DEFAULT_TABLE_WIDTH),c.setResourceBlockStyleByPreBlock(o,t),e&&i.push(e),i.push(o),n&&i.push(n),this.executeAtomicCommand(new a({note:this._note,newBlks:i,preBlk:t})),o},_initArray:function(t,e){for(var n=[];t--;)n[t]=e;return n},fromCollabJSON:function(){var t=this._cmdArgs.collabProperties.cmdJSON;e.__super__.fromCollabJSON.apply(this),t&&(this._tableBlkId=t.newBlkId,this._columnNums=t.colNums,this._rowNums=t.rowNums)},toCollabJSON:function(){var t;return(t=e.__super__.toCollabJSON.apply(this))&&(t.newBlkId=this._tableBlkId,t.colNums=this._columnNums,t.rowNums=this._rowNums),t}}),i.add(e),e}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e,o=n(13),i=n(5),r=n(44),a=n(21),s=n(33),l=n(34),c=n(4),u=n(16),d=n(3);return e=o.extend({name:"comp.InsertTodo",_cmdArgs:null,_note:null,_todoBlkId:null,_checked:!1,initialize:function(){this._note=this.options.note,this._cmdArgs=this.options.args||{},e.__super__.initialize.apply(this,arguments),c.isCollabCommand(this._cmdArgs)||(this._todoBlkId=c.newGUID(),this._checked=this._cmdArgs.checked)},apply:function(){var t,e,n,o,i=this,s=i._cmdArgs.range,l=s.getStartBlockRange(),c=s.getEndBlockRange(),p=l.block,h=c.block;s.isInMultiBlock()?(o=i._note.getInterBlocks(p,h,!0),n=o.every(function(t){return d.isTodo(t)||!d.isTextBlock(t)}),o.forEach(function(r,a){0!==a?a!==o.length-1?i._helpSetBlock(r,n):e=i._helpSetBlock(r,n):t=i._helpSetBlock(r,n)}),l=r.createRangeByBlock({block:t,start:l.start,end:l.end}),c=r.createRangeByBlock({block:e,start:c.start,end:c.end}),s=a.create({startRange:l,endRange:c}),i.setEndingRange(s)):(e=i._helpSetBlock(h,!0),u.setTextBlockAsEndingRange(i,e,c.start,c.end))},_helpSetBlock:function(t,e){var n,o,i=this._note,r=t.getId();return d.isTodo(t)?n=e?u.replaceBlockWithParagraph(this,this._note,t,t.getText()):t:d.isTextBlock(t)&&(o=i.getPreBlock(t),n=u.createNewTodo(t,{id:r,text:t.getText(),checked:this._checked}),this.executeAtomicCommand(new l({note:i,blocks:[t]})),this.executeAtomicCommand(new s({note:i,newBlks:[n],preBlk:o}))),n},fromCollabJSON:function(){var t=this._cmdArgs.collabProperties.cmdJSON;e.__super__.fromCollabJSON.apply(this),t&&(this._todoBlkId=t.newBlkId,this._checked=t.simpleValue1)},toCollabJSON:function(){var t;return(t=e.__super__.toCollabJSON.apply(this))&&(t.newBlkId=this._todoBlkId,t.simpleValue1=this._checked),t}}),i.add(e),e}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e,o=n(13),i=n(5),r=n(44),a=n(21),s=n(33),l=n(34),c=n(4),u=n(16),d=n(3);return e=o.extend({name:"comp.InsertQuote",_cmdArgs:null,_note:null,_quoteBlkId:null,_checked:!1,initialize:function(){this._note=this.options.note,this._cmdArgs=this.options.args||{},e.__super__.initialize.apply(this,arguments),c.isCollabCommand(this._cmdArgs)||(this._quoteBlkId=c.newGUID())},apply:function(){var t,e,n,o,i=this,s=i._cmdArgs.range,l=s.getStartBlockRange(),c=s.getEndBlockRange(),p=l.block,h=c.block;s.isInMultiBlock()?(o=i._note.getInterBlocks(p,h,!0),n=o.every(function(t){return d.isQuote(t)||!d.isTextBlock(t)}),o.forEach(function(r,a){0!==a?a!==o.length-1?i._helpSetBlock(r,n):e=i._helpSetBlock(r,n):t=i._helpSetBlock(r,n)}),l=r.createRangeByBlock({block:t,start:l.start,end:l.end}),c=r.createRangeByBlock({block:e,start:c.start,end:c.end}),s=a.create({startRange:l,endRange:c}),i.setEndingRange(s)):(e=i._helpSetBlock(h,!0),u.setTextBlockAsEndingRange(i,e,c.start,c.end))},_helpSetBlock:function(t,e){var n,o,i=this._note,r=t.getId();return d.isQuote(t)?n=e?u.replaceBlockWithParagraph(this,this._note,t,t.getText()):t:d.isTextBlock(t)&&(o=i.getPreBlock(t),n=u.createNewQuote(t,{id:r,text:t.getText(),checked:this._checked}),this.executeAtomicCommand(new l({note:i,blocks:[t]})),this.executeAtomicCommand(new s({note:i,newBlks:[n],preBlk:o}))),n},fromCollabJSON:function(){var t=this._cmdArgs.collabProperties.cmdJSON;e.__super__.fromCollabJSON.apply(this),t&&(this._quoteBlkId=t.newBlkId)},toCollabJSON:function(){var t;return(t=e.__super__.toCollabJSON.apply(this))&&(t.newBlkId=this._quoteBlkId),t}}),i.add(e),e}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e,o=n(13),i=n(5),r=n(2),a=n(3),s=n(16),l=n(229),c=n(34),u=n(83),d=n(169),p=n(102),h=n(227),f=n(172),g=n(136),m=n(101),y=n(4);return e=o.extend({name:"comp.KeyBackspace",_cmdArgs:null,_note:null,initialize:function(){var t,n;if(this._note=this.options.note,this._cmdArgs=this.options.args,this._inlineStyles=this._cmdArgs.inlineStyles,e.__super__.initialize.apply(this),!y.isCollabCommand(this._cmdArgs)){if(n=(t=this._cmdArgs.range).getStartBlockRange().block,!t)return this.isReadyToApply=!1,void r.error(this.name+":note range should NOT be null");if(t.isInSingleBlock()&&a.isTable(n))return this.isReadyToApply=!1,void r.error("should NOT trigger the cmd when in Table.")}},apply:function(){var t,e,n,o,i,r,l,u,d=this._cmdArgs.range,h=[];if(e=(t=d.getStartBlockRange()).block,i=o=d.getEndBlockRange().block,r=this._note.getPreBlock(e),u=this._cmdArgs.inlineStyles,a.isCode(e))return t.selectWholeBlock?(i=s.replaceBlockWithParagraph(this,this._note,e,""),s.setTextBlockAsEndingRange(this,i,0,0)):d.isCollapsed()?(n=this._deleteCodeText(e,t),s.setCodeBlockAsEndingRange(this,n,0)):(s.deleteSelectedContent(this,this._note,d),s.setCodeBlockAsEndingRange(this,t,0)),!0;if(d.isCollapsed()||s.deleteSelectedContent(this,this._note,d),d.isCollapsed()&&a.isTextBlock(e))return 0===t.start?this._deleteAtTextBlockStart(r,e,u):this._deleteAtTextBlockMiddle(e,t.start);if(d.isInSingleBlock()&&a.isTextBlock(e))return s.setTextBlockAsEndingRange(this,e,t.start,t.start),!0;if(a.isTextBlock(e)||(r&&!a.isTable(r)?(h.push(e),i=r,a.isTextBlock(r)&&(l=r.getLength())):(i=s.replaceBlockWithParagraph(this,this._note,e,""),l=0)),d.isInMultiBlock(o)&&(a.isTextBlock(o)?a.isTextBlock(e)&&!a.isCode(o)?(this.executeAtomicCommand(new p({block:e,start:e.getLength(),text:o.getText()})),h.push(o),l=t.start,i=e):(l=0,i=o):h.push(o)),h.length>0&&this.executeAtomicCommand(new c({note:this._note,blocks:h})),a.isTextBlock(i)){if(a.isCode(i))return s.setCodeBlockAsEndingRange(),!0;s.setTextBlockAsEndingRange(this,i,l,l)}else this.setEndingRange(m.buildNoteRangeFromNonTextBlock(i));return!0},_deleteAtTextBlockStart:function(t,e,n){var o,i,r;return a.isListItem(e)?(e.getIndex()>0&&e.getLevel()>1?this.executeAtomicCommand(new f({listItems:[e],newLevel:e.getLevel()-1})):e=s.replaceBlockWithParagraph(this,this._note,e,e.getText(),n),s.setTextBlockAsEndingRange(this,e,0,0),!0):a.isTodo(e)||a.isQuote(e)?(e=s.replaceBlockWithParagraph(this,this._note,e,e.getText(),n),s.setTextBlockAsEndingRange(this,e,0,0),!0):(i=e.getBlockStyle("text-indent"))&&i>0?(this.executeAtomicCommand(new h({blocks:[e],styleNameValues:{"text-indent":i-1}})),s.setTextBlockAsEndingRange(this,e,0,0),!0):(o=e.getBlockStyle("indent"))&&o>0?(this.executeAtomicCommand(new h({blocks:[e],styleNameValues:{indent:o-1}})),s.setTextBlockAsEndingRange(this,e,0,0),!0):t?!a.isTextBlock(t)||a.isCode(t)?(a.isHr(t)?(this.executeAtomicCommand(new c({note:this._note,blocks:[t]})),s.setTextBlockAsEndingRange(this,e,0,0)):this.setEndingRange(m.buildNoteRangeFromNonTextBlock(t)),!0):(r=t.getLength(),this.executeAtomicCommand(new p({block:t,start:t.getLength(),text:e.getText()})),this.executeAtomicCommand(new c({note:this._note,blocks:[e]})),s.setTextBlockAsEndingRange(this,t,r,r),!0):(s.setTextBlockAsEndingRange(this,e,0,0),!0)},_deleteAtTextBlockMiddle:function(t,e){g.isAtHrefBorder(t,e,!0)?this._deleteHrefAtCursorPos(t,e):(this.executeAtomicCommand(new u({block:t,start:e-1,end:e,inlineStyles:this._inlineStyles})),s.setTextBlockAsEndingRange(this,t,e-1,e-1))},_deleteHrefAtCursorPos:function(t,e){var n;-1!==(n=g.findHrefBorder(t,e,!0))&&s.deleteHref(this,t,n,e)},_deleteCodeText:function(t,e){var n=e.clone(),o=e.block.getLineInfo(e.startLineIndex),i=e.block.getLineInfo(e.startLineIndex-1);return 0===e.startLineCharIndex?i&&(n.startLineIndex=e.startLineIndex-1,n.startLineCharIndex=i.lineLength):o.lineStartSpacesNum===e.startLineCharIndex?l.keyBackspace.currentLineIsEmpty.backToLineStart||!i?n.startLineCharIndex=0:(n.startLineIndex=e.startLineIndex-1,n.startLineCharIndex=i.lineLength):n.startLineCharIndex=e.startLineCharIndex-1,n.startLineIndex<e.startLineIndex&&s.getNoteView(this).getBlockViewByBlock(t).scrollRightByIndex(n.startLineIndex),this.executeAtomicCommand(new d({block:t,start:e.start,startBlockRange:n,endBlockRange:e,inlineStyles:this._inlineStyles})),n},isSingleBlockAffected:function(){var t,n=this._args.range,o=e.__super__.isSingleBlockAffected.apply(this),i=0;return o&&n.isCollapsed()&&(i=(t=n.getStartBlockRange()).start,this._note.getPreBlock(t.block)&&0===i&&(o=!1)),o}}),i.add(e),e}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e,o=n(299),i=n(5),r=n(2),a=n(3),s=n(4);return e=o.extend({name:"comp.KeyDelete",_cmdArgs:null,_note:null,initialize:function(){var t,n,o,i,l;if(this._note=this.options.note,this._cmdArgs=this.options.args,e.__super__.initialize.apply(this),!s.isCollabCommand(this._cmdArgs)){if(i=(n=(t=this._cmdArgs.range).getStartBlockRange()).block,l=(o=t.getEndBlockRange()).block,!t)return this.isReadyToApply=!1,void r.error(this.name+":note range should NOT be null");if(t.isInSingleBlock()&&a.isTable(i))return this.isReadyToApply=!1,void r.error("should NOT trigger the cmd when in Table.");if(t.isInSingleBlock()&&a.isTextBlock(i)&&t.isCollapsed()&&n.start===i.getLength()&&!this._note.getNextBlock(i))return this.isReadyToApply=!1,void r.warn("do NOT support the command at the end of note:",this.name);a.isTextBlock(l)&&o.end===l.getLength()&&a.isCatalogue(this._note.getNextBlock(l))&&(this.isReadyToApply=!1,r.warn("do NOT support when next is Catalogue block."))}},isSingleBlockAffected:function(){var t,n,o=this._args.range,i=e.__super__.isSingleBlockAffected.apply(this),r=0;return i&&o.isCollapsed()&&(t=(n=o.getStartBlockRange()).block,r=n.start,this._note.getNextBlock(t)&&r===t.getEndOffset()&&(i=!1)),i},isValidStartNoteRange:function(){var t,e,n=!0;return(t=this.getStartingRange())&&t.isInSingleBlock()&&(e=t.getStartBlockRange().block,a.isTable(e)&&(n=!1)),n}}),i.add(e),e}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e,o=n(13),i=n(5),r=n(2),a=n(0),s=n(3),l=n(12),c=n(82),u=n(16),d=n(229),p=n(33),h=n(137),f=n(83),g=n(34),m=n(172),y=n(136),v=n(4);return e=o.extend({name:"comp.KeyEnter",_note:null,_cmdArgs:null,_newBlkId:null,initialize:function(){var t,n;if(this._note=this.options.note,this._cmdArgs=this.options.args,e.__super__.initialize.apply(this),!v.isCollabCommand(this._cmdArgs)){if(n=(t=this._cmdArgs.range).getStartBlockRange().block,!t)return this.isReadyToApply=!1,void r.error(this.name+":note range should NOT be null");if(t.isInSingleBlock()&&s.isTable(n))return this.isReadyToApply=!1,void r.error("should NOT trigger the cmd when in Table.");this._newBlkId=v.newGUID()}},apply:function(){var t,e,n,o,i,r,l=this._cmdArgs.range,c=!1,d=null,p=[];return i=e=(t=l.getStartBlockRange()).block,r=n=l.getEndBlockRange().block,l.isCollapsed()||u.deleteSelectedContent(this,this._note,l),s.isTextBlock(e)&&!s.isCode(e)&&(s.isCatalogue(e)||(i=s.isQuote(e)&&e.richText.getLength()?u.createNewQuote(e,{id:e.getId(),text:e.getText()}):u.createNewParagraph(e,e.getId(),e.getText()),y.isAtHrefBorder(i,t.start,!0)&&u.deleteHref(this,i,0,e.getLength())),u.recogLink(this,e,0,e.getLength())),l.isInMultiBlock()?(s.isTextBlock(e)||(i=u.replaceBlockWithParagraph(this,this._note,e,"")),s.isTextBlock(n)||(r=u.replaceBlockWithParagraph(this,this._note,n,"")),s.isListItem(i)?r=this._replaceBlockWithListItem(r,i,r.getText()):s.isTextBlock(i)&&s.isListItem(r)&&(r=u.replaceBlockWithParagraph(this,this._note,r,r.getText())),u.setTextBlockAsEndingRange(this,r,0,0),!0):(s.isTextBlock(e)?s.isCode(e)||(o=e.sliceText(t.start,e.getLength()),this.executeAtomicCommand(new f({block:e,start:t.start,end:e.getLength()}))):i=u.replaceBlockWithParagraph(this,this._note,e,""),s.isListItem(e)?e.isEmpty()&&0===o.getLength()?r=i=this._reduceListItemLevel(e):(r=this._insertListItem(e,this._newBlkId,o,this._cmdArgs.inlineStyles),c=!0):(s.isHeading(e)?r=o.toString().length>0?this._insertHeading(i,this._newBlkId,o,e.getLevel()):this._insertParagraph(i,this._newBlkId,o):s.isCatalogue(e)?r=this._insertCatalogueHelp(i,{startBlock:e,paraId:this._newBlkId,text:o}):s.isTodo(e)?r=e.isEmpty()&&0===o.getLength()?u.replaceBlockWithParagraph(this,this._note,e,""):this._insertTodo(i,{startBlock:e,id:this._newBlkId,text:o,checked:!1,inlineStyles:this._cmdArgs.inlineStyles}):s.isQuote(e)?r=e.isEmpty()&&0===o.getLength()?u.replaceBlockWithParagraph(this,this._note,e,""):this._insertQuote(i,{id:this._newBlkId,text:o,inlineStyles:this._cmdArgs.inlineStyles}):s.isCode(e)?t.selectWholeBlock?r=u.replaceBlockWithParagraph(this,this._note,e,""):d=this._insertCodeLine(t):r=this._insertParagraph(i,this._newBlkId,o,this._cmdArgs.inlineStyles),c=!0),r.setInlineStylesForEmpty(this._cmdArgs.inlineStyles),s.isCode(r)?(u.getNoteView(this).getBlockViewByBlock(r).scrollToStart(),u.setCodeBlockAsEndingRange(this,t,d.newCursorOffset,Number(!!d.insertedChars))):u.setTextBlockAsEndingRange(this,r,0,0),a.each(this._note.getInterBlocks(e,n,!0),function(t){p.push(t.getId())}),c&&p.push(this._newBlkId),this.pushAffectedBlockIds(p),!0)},_insertListItem:function(t,e,n,o){var i;return i=u.createNewListItem(t,e,n),u.setBlockStyle(i,o),this.executeAtomicCommand(new p({note:this._note,newBlks:[i],preBlk:t})),i},_insertParagraph:function(t,e,n,o){var i;if(i=u.createNewParagraph(t,e,n,!o))return o&&u.setBlockStyle(i,o),this.executeAtomicCommand(new p({note:this._note,newBlks:[i],preBlk:t})),i},_insertHeading:function(t,e,n,o){var i;return i=u.createNewHeading(t,e,n,o,!0),this.executeAtomicCommand(new p({note:this._note,newBlks:[i],preBlk:t})),i},_insertTodo:function(t,e){var n;return n=u.createNewTodo(t,e),u.setBlockStyle(n,e.inlineStyles),this.executeAtomicCommand(new p({note:this._note,newBlks:[n],preBlk:t})),n},_insertQuote:function(t,e){var n;return n=u.createNewQuote(t,e),u.setBlockStyle(n,e.inlineStyles),this.executeAtomicCommand(new p({note:this._note,newBlks:[n],preBlk:t})),n},_insertCodeLine:function(t){var e,n,o,i,r=0,a=t.block.getLineInfo(t.startLineIndex);return t.startLineCharIndex===a.lineLength&&(r=d.keyEnter.whenEndCharIs[a.lineEndChar]||d.keyEnter.whenEndCharIs.default),t.startLineCharIndex===a.lineLength-1&&(n=a.lineText.slice(a.lineText.length-2),(o=["{}","()","[]"].indexOf(n)>-1)&&(r=4)),e=c.LINE_BREAK+" ".repeat(a.lineStartSpacesNum+r),o&&(e+=c.LINE_BREAK+" ".repeat(a.lineStartSpacesNum)),i=new l({text:e}),this.executeAtomicCommand(new h({block:t.block,startBlockRange:t,text:i})),{insertedChars:e,isBetweenPairs:o,newCursorOffset:o?e.length-a.lineStartSpacesNum-2:e.length-1}},_insertCatalogueHelp:function(t,e){var n=e.startBlock;return e.text.getLength()<1?e.href="":e.href=n.getHref(),this._insertCatalogue(t,e)},_insertCatalogue:function(t,e){var n;return n=u.createNewCatalogue(t,e),this.executeAtomicCommand(new p({note:this._note,newBlks:[n],preBlk:t})),n},_reduceListItemLevel:function(t){var e=t;return t.getLevel()<=1?e=u.replaceBlockWithParagraph(this,this._note,t,""):this.executeAtomicCommand(new m({listItems:[t],newLevel:t.getLevel()-1})),e},_replaceBlockWithListItem:function(t,e,n){return this.executeAtomicCommand(new g({note:this._note,blocks:[t]})),this._insertListItem(e,t.getId(),n,this._cmdArgs.inlineStyles)},fromCollabJSON:function(){var t=this.options.args.collabProperties.cmdJSON;e.__super__.fromCollabJSON.apply(this),t&&(this._newBlkId=t.newBlkId)},isSingleBlockAffected:function(){return!1},toCollabJSON:function(){var t=e.__super__.toCollabJSON.apply(this);return t.newBlkId=this._newBlkId,t}}),i.add(e),e}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e,o=n(13),i=n(5),r=n(2),a=n(3),s=n(12),l=n(16),c=n(229),u=n(83),d=n(137),p=n(169),h=n(172),f=n(4);return e=o.extend({name:"comp.KeyTab",_cmdArgs:null,_note:null,_withShiftKey:!1,initialize:function(){var t,n;if(this._note=this.options.note,this._cmdArgs=this.options.args,e.__super__.initialize.apply(this),!f.isCollabCommand(this._cmdArgs)){if(t=this._cmdArgs.range,this._cmdArgs.withShiftKey&&(this._withShiftKey=!0),!t||!t.canDrawedByNative())return r.error(this.name+":note range should NOT be null"),void(this.isReadyToApply=!1);if(n=t.getStartBlockRange().block,t.isInSingleBlock()&&!a.isTextBlock(n))return void(this.isReadyToApply=!1)}},apply:function(){var t,e,n,o,i,r,s=this._cmdArgs.range,c=1;if(e=(t=s.getStartBlockRange()).block,n=s.getEndBlockRange().block,this._withShiftKey&&(c=-1),(i=s.isInMultiBlock())||0===t.start&&t.end===e.getLength())return r=!i,o=this._note.getInterBlocks(e,n,!0),l.isInSameList(o)?this._isFirstListItem(o[0])?l.updateBlocksIndentLevel(this,o[0].getOwnerList().getItems(),c):this.executeAtomicCommand(new h({listItems:o,deltaLevel:c})):this._withShiftKey&&r?e.getBlockStyle("text-indent")?this._updateBlockTextIndent(e,c):l.updateBlocksIndentLevel(this,[e],c):r&&0===t.end?this._updateBlockTextIndent(e,c):l.updateBlocksIndentLevel(this,o,c),this.setEndingRange(s),!0;0===t.start?a.isListItem(e)?this._isFirstListItem(e)?(l.updateBlocksIndentLevel(this,e.getOwnerList().getItems(),c),this.setEndingRange(s)):(this.executeAtomicCommand(new h({listItems:[e],deltaLevel:c})),this.setEndingRange(s)):this._withShiftKey?e.getBlockStyle("text-indent")?this._updateBlockTextIndent(e,c):(l.updateBlocksIndentLevel(this,[e],c),this.setEndingRange(s)):this._updateBlockTextIndent(e,c):this._withShiftKey?this._handleShiftTabNotAtStart(t):this._insertTabChar()},_handleShiftTabNotAtStart:function(t){var e,n,o,i,r=t.block,s=!0;if(a.isCode(r))return this._decreaseIndent(t);for(e=r.getText().getReadOnlyData(),i=(n=t.start)-1;i>=0;i--)if("\t"!==e[i].char){if(" "!==e[i].char){s=!1;break}n-i==4&&(o=i)}else o||(o=i);s?(o=o||0,this.executeAtomicCommand(new u({block:r,start:o,end:n})),l.setTextBlockAsEndingRange(this,r,o,o)):this._insertTabChar()},_insertTabChar:function(){var t,e,n=this._cmdArgs.inlineStyles,o=this._cmdArgs.range,i=0,r=o.getStartBlockRange(),u=o.getEndBlockRange(),p=r.clone(),h=r.clone();if(a.isCode(r.block)&&o.isInSingleBlock()){for(e=r.startLineIndex;e<=u.endLineIndex;e++)t=new s({text:" ".repeat(c.keyTab.addSpacesNum)}),p.startLineIndex=e,p.startLineCharIndex=0,this.executeAtomicCommand(new d({block:r.block,startBlockRange:p,text:t}));return h.startLineCharIndex+=4,i=h.endLineCharIndex+c.keyTab.addSpacesNum,void(r.isCollapsed()?l.setCodeBlockAsEndingRange(this,h,0):l.expandCodeRange(this,h,i,h.endLineIndex-h.startLineIndex))}l.deleteSelectedContent(this,this._note,o),l.insertTabChar(this,r.block,r.start,n),l.setTextBlockAsEndingRange(this,r.block,r.start+1,r.start+1)},_decreaseIndent:function(t){var e,n,o,i=t.block,r=t.clone(),a=t.clone(),s=[];for(e=t.startLineIndex;e<=t.endLineIndex;e++)0!==(n=i.getLineInfo(e).lineStartSpacesNum)?(o=n<4?n:4,r.startLineIndex=e,r.endLineIndex=e,r.startLineCharIndex=0,r.endLineCharIndex=o,s.push(o),this.executeAtomicCommand(new p({block:t.block,startBlockRange:r,endBlockRange:r}))):s.push(0);a.startLineCharIndex=Math.max(a.startLineCharIndex-s.shift(),0),l.expandCodeRange(this,a,a.endLineCharIndex-s.pop()||0,a.endLineIndex-a.startLineIndex)},_isFirstListItem:function(t){return 1===t.getLevel()&&1===t.getIndex()},_updateBlockTextIndent:function(t,e){l.updateBlockTextIndentLevel(this,t,e),this.setEndingRange(this._cmdArgs.range)},fromCollabJSON:function(){var t=this.options.args.collabProperties.cmdJSON;t&&t.simpleValue1&&(this._withShiftKey=!0),e.__super__.fromCollabJSON.apply(this)},toCollabJSON:function(){var t=e.__super__.toCollabJSON.apply(this);return this._withShiftKey&&(t.simpleValue1=!0),t}}),i.add(e),e}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e,o=n(13),i=n(5),r=n(12),a=n(16),s=n(2),l=n(3),c=n(34),u=n(102),d=n(137),p=n(120),h=n(4);return e=o.extend({name:"comp.KeyTextInput",_cmdArgs:null,_note:null,_inputtedText:null,_recogLink:!1,initialize:function(){var t;if(this._note=this.options.note,this._cmdArgs=this.options.args,t=this._cmdArgs.range,e.__super__.initialize.apply(this,arguments),!h.isCollabCommand(this._cmdArgs)){if(!t)return this.isReadyToApply=!1,void s.error(this.name+":note range should NOT be null");this._recogLink=this._cmdArgs.recogLink,this._inputtedText=this._cmdArgs.text}},apply:function(){var t,e,n,o,i,s,p,h,f=!0,g=this._cmdArgs.range;if(n=e=(t=g.getStartBlockRange()).block,i=t.start,o=g.getEndBlockRange().block,g.isInSingleBlock()&&l.isTable(e))return this._insertTextInTable(t,e,this._inputtedText);if(g.isCollapsed()||l.isCode(n)||a.deleteSelectedContent(this,this._note,g),l.isTextBlock(e,t)||(n=a.replaceBlockWithParagraph(this,this._note,e,""),i=0),g.isInMultiBlock()&&(l.isTextBlock(o)&&(h=o.getText()),this.executeAtomicCommand(new c({note:this._note,blocks:[o]}))),s=i+this._inputtedText.getLength(),h&&this._inputtedText.append(h),l.isCode(n)){switch(g.isCollapsed()||a.deleteSelectedContent(this,this._note,g),p=this._inputtedText.toString()){case"{":p+="}";break;case"(":p+=")";break;case"[":p+="]";break;default:f=!1}return this._inputtedText=new r({text:p}),this.executeAtomicCommand(new d({block:n,start:i,text:this._inputtedText,startBlockRange:t})),a.setCodeBlockAsEndingRange(this,t,this._inputtedText.getLength()-Number(f)),!0}return this.executeAtomicCommand(new u({block:n,start:i,text:this._inputtedText})),this._recogLink&&a.recogLink(this,n,0,i),a.setTextBlockAsEndingRange(this,n,s,s),!0},_insertTextInTable:function(t,e,n){var o,i;(o=t.getAsRectRange())&&(i=o.getFirstCell(),this.executeAtomicCommand(new p({table:e,cellRect:{row:i.row,col:i.col},content:n})))},canBeMerged:function(t){var n,o,i;if(e.__super__.canBeMerged.apply(this,[t])){if(!this.startingRange||!t.getStartingRange())return!1;if(n=this.startingRange.getStartBlockRange(),i=t.getStartingRange().getStartBlockRange(),!t.getStartingRange().isCollapsed())return!1;if(this.isLocalExecutedCmd){if(!this.endingRange)return!1;if(o=this.endingRange.getEndBlockRange(),!l.isTextBlock(o))return!1;if(i.getBlockId()!==o.getBlockId())return!1;if(o.end!==i.start)return!1}else{if(n.getBlockId()!==i.getBlockId())return!1;if(n.start!==i.start)return!1}return" "!==t.getInputtedText().toString()}return!1},fromCollabJSON:function(){var t=this.options.args.collabProperties.cmdJSON;e.__super__.fromCollabJSON.apply(this),t&&(this._inputtedText=r.fromCollabJSON(t.richText),t.recogLink&&(this._recogLink=!0))},getInputtedText:function(){return this._inputtedText},mergeLocalCmd:function(t){var e,n,o=t.getInputtedText();this.endingRange&&(e=this.endingRange.getEndBlockRange()),o&&o.getLength()>0&&(this._inputtedText.append(o),this.isLocalExecutedCmd&&(n=e.end+o.getLength(),a.setTextBlockAsEndingRange(this,e.block,n,n)))},toCollabJSON:function(){var t=e.__super__.toCollabJSON.apply(this);return t&&(t.richText=this._inputtedText.toCollabJSON(),this._recogLink&&(t.recogLink=this._recogLink)),t}}),i.add(e),e}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e,o=n(13),i=n(5),r=n(2),a=n(16);return e=o.extend({name:"comp.RemoveFormat",_note:null,_cmdArgs:null,initialize:function(){this._note=this.options.note,this._cmdArgs=this.options.args,e.__super__.initialize.apply(this)},apply:function(){var t=this._cmdArgs.range;return!t||t.isCollapsed()?(r.error("collapsed时应该修改编辑器当前样式状态，不应进入此命令",t),!1):(a.resetAllStyles(this,this._note,t,this._args.blockStyles,this._args.inlineStyles,{resetAllStyles:this._args.resetAllStyles,isRemoveFormat:!0}),this.setEndingRange(t),!0)}}),i.add(e),e}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e,o=n(13),i=n(5),r=n(0),a=n(655),s=n(4);return e=o.extend({name:"comp.ReplaceResource",_note:null,_cmdArgs:null,_resources:null,_resProps:null,initialize:function(){this._note=this.options.note,this._cmdArgs=this.options.args,e.__super__.initialize.apply(this),s.isCollabCommand(this._cmdArgs)||(this._resources=this._cmdArgs.resources,this._resProps=this._cmdArgs.resProps,this.endingRange=this._cmdArgs.endingRange)},apply:function(){return this.executeAtomicCommand(new a({resources:this._resources,newResProps:this._resProps}),this.endingRange),!0},fromCollabJSON:function(){var t=this,n=t._cmdArgs.collabProperties.coreEditor,o=t._cmdArgs.collabProperties.cmdJSON;o&&(t._resProps=o.simpleValue1,t._resources=[],r.each(o.resIds,function(e){t._resources.push(n.getBlockById(e))}),o.simpleValue2&&(t._cmdArgs.ignoreUndoRedo=!0),o.endNoteRange&&(t.endingRange=o.endNoteRange)),e.__super__.fromCollabJSON.apply(t)},isSingleBlockAffected:function(){return!1},toCollabJSON:function(){var t=[],n=e.__super__.toCollabJSON.apply(this);return n&&(r.each(this._resources,function(e){t.push(e.getId())}),n.simpleValue1=this._resProps,n.resIds=t,this._cmdArgs.ignoreUndoRedo&&(n.simpleValue2=!0),n.endNoteRange=this.endingRange),n}}),i.add(e),e}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e,o=n(22),i=n(5),r=n(0),a=n(3),s=n(4);return e=o.extend({name:"atom.SetResourceProps",_resources:null,_newResProps:null,_oldResProps:null,initialize:function(){var t=this.options,n=t.args;e.__super__.initialize.apply(this),s.isCollabCommand(n)||(this._resources=t.resources,this._newResProps=t.newResProps)},apply:function(){var t=this;return t._oldResProps={},r.each(t._resources,function(e,n){t._oldResProps[n]={},a.isImage(e)?(t._newResProps[n].source&&(t._oldResProps[n].source=e.getSource(),e.setSource(t._newResProps[n].source)),r.isUndefined(t._newResProps[n].title)||(t._oldResProps[n].title=e.getTitle(),e.setTitle(t._newResProps[n].title))):a.isAttachment(e)&&(t._newResProps[n].source&&(t._oldResProps[n].source=e.getSource(),e.setSource(t._newResProps[n].source)),t._newResProps[n].resource&&(t._oldResProps[n].resource=e.getResource(),e.setResource(t._newResProps[n].resource)),t._newResProps[n].fileName&&(t._oldResProps[n].fileName=e.getFileName(),e.setFileName(t._newResProps[n].fileName)),t._newResProps[n].fileLength&&(t._oldResProps[n].fileLength=e.getFileLength(),e.setFileLength(t._newResProps[n].fileLength)))}),!0},doUnapply:function(){var t=this;return r.each(t._resources,function(e,n){a.isImage(e)?(t._oldResProps[n].source&&e.setSource(t._oldResProps[n].source),r.isUndefined(t._oldResProps[n].title)||e.setTitle(t._oldResProps[n].title)):a.isAttachment(e)&&(t._oldResProps[n].source&&e.setSource(t._oldResProps[n].src),t._oldResProps[n].resource&&e.setResource(t._oldResProps[n].resource),t._oldResProps[n].fileName&&e.setFileName(t._oldResProps[n].fileName),t._oldResProps[n].fileLength&&e.setFileLength(t._oldResProps[n].fileLength))}),!0},fromCollabJSON:function(){var t,n=this.options.args,o=n.collabProperties.cmdJSON;o&&(t=n.collabProperties.coreEditor.getNote(),o.dataBefore&&(this._oldResProps=o.dataBefore),this._newResProps=o.dataAfter,this._resources=this._getResByIds(t,o.resIds)),e.__super__.fromCollabJSON.apply(this)},toCollabJSON:function(){var t=[],n=e.__super__.toCollabJSON.apply(this);return this._oldResProps&&(n.dataBefore=this._oldResProps),n.dataAfter=this._newResProps,r.each(this._resources,function(e){t.push(e.getId())}),n.resIds=t,n},_getResByIds:function(t,e){var n=[];return r.some(t.getAllBlocks(),function(t){return r.contains(e,t.getId())&&n.push(t),e.length===n.length}),n}}),i.add(e),e}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e,o=n(0),i=n(13),r=n(5),a=n(3),s=n(16),l=n(97),c=n(112),u=n(12),d=n(7),p=n(34),h=n(33),f=n(4);return e=i.extend({name:"comp.RefreshCatalogue",_cmdArgs:null,_note:null,_ownerId:null,_delete:!1,_catalogueIds:null,_catalogues:null,_newCatalogues:null,_blankParaId:null,initialize:function(){this._note=this.options.note,this._cmdArgs=this.options.args||{},this._ownerId=this._cmdArgs.ownerId,this._delete=this._cmdArgs.delete,e.__super__.initialize.apply(this,arguments),this._initBlocks()},_initBlocks:function(){var t,e,n=this,i=n._note.blocks,r=[],u=[],p=[];o.each(i,function(t){a.isCatalogue(t)&&t.getOwnerId()===n._ownerId&&r.push(t),s.isForCatalogueBlock(t)&&u.push(t)}),(r.length>0||!n._ownerId)&&(n._catalogueIds=n._catalogueIds||[],n._ownerId=n._ownerId||f.newGUID(),e=new c({id:n._ownerId}),o.each(u,function(o,i){t=new l({indent:o.getLevel()-1,text:o.getText().toString().trim(),href:o.getId(),ownerList:e}),p.push(t),n._catalogueIds[i]?t.setId(n._catalogueIds[i]):n._catalogueIds[i]=t.getId()}),0===u.length&&(t=new l({indent:0,text:d.INSERT_BLANK_CATALOGUE_TEXT,ownerList:e}),p.push(t),n._catalogueIds[0]?t.setId(n._catalogueIds[0]):n._catalogueIds[0]=t.getId())),n._catalogues=r,n._newCatalogues=p,(0===p.length||n._delete)&&(n._blankParaId=n._blankParaId||f.newGUID())},apply:function(){var t=this._catalogues,e=this._newCatalogues,n=t[t.length-1]||this.startingRange.getEndBlockRange().block,i=e[e.length-1];o.each(e,function(t){s.setResourceBlockStyleByPreBlock(t,n)}),this._blankParaId?(i=s.createNewParagraph(null,this._blankParaId,new u({text:""})),s.setResourceBlockStyleByPreBlock(i,n),this.executeAtomicCommand(new h({note:this._note,newBlks:[i],preBlk:n}))):this.executeAtomicCommand(new h({note:this._note,newBlks:e,preBlk:n})),t.length>0&&this.executeAtomicCommand(new p({note:this._note,blocks:this._note.getInterBlocks(t[0],t[t.length-1],!0)})),s.setTextBlockAsEndingRange(this,i,i.getLength(),i.getLength())},fromCollabJSON:function(){var t=this._cmdArgs.collabProperties.cmdJSON;e.__super__.fromCollabJSON.apply(this),t&&(this._ownerId=t.listId,this._catalogueIds=t.blockIds,this._delete=t.simpleValue1,this._blankParaId=t.newBlkId)},toCollabJSON:function(){var t;return(t=e.__super__.toCollabJSON.apply(this))&&(t.listId=this._ownerId,t.blockIds=this._catalogueIds,t.simpleValue1=this._delete,t.newBlkId=this._blankParaId),t}}),r.add(e),e}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e,o=n(13),i=n(5),r=n(4);return e=o.extend({_cmdArgs:null,_oldData:null,_content:null,_align:null,_headerFooter:null,name:"comp.SetHeaderFooter",initialize:function(t){this._oldData={},this._cmdArgs=t.args,r.isCollabCommand(this._cmdArgs)||(this._content=this._cmdArgs.content,this._align=this._cmdArgs.align,this._headerFooter=this._cmdArgs.headerFooter),this.startingRange=t.args.range,this.endingRange=t.args.endingRange,e.__super__.initialize.apply(this)},apply:function(){var t=this._align,e=this._content,n=this._headerFooter;n&&(null!=t&&(this._oldData.align=n.getAlign()),null!=e&&(this._oldData.content=n.getContent(!1)),n.setContentAndStyle(e,t),this.effected=!0)},doReapply:function(){var t=this._align,e=this._content;this._headerFooter.setContentAndStyle(e,t)},doUnapply:function(){var t=this._headerFooter,e=this._oldData;e&&t.setContentAndStyle(e.content,e.align)},fromCollabJSON:function(){var t=this._cmdArgs.collabProperties,n=t.cmdJSON,o=t.coreEditor.note;e.__super__.fromCollabJSON.apply(this),n&&(this._content=n.headerFooterInfo.content,this._align=n.headerFooterInfo.align,this._headerFooter=o.getHeaderFooter(n.headerFooterInfo.isFooter))},toCollabJSON:function(){var t,n=e.__super__.toCollabJSON.apply(this);return n&&((t={}).content=this._content,t.align=this._align,t.isFooter=this._headerFooter.isFooter,n.headerFooterInfo=t),n}}),i.add(e),e}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e,o=n(0),i=n(13),r=n(5),a=n(659),s=n(300),l=n(21),c=n(4);return e=i.extend({name:"comp.SetBlockProps",_cmdArgs:null,_note:null,_blocks:null,_props:null,updateSelectionDisabled:!0,initialize:function(){this._note=this.options.note,this._cmdArgs=this.options.args,e.__super__.initialize.apply(this),c.isCollabCommand(this._cmdArgs)||(this._blocks=this._cmdArgs.blocks,this._props=this._cmdArgs.props)},apply:function(){var t=this._blocks[0],e=new s({block:t,start:t.getEndOffset(),end:t.getEndOffset()});return this.executeAtomicCommand(new a({blocks:this._blocks,props:this._props}),new l({startRange:e,endRange:e})),!0},fromCollabJSON:function(){var t=this,n=t._cmdArgs.collabProperties.cmdJSON;n&&(t._blocks=[],o.each(n.blockIds,function(e){t._blocks.push(t._note.getBlockById(e))}),t._props=n.simpleValue1),e.__super__.fromCollabJSON.apply(t)},toCollabJSON:function(){var t=e.__super__.toCollabJSON.apply(this),n=[];return o.each(this._blocks,function(t){n.push(t.getId())}),t.blockIds=n,t.simpleValue1=this._props,t}}),r.add(e),e}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e,o=n(22),i=n(5),r=n(0),a=n(4);function s(t){return t.charAt(0).toUpperCase()+t.slice(1)}function l(t){return"set"+s(t)}return e=o.extend({name:"atom.SetBlockProps",_blocks:null,_oldPropsMap:{},_props:null,initialize:function(t){var n=this.options.args;this._oldPropsMap={},a.isCollabCommand(n)||(this._blocks=t.blocks,this._props=t.props),e.__super__.initialize.apply(this,arguments)},apply:function(){var t,e=this;r.each(e._blocks,function(n){t={},r.each(e._props,function(e,o){t[o]=n[function(t){return"get"+s(t)}(o)](),n[l(o)](e)}),e._oldPropsMap[n.getId()]=t})},doUnapply:function(){var t,e=this;r.each(e._blocks,function(n){t=e._oldPropsMap[n.getId()],r.each(t,function(t,e){n[l(e)](t)})})},fromCollabJSON:function(){var t=this,n=t.options.args.collabProperties,o=n.cmdJSON;e.__super__.fromCollabJSON.apply(t),t._note=n.coreEditor.getNote(),o&&(t._blocks=[],r.each(o.blockIds,function(e){t._blocks.push(t._note.getBlockById(e))}),t._props=o.simpleValue1,t._oldPropsMap=o.simpleValue2)},toCollabJSON:function(){var t=e.__super__.toCollabJSON.apply(this),n=[];return r.each(this._blocks,function(t){n.push(t.getId())}),t.blockIds=n,t.simpleValue1=this._props,t.simpleValue2=this._oldPropsMap,t}}),i.add(e),e}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e,o=n(13),i=n(5),r=n(661),a=n(4);return e=o.extend({name:"comp.SetCodeLanguage",_codeBlock:null,_language:null,initialize:function(){var t=this.options.args;a.isCollabCommand(t)||(this._codeBlock=this.options.args.block,this._language=this.options.args.newLanguage),e.__super__.initialize.apply(this)},apply:function(){var t=this.options.args,e=this.startingRange.startRange.block;return a.isCollabCommand(t)&&e&&(this._codeBlock=e),this.executeAtomicCommand(new r({block:this._codeBlock,newLanguage:this._language})),!0},fromCollabJSON:function(){var t=this.options.args.collabProperties.cmdJSON;e.__super__.fromCollabJSON.apply(this),t&&(this._language=t.language)},toCollabJSON:function(){var t=e.__super__.toCollabJSON.apply(this);return t.language=this._language,t}}),i.add(e),e}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e,o=n(22),i=n(5),r=n(4);return e=o.extend({name:"atom.SetCodeLanguage",_codeBlock:null,_language:null,_preLanguage:null,initialize:function(){var t=this.options.args;r.isCollabCommand(t)||(this._codeBlock=this.options.block,this._language=this.options.newLanguage,this._preLanguage=this.options.block.getLanguage()),e.__super__.initialize.apply(this)},apply:function(){return!!this._language&&(this._codeBlock.setLanguage(this._language),!0)},doUnapply:function(){this._codeBlock&&this._preLanguage&&this._codeBlock.setLanguage(this._preLanguage)},fromCollabJSON:function(){var t=this.options.args.collabProperties.cmdJSON;e.__super__.fromCollabJSON.apply(this),t&&(this._language=t.language)},toCollabJSON:function(){var t=e.__super__.toCollabJSON.apply(this);return t.language=this._language,t}}),i.add(e),e}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e,o=n(13),i=n(5),r=n(663),a=n(4);return e=o.extend({name:"comp.SetCodeTheme",_codeBlock:null,_theme:null,initialize:function(){var t=this.options.args;a.isCollabCommand(t)||(this._codeBlock=this.options.args.block,this._theme=this.options.args.newTheme),e.__super__.initialize.apply(this)},apply:function(){var t=this.options.args,e=this.startingRange.startRange.block;return a.isCollabCommand(t)&&e&&(this._codeBlock=e),this.executeAtomicCommand(new r({block:this._codeBlock,newTheme:this._theme})),!0},fromCollabJSON:function(){var t=this.options.args.collabProperties.cmdJSON;e.__super__.fromCollabJSON.apply(this),t&&(this._theme=t.theme)},toCollabJSON:function(){var t=e.__super__.toCollabJSON.apply(this);return t.theme=this._theme,t}}),i.add(e),e}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e,o=n(22),i=n(5),r=n(4);return e=o.extend({name:"atom.SetCodeTheme",_codeBlock:null,_theme:null,_preTheme:null,initialize:function(){var t=this.options.args;r.isCollabCommand(t)||(this._codeBlock=this.options.block,this._theme=this.options.newTheme,this._preTheme=this.options.block.getTheme()),e.__super__.initialize.apply(this)},apply:function(){return!!this._theme&&(this._codeBlock.setTheme(this._theme),!0)},doUnapply:function(){this._codeBlock&&this._preTheme&&this._codeBlock.setTheme(this._preTheme)},fromCollabJSON:function(){var t=this.options.args.collabProperties.cmdJSON;e.__super__.fromCollabJSON.apply(this),t&&(this._theme=t.theme)},toCollabJSON:function(){var t=e.__super__.toCollabJSON.apply(this);return t.theme=this._theme,t}}),i.add(e),e}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e,o=n(13),i=n(5),r=n(665),a=n(4);return e=o.extend({name:"comp.SetTableCellsSize",_table:null,_sizes:null,initialize:function(){var t=this.options.args;a.isCollabCommand(t)||(this._table=t.table,this._sizes=t.sizes),e.__super__.initialize.apply(this)},apply:function(){var t=this,e=t._table,n=t._sizes;return!(n.length<1)&&(n.forEach(function(n){t.executeAtomicCommand(new r({table:e,size:n}))}),!0)},fromCollabJSON:function(){var t,n=this.options.args.collabProperties,o=n.cmdJSON;e.__super__.fromCollabJSON.apply(this),t=n.coreEditor.getNote(),o&&(this._table=t.getBlockById(o.blockId),this._sizes=o.simpleValue1)},toCollabJSON:function(){var t=e.__super__.toCollabJSON.apply(this);return t.blockId=this._table.getId(),t.simpleValue1=this._sizes,t}}),i.add(e),e}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e,o=n(22),i=n(5),r=n(4);return e=o.extend({name:"atom.SetTableCellSize",_table:null,_size:null,_oldSize:null,effected:!1,initialize:function(){var t=this.options.args;this._oldSize={},e.__super__.initialize.apply(this),r.isCollabCommand(t)||(this._table=this.options.table,this._size=this.options.size)},apply:function(){var t=this._table,e=this._size;return null!=e.row&&(this._oldSize.row=e.row,this._oldSize.height=t.getRowHeight(e.row),t.setRowHeight(e.row,e.height),this.effected=!0),null!=e.col&&(this._oldSize.col=e.col,this._oldSize.width=t.getColumnWidth(e.col),t.setColumnWidth(e.col,e.width),this.effected=!0),this.effected},doUnapply:function(){var t=this._table,e=this._oldSize;null!=e.row&&t.setRowHeight(e.row,e.height),null!=e.col&&t.setColumnWidth(e.col,e.width)},fromCollabJSON:function(){var t,n=this.options.args.collabProperties,o=n.cmdJSON;e.__super__.fromCollabJSON.apply(this),t=n.coreEditor.getNote(),o&&(this._table=t.getBlockById(o.blockId),this._size=o.simpleValue1,this._oldSize=o.simpleValue2)},toCollabJSON:function(){var t=e.__super__.toCollabJSON.apply(this);return t.blockId=this._table.getId(),t.simpleValue1=this._size,t.simpleValue2=this._oldSize,t}}),i.add(e),e}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e,o=n(13),i=n(5),r=n(16),a=n(74),s=n(133),l=n(301),c=n(4);return e=o.extend({name:"comp.InsertTableRowCol",_table:null,_rect:null,_cellsData:null,effected:!1,initialize:function(){var t,n=this.options.args;this._rect={},e.__super__.initialize.apply(this),c.isCollabCommand(n)||(this._cellsData=n.cellsData,this._sizes=n.sizes,(t=n.range)?this._transformRangeToData(t,n):(this._rect=n.rect,this._table=n.table))},_transformRangeToData:function(t,e){var n,o=t.getStartBlockRange(),i=o.getAsRectRange(),r=e.describe;i&&(n=i.getRect(),this._cellsData||(this._cellsData=this._calculateInsertData(r,n)),null!=r.row&&(this._rect.row=r.row===a.UP?n.top:n.top+n.height),null!=r.col&&(this._rect.col=r.col===a.LEFT?n.left:this._rect.col=n.left+n.width),this._table=o.block)},apply:function(){var t=this,e=t._rect,n=t._cellsData,o=t._sizes;null!=e.row&&(n.forEach(function(n){t._insertRows(e.row,[n],o)}),this.effected=!0),null!=e.col&&(n.forEach(function(n){t._insertCols(e.col,[n],o)}),this.effected=!0)},_insertRows:function(t,e,n){var o=this,i=o._table;e.forEach(function(n,a){0===n.length&&(n=i.creatRowData(t+a)),e[a]=n,r.fixMergeCellBeforeRowColChange({index:t+a,table:i,cmd:o,insertData:n})}),o.executeAtomicCommand(new l({cellsData:e,sizes:n,rect:this._rect,table:i}))},_insertCols:function(t,e,n){var o,i=this,a=i._table,s=a.getCells().length,c=[];e.forEach(function(e,n){for(c.push([]),o=0;o<s;o++)c[n].push(e[o]||a.createCell());r.fixMergeCellBeforeRowColChange({index:t+n,table:a,cmd:i,isCol:!0,insertData:c[n]})}),i.executeAtomicCommand(new l({cellsData:c,sizes:n,rect:this._rect,table:a}))},_calculateInsertData:function(t,e){return t.hasOwnProperty("col")?new Array(e.width).fill([]):t.hasOwnProperty("row")?new Array(e.height).fill([]):void 0},fromCollabJSON:function(){var t,n=this.options.args.collabProperties,o=n.cmdJSON;e.__super__.fromCollabJSON.apply(this),t=n.coreEditor.getNote(),o&&(this._table=t.getBlockById(o.blockId),this._rect=o.simpleValue1,this._sizes=o.simpleValue2,this._cellsData=s.cellsFromCollabJSON(o.dataBefore))},toCollabJSON:function(){var t=e.__super__.toCollabJSON.apply(this);return t.blockId=this._table.getId(),t.simpleValue1=this._rect,t.simpleValue2=this._sizes,t.dataBefore=s.cellsToCollabJSON(this._cellsData),t}}),i.add(e),e}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e,o=n(13),i=n(5),r=n(34),a=n(668),s=n(16),l=n(21),c=n(73),u=n(4);return e=o.extend({name:"comp.DeleteTableRowCol",_table:null,_rect:null,_oldData:null,_count:null,_range:null,effected:!1,initialize:function(){var t,n=this.options.args;this._rect={},e.__super__.initialize.apply(this),u.isCollabCommand(n)||((t=n.range)?this._transformRangeToData(t,n):(this._rect=n.rect,this._count=n.count,this._table=n.table))},_transformRangeToData:function(t,e){var n,o,i=t.getStartBlockRange(),r=e.describe;(n=i.getAsRectRange())&&(o=n.getRect(),r.row&&(this._rect.row=o.top,this._count=o.height),r.col&&(this._rect.col=o.left,this._count=o.width),this._rectOfRectRange=o,this._table=i.block)},apply:function(){var t,e,n,o,i,r,u=this._count,d=this._rect,p=this._table;if(null!=d.row){if(t=p.getRowCount(),0===d.row&&t===u)return this._deleteTable();for(n=0;n<u;n++)s.fixMergeCellBeforeRowColChange({index:d.row,table:p,cmd:this,isDelete:!0}),this.executeAtomicCommand(new a({count:1,rect:d,table:p}));this.effected=!0}if(null!=d.col){if(e=p.getColumnCount(),0===d.col&&e===u)return this._deleteTable();for(n=0;n<u;n++)s.fixMergeCellBeforeRowColChange({index:d.col,table:p,cmd:this,isDelete:!0,isCol:!0}),this.executeAtomicCommand(new a({count:1,rect:d,table:p}));this.effected=!0}this._rectOfRectRange&&((o=c.create({block:p,type:c.TYPES.NORMAL,rect:this._rectOfRectRange}))&&(i=o.getAsRectRange()),i||(o=c.create({block:p,type:c.TYPES.FIRST_CELL})),r=l.create({startRange:o,endRange:o}),this.setEndingRange(r))},_deleteTable:function(){this._applyCommandToComposite(new r({blocks:[this._table],note:this.options.note})),this.setEndingRange(l.createMock()),this.effected=!0},fromCollabJSON:function(){var t,n=this.options.args.collabProperties,o=n.cmdJSON;e.__super__.fromCollabJSON.apply(this),t=n.coreEditor.getNote(),o&&(this._table=t.getBlockById(o.blockId),this._rect=o.simpleValue1,this._count=o.simpleValue2)},toCollabJSON:function(){var t=e.__super__.toCollabJSON.apply(this);return t.blockId=this._table.getId(),t.simpleValue1=this._rect,t.simpleValue2=this._count,t}}),i.add(e),e}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e,o=n(22),i=n(5),r=n(133),a=n(4);return e=o.extend({name:"atom.DeleteTableRowCol",_table:null,_rect:null,_oldCellsData:null,_count:null,effected:!1,initialize:function(){var t=this.options,n=t.args;a.isCollabCommand(n)||(this._count=t.count,this._rect=t.rect,this._table=t.table),e.__super__.initialize.apply(this)},apply:function(){var t=this._rect,e=this._table,n=this._count;null!=t.row&&(this._oldCellsData=e.deleteRows(t.row,n),this.effected=!0),null!=t.col&&(this._oldCellsData=e.deleteCols(t.col,n),this.effected=!0)},doUnapply:function(){var t=this._rect,e=this._table,n=this._oldCellsData;null!=t.row&&e.insertRows(t.row,n.rowsData,n.heights),null!=t.col&&e.insertCols(t.col,n.colsData,n.widths)},fromCollabJSON:function(){var t,n,o=this.options.args.collabProperties,i=o.cmdJSON;e.__super__.fromCollabJSON.apply(this),n=o.coreEditor.getNote(),i&&(this._table=n.getBlockById(i.blockId),this._rect=i.simpleValue1,this._count=i.simpleValue2,(t=i.dataBefore)&&(this._oldCellsData=t,t.rowsData&&(this._oldCellsData.rowsData=r.cellsFromCollabJSON(t.rowsData)),t.colsData&&(this._oldCellsData.colsData=r.cellsFromCollabJSON(t.colsData))))},toCollabJSON:function(){var t,n=e.__super__.toCollabJSON.apply(this);return n.blockId=this._table.getId(),n.simpleValue1=this._rect,n.simpleValue2=this._count,(t=this._oldCellsData)&&(n.dataBefore=t,t.rowsData&&(n.dataBefore.rowsData=r.cellsToCollabJSON(t.rowsData)),t.colsData&&(n.dataBefore.colsData=r.cellsToCollabJSON(t.colsData))),n}}),i.add(e),e}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e,o=n(13),i=n(5),r=n(228),a=n(171),s=n(670),l=n(4);return e=o.extend({name:"comp.ToggleMergeTableCell",_table:null,_rect:null,_oldData:null,_range:null,effected:!1,initialize:function(){var t,n=this.options.args;l.isCollabCommand(n)||((t=n.range)?this._transformRangeToData(t,n):(this._rect=n.rect,this._table=n.table)),e.__super__.initialize.apply(this)},_transformRangeToData:function(t){var e,n,o=t.getStartBlockRange();(e=o.getAsRectRange())&&(n=e.getRect(),this._range=t,this._rect=n,this._table=o.block)},apply:function(){var t,e,n,o=this._rect,i=this._table,l=!1,c=!1,u=null;if(o&&(1!==o.width||1!==o.height)){for(i.isMergeRect(o)&&(l=!0),e=o.top;e<o.top+o.height;e++)for(n=o.left;n<o.left+o.width;n++)t=i.getCell(e,n),e===o.top&&n===o.left?(t.isEmpty()||(c=!0),this.executeAtomicCommand(new r({table:i,type:r.TYPES.POINT,value:l?null:{width:o.width,height:o.height},rect:{row:e,col:n}}))):(c||u||t.isEmpty()||(u=t.getContent()),l||(this._applyCommandToComposite(new s({args:{table:i,content:"",range:this._range,cellRect:{row:e,col:n}}})),this.executeAtomicCommand(new a({table:i,styles:null,rect:{width:1,height:1,top:e,left:n}}))),this.executeAtomicCommand(new r({table:i,type:r.TYPES.CELL,value:l?null:{dy:e-o.top,dx:n-o.left},rect:{row:e,col:n}})));u&&this._applyCommandToComposite(new s({args:{table:i,content:u,cellRect:{row:o.top,col:o.left}}})),this.effected=!0}},fromCollabJSON:function(){var t,n=this.options.args.collabProperties,o=n.cmdJSON;e.__super__.fromCollabJSON.apply(this),t=n.coreEditor.getNote(),o&&(this._table=t.getBlockById(o.blockId),this._rect=o.simpleValue1)},toCollabJSON:function(){var t=e.__super__.toCollabJSON.apply(this);return t.blockId=this._table.getId(),t.simpleValue1=this._rect,t}}),i.add(e),e}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e,o=n(13),i=n(5),r=n(120),a=n(4),s=n(161);return e=o.extend({name:"comp.SetTableCellContent",_table:null,_cellRect:null,_oldContent:null,initialize:function(){var t=this.options.args;a.isCollabCommand(t)||(this._table=t.table,this._cellRect=t.cellRect,this._content=t.content),e.__super__.initialize.apply(this)},apply:function(){this.executeAtomicCommand(new r({table:this._table,cellRect:this._cellRect,content:this._content}))},fromCollabJSON:function(){var t,n=this.options.args.collabProperties,o=n.cmdJSON;e.__super__.fromCollabJSON.apply(this),t=n.coreEditor.getNote(),o&&(this._table=t.getBlockById(o.blockId),this._content=s.contentFromCollabJSON(o.simpleValue1),this._oldContent=s.contentFromCollabJSON(o.simpleValue2),this._cellRect=o.newBlkId)},toCollabJSON:function(){var t=e.__super__.toCollabJSON.apply(this);return t.blockId=this._table.getId(),t.simpleValue1=s.contentToCollabJSON(this._content),t.simpleValue2=s.contentToCollabJSON(this._oldContent),t.newBlkId=this._cellRect,t}}),i.add(e),e}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e,o=n(13),i=n(5),r=n(171),a=n(4);return e=o.extend({name:"comp.SetTableCellBlockStyle",_table:null,_styles:null,_rect:null,_toggle:null,_default:null,effected:!1,initialize:function(){var t,n=this.options.args;e.__super__.initialize.apply(this),a.isCollabCommand(n)||(t=n.range,this._styles=n.styles,this._toggle=n.toggle,this._default=n.default,this._transformRangeToData(t,n))},_transformRangeToData:function(t){var e,n,o=t.getStartBlockRange();(e=o.getAsRectRange())&&(n=e.getRect(),this._rect=n,this._table=o.block)},apply:function(){if(!this._rect)return this.effected;this.executeAtomicCommand(new r({table:this._table,rect:this._rect,styles:this._styles,toggle:this._toggle,default:this._default})),this.effected=!0},fromCollabJSON:function(){var t,n=this.options.args.collabProperties,o=n.cmdJSON;e.__super__.fromCollabJSON.apply(this),t=n.coreEditor.getNote(),o&&(this._table=t.getBlockById(o.blockId),this._rect=o.simpleValue1,this._styles=o.simpleValue2||null,this._toggle=o.newBlkId||null)},toCollabJSON:function(){var t=e.__super__.toCollabJSON.apply(this);return t.blockId=this._table.getId(),t.simpleValue1=this._rect,t.simpleValue2=this._styles||null,t.newBlkId=this._toggle||null,t}}),i.add(e),e}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e,o=n(13),i=n(5),r=n(301),a=n(120),s=n(228),l=n(171),c=n(133),u=n(4);return e=o.extend({name:"comp.InsertTableCells",_table:null,_widths:null,_heights:null,_cellsData:null,_rect:null,effected:!1,initialize:function(){var t=this.options.args;e.__super__.initialize.apply(this),u.isCollabCommand(t)||(this._table=t.table,this._widths=t.widths,this._heights=t.heights,this._cellsData=t.cellsData,this._transformRangeToData(t.range))},_transformRangeToData:function(t){var e,n=t.getStartBlockRange();n.getAsRectRange&&(e=n.getAsRectRange(),this._rect=e.getRect())},apply:function(){var t,e,n,o,i,r,s,c=this._table,u=this._rect,d=this._cellsData;if(!d)return this._clearCellsData();if(!d[0]||d[0].length<1)return!1;for(t=d.length,e=d[0].length,this._handleExtendCol(),this._handleExtendRow(),o=0;o<t;o++)for(r=o+u.top,i=0;i<e;i++)s=i+u.left,n=d[o][i],(t>1||e>1)&&(this._handleOldMergePoint(c.getCell(r,s),r,s),this._handleMergePointCell(n,o,i)),n.isMergedCell()||(this.executeAtomicCommand(new a({content:n.getContent(),table:c,cellRect:{row:o+u.top,col:i+u.left}})),this.executeAtomicCommand(new l({rect:{top:u.top+o,left:u.left+i,width:1,height:1},styles:n.getBlockStyles(),table:c})),this.effected=!0)},_handleExtendCol:function(){var t,e,n,o=this._table,i=this._rect,a=this._widths,s=this._cellsData,l=s[0].length,c=o.getColumnCount(),u=o.getRowCount(),d=[];if((t=i.left+l-c)>0){for(s.forEach(function(e,n){e.slice(-t).forEach(function(t,e){d[e]=d[e]||[],d[e][i.top+n]=t})}),e=0;e<u;e++)for(n=0;n<d.length;n++)d[n][e]=d[n][e]||o.createCell({row:e,col:i.left+n});this.executeAtomicCommand(new r({rect:{col:c},table:o,cellsData:d,sizes:a?a.slice(-t):null})),this.effected=!0}},_handleExtendRow:function(){var t,e,n,o=this._table,i=this._rect,a=this._heights,s=this._cellsData,l=s.length,c=o.getColumnCount(),u=o.getRowCount(),d=[];if((t=i.top+l-u)>0){for(s.slice(-t).forEach(function(t,e){d[e]=d[e]||[],t.forEach(function(t,n){d[e][i.left+n]=t})}),e=0;e<d.length;e++)for(n=0;n<c;n++)d[e][n]=d[e][n]||o.createCell({row:i.top+i.height,col:n});this.executeAtomicCommand(new r({rect:{row:u},table:o,cellsData:d,sizes:a?a.slice(-t):null})),this.effected=!0}},_handleMergePointCell:function(t,e,n){var o=this._table,i=this._rect;t.isMergePoint()?(t.getMergePointAttr(),this.executeAtomicCommand(new s({rect:{row:i.top+e,col:i.left+n},value:t.getMergePointAttr(),type:s.TYPES.POINT,table:o}))):t.isMergedCell()&&this.executeAtomicCommand(new s({rect:{row:i.top+e,col:i.left+n},value:t.getMergedCellAttr(),type:s.TYPES.CELL,table:o}))},_handleOldMergePoint:function(t,e,n){var o,i,r=this._table,a=this._rect,s=this._cellsData,l=s.length,c=s[0].length;if(t&&(t.isMergePoint()&&(o=t.getMergePointAttr(),this._clearCellsAttr(e,n,o.width,o.height)),t.isMergedCell())){if(!(i=r.getCell(e,n,{findMergePointIfNeeded:!0,withPosition:!0}))||a.top+l>=i.row&&a.top<=i.row&&a.left+c>i.col&&a.left<=i.col)return;o=i.cell.getMergePointAttr(),this._clearCellsAttr(i.row,i.col,o.width,o.height)}},_clearCellsAttr:function(t,e,n,o){var i,r,a=this._table;for(i=0;i<o;i++)for(r=0;r<n;r++)this.executeAtomicCommand(new s({table:a,rect:{row:t+i,col:e+r}}))},_clearCellsData:function(){var t,e,n=this._rect,o=this._table;for(t=0;t<n.height;t++)for(e=0;e<n.width;e++)this.executeAtomicCommand(new a({content:"",table:o,cellRect:{row:t+n.top,col:e+n.left}}));this.executeAtomicCommand(new l({rect:n,table:o}))},fromCollabJSON:function(){var t,n=this.options.args.collabProperties,o=n.cmdJSON;e.__super__.fromCollabJSON.apply(this),t=n.coreEditor.getNote(),o&&(this._table=t.getBlockById(o.blockId),this._rect=o.simpleValue1,this._widths=o.simpleValue2.widths,this._heights=o.simpleValue2.heights,this._cellsData=c.cellsFromCollabJSON(o.dataBefore))},toCollabJSON:function(){var t=e.__super__.toCollabJSON.apply(this);return t.blockId=this._table.getId(),t.simpleValue1=this._rect,t.simpleValue2={widths:this._widths,height:this._heights},t.dataBefore=c.cellsToCollabJSON(this._cellsData),t}}),i.add(e),e}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e,o=n(13),i=n(5),r=n(298),a=n(4);return e=o.extend({name:"comp.SetTableCellInlineStyle",_table:null,_styles:null,_rect:null,_toggle:null,initialize:function(){var t,n=this.options.args;e.__super__.initialize.apply(this),a.isCollabCommand(n)||(t=n.range,this._styles=n.styles,this._toggle=n.toggle,this._transformRangeToData(t,n))},_transformRangeToData:function(t){var e,n,o=t.getStartBlockRange();(e=o.getAsRectRange())&&(n=e.getRect(),this._rect=n,this._table=o.block)},apply:function(){this._rect&&this.executeAtomicCommand(new r({table:this._table,rect:this._rect,styles:this._styles,toggle:this._toggle}))},fromCollabJSON:function(){var t,n=this.options.args.collabProperties,o=n.cmdJSON;e.__super__.fromCollabJSON.apply(this),t=n.coreEditor.getNote(),o&&(this._table=t.getBlockById(o.blockId),this._rect=o.simpleValue1,this._styles=o.simpleValue2||null,this._toggle=o.newBlkId||null)},toCollabJSON:function(){var t=e.__super__.toCollabJSON.apply(this);return t.blockId=this._table.getId(),t.simpleValue1=this._rect,t.simpleValue2=this._styles||null,t.newBlkId=this._toggle||null,t}}),i.add(e),e}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e,o=n(26),i=n(0),r=n(2),a=n(29),s=n(7),l=n(296),c=function(t){return t&&t.name===l.prototype.name},u=n(101),d=n(21);return e={_editor:null,_undoStack:null,_redoStack:null,_notOwnManagerAdapterStack:null,initialize:function(t){this._undoStack=[],this._redoStack=[],this._notOwnManagerAdapterStack=[],this._editor=t.editor},exec:function(t,e,n){var o,i,a,s,l=!1,u=!0,p=!1;return t?this._editor.isCollabEnabled()&&(l=n.collabProperties.isCollabCmd&&n.collabProperties.isOwnCmd,u=!n.collabProperties.isCollabCmd,l&&(c(t)?this._localManagerAdapterOverriden(t)?t.setIgnoreUndoRedo(!0):p=!0:n.collabProperties.cmdJSON.isLocalExecutedCmd&&(p=!0)),p)?(r.log("Skip local-executed collab command and update noteVersion",t),this._updateUndoCmdFinalVersion(t.cmdId,n.collabProperties.finalNoteVersion),this.trigger("command-exec",t,n),!0):(s=t.apply(),i={cmdName:t.name,cmdType:"do"},o=t.getEndingRange(),!1!==s&&!d.isNoteRange(o)&&t.getStartingRange()&&(r.warn("endingRange should be a noteRange, so set it to be same as startEndingRange:",o),o=t.getStartingRange(),t.setEndingRange(o)),a=u||l,o&&a&&!t.updateSelectionDisabled&&this.trigger("update-selection",o,i,n),a&&!t.effected?(this.trigger("command-exec",t,n),s):(c(t)&&(t.sendInfoToInner({canUndo:this.canUndo(),canRedo:this.canRedo()}),a||this._notOwnManagerAdapterStack.push(t)),this._editor.isCollabEnabled()?n.collabProperties.dataCmdError?(this.trigger("command-exec",t,n),!1):(a&&(t.getIgnoreUndoRedo()||this._pushToUndoStack(t),this._redoStack=[]),this.trigger("command-exec",t,n),!0):(t.getIgnoreUndoRedo()||this._undoStack.push(t),this._redoStack=[],this.trigger("command-exec",t,n),!0))):(r.log("Skip empty local command"),!1)},canUndo:function(){return 0!==this._undoStack.length},undo:function(){if(!this.canUndo())return r.warn("Can Not undo"),!1;var t,e=this._undoStack,n=this._redoStack,o=e.pop();return o.doUnapply(),n.push(o),this.trigger("command-exec",o),t={cmdName:o.name,cmdType:"undo"},this.trigger("update-selection",o.getStartingRange(),t),!0},canRedo:function(){return 0!==this._redoStack.length},redo:function(){if(!this.canRedo())return!1;var t,e=this._undoStack,n=this._redoStack.pop();return n.doReapply(),e.push(n),this.trigger("command-exec",n),t={cmdName:n.name,cmdType:"redo"},this.trigger("update-selection",n.getEndingRange(),t),!0},reset:function(){this._undoStack=[],this._redoStack=[],this._notOwnManagerAdapterStack=[]},registerManager:function(t,e){var n,o=this;t&&t.on?(o.unregisterManager(t),t.on("command-executed",function(i,a){var s=l.create(e,i,a);s?(s.isOriginalCmd=!0,s.isLocalExecutedCmd=!0,s.setCmdOriginalNoteVersion(o._editor.getNoteVersion()),o._pushToUndoStack(s),o._redoStack=[],o.trigger("command-exec",s),t.triggerGlobalUndoStatus(o.canUndo(),o.canRedo()),o._editor.isCollabEnabled()&&(n=window.JSON.parse(a))&&0!==n.colWidths.length&&0!==n.rowHeights.length&&o._editor.pushLocalDataCommand(s,!0)):r.warn("ManagerAdapter failed to create command!")})):r.warn("commandManager is not Valid!")},unregisterManager:function(t){t&&t.on&&t.off("command-executed")},applyCollabCmdRedoUndo:function(t){var e,n=t.options.args,o=n.collabProperties.cmdJSON,i=n.collabProperties.isOwnCmd;if(i&&n.collabProperties.isLocalExecutedCmd)return r.log("skip local-executed-own redo/undo",t),void this.trigger("command-exec",t,n);n.collabProperties.isCollabUndo?(t.setCollabUndo(!0),t.setCollabRedo(!1),e=t.doUnapply(n)):n.collabProperties.isCollabRedo&&(t.setCollabUndo(!1),t.setCollabRedo(!0),e=t.doReapply(n)),!1!==e?(n.collabProperties.isCollabUndo&&t.setStartingRange(u.buildNoteRangeFromJSON(o.startNoteRange,this._editor)),n.collabProperties.isCollabRedo&&t.setEndingRange(u.buildNoteRangeFromJSON(o.endNoteRange,this._editor)),i&&(n.collabProperties.isCollabUndo?(this._pushToRedoStack(this._undoStack.pop()),this.trigger("update-selection",t.getStartingRange())):n.collabProperties.isCollabRedo&&(this._pushToUndoStack(this._redoStack.pop()),this.trigger("update-selection",t.getEndingRange())))):i&&(n.collabProperties.isCollabUndo?this.dropUndoCmds():n.collabProperties.isCollabRedo&&this.dropRedoCmd(),this._editor.notifyErrorToHost(s.INVALIDACTION_FAILED_COLLABCMD,n.collabProperties.coreEditor)),i&&c(t)&&t.sendInfoToInner({canUndo:this.canUndo(),canRedo:this.canRedo()}),this.trigger("command-exec",t,n)},dropRedoCmd:function(){r.log("Drop Redo Command"),this._redoStack.pop(),this.trigger("redo-stack-change")},dropUndoCmds:function(t,e,n){var o;r.log("Drop Undo Command:",t,e,n),t?(o=this._getUndoCmdIndexById(t))>=0&&(n?this._undoStack.splice(o,e,n):this._undoStack.splice(o,e)):this._undoStack.pop(),this.trigger("undo-stack-change")},getRedoCmd:function(){return i.last(this._redoStack)},getUndoCmd:function(){return i.last(this._undoStack)},_getUndoCmdIndexById:function(t){var e=-1,n=0;return i.some(this._undoStack,function(o){return o.getCmdId()===t&&(e=n),e>=0||(n++,!1)}),e},_pushToRedoStack:function(t){t?this._redoStack.push(t):r.log("null command should NOT be pushed to Redo Stack")},_pushToUndoStack:function(t){t?t.getIgnoreUndoRedo()?r.log("this command no need undo redo."):(this._undoStack.push(t),this._undoStack.length>s.MAX_UNDO_STACK_SIZE&&this._undoStack.shift()):r.log("null command should NOT be pushed to Undo Stack")},_localManagerAdapterOverriden:function(t){var e,n=!1,o=0;for(this._notOwnManagerAdapterStack&&(o=this._notOwnManagerAdapterStack.length);o>0&&(e=this._notOwnManagerAdapterStack[o-1]).getCmdOriginalNoteVersion()===t.getCmdOriginalNoteVersion();o--)if(t.getBlockId()===e.getBlockId()){n=!0;break}return n},_updateUndoCmdFinalVersion:function(t,e){i.some(this._undoStack,function(n){if(n.cmdId===t)return n.setCmdFinalNoteVersion(e),!0})}},i.extend(e,a.Events),o.extend(e)}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";var a,s=this&&this.__extends||(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});o=[n,r,n(21),n(50),n(27),n(2),n(55),n(303)],void 0===(i=function(t,e,n,o,i,r,a,l){return function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.prototype.collapseToStart=function(){this.noteRange&&this.noteRange.collapse&&(this.noteRange.collapse(!0),this._drawRange(),this._triggerSelectionChange())},e.prototype.collapseToEnd=function(){this.noteRange&&this.noteRange.collapse&&(this.noteRange.collapse(!1),this._drawRange(),this._triggerSelectionChange())},e.prototype.getNativeRange=function(){return a.getRange(window)},e.prototype.getRange=function(){return this.noteRange},e.prototype.isCollapsed=function(){var t=this.noteRange;return!!t&&t.isCollapsed()},e.prototype.reset=function(){this.noteRange=null},e.prototype.setRange=function(t,e,n,o){this._setRange(t,{scrollIntoView:o,selectionChangeEvent:e,toDraw:!0,trigger:!0,inlineStyles:n})},e.prototype.initialize=function(t){this.noteView=t.noteView,this._bindEvents()},e.prototype._bindEvents=function(){o.addListeners({selectionchange:"_onDocSelectionChange","set-range":"_onSetRange"},this.noteView,this)},e.prototype._convertToNoteRange=function(t){return n.fromNativeRange(t,this.noteView)},e.prototype._drawRange=function(t){t=!1!==t,this.noteView.trigger("draw-range",this.noteRange,t)},e.prototype._onDocSelectionChange=function(t){var e=a.getRange(),n=this._convertToNoteRange(e);this.noteRange=n,!n||n.canDrawedByNative()?(this.trigger("doc-change-selection",n),this._triggerSelectionChange()):this.setRange(n)},e.prototype._onSetRange=function(t,e,n,o){this._setRange(t,{selectionChangeEvent:o,toDraw:e,trigger:n})},e.prototype._setRange=function(t,e){var n=this._convertToNoteRange(t);n&&n.getStartBlockRange()&&n.getEndBlockRange()?(e=e||{},this.noteRange=n,e.toDraw&&this._drawRange(e.scrollIntoView),e.trigger&&this._triggerSelectionChange(e.selectionChangeEvent,e.inlineStyles)):r.warn("Failed convert native range to note range!")},e.prototype._triggerSelectionChange=function(t,e){t||(t=l.createUserTypeEvent()),this.trigger("selection-change",t,e)},e}(i)}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(){return{encode:function(t){return window.btoa(window.unescape(encodeURIComponent(t)))},decode:function(t){return decodeURIComponent(window.escape(window.atob(t)))}}}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";o=[n,r,n(678),n(679),n(680),n(681),n(682),n(683),n(684),n(685),n(686),n(687),n(688),n(689),n(690),n(691),n(692),n(693),n(694),n(695),n(696),n(697),n(698),n(699),n(700),n(701),n(702),n(703),n(704),n(705),n(706),n(707),n(708),n(709),n(710)],void 0===(i=function(t,e){Object.defineProperty(e,"__esModule",{value:!0})}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";o=[n,r,n(6)],void 0===(i=function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),n.register({name:"backspace",key:"backspace",action:function(t){t.execDeleteBackward()}})}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";o=[n,r,n(6)],void 0===(i=function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),n.register({name:"del",key:"del",action:function(t){t.execDeleteForward()}})}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";o=[n,r,n(6),n(21),n(44),n(3)],void 0===(i=function(t,e,n,o,i,r){var a=this;Object.defineProperty(e,"__esModule",{value:!0});var s=function(t,e,n){var s=t.noteView;s&&(s.directionKeyJustMoved=!0),t.moveCaretWithDirection(!0,e);var l=t.getNoteRange().getEndBlockRange(),c=l.block,u=t.note.getLastBlock(),d=t.note.getNextBlock(c);if(!c.isEmpty()||r.isHr(d))switch(n){case"right":c.getLength()===l.end&&u===c&&t.execCommand("comp.AppendBlank",{inlineStyles:a.editingInlineStates});break;case"down":u===c&&t.execCommand("comp.AppendBlank",{inlineStyles:a.editingInlineStates})}else if(u!==c&&d){var p=i.createRangeByBlock({allContent:!1,block:d,collapseToStart:!1});t.noteSelection.setRange(new o({startRange:p,endRange:p})),e.preventDefault()}};n.register({name:"down",key:"down",preventDefault:!1,action:s}),n.register({name:"right",key:"right",preventDefault:!1,action:s})}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";o=[n,r,n(3),n(6)],void 0===(i=function(t,e,n,o){Object.defineProperty(e,"__esModule",{value:!0});var i=function(t){var e,o;o=(e=t.getNoteRange()).getEndBlockRange(),e.isInSingleBlock()&&n.isHeading(o.block)&&o.isCollapsed()&&o.start===o.block.getLength()&&t.resetEditingInlineStates(),t.execCommand("comp.KeyEnter",{inlineStyles:t.getEditingInlineState()})};o.register({name:"enter",key:"enter",action:i}),o.register({name:"alt+enter",key:"alt+enter",action:i}),o.register({name:"shift+enter",key:"shift+enter",action:i})}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";o=[n,r,n(6)],void 0===(i=function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),n.register({name:"esc",key:"esc",preventDefault:!1,action:function(t){t.trigger("esc")}})}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";o=[n,r,n(3),n(2),n(6)],void 0===(i=function(t,e,n,o,i){Object.defineProperty(e,"__esModule",{value:!0}),i.register({name:"space",key:"space",action:function(t){var e,i=t.getNoteRange();i&&(e=i.getStartBlockRange().block,i.isInSingleBlock()&&e&&n.isTable(e))?o.error("should NOT trigger insertText when select only Table."):t.insertText(" ",!1)}})}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";o=[n,r,n(6)],void 0===(i=function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),n.register({name:"tab",key:"tab",action:function(t){var e=t.getEditingInlineState();t.execCommand("comp.KeyTab",{inlineStyles:e})}})}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";o=[n,r,n(6)],void 0===(i=function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var o=function(t,e){var n=t.noteView;n&&(n.directionKeyJustMoved=!0),t.moveCaretWithDirection(!1,e)};n.register({name:"up",key:"up",preventDefault:!1,action:o}),n.register({name:"left",key:"left",preventDefault:!1,action:o})}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";o=[n,r,n(6),n(0),n(2)],void 0===(i=function(t,e,n,o,i){Object.defineProperty(e,"__esModule",{value:!0});o.each(["ctrl+backspace","ctrl+del","shift+backspace","shift+del","alt+backspace","alt+del","mod+backspace","mod+del"],function(t){n.register({name:t,key:t,preventDefault:!0,action:function(){i.log("shortcut prevented:",t)}})})}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";o=[n,r,n(6)],void 0===(i=function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),n.register({name:"bold",key:"mod+b",action:function(t){t.toggleInlineStyle("bold")}})}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";o=[n,r,n(79),n(6)],void 0===(i=function(t,e,n,o){Object.defineProperty(e,"__esModule",{value:!0});var i=function(t){return n.pad(t,2,"0","left")};o.register({name:"insertDate",key:"alt+shift+d",action:function(t){var e=new Date,n=e.getFullYear()+"/"+i(e.getMonth()+1)+"/"+i(e.getDate())+" "+i(e.getHours())+":"+i(e.getMinutes());t.insertText(" "+n+" ",!1)}})}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";o=[n,r,n(6)],void 0===(i=function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),n.register({name:"italic",key:"mod+i",action:function(t){t.toggleInlineStyle("italic")}})}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";o=[n,r,n(6)],void 0===(i=function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0});var o=function(t){t.redo()};n.register({name:"redo",key:"mod+y",action:o}),n.register({name:"redo_2",key:"mod+shift+z",action:o})}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";o=[n,r,n(2),n(6)],void 0===(i=function(t,e,n,o){Object.defineProperty(e,"__esModule",{value:!0}),o.register({name:"reloadPage",key:"mod+shift+r",preventDefault:!1,action:function(){if(n.DEBUG){window.clearJstCache&&(window.clearJstCache(),window.alert("Clear JST cache... Done!"));var t=window.location.href;window.location.href=t}}})}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";o=[n,r,n(6)],void 0===(i=function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),n.register({name:"save",key:"mod+s",action:function(t){t.trigger("yne-save-content")}})}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";o=[n,r,n(6)],void 0===(i=function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),n.register({name:"underline",key:"mod+u",action:function(t){t.toggleInlineStyle("underline")}})}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";o=[n,r,n(6)],void 0===(i=function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),n.register({name:"undo",key:"mod+z",action:function(t){t.undo()}})}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";o=[n,r,n(6)],void 0===(i=function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),n.register({name:"selectAll",key:"mod+a",read:!0,action:function(t){t.selectAll()}})}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";o=[n,r,n(3),n(6)],void 0===(i=function(t,e,n,o){Object.defineProperty(e,"__esModule",{value:!0});var i=function(t){var e,o,i=t.getNoteRange(),r=t.noteView;r.getHtmlContentEditable()||i&&i.isInSingleBlock()&&i.isMatchBlockTypes(t.note,[n.IMAGE,n.ATTACHMENT])&&(e=i.getStartBlockRange().block,(o=r.getBlockViewByBlock(e))&&(r.setHtmlContentEditable(!0),o.el.focus(),window.setTimeout(function(){r.setHtmlContentEditable(!1)},0)))};o.register({name:"copy",key:"mod+c",preventDefault:!1,read:!0,action:i}),o.register({name:"cut",key:"mod+x",preventDefault:!1,action:i})}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";o=[n,r,n(10),n(6)],void 0===(i=function(t,e,n,o){Object.defineProperty(e,"__esModule",{value:!0}),o.register({name:"paste",key:"mod+v",preventDefault:!1,action:function(t,e){var o=t.editor;t.setPasteAsText(!1),n.IS_MAC&&(e.preventDefault(),o.callMacNativeApi("menuPaste"))}}),o.register({name:"pasteAsText",key:"mod+shift+v",preventDefault:!1,action:function(t){t.setPasteAsText(!0)}}),o.register({name:"pasteAsText_alternative",key:"mod+shift+option+v",preventDefault:!1,action:function(t){t.setPasteAsText(!0)}})}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";o=[n,r,n(10),n(6)],void 0===(i=function(t,e,n,o){Object.defineProperty(e,"__esModule",{value:!0});var i=!0;(n.IS_WEB_NOTE||n.IS_WEB_GROUP)&&(i=!1),o.register({name:"find",key:"mod+f",read:!0,preventDefault:i,action:function(t){t.trigger("find")}})}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";o=[n,r,n(6)],void 0===(i=function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),n.register({name:"shiftTab",key:"shift+tab",action:function(t){var e=t.getEditingInlineState();t.execCommand("comp.KeyTab",{inlineStyles:e,withShiftKey:!0})}})}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";o=[n,r,n(10),n(6)],void 0===(i=function(t,e,n,o){Object.defineProperty(e,"__esModule",{value:!0}),n.IS_PC&&(o.register({name:"zoomIn_0",key:"mod+plus",action:function(t){t.zoomInEditor()}}),o.register({name:"zoomIn_1",key:"mod+shift+plus",action:function(t){t.zoomInEditor()}}),o.register({name:"zoomIn_2",key:"mod+=",action:function(t){t.zoomInEditor()}}),o.register({name:"zoomIn_3",key:"mod+shift+=",action:function(t){t.zoomInEditor()}}))}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";o=[n,r,n(10),n(6)],void 0===(i=function(t,e,n,o){Object.defineProperty(e,"__esModule",{value:!0}),n.IS_PC&&(o.register({name:"zoomOut_0",key:"mod+-",action:function(t){t.zoomOutEditor()}}),o.register({name:"zoomOut_1",key:"mod+shift+-",action:function(t){t.zoomOutEditor()}}),o.register({name:"zoomOut_2",key:"mod+0",action:function(t){t.zoomEditor(1,!0)}}))}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";o=[n,r,n(10),n(6)],void 0===(i=function(t,e,n,o){Object.defineProperty(e,"__esModule",{value:!0}),o.register({name:"deleteToEnd",key:"ctrl+k",action:function(t){n.IS_MAC&&t.execDeleteToEnd()}})}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";o=[n,r,n(10),n(6)],void 0===(i=function(t,e,n,o){Object.defineProperty(e,"__esModule",{value:!0}),o.register({name:"deleteForward",key:"ctrl+d",action:function(t){n.IS_MAC&&t.execDeleteForward()}})}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";o=[n,r,n(30),n(2),n(10),n(6)],void 0===(i=function(t,e,n,o,i,r){Object.defineProperty(e,"__esModule",{value:!0});var a={insertHeading_1:"1",insertHeading_2:"2",insertHeading_3:"3",insertHeading_4:"4"},s=function(t,e,n){o.log(e),null!=a[n]?t.execCmdByShortCut("comp.InsertHeading",{level:a[n]}):o.warn("Unsupported shortKey:",n)};n.isSafari()&&!i.IS_MAC||(r.register({name:"insertHeading_1",key:"mod+1",preventDefault:!0,action:s}),r.register({name:"insertHeading_2",key:"mod+2",preventDefault:!0,action:s}),r.register({name:"insertHeading_3",key:"mod+3",preventDefault:!0,action:s}),r.register({name:"insertHeading_4",key:"mod+4",preventDefault:!0,action:s}))}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";o=[n,r,n(6)],void 0===(i=function(t,e,n){Object.defineProperty(e,"__esModule",{value:!0}),n.register({name:"strikeout",key:"mod+e",action:function(t){t.toggleInlineStyle("strike")}})}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";o=[n,r,n(62),n(30),n(2),n(10),n(6)],void 0===(i=function(t,e,n,o,i,r,a){Object.defineProperty(e,"__esModule",{value:!0});var s=function(t,e,o){var r;if(i.log(e),"insertOrderList"===o)r=n.ORDERED;else{if("insertUnorderList"!==o)return void i.warn("Unsupported shortKey:",o);r=n.UNORDERED}t.execCmdByShortCut("comp.InsertList",{type:r})};o.isSafari()&&!r.IS_MAC||(a.register({name:"insertUnorderList",key:"mod+l",preventDefault:!0,action:s}),a.register({name:"insertOrderList",key:"mod+shift+l",preventDefault:!0,action:s}))}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";o=[n,r,n(30),n(2),n(10),n(6)],void 0===(i=function(t,e,n,o,i,r){Object.defineProperty(e,"__esModule",{value:!0});n.isSafari()&&!i.IS_MAC||r.register({name:"insertTodo",key:"mod+d",preventDefault:!0,action:function(t,e,n){o.log(e,n),t.execCmdByShortCut("comp.InsertTodo",{checked:!1})}})}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";o=[n,r,n(30),n(2),n(10),n(6)],void 0===(i=function(t,e,n,o,i,r){Object.defineProperty(e,"__esModule",{value:!0});n.isSafari()&&!i.IS_MAC||r.register({name:"insertHR",key:"mod+h",preventDefault:!0,action:function(t,e,n){o.log(e,n),t.execCmdByShortCut("comp.InsertHorizontalRule")}})}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";o=[n,r,n(30),n(2),n(10),n(6)],void 0===(i=function(t,e,n,o,i,r){Object.defineProperty(e,"__esModule",{value:!0});n.isSafari()&&!i.IS_MAC||r.register({name:"insertQuote",key:"ctrl+q",preventDefault:!0,action:function(t,e,n){o.log(e,n),t.execCmdByShortCut("comp.InsertQuote")}})}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";o=[n,r,n(30),n(10),n(6)],void 0===(i=function(t,e,n,o,i){Object.defineProperty(e,"__esModule",{value:!0});n.isSafari()&&!o.IS_MAC||i.register({name:"insertCode",key:"ctrl+alt+d",preventDefault:!0,action:function(t,e,n){t.execCmdByShortCut("comp.InsertCode")}})}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(29),o=n(0),i=n(8),r=n(19),a=n(43),s=n(139),l=[["r","g","b"],["h","s","v"],["h","s","l"]],c=[[255,255,255],[360,100,100],[360,100,100]];return e.View.extend({className:"color-picker",name:"colorpicker",label:"选色器",templateName:"color_picker",events:{mousedown:"onMouseDown","mousedown .color-picker-panel":"onPanelMouseDown","mousedown .color-picker-panel-board":"onBoardMousedown","mousedown .color-picker-panel-alpha":"onAlphaMousedown","mousedown .color-picker-panel-ribbon":"onRibbonMousedown","click .color-picker-panel-params-lable-number":"onParamsLabelClick"},initialize:function(t){this.editor=t.editor,this.render(),this.hidePicker(),this.mode=0,o.bindAll(this,"onDocumentMouseDown","onBoardMousedown","onBoardDrag","onBoardDragEnd","onAlphaMousedown","onAlphaDrag","onAlphaDragEnd","onRibbonMousedown","onRibbonDrag","onRibbonDragEnd","onParamsLabelClick"),this.on("color-picker-show",this.showPicker),i(document).on("mousedown",this.onDocumentMouseDown)},render:function(){var t,e=this.$el;t=r.render("common",this.templateName),e.html(t),this.panel=e.find(".color-picker-panel")[0],this.board=e.find(".color-picker-panel-board")[0],this.boardBg=i(this.board).find(".color-picker-panel-board-hsv"),this.ribbon=e.find(".color-picker-panel-ribbon")[0],this.alpha=e.find(".color-picker-panel-alpha")[0],this.preview=e.find(".color-picker-panel-preview")[0],this.inputs=e.find(".color-picker-panel-params-input"),this.inputHex=i(this.inputs).find("input")[0],this.inputR=i(this.inputs).find("input")[1],this.inputG=i(this.inputs).find("input")[2],this.inputB=i(this.inputs).find("input")[3],this.inputA=i(this.inputs).find("input")[4],this.labelR=e.find(".color-picker-panel-params-lable-number")[0],this.labelG=e.find(".color-picker-panel-params-lable-number")[1],this.labelB=e.find(".color-picker-panel-params-lable-number")[2],this.bindEvents()},bindEvents:function(){o.bindAll(this,"onHexChange","onRedChange","onGreenChange","onBlueChange","onAlphaChange","updateInputHex","updateInputR","updateInputG","updateInputB","updateInputA","onKeyDown","onLastInputKeyDown"),i(this.inputHex).on("input propertychange",this.onHexChange),i(this.inputHex).on("blur",this.updateInputHex),i(this.inputHex).on("keydown",this.onKeyDown),i(this.inputR).on("input propertychange",this.onRedChange),i(this.inputR).on("blur",this.updateInputR),i(this.inputR).on("keydown",this.onKeyDown),i(this.inputG).on("input propertychange",this.onGreenChange),i(this.inputG).on("blur",this.updateInputG),i(this.inputG).on("keydown",this.onKeyDown),i(this.inputB).on("input propertychange",this.onBlueChange),i(this.inputB).on("blur",this.updateInputB),i(this.inputB).on("keydown",this.onKeyDown),i(this.inputA).on("input propertychange",this.onAlphaChange),i(this.inputA).on("blur",this.updateInputA),i(this.inputA).on("keydown",this.onLastInputKeyDown)},showPicker:function(t){var e=this.solidColor(t.selectedValue);e.isValid()||(e=this.solidColor(t.value)),e.isValid()||(e=a("#393939")),this.color=e,this.mode=0,this.item=t,this.$el.show(),this.updateUI()},solidColor:function(t){var e=a(t),n=e.toRgb();return 0===n.r&&0===n.g&&0===n.b&&0===n.a&&e.setAlpha(1),e},hidePicker:function(){var t;this.removeWindowListeners(),this.$el.hide(),this.item&&(t=this.color.toRgbString(),this.item.changeValue(t),this.item=null)},removeWindowListeners:function(){i(window).off("mousemove",this.onBoardDrag),i(window).off("mouseup",this.onBoardDragEnd),i(window).off("mousemove",this.onAlphaDrag),i(window).off("mouseup",this.onAlphaDragEnd),i(window).off("mousemove",this.onRibbonDrag),i(window).off("mouseup",this.onRibbonDragEnd)},onDocumentMouseDown:function(){this.hidePicker()},onMouseDown:function(t){this.hidePicker(),t.stopPropagation(),t.preventDefault()},onPanelMouseDown:function(t){t.stopPropagation()},onBoardMousedown:function(t){this.onBoardDrag(t),this.removeWindowListeners(),i(window).on("mousemove",this.onBoardDrag),i(window).on("mouseup",this.onBoardDragEnd)},onBoardDrag:function(t){var e=t.clientX,n=t.clientY;t.preventDefault(),this.pointMoveTo({x:e,y:n})},onBoardDragEnd:function(t){this.onBoardDrag(t),this.removeWindowListeners()},pointMoveTo:function(t){var e,n,o=this.board.getBoundingClientRect(),r=t.x-o.left,s=t.y-o.top,l=this.color.toHsv(),c=i(this.boardBg).css("background-color"),u=l.h;(e=a(c)).isValid()&&(u=e.toHsv().h),r=Math.max(0,r),r=Math.min(r,200),s=Math.max(0,s),s=Math.min(s,150),(n=a.fromRatio({h:u/360,s:r/200,v:1-s/150,a:l.a})).isValid()&&(this.color=n,this.updateBoardPoint(r-4,s-4),this.updatePreview(),this.updateAlpha(),this.updateInputHex(),this.updateInputG(),this.updateInputB(),this.updateInputR())},onAlphaMousedown:function(t){this.onAlphaDrag(t),this.removeWindowListeners(),i(window).on("mousemove",this.onAlphaDrag),i(window).on("mouseup",this.onAlphaDragEnd)},onAlphaDrag:function(t){var e=t.clientX,n=t.clientY;t.preventDefault(),this.alphaMoveTo({x:e,y:n})},onAlphaDragEnd:function(t){this.onAlphaDrag(t),this.removeWindowListeners()},alphaMoveTo:function(t){var e,n=this.alpha.getBoundingClientRect(),o=n.width,i=t.x-n.left;i=Math.max(0,i),e=(i=Math.min(i,o))/o,this.color.setAlpha(e),this.updateAlpha(100*e),this.updatePreview(),this.updateInputA()},onRibbonMousedown:function(t){this.onRibbonDrag(t),this.removeWindowListeners(),i(window).on("mousemove",this.onRibbonDrag),i(window).on("mouseup",this.onRibbonDragEnd)},onRibbonDrag:function(t){var e=t.clientX,n=t.clientY;t.preventDefault(),this.ribbonMoveTo({x:e,y:n})},onRibbonDragEnd:function(t){this.onRibbonDrag(t),this.removeWindowListeners()},ribbonMoveTo:function(t){var e,n,o=this.ribbon.getBoundingClientRect(),i=o.width,r=t.x-o.left,s=this.color.toHsv();r=Math.max(0,r),e=(r=Math.min(r,i))/i,(n=a.fromRatio({h:e,s:s.s,v:s.v,a:s.a})).isValid()&&(this.color=n,this.updateRibbon(100*e),this.updateBoardBg(360*e),this.updatePreview(),this.updateAlpha(),this.updateInputHex(),this.updateInputR(),0===this.mode&&(this.updateInputG(),this.updateInputB()))},onHexChange:function(){var t,e=i(this.inputHex).val();e.length>0&&e.length<6&&(e=e.concat("0".repeat(6-e.length))),(t=a(e)).isValid()&&(t.setAlpha(this.color.getAlpha()),this.color=t,this.updateOnHexChange())},updateOnHexChange:function(){this.updateBoardPoint(),this.updateBoardBg(),this.updatePreview(),this.updateAlpha(),this.updateRibbon(),this.updateInputR(),this.updateInputG(),this.updateInputB()},onRedChange:function(){var t=i(this.inputR).val(),e=this.mode,n=this.color.toHsv(),r=this.color.toRgb(),s=this.color.toHsl();t=parseInt(t),o.isNumber(t)&&!o.isNaN(t)&&(t<0||t>c[e][0]||(this.color=1===e?a.fromRatio({h:t/360,s:n.s,v:n.v,a:n.a}):2===e?a.fromRatio({h:t/360,s:s.s,l:s.l,a:s.a}):a({r:t,g:r.g,b:r.b,a:r.a}),this.updateOnRedChange()))},updateOnRedChange:function(){0===this.mode&&this.updateBoardPoint(),this.updateBoardBg(),this.updatePreview(),this.updateAlpha(),this.updateRibbon(),this.updateInputHex()},onGreenChange:function(){var t=i(this.inputG).val(),e=this.mode,n=this.color.toHsv(),r=this.color.toRgb(),s=this.color.toHsl();t=parseInt(t),o.isNumber(t)&&!o.isNaN(t)&&(t<0||t>c[e][1]||(this.color=1===e?a.fromRatio({h:n.h,s:t/100,v:n.v,a:n.a}):2===e?a.fromRatio({h:s.h,s:t/100,l:s.l,a:s.a}):a({r:r.r,g:t,b:r.b,a:r.a}),this.updateOnGreenChange()))},updateOnGreenChange:function(){this.updateBoardPoint(),0===this.mode&&(this.updateBoardBg(),this.updateRibbon()),this.updatePreview(),this.updateAlpha(),this.updateInputHex()},onBlueChange:function(){var t=i(this.inputB).val(),e=this.mode,n=this.color.toHsv(),r=this.color.toRgb(),s=this.color.toHsl();t=parseInt(t),o.isNumber(t)&&!o.isNaN(t)&&(t<0||t>c[e][2]||(this.color=1===e?a.fromRatio({h:n.h,s:n.s,v:t/100,a:n.a}):2===e?a.fromRatio({h:s.h,s:s.s,l:t/100,a:s.a}):a({r:r.r,g:r.g,b:t,a:r.a}),this.updateOnBlueChange()))},updateOnBlueChange:function(){this.updateBoardPoint(),0===this.mode&&(this.updateBoardBg(),this.updateRibbon()),this.updatePreview(),this.updateAlpha(),this.updateInputHex()},onAlphaChange:function(){var t=i(this.inputA).val();t=parseInt(t),o.isNumber(t)&&!o.isNaN(t)&&(t<0||t>100||(this.color.setAlpha(t/100),this.updateOnAlphaChange()))},updateOnAlphaChange:function(){this.updatePreview(),this.updateAlpha()},onParamsLabelClick:function(){var t=this.mode;t+=1,t%=3,this.mode=t,this.updateInputR(),this.updateInputB(),this.updateInputG()},onKeyDown:function(t){s.isMatch("enter",t.keyCode)&&(t.stopPropagation(),t.preventDefault(),this.hidePicker(),this.editor.focus())},onLastInputKeyDown:function(t){(s.isMatch("enter",t.keyCode)||s.isMatch("tab",t.keyCode))&&(t.stopPropagation(),t.preventDefault(),this.hidePicker(),this.editor.focus())},inputValue:function(t,e){var n,o=this.color,i=o.toRgb(),r=o.toHsv(),a=o.toHsl(),s=1;switch(t){case 0:n=i;break;case 1:n=r;break;case 2:n=a;break;default:n=i}return(0===t||1!==e&&2!==e)&&3!==e||(s=100),Math.round(n[l[t][e]]*s)},updateInputHex:function(){var t=this.color;i(this.inputHex).val(t.toHex().toUpperCase())},updateInputR:function(){var t=this.mode;i(this.labelR).text(l[t][0].toUpperCase()),i(this.inputR).val(this.inputValue(t,0))},updateInputG:function(){var t=this.mode;i(this.labelG).text(l[t][1].toUpperCase()),i(this.inputG).val(this.inputValue(t,1))},updateInputB:function(){var t=this.mode;i(this.labelB).text(l[t][2].toUpperCase()),i(this.inputB).val(this.inputValue(t,2))},updateInputA:function(){var t=this.color.getAlpha();i(this.inputA).val(Math.round(100*t))},updateBoardBg:function(t){var e,n=this.color.toHsv(),o=this.boardBg;t>=0&&t<=360||(t=n.h),e=a.fromRatio({h:t/360,s:1,v:1}),o.css("background-color",e.toHexString())},updateBoardPoint:function(t,e){var n=this.color.toHsv(),o=i(this.board).find("span");t>=0&&t<=200||(t=200*n.s-4),e>=0&&e<=150||(e=150*(1-n.v)-4),o.css("left",t+"px"),o.css("top",e+"px")},updatePreview:function(){var t=this.color,e=t.getAlpha(),n=i(this.preview).find("span");n.css("background-color",t.toHexString()),n.css("opacity",e)},updateAlpha:function(t){var e,n=this.color.toRgb(),o=i(this.alpha).find(".color-picker-panel-alpha-bg"),r=i(this.alpha).find("span");t>=0&&t<=100||(t=100*n.a),e="linear-gradient(to right, "+a({r:n.r,g:n.g,b:n.b,a:0}).toRgbString()+", "+a({r:n.r,g:n.g,b:n.b,a:1}).toRgbString()+")",o.css("background",e),r.css("left",t+"%")},updateRibbon:function(t){var e=this.color.toHsv().h,n=i(this.ribbon).find("span");t>=0&&t<=100||(t=Math.round(e/360*100)),n.css("left",t+"%")},updateUI:function(){this.updateBoardBg(),this.updateBoardPoint(),this.updatePreview(),this.updateAlpha(),this.updateRibbon(),this.updateInputHex(),this.updateInputA(),this.updateInputR(),this.updateInputB(),this.updateInputG(),this.updateInputHex()},reset:function(){this.$el.hide()}})}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(19),o=n(29),i=n(0),r=n(139),a=n(10),s=n(2),l=n(306),c=function(){};return o.View.extend({className:"image-title-input-wrapper",name:"ImageTitleInputView",events:{"keydown .image-title-input":"_onKeyDown","paste .image-title-input":"_onPaste","input .image-title-input":"_onInput"},zoom:1,initialize:function(t){this.editor=t.editor,i.bindAll(this,"_onEditStart","_onEditEnd","_onKeyDown","_onExit","_onUpdate","_getPosition","_onPaste","_show","_hide","_onInput","_handlerPlaceholder","_onLockedChange"),this.on("img-title-edit-start",this._onEditStart),this.on("img-title-edit-end",this._onEditEnd),this.on("img-title-edit-focus",this._onFocus),this.on("img-title-edit-exit",this._onExit),this.on("img-title-edit-update",this._onUpdate),this.on("locked-change",this._onLockedChange),this._callback=c},render:function(){var t=e.render("common","image-title-input",{title:""});this.$el.html(t)},_getPosition:function(t){var e=this.editor.getNoteViewWrapper(),n=a.IS_PC?this.editor.getNoteViewFrame():this.editor.noteView.$el,o=n.offset(),i=parseInt(n.css("margin-top"));t.left=t.left-e.offset().left+e.scrollLeft(),t.top=t.top-o.top+i},_show:function(){var t=this._origialNode;this.$el.show(),t&&t.css("color","transparent")},_hide:function(){var t=this._origialNode;t&&(t.css("color",""),t.css("height","auto")),this.$el.hide()},_onEditStart:function(t,n,o,r,a){var s,l=this,u=n();l.getOffset=n,l._getPosition(u),l._callback!==c&&l._onEditEnd(),t||(t=""),s=e.render("common","image-title-input",i.defaults({title:t},u)),l.$el.html(s),l.$input=this.$el.find(".image-title-input"),l.$placeholder=this.$el.find(".image-title-placeholder"),l.$input.on("blur",function(){l._handlerPlaceholder(),l._onEditEnd()}).on("focus",function(){l._handlerPlaceholder(),l.editor.controller.lockBlockById(a)}),l._callback=o||c,l._origialNode=r,l._handlerPlaceholder(),t&&l._show(),l.$placeholder.click(function(){l.$input.focus()})},_onEditEnd:function(t,e){if(this.$input&&this.$input.is(":visible")){var n=this.$input.text();this._callback(n,t,e,this.$el.is(":visible"))}},_onKeyDown:function(t){if(this.$input.is(":visible")&&r.isMatch("enter",t.keyCode)&&i.isFunction(this._onEditEnd))return t.preventDefault(),this._onEditEnd(!0,this.editor.controller.getNextCaretBlockRange()),void this._onExit();(t.ctrlKey||t.metaKey)&&["B","b","U","u","I","i"].forEach(function(e){r.isMatch(e,t.keyCode)&&t.preventDefault()})},_onFocus:function(){var t=this.$input;t&&t.is(":visible")||this._show(),t.focus()},_onExit:function(){this._hide(),this._callback=c},_onUpdate:function(t){var e=t();this.getOffset=t,this._getPosition(e),this.$input.css({left:e.left,top:e.top,width:e.width+"px","min-height":e.height+"px"}),this.$placeholder.css({left:e.left,top:e.top,width:e.width+"px"})},_handlerPlaceholder:function(){this.$input.text()?this.$placeholder.hide():this.$placeholder.show()},setZoom:function(t){this.zoom=t,this.$el.css("zoom",this.zoom)},_transferString:function(t){var e=t;try{e=(e=e.replace(/\r\n/g," ")).replace(/\n/g," ")}catch(t){s.log("replace image title line break failed!")}return e},_onPaste:function(t){var e,n,o=t.originalEvent;t.preventDefault(),o.clipboardData&&o.clipboardData.getData?(e=o.clipboardData.getData("text/plain"),n=this._transferString(e),document.execCommand("insertHTML",!1,n)):window.clipboardData&&window.clipboardData.getData&&(e=window.clipboardData.getData("Text"),l(e))},_onInput:function(){var t=this.$input.height();t!==this._origialNode.height()&&this._origialNode.height(t),this._handlerPlaceholder()},_onLockedChange:function(){this.getOffset&&this._onUpdate(this.getOffset)}})}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(29),o=n(0),i=n(8),r=n(19),a=n(139),s=n(10),l=n(3),c=n(110),u=n(21);return e.View.extend({className:"link-view",templateName:"link_view",zoom:1,events:{"click .link-confirm-button":"onConfirmButtonClick","click .link-modify-button":"onModifyButtonClick","click .link-remove-button":"onRemoveButtonClick","keydown .link-input":"onKeyDown",mousedown:"onMouseDown",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave"},initialize:function(t){this.editor=t.editor,this.on("link-menu-show",this.timeoutToShowMenu),this.on("link-menu-hide",this.timeoutToHideMenu),this.bindDocumentEvents(),this.modifyMode=!1,this.on("locked-change",this.recalPosition),i(window).on("resize",this.recalPosition.bind(this))},render:function(){var t,e=this.$el;t=r.render("common",this.templateName,{link:c.safeHref(this.link),isReadOnly:this.editor.isReadOnly()}),e.html(t),this.menuPreviewLink=e.find(".hover-menu-show-link"),this.menuModifyLink=e.find(".hover-menu-modify-link"),this.input=e.find(".link-input"),this.hideModifyMenu()},bindDocumentEvents:function(){o.bindAll(this,"onDocumentMouseDown"),i(document).on("mousedown",this.onDocumentMouseDown)},onKeyDown:function(t){t.stopPropagation(),a.isMatch("enter",t.keyCode)&&(t.preventDefault(),this.onConfirmButtonClick())},onDocumentMouseDown:function(){this.fadeOutMenu()},onMouseDown:function(t){t.stopPropagation()},onConfirmButtonClick:function(){var t=this.range,e=c.safeHref(i(this.input).val());e!==this.link?(window.focus(),e&&this.editor.execCommand("comp.InsertLink",{src:e,range:t}),this.fadeOutMenu()):this.fadeOutMenu()},onRemoveButtonClick:function(){var t=this.range;l.isCatalogue(this.block)?this.editor.execCommand("atom.SetCatalogueHref",{range:t,block:this.block,href:null}):this.editor.execCommand("comp.ApplyStyles",{range:t,inlineStyles:{href:"",color:"#393939",underline:!1}}),this.fadeOutMenu()},onModifyButtonClick:function(){this.hidePreviewMenu(),this.showModifyMenu()},showMenu:function(t){var e=t.range.clone(),n=t.linkNode.href;if(l.isCatalogue(t.block)&&(n=t.block.getViewHref()),!this.modifyMode&&n){var o=new RegExp("^note://");n.match(o)||(this.hideTimerId&&(clearTimeout(this.hideTimerId),this.hideTimerId=null),this.link&&this.hideMenu(),this.linkNode=t.linkNode,this.link=n,this.block=t.block,this.blockId=t.block.getId(),this.range=new u({startRange:e,endRange:e}),this.render(),this.showPreviewMenu())}},recalPosition:function(){this.link&&this.modifyMode&&this.setPosition()},setPosition:function(){var t,e,n,r,a,l,c,u,d,p,h=this.linkNode,f=this.editor.noteView,g=this.editor.getNoteViewWrapper(),m=this.editor.getNoteViewWrapper(),y=s.IS_PC?this.editor.getNoteViewFrame().offset():this.editor.noteView.$el.offset();(t=i(h).offset()).left=t.left-m.offset().left+m.scrollLeft()/this.zoom,t.top=t.top-y.top,e=t.top+i(h).outerHeight(),n=t.left+i(h).outerWidth()/2,l=t.left,p=this.$el.find(".hover-menu-before"),a=i(p[0]).outerWidth()/2,c=e+i(p[0]).outerHeight(),n-l-a<15&&(l=n-15-a),u=this.modifyMode?this.$el.find(".hover-menu-modify-link .hover-menu-body").outerWidth():this.$el.find(".hover-menu-show-link .hover-menu-body").outerWidth(),d=f.$el.outerWidth()-30,g.hasClass("read-mode")&&(d+=parseInt(g.find(".note-view-frame").css("margin-left"))),l+u>d&&(l=d-u),r=n-l-a,i(h).outerHeight()>parseFloat(i(h).css("line-height"))&&(l=t.left-15-a,r=15),this.$el.css("left",l),this.$el.css("top",c),o.each(p,function(t){i(t).css("left",r)})},setZoom:function(t){this.zoom=t,this.$el.css("zoom",this.zoom)},showPreviewMenu:function(){var t=this.menuPreviewLink;this.setPosition(),i(t).show()},hidePreviewMenu:function(){var t=this.menuPreviewLink;i(t).hide()},fadeOutPreviewMenu:function(){var t=this.menuPreviewLink;i(t).fadeOut()},showModifyMenu:function(){var t=this.menuModifyLink;this.modifyMode=!0,this.editor.controller.lockBlockById(this.blockId),this.setPosition(),i(t).show()},hideModifyMenu:function(){var t=this.menuModifyLink;i(t).hide(),this.modifyMode=!1},fadeOutModifyMenu:function(){var t=this.menuModifyLink;i(t).fadeOut(),this.modifyMode=!1},hideMenu:function(){this.stay||(this.hideModifyMenu(),this.hidePreviewMenu(),this.link=null)},fadeOutMenu:function(){this.fadeOutModifyMenu(),this.fadeOutPreviewMenu(),this.link=null,this.range=null,this.linkNode=null,this.hideTimerId=null,this.blockId=null,this.block=null,this.showTimerId&&(clearTimeout(this.showTimerId),this.showTimerId=null)},onMouseEnter:function(t){t.stopPropagation(),this.hideTimerId&&(clearTimeout(this.hideTimerId),this.hideTimerId=null)},onMouseLeave:function(){this.trigger("link-menu-hide")},timeoutToHideMenu:function(){var t=this;t.modifyMode||t.hideTimerId||(t.hideTimerId=setTimeout(function(){t.fadeOutMenu()},100))},timeoutToShowMenu:function(t){var e=this;e.showTimerId||(e.showTimerId=setTimeout(function(){e.showMenu(t)},500))}})}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(715);return[n(716),n(717),n(718),n(719),n(720),n(721),n(722),n(723),n(724),n(725),n(726),n(727),n(728),e,n(729),n(730),n(731),n(732),e,n(733),n(734),n(735),e,n(736)]}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";var a,s=this&&this.__extends||(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});o=[n,r,n(20)],void 0===(i=function(t,e,n){var o=new(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.prototype.queryAction=function(t,e){},e.prototype.selectAction=function(){},e.prototype.initialize=function(e){t.prototype.initialize.call(this,e),this.name="split",this.label="---",this.type=n.TYPE.SPLIT},e}(n))({});return function(){return o}}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";var a,s=this&&this.__extends||(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});o=[n,r,n(20)],void 0===(i=function(t,e,n){var o=new(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.prototype.queryAction=function(t,e){return this.block=e.imgBlock,!!e.imgBlock},e.prototype.selectAction=function(){this.block&&this.block.trigger("edit-image-title")},e.prototype.reset=function(){t.prototype.reset.call(this),this.block=null},e.prototype.initialize=function(e){t.prototype.initialize.call(this,e),this.name="imageTitle",this.label="标题"},e}(n))({});return function(){return o}}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";var a,s=this&&this.__extends||(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});o=[n,r,n(20)],void 0===(i=function(t,e,n){var o=new(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.prototype.queryAction=function(t,e){return this.editor.canUndo()},e.prototype.selectAction=function(){this.editor.undo()},e.prototype.initialize=function(e){t.prototype.initialize.call(this,e),this.name="undo",this.label="撤销",this.key="mod+z"},e}(n))({});return function(){return o}}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";var a,s=this&&this.__extends||(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});o=[n,r,n(20)],void 0===(i=function(t,e,n){var o=new(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.prototype.queryAction=function(t,e){return this.editor.canRedo()},e.prototype.selectAction=function(){this.editor.redo()},e.prototype.initialize=function(e){t.prototype.initialize.call(this,e),this.name="redo",this.label="重做",this.key="mod+y"},e}(n))({});return function(){return o}}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";var a,s=this&&this.__extends||(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});o=[n,r,n(10),n(20)],void 0===(i=function(t,e,n,o){var i=new(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.prototype.queryAction=function(t,e){var n=t.target,o=n.ownerDocument;e.isRangeCollapsed?this.isDisabled=!0:(this.doc=o,this.targetEl=n)},e.prototype.selectAction=function(){var t,e,o,i=this.doc,r=this.editor,a=this.targetEl;if((t=r.getNoteRange()).isSingleTableSelected()&&(e=t.getStartBlockRange().block,a=r.getController().noteView.getBlockViewByBlock(e).getHiddenInputView()),a.focus(),n.IS_MAC)r.callMacNativeApi("menuCut");else{try{o=i.execCommand("cut")}catch(t){o=!1}o||r.trigger("yne-clipboard-error","cut",function(){r.focus()})}},e.prototype.reset=function(){t.prototype.reset.call(this),this.doc=null,this.targetEl=null},e.prototype.initialize=function(e){t.prototype.initialize.call(this,e),this.name="cut",this.label="剪切",this.key="mod+x"},e}(o))({});return function(){return i}}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";var a,s=this&&this.__extends||(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});o=[n,r,n(10),n(20)],void 0===(i=function(t,e,n,o){var i=new(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.prototype.queryAction=function(t,e){var n=t.target,o=n.ownerDocument;e.isRangeCollapsed?this.isDisabled=!0:(this.targetEl=n,this.doc=o)},e.prototype.selectAction=function(){var t,e,o,i=this.doc,r=this.editor,a=this.targetEl;if((t=r.getNoteRange()).isSingleTableSelected()&&(e=t.getStartBlockRange().block,a=r.getController().noteView.getBlockViewByBlock(e).getHiddenInputView()),a.focus(),n.IS_MAC)r.callMacNativeApi("menuCopy");else{try{o=i.execCommand("copy")}catch(t){o=!1}o||r.trigger("yne-clipboard-error","copy",function(){r.focus()})}},e.prototype.reset=function(){t.prototype.reset.call(this),this.doc=null,this.targetEl=null},e.prototype.initialize=function(e){t.prototype.initialize.call(this,e),this.name="copy",this.label="复制",this.key="mod+c"},e}(o))({});return function(){return i}}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";var a,s=this&&this.__extends||(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});o=[n,r,n(10),n(20)],void 0===(i=function(t,e,n,o){var i=new(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.prototype.queryAction=function(t,e){var o,i=t.target,r=i.ownerDocument;return this.targetEl=i,this.doc=r,n.IS_MAC&&(o=this.editor.callMacNativeApi("macClipboardAvailable"),this.isDisabled=!o),!0},e.prototype.selectAction=function(){var t,e,o,i=this,r=i.editor,a=r.getNoteRange(),s=i.doc,l=i.targetEl;if(a.isSingleTableSelected()&&(t=a.getStartBlockRange().block,(e=r.getController().noteView.getBlockViewByBlock(t)).setPasteAsText(!1),l=e.getHiddenInputView()),l.focus(),n.IS_MAC)return r.setPasteAsText(!1),void r.callMacNativeApi("menuPaste");try{o=s.execCommand("paste")}catch(t){o=!1}o||this.editor.trigger("yne-clipboard-error","paste",function(){i.editor.focus()})},e.prototype.reset=function(){t.prototype.reset.call(this),this.doc=null,this.targetEl=null},e.prototype.initialize=function(e){t.prototype.initialize.call(this,e),this.name="paste",this.label="粘贴"},e}(o))({});return function(){return i}}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(20),o=n(0);return function(){return new e({name:"pasteNoteLink",label:"粘贴引用链接",key:"mod+v",_linkId:null,_linkName:null,queryAction:function(){var t=this,e=t.editor;t._linkId=t._linkName=null,t.isDisabled=t.isHidden=!0,e.trigger("yne-require-innerlink",function(e,n){var i=o.isUndefined(e)||o.isUndefined(n);t.isDisabled=t.isHidden=i,i||(t._linkId=e,t._linkName=n)})},selectAction:function(){this.editor.insertNoteLink(this._linkId,this._linkName)}})}}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";var a,s=this&&this.__extends||(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});o=[n,r,n(10),n(20)],void 0===(i=function(t,e,n,o){var i=new(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.prototype.queryAction=function(t,e){var o,i=t.target;return this.targetEl=i,n.IS_MAC&&(this.isHidden=!1,o=this.editor.callMacNativeApi("macClipboardAvailable"),this.isDisabled=!o),!0},e.prototype.selectAction=function(){var t,e,o=this,i=this.editor,r=i.getNoteRange(),a=this.targetEl;if(r.isSingleTableSelected()&&(t=r.getStartBlockRange().block,(e=i.getController().noteView.getBlockViewByBlock(t)).setPasteAsText(!0),a=e.getHiddenInputView()),a.focus(),n.IS_MAC)return i.setPasteAsText(!0),void i.callMacNativeApi("menuPaste");this.editor.trigger("yne-clipboard-error","paste-as-text",function(){o.editor.focus()})},e.prototype.reset=function(){t.prototype.reset.call(this),this.targetEl=null},e.prototype.initialize=function(e){t.prototype.initialize.call(this,e),this.name="pasteAsText",this.label="纯文本粘贴"},e}(o))({});return function(){return i}}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";var a,s=this&&this.__extends||(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});o=[n,r,n(20)],void 0===(i=function(t,e,n){var o=new(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.prototype.queryAction=function(t,e){var n=this.editor.canRemoveFormat()&&!e.isImgAttachBlock&&!e.tableInfo;return this.isDisabled=!n,!e.tableInfo&&!e.isImgAttachBlock},e.prototype.selectAction=function(){this.editor.execCommand("comp.RemoveFormat")},e.prototype.initialize=function(e){t.prototype.initialize.call(this,e),this.name="removeFormat",this.label="清除格式"},e}(n))({});return function(){return o}}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";var a,s=this&&this.__extends||(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});o=[n,r,n(20)],void 0===(i=function(t,e,n){var o=new(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.prototype.queryAction=function(t,e){return!e.isImgAttachBlock&&!e.tableInfo},e.prototype.selectAction=function(){this.editor.selectAll()},e.prototype.initialize=function(e){t.prototype.initialize.call(this,e),this.name="selectAll",this.label="全选"},e}(n))({});return function(){return o}}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";var a,s=this&&this.__extends||(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});o=[n,r,n(20)],void 0===(i=function(t,e,n){var o=new(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.prototype.queryAction=function(t,e){return!e.isImgAttachBlock&&!e.tableInfo},e.prototype.selectAction=function(){var t=this.editor,e=this.editor.countWords(!0),n=e.count,o=e.isSelected,i=e.detail;t.trigger("yne-show-words",n,o,i)},e.prototype.initialize=function(e){t.prototype.initialize.call(this,e),this.name="countWords",this.label="统计字数"},e}(n))({});return function(){return o}}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";var a,s=this&&this.__extends||(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});o=[n,r,n(99),n(20)],void 0===(i=function(t,e,n,o){var i=new(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.prototype.queryAction=function(t,e){return this.block=e.imgBlock||e.attachmentBlock,this.isImg=!!e.imgBlock,this.tableInfo=e.tableInfo,!!e.isImgAttachBlock||!(!e.tableInfo||!e.tableInfo.cell)},e.prototype.selectAction=function(){var t=this.block,e=this.isImg,o=this.tableInfo;o&&(t=o.cell.getContent(),o.type===n.IMAGE&&(e=!0)),e?this.editor.trigger("yne-download-image",t.getSource()):this.editor.trigger("yne-download-attachment",t.getResource(),t.getFileName())},e.prototype.reset=function(){t.prototype.reset.call(this),this.block=null},e.prototype.initialize=function(e){t.prototype.initialize.call(this,e),this.name="download",this.label="另存为"},e}(o))({});return function(){return i}}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";var a,s=this&&this.__extends||(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});o=[n,r,n(20)],void 0===(i=function(t,e,n){var o=new(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.prototype.queryAction=function(t,e){var n=this.editor;return this.noteRange=n.getNoteRange(),!!e.isImgAttachBlock},e.prototype.selectAction=function(){this.editor.execCommand("comp.DeleteNoteRange",{range:this.noteRange})},e.prototype.reset=function(){t.prototype.reset.call(this),this.noteRange=null},e.prototype.initialize=function(e){t.prototype.initialize.call(this,e),this.name="delete",this.label="删除"},e}(n))({});return function(){return o}}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";var a,s=this&&this.__extends||(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});o=[n,r,n(20)],void 0===(i=function(t,e,n){var o=new(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.prototype.queryAction=function(t,e){return!!e.tableInfo&&(e.tableInfo.onlyMergePointAndCell?(this.label="拆分单元格",!0):!1===e.tableInfo.onlyOneCell&&(this.label="合并单元格",!0))},e.prototype.selectAction=function(){this.editor.execCommand("comp.ToggleMergeTableCell",{})},e.prototype.initialize=function(e){t.prototype.initialize.call(this,e),this.name="mergeCell",this.label="合并单元格"},e}(n))({});return function(){return o}}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";var a,s=this&&this.__extends||(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});o=[n,r,n(74),n(20)],void 0===(i=function(t,e,n,o){var i=new(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.prototype.queryAction=function(t,e){return!!e.tableInfo},e.prototype.selectAction=function(){this.editor.execCommand("comp.InsertTableRowCol",{describe:{row:n.UP}})},e.prototype.initialize=function(e){t.prototype.initialize.call(this,e),this.name="insertRowUp",this.label="在上方插入行"},e}(o))({});return function(){return i}}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";var a,s=this&&this.__extends||(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});o=[n,r,n(74),n(20)],void 0===(i=function(t,e,n,o){var i=new(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.prototype.queryAction=function(t,e){return!!e.tableInfo},e.prototype.selectAction=function(){this.editor.execCommand("comp.InsertTableRowCol",{describe:{row:n.DOWN}})},e.prototype.initialize=function(e){t.prototype.initialize.call(this,e),this.name="insertRowDown",this.label="在下方插入行"},e}(o))({});return function(){return i}}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";var a,s=this&&this.__extends||(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});o=[n,r,n(20)],void 0===(i=function(t,e,n){var o=new(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.prototype.queryAction=function(t,e){return!!e.tableInfo},e.prototype.selectAction=function(){this.editor.execCommand("comp.DeleteTableRowCol",{describe:{row:!0}})},e.prototype.initialize=function(e){t.prototype.initialize.call(this,e),this.name="deleteRow",this.label="删除整行"},e}(n))({});return function(){return o}}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";var a,s=this&&this.__extends||(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});o=[n,r,n(74),n(20)],void 0===(i=function(t,e,n,o){var i=new(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.prototype.queryAction=function(t,e){return!!e.tableInfo},e.prototype.selectAction=function(){this.editor.execCommand("comp.InsertTableRowCol",{describe:{col:n.LEFT}})},e.prototype.initialize=function(e){t.prototype.initialize.call(this,e),this.name="insertColLeft",this.label="在左侧插入列"},e}(o))({});return function(){return i}}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";var a,s=this&&this.__extends||(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});o=[n,r,n(74),n(20)],void 0===(i=function(t,e,n,o){var i=new(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.prototype.queryAction=function(t,e){return!!e.tableInfo},e.prototype.selectAction=function(){this.editor.execCommand("comp.InsertTableRowCol",{describe:{col:n.RIGHT}})},e.prototype.initialize=function(e){t.prototype.initialize.call(this,e),this.name="insertColRight",this.label="在右侧插入列"},e}(o))({});return function(){return i}}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";var a,s=this&&this.__extends||(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});o=[n,r,n(20)],void 0===(i=function(t,e,n){var o=new(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.prototype.queryAction=function(t,e){return!!e.tableInfo},e.prototype.selectAction=function(){this.editor.execCommand("comp.DeleteTableRowCol",{describe:{col:!0}})},e.prototype.initialize=function(e){t.prototype.initialize.call(this,e),this.name="deleteCol",this.label="删除整列"},e}(n))({});return function(){return o}}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";var a,s=this&&this.__extends||(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});o=[n,r,n(20)],void 0===(i=function(t,e,n){var o=new(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.prototype.queryAction=function(t,e){return!!e.tableInfo},e.prototype.selectAction=function(){this.editor.execCommand("comp.DeleteNoteRange",{isTableDelete:!0})},e.prototype.initialize=function(e){t.prototype.initialize.call(this,e),this.name="deleteTable",this.label="删除整个表格"},e}(n))({});return function(){return o}}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(738),o=n(0),i=n(2),r=!1;return{checkNativeApi:function(){var t=window.ynote||{};t?o.each(e,function(e,n){null==t[n]&&i.error("Native does not implement api: "+n)}):i.error("window.ynote does not exist!")},callNativeApi:function(t,e){var n,o=window.ynote||{};if(r||(this.checkNativeApi(),r=!0),n=o[t])return n.apply(o,e||[]);i.error("No native api: "+t)}}}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(){return{menuCopy:function(){},menuPaste:function(){},macClipboardAvailable:function(){},macClipboardData:function(t){}}}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){n(307);var e=n(29),o=n(0),i=n(8),r=n(3),a=n(302),s=n(10),l=n(740),c=[n(741),n(742),n(743),n(744),n(308),n(746),n(84),n(747),n(749),n(750),n(84),n(751),n(752),n(753),n(754),n(755),n(84),n(756),n(759),n(308),n(760),n(761),n(762),n(763),n(764),n(84),n(765),n(766),n(84),n(767),n(768),n(769),n(770),n(771),n(772),n(773),n(84),n(774),n(775),n(776),n(777),n(778),n(779),n(780)],u=n(781),d=[];return s.IS_MAC||c.push(l),e.View.extend({className:"bulb-toolbar",events:{mousedown:"_onMouseDown"},_lastRangeType:null,initialize:function(t){var e=t.editor;this.editor=e,this.items=[],this.initItems(),this.bindEvents(),this.isRendered=!1},initItems:function(){var t=this,e=t.editor;o.each(c,function(n){t.addItem(new n({editor:e}))}),t.showMore=new u({editor:e,items:d}),t.addItem(t.showMore)},bindEvents:function(){var t=this,e=t.editor,n=a.EDITOR_BUTTON_STATE_MAP;e.on("yne-editing-state-change",function(){var i,s=e.getNoteRange(),l=a.RANGE_DEFAULT;s&&(i=s.getStartBlockRange().block,r.isHeaderFooter(i)?l=a.RANGE_HEADER_FOOTER:r.isImage(i)?l=a.RANGE_IMAGE:r.isAttachment(i)?l=a.RANGE_ATTACHMENT:s.isSingleTableSelected()?l=a.RANGE_TABLE_CELL:r.isCatalogue(i)?l=a.RANGE_CATALOGUE:r.isQuote(i)?l=a.RANGE_QUOTE:r.isCode(i)&&(l=a.RANGE_CODE)),t._lastRangeType!==l&&(t._lastRangeType=l,o.each(t.items,function(t){var e,i=n[t.name],r=a.ACTION_SHOW_ENABLE;switch(o.each(i,function(t){t.on===a.RANGE_DEFAULT&&(r=t.action),t.on===l&&(e=t.action)}),null==e&&(e=r),e){case a.ACTION_SHOW_ENABLE:t.show(),t.enable();break;case a.ACTION_HIDE:t.hide();break;case a.ACTION_ENABLE:t.enable();break;case a.ACTION_DISABLE:t.show(),t.disable()}}),t.reShrink())})},render:function(){var t=this,e=this.items,n=this.$el;o.each(e,function(e){n.append(e.$el),e.on("re-shrink",o.throttle(t.reShrink.bind(t),100))}),t.isRendered=!0,i(window).on("resize",t.reShrink.bind(t))},reset:function(){o.each(this.items,function(t){t&&t.reset&&t.reset()})},addItem:function(t){this.items.push(t)},addItems:function(t){this.items.concat(t)},show:function(){var t=this,e=this.items;o.each(e,function(e){t.$el.append(e.$el)}),t.$el.show(),t.shrink()},hide:function(){this.$el.hide(),this.showMore.hideMenu()},reShrink:function(){var t=this.items,e=this.$el;o.each(t,function(t){e.append(t.$el)}),this.shrink()},shrink:function(){var t,e,n=this.items,i=this.$el.parent().width(),r=o.last(n).$el,a=r.outerWidth(!0),s=0;d=[],o.map(n,function(o,r){var l,c=o.isVisible;if(r===n.length-1)return o.items=d,t=o.$el.find(".combo-menu"),s>(e=i-100)?t.css("width",e).css("white-space","normal"):t.css("width","").css("white-space",""),void o.resetMenu();c?(l=o.$el.outerWidth(!0),a+=l):l=0,i<a&&(s+=l,d.push(o))}),0===d.length?r.hide():r.show()},_onMouseDown:function(t){t.preventDefault()},_invoke:function(t){o.each(this.items,function(e){e[t]&&e[t]()})},enable:function(){this.$el.removeClass("disabled"),this._invoke("enable")},disable:function(){this.$el.addClass("disabled"),this._invoke("disable")}})}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(56).extend({name:"view-mode",label:"视图切换",defaultState:!1,state:!1,templateName:"toolbar-button-template",render:function(){var t,n=this;e.__super__.render.apply(n,arguments),(t=n.$el.find(".button")).addClass("normal"),n.editor.on("view-mode-change",function(e){var o=2===e;o?(t.removeClass("normal"),t.addClass("page")):(t.removeClass("page"),t.addClass("normal")),n.state=o})},onClick:function(){var t=!0===this.state?0:2;this.editor.setViewMode(t,!0,!0)}});return e}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){return n(56).extend({name:"undo",label:"撤销",defaultState:!1,state:!1,templateName:"toolbar-button-template",editorEvents:{"command-exec":"_onHistoryChange","undo-stack-change":"_onHistoryChange","cell-edit-view-exit":"_onHistoryChange","cell-edit-view-enter":"_onCellEditViewHistoryChange","cell-edit-view-history-change":"_onCellEditViewHistoryChange"},_onHistoryChange:function(){this.setState(this.editor.canUndo())},_onCellEditViewHistoryChange:function(t){this.setState(t.canUndo)},onClick:function(){!0===this.state&&this.editor.execCommandByToolbar("undo")}})}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){return n(56).extend({name:"redo",label:"重做",defaultState:!1,state:!1,templateName:"toolbar-button-template",editorEvents:{"command-exec":"_onHistoryChange","redo-stack-change":"_onHistoryChange","cell-edit-view-exit":"_onHistoryChange","cell-edit-view-enter":"_onCellEditViewHistoryChange","cell-edit-view-history-change":"_onCellEditViewHistoryChange"},_onHistoryChange:function(){this.setState(this.editor.canRedo())},_onCellEditViewHistoryChange:function(t){this.setState(t.canRedo)},onClick:function(){!0===this.state&&this.editor.execCommandByToolbar("redo")}})}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){return n(56).extend({name:"remove-format",label:"清除格式",defaultState:!1,state:!1,templateName:"toolbar-button-template",editorEvents:{"yne-selection-change":"_onSelectionChange","yne-editing-state-change":"_onEditingStateChange"},_onEditingStateChange:function(t){this.$el.hasClass("disabled")||(t&&null!==t.cellEditViewRangeCollapsed?this.setState(!1===t.cellEditViewRangeCollapsed):this.setState(!0))},_onSelectionChange:function(){this.$el.hasClass("disabled")||this.setState(!0)},onClick:function(){var t;(t=this.editor.getNoteRange())&&!t.isCollapsed()?this.editor.execCommandByToolbar("comp.RemoveFormat",{resetAllStyles:!0}):this.editor.resetEditingInlineStates()}})}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(56),o=n(745);return e.extend({name:"format-painter",label:"格式刷",events:{click:"onClick",dblclick:"onDblClick",mousedown:"onMouseDown"},defaultState:!1,state:!1,templateName:"toolbar-button-template",initialize:function(){e.prototype.initialize.apply(this,arguments),this._initFormatPainterManager()},_initFormatPainterManager:function(){this._formatPainterManager=new o({editor:this.editor}),this._formatPainterManager.on("formatpainter-state-change",this.onFormatPainterStateChange.bind(this))},clickAction:function(){!0===this.state?this.reset():this.stash(!0)},onClick:function(){var t=this;clearTimeout(t._timer),t._timer=setTimeout(function(){t.clickAction()},300)},onDblClick:function(){clearTimeout(this._timer),this.stash()},stash:function(t){this._formatPainterManager.stash(t)},reset:function(){this._formatPainterManager.reset()},onFormatPainterStateChange:function(t){this.setState(!!t)}})}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e,o=n(26),i=n(8),r=n(29),a=n(0),s=n(7),l=n(43),c=0,u=1,d=2;return e={state:null,data:null,initialize:function(t){this._editor=t.editor,this.state=c,a.bindAll(this,"stash","_paintWithDebounce","reset","_onSelectStart","_onCommandExec")},_isLinkStyle:function(t){return t&&t.color&&t.color!==s.INTERM&&l.equals(t.color,"blue")&&!0===t.underline},stash:function(t){var e,n=this._editor;this.reset(),e=n.querySelectionInlineStyles(),this._isLinkStyle(e)&&e.href&&(delete e.color,delete e.underline),this.data={inlineStyles:e,blockStyles:n.querySelectionBlockStyles()},t?this.setState(u):this.setState(d),this.bindEvents()},paint:function(){this.data&&this._editor.execCommandByToolbar("comp.FormatPainter",{data:this.data}),this.state===u&&this.reset()},reset:function(){this._clearPaintTimeout(),this.data=null,this.setState(c),this.unbindEvents()},setState:function(t){this.state!==t&&(this.state=t,this.trigger("formatpainter-state-change",!!t),this.updateFormatPainterCursorUI(!!t))},updateFormatPainterCursorUI:function(t){this._editor.updateFormatPainterCursorUI(t)},bindEvents:function(){var t=this._editor;this.unbindEvents(),t.on("selectstart",this._onSelectStart),t.on("mouse-down",this._onSelectStart),t.on("esc",this.reset),t.on("command-exec",this._onCommandExec)},unbindEvents:function(){var t=this._editor;t.off("selectstart",this._onSelectStart),t.off("mouse-down",this._onSelectStart),t.off("esc",this.reset),t.off("command-exec",this._onCommandExec),i(document).off("mouseup",this._paintWithDebounce)},_onSelectStart:function(){i(document).one("mouseup",this._paintWithDebounce)},_clearPaintTimeout:function(){this._paintTimeout&&(window.clearTimeout(this._paintTimeout),this._paintTimeout=null)},_paintWithDebounce:function(){var t=this;t._clearPaintTimeout(),t._paintTimeout=window.setTimeout(function(){t.paint()},100)},_onCommandExec:function(t){"comp.FormatPainter"!==(t||{}).name&&this.reset()}},a.extend(e,r.Events),o.extend(e)}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(8),o=n(140),i=n(208);return o.extend({name:"heading",label:"标题",defaultValue:"default",items:i.headingArray,templateName:"toolbar-combo-box-heading",editorEvents:{"yne-editing-state-change":"onEditingStateChange","yne-selection-change":"onSelectionChange"},updateValueUI:function(t){var n=e(this.valueWrapperEl).find(".combo-value")[0];i.headingMap[t]?e(n).text(i.headingMap[t].name):e(n).text(this.getUnlistedText(t)||"")},getUnlistedText:function(t){return t?i.headingMap[t].name:i.headingMap[this.defaultValue].name+""},onItemClick:function(t){var e,n,o=t.textContent.trim();for(e in i.headingMap)if(i.headingMap[e].name===o){n=e;break}this.editor.execCommandByToolbar("comp.InsertHeading",{level:n})},onEditingStateChange:function(){var t=this.editor.querySelectionBlockStyle(this.name);i.headingMap[t]?this.select(t):this.select(this.defaultValue)}})}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(140),o=n(748);return e.extend({name:"code-language",label:"语言",defaultValue:"javascript",items:o,templateName:"toolbar-combo-box-font-size",onChange:function(t){var e=this.editor.controller.getNoteRange().getStartBlockRange().block;this.editor.execCommandByToolbar("comp.SetCodeLanguage",{block:e,newLanguage:t})}})}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(){return{javascript:"JavaScript",java:"Java",python:"Python",php:"PHP",csharp:"C#",cpp:"C++",css:"CSS",ruby:"Ruby",c:"C",objectivec:"Objective-C",swift:"Swift",scala:"Scala",shell:"Shell",go:"Go",r:"R",typescript:"Typescript",html:"HTML",markdown:"Markdown",kotlin:"Kotlin",json:"JSON",xml:"XML",sql:"SQL",matlab:"MATLAB"}}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){return n(140).extend({name:"code-theme",label:"主题",defaultValue:"default",items:{default:"默认主题",tomorrow:"宁静深邃",coy:"清新条纹",okaidia:"暗夜繁星",Ateliersulphurpool:"轻快蓝调",vs:"简约线条"},templateName:"toolbar-combo-box-font-size",onChange:function(t){var e=this.editor.controller.getNoteRange().getStartBlockRange().block;this.editor.execCommandByToolbar("comp.SetCodeTheme",{block:e,newTheme:t})}})}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e,o=n(140),i=n(7),r=n(51),a=n(8);return e=o.extend({name:"font-family",label:"字体",defaultValue:r.DEFAULT_FONT,items:r.getItems(),templateName:"toolbar-combo-box-font-family",getUnlistedText:function(t){var e;return t&&t!==i.INTERM&&(e=r.getFont(t)),e=e||r.splitFontFamily(t)[0]||"微软雅黑"},render:function(){var t,n=this;e.__super__.render.apply(n,arguments),t=n.$el.find(".combo-value-font-family"),a(t).hover(function(){a(n.displayWrapperEl).tooltipster({animation:"",animationDuration:0,content:t.text(),delay:[800,300]})},function(){a(n.displayWrapperEl).tooltipster({animation:"",animationDuration:0,content:n.label,delay:[800,300]})})}})}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){return n(140).extend({name:"font-size",label:"字号",defaultValue:"14",items:{9:"9",12:"12",14:"14",16:"16",18:"18",22:"22",26:"26",30:"30",36:"36",42:"42"},templateName:"toolbar-combo-box-font-size",getUnlistedText:function(t){var e=parseInt(t,10);return e&&!isNaN(e)?e+"":this.defaultValue+""}})}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(174),o=n(7);return e.extend({name:"bold",label:"加粗",shortcut:o.IS_MAC?"Command+B":"Ctrl+B"})}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(174),o=n(7);return e.extend({name:"italic",label:"斜体",shortcut:o.IS_MAC?"Command+I":"Ctrl+I"})}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(174),o=n(7);return e.extend({name:"underline",label:"下划线",shortcut:o.IS_MAC?"Command+U":"Ctrl+U"})}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(174),o=n(7);return e.extend({name:"strike",label:"删除线",shortcut:o.IS_MAC?"Command+E":"Ctrl+E"})}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(309),o=n(2),i=n(43);return e.extend({name:"color",label:"文字颜色",defaultValue:"#393939",defaultSetValue:"#DF402A",doAction:function(t){var e={},n=t||this.value,r=i(n);r&&!1!==r.isValid()?(e[this.name]=r.toHexString(),this.editor.execCommandByToolbar("comp.ApplyStyles",{inlineStyles:e})):o.error("tiny color object is not valid",r)}})}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(173),o=n(8),i=n(758);return e.extend({name:"color",defaultValue:"#000000",items:i,templateName:"toolbar-combo-box-color",editorEvents:{"yne-selection-change":"onSelectionChange"},onValueWrapperElClick:function(){var t=this.value;this.hideMenu(),this.onChange(t)},onChange:function(t){this.doAction(t)},doAction:function(){},onItemClick:function(t){var e=o(t).data("value");if(o(t).hasClass("color-section-other"))return this.editor.trigger("color-picker-show",this),void this.hideMenu();this.changeValue(e)},changeValue:function(t){this.select(t),this.onChange(t)},updateValueUI:function(t){var e=o(this.valueWrapperEl).find(".combo-value-buttom-color")[0];o(e).css("background-color",t)},onSelectionChange:function(){var t=this.editor.querySelectionInlineStyle(this.name);this.selectedValue=t}})}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(){return{theme:["#ffffff","#000000","#eeece0","#1c487f","#4d80bf","#c24f4a","#9abc52","#7b5ba1","#46acc8","#f9963b"],other:[["#f2f2f2","#808080","#ddd9c2","#c5d9f2","#dce6f3","#f3dcdb","#ebf1dd","#e6e0ec","#daeef4","#feead9"],["#d9d9d9","#595959","#c4be95","#8db3e5","#b8cde6","#e7b9b7","#d7e5bb","#ccc0db","#b6dee9","#fdd5b3"],["#bfbfbf","#404040","#948b50","#528cd8","#94b2d9","#da9693","#c3d798","#b3a1c8","#91cdde","#fbc08c"],["#a6a6a6","#262626","#4a4528","#15365f","#355f94","#973632","#769436","#60487c","#2c859d","#e66c00"],["#808080","#0d0d0d","#1e1c10","#0f2340","#243f62","#642422","#4f6324","#403053","#1e5969","#994800"]],standard:["#df402a","#f77567","#fad4d3","#fae220","#b19067","#77c94b","#98dede","#184e87","#9896a4","#90a7d1"]}}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){return n(309).extend({name:"back-color",label:"背景色",defaultValue:"transparent",defaultSetValue:"#FAE220",templateName:"toolbar-combo-box-back-color",doAction:function(t){var e={};e[this.name]=t||this.value,this.editor.execCommandByToolbar("comp.ApplyStyles",{inlineStyles:e})}})}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(232),o=n(62),i=n(7);return e.extend({name:"unordered-list",label:"无序列表",defaultState:!1,state:!1,templateName:"toolbar-button-template",shortcut:i.IS_MAC?"Command+L":"Ctrl+L",querySelectionState:function(){return this.editor.isSameList("unordered")},onClick:function(){this.editor.execCommandByToolbar("comp.InsertList",{type:o.UNORDERED})}})}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(232),o=n(62),i=n(7);return e.extend({name:"ordered-list",label:"项目编号",defaultState:!1,state:!1,templateName:"toolbar-button-template",shortcut:i.IS_MAC?"Command+Shift+L":"Ctrl+Shift+L",querySelectionState:function(){return this.editor.isSameList("ordered")},onClick:function(){this.editor.execCommandByToolbar("comp.InsertList",{type:o.ORDERED})}})}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(103),o=n(7);return e.extend({name:"todo",label:"待办",defaultState:!1,state:!1,templateName:"toolbar-button-template",shortcut:o.IS_MAC?"Command+D":"Ctrl+D",onClick:function(){this.editor.execCommandByToolbar("comp.InsertTodo",{checked:!1})}})}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(103),o=n(7);return e.extend({name:"quote",label:"引用",defaultState:!1,state:!1,templateName:"toolbar-button-template",shortcut:(o.IS_MAC,""),onClick:function(){this.editor.execCommandByToolbar("comp.InsertQuote")}})}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(103),o=n(7);return e.extend({name:"code",label:"代码块",defaultState:!1,state:!1,templateName:"toolbar-button-template",shortcut:o.IS_MAC?"Control+Alt+D":"Ctrl+Alt+D",onClick:function(){this.editor.execCommandByToolbar("comp.InsertCode")}})}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(175),o=n(3),i=n(0),r=n(8),a=e.extend({name:"align",label:"对齐方式",defaultValue:"left",items:{justify:"两端对齐",left:"左对齐",center:"居中对齐",right:"右对齐"},templateName:"toolbar-combo-box-align",updateValueUI:function(t){var e=r(this.valueWrapperEl).find(".combo-value")[0];r(e).removeClass(i.keys(this.items).join(" ")),r(e).addClass(t)},onChange:function(t){var e,n,i,r;(i=(e=this.editor).getNoteRange())&&(r=(n=i.getStartBlockRange()).block)&&o.isHeaderFooter(r)?e.execCommandByToolbar("comp.SetHeaderFooter",{align:t,headerFooter:r,range:n}):a.__super__.onChange.apply(this,arguments)},onSelectionChange:function(){var t,e=this.editor.getNoteRange(),n=e&&e.getStartBlockRange().block;t=n&&o.isHeaderFooter(n)?n.getAlign():this.editor.querySelectionBlockStyle(this.name),this.items[t]?this.select(t):this.select(this.defaultValue)}});return a}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(175),o=n(0),i=n(8);return e.extend({name:"table-justify",label:"垂直对齐",defaultValue:"middle",isVisible:!1,items:{top:"顶端对齐",middle:"水平居中",bottom:"底端对齐"},templateName:"toolbar-combo-box-align",updateValueUI:function(t){var e=i(this.valueWrapperEl).find(".combo-value")[0];i(e).removeClass(o.keys(this.items).join(" ")),i(e).addClass(t)},onEditingStateChange:function(){this.enable()},onChange:function(t){var e=this.editor;t&&e.execCommandByToolbar("comp.SetTableCellBlockStyle",{styles:{verticalAlign:t}})},onSelectionChange:function(){var t;t=this.editor.querySelectionBlockStyle("verticalAlign"),this.items[t]?this.select(t):this.select(this.defaultValue)}})}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){return n(232).extend({name:"indent",label:"增加缩进",defaultState:!1,state:!1,templateName:"toolbar-button-template",onClick:function(){this.editor.execCommandByToolbar("comp.IndentOutdent",{indentStep:1})}})}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){return n(56).extend({name:"outdent",label:"减少缩进",defaultState:!1,state:!1,templateName:"toolbar-button-template",onClick:function(){this.editor.execCommandByToolbar("comp.IndentOutdent",{indentStep:-1})}})}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(175),o=n(0),i=n(8);return e.extend({name:"line-height",label:"行高",defaultValue:1.75,keys:[1,1.25,1.5,1.75,2,2.5,3],items:[{key:1,value:"1.0"},{key:1.25,value:"1.25"},{key:1.5,value:"1.5"},{key:1.75,value:"1.75"},{key:2,value:"2.0"},{key:2.5,value:"2.5"},{key:3,value:"3.0"}],templateName:"toolbar-combo-box-line-height",updateValueUI:function(t){var e=i(this.menuWrapperEl),n=o.indexOf(this.keys,t);e.find(".active").removeClass("active svg-common"),-1!==n&&e.find(".line-height-"+n).addClass("active svg-common")},onSelectionChange:function(){var t,e,n=this.editor.querySelectionBlockStyle(this.name);-1!==o.indexOf(this.keys,n)?this.select(n):parseFloat(n)==n?(t=parseFloat(n),o.each(this.keys,function(o){var i=Math.abs(o-n);i<t&&(e=o,t=i)}),this.select(e)):(this.select(this.defaultValue),this._isForceSelectWhenClick=!0)}})}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){return n(56).extend({name:"table-wrap",label:"自动换行",defaultState:!0,isVisible:!1,templateName:"toolbar-button-template",onEditingStateChange:function(){var t;t=this.editor.querySelectionBlockStyle("wrap"),this.setState(null==t?this.defaultState:t)},onClick:function(){this.editor.execCommandByToolbar("comp.SetTableCellBlockStyle",{toggle:"wrap",default:this.defaultState})}})}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(175),o=n(74),i=n(0),r=n(8);return e.extend({name:"table-operate",label:"操作表格",defaultValue:"",isVisible:!1,items:{insertRowUp:"在上方插入行",insertRowDown:"在下方插入行",deleteRow:"删除整行",insertColLeft:"在左侧插入列",insertColRight:"在右侧插入列",deleteCol:"删除整列",deleteTable:"删除整个表格"},templateName:"toolbar-combo-box-align",updateValueUI:function(t){var e=r(this.valueWrapperEl).find(".combo-value")[0];r(e).removeClass(i.keys(this.items).join(" ")),r(e).addClass(t)},onChange:function(t){var e,n,i=this.editor;t&&("insertRowUp"===t&&(e=o.UP),"insertRowDown"===t&&(e=o.DOWN),"insertColLeft"===t&&(n=o.LEFT),"insertColRight"===t&&(n=o.RIGHT),e&&i.execCommandByToolbar("comp.InsertTableRowCol",{describe:{row:e}}),n&&i.execCommandByToolbar("comp.InsertTableRowCol",{describe:{col:n}}),"deleteRow"===t&&i.execCommandByToolbar("comp.DeleteTableRowCol",{describe:{row:!0}}),"deleteCol"===t&&i.execCommandByToolbar("comp.DeleteTableRowCol",{describe:{col:!0}}),"deleteTable"===t&&i.execCommandByToolbar("comp.DeleteNoteRange",{isTableDelete:!0}),this.value="")}})}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(84),o=n(0);return e.extend({name:"table-split",isVisible:!1,initialize:function(t){this.editor=t.editor,this.bindEditorEvents(),this.isVisible||this.hide()},editorEvents:{"yne-selection-change":"onSelectionChange"},bindEditorEvents:function(){var t=this,e=t.editor,n=t.editorEvents;n&&o.each(n,function(n,o){e.on(o,t[n].bind(t))})}})}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){return n(56).extend({name:"table-merge",label:"合并单元格",defaultState:!1,isVisible:!1,templateName:"toolbar-button-template",onClick:function(){this.editor.execCommandByToolbar("comp.ToggleMergeTableCell")},onSelectionChange:function(){var t=this.editor.controller.getNoteRange().getStartBlockRange(),e=t.getAsRectRange&&t.getAsRectRange(),n=e&&e.onlyMergePointAndCell();this.label=n?"拆分单元格":"合并单元格",this.render(),this.setState(n)}})}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(0),o=n(8),i=n(19),r=n(122);return r.extend({className:"toolbar-item toolbar-combo-box toolbar-combo-box-table",events:{"click .combo-value-wrapper":"onValueWrapperClick","mouseleave .combo-menu":"onMenuMouseLeave","mouseenter .combo-item":"onItemMouseEnter","click .combo-item":"onItemClick",mousedown:"onMouseDown"},editorEvents:{"yne-editing-state-change":"onEditingStateChange","yne-selection-change":"onSelectionChange"},name:"table",label:"表格",templateName:"toolbar-combo-box-table",initialize:function(t){this.editor=t.editor,this.render(),this.bindDocumentEvents(),this.bindEditorEvents()},render:function(){var t,e=this.$el;t=i.render("web",this.templateName,{name:this.name,label:this.label,maxRows:10,maxCols:8}),e.html(t),this.menuWrapperEl=e.find(".combo-menu-wrapper")[0],this.menuLabelEl=e.find(".combo-menu-label-table")[0],this.comboItems=e.find(".combo-item"),e.find(".combo-display-wrapper").tooltipster({animation:"",animationDuration:0,theme:["tooltipster-borderless","tooltipster-borderless-customized"],side:"bottom",delay:[800,300]})},bindDocumentEvents:function(){e.bindAll(this,"onDocumentMouseDown"),o(document).on("mousedown",this.onDocumentMouseDown)},bindEditorEvents:function(){var t=this,n=t.editor,o=t.editorEvents;o&&e.each(o,function(e,o){n.on(o,t[e].bind(t))})},onDocumentMouseDown:function(t){var e=t.target;o.contains(this.el,e)||this.hideMenu()},onValueWrapperClick:function(){this.toggleMenu()},onItemMouseEnter:function(t){var e=t.target,n=this.getItemCoordinate(e);this.selectItems(n.row+1,n.col+1)},onItemClick:function(t){var e=t.target,n=this.getItemCoordinate(e);this.insertTable(n.row+1,n.col+1),this.hideMenu()},onMenuMouseLeave:function(){this.resetSelected()},onMouseDown:function(t){t.preventDefault()},getItemCoordinate:function(t){var e=o(t);return{row:e.data("row"),col:e.data("col")}},resetSelected:function(){this.selectItems(0,0)},selectItems:function(t,e){this.updateSelectedLabelText(t,e),this.updateSelectedItemsUI(t,e)},updateSelectedLabelText:function(t,e){var n=o(this.menuLabelEl);t>0&&e>0?n.html(t+" 行 "+e+" 列"):n.html("插入表格")},updateSelectedItemsUI:function(t,e){var n,i;for(o(this.comboItems).removeClass("selected"),n=0;n<t;n++)for(i=0;i<e;i++)o(this.comboItems[8*n+i]).addClass("selected")},insertTable:function(t,e){this.editor.execCommandByToolbar("comp.InsertTable",{rows:t,cols:e})},toggleMenu:function(){o(this.menuWrapperEl).hasClass("show")?this.hideMenu():this.showMenu()},showMenu:function(){var t=this.menuWrapperEl;o(t).removeClass("menu-position-fix"),o(t).addClass("show"),t.getBoundingClientRect().right>document.documentElement.offsetWidth&&o(t).addClass("menu-position-fix")},hideMenu:function(){o(this.menuWrapperEl).removeClass("show"),this.resetSelected()},onEditingStateChange:function(){}})}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(103),o=n(7);return e.extend({name:"hr",label:"水平线",defaultState:!1,state:!1,templateName:"toolbar-button-template",shortcut:o.IS_MAC?"Command+H":"Ctrl+H",onClick:function(){this.editor.execCommandByToolbar("comp.InsertHorizontalRule")}})}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(0),o=n(8),i=n(19),r=n(139),a=n(110);return n(122).extend({className:"toolbar-item toolbar-combo-box toolbar-combo-link",name:"link",label:"链接",templateName:"toolbar-combo-box-insert-link",events:{"mousedown .combo-value-wrapper-link":"onValueWrapperMouseDown","click .combo-value-wrapper-link":"onValueWrapperClick","click .link-button":"onConfirmButtonClick",mousedown:"onMouseDown"},initialize:function(t){this.editor=t.editor,this.items=t.items,this.render(),this.bindDocumentEvents(),this.bindEditorEvents()},render:function(){var t,e=this,n=e.$el;t=i.render("web",e.templateName,{name:e.name,label:e.label}),n.html(t),e.menuWrapperEl=n.find(".combo-menu-wrapper")[0],e.menuItemContainer=n.find(".combo-menu")[0],e.input=n.find(".link-input"),o(e.input).keydown(function(t){t.stopPropagation(),r.isMatch("enter",t.keyCode)&&(t.preventDefault(),e.onConfirmButtonClick())}),n.find(".combo-display-wrapper").tooltipster({animation:"",animationDuration:0,theme:["tooltipster-borderless","tooltipster-borderless-customized"],side:"bottom",delay:[800,300]})},bindDocumentEvents:function(){e.bindAll(this,"onDocumentMouseDown"),o(document).on("mousedown",this.onDocumentMouseDown)},onDocumentMouseDown:function(){this.hideMenu()},bindEditorEvents:function(){var t=this,n=t.editor,o=t.editorEvents;o&&e.each(o,function(e,o){n.on(o,t[e].bind(t))})},onMouseDown:function(t){t.stopPropagation(),t.preventDefault()},onConfirmButtonClick:function(){var t=a.safeHref(o(this.input).val().trim());t&&this.editor.execCommandByToolbar("comp.InsertLink",{src:t}),this.hideMenu(),window.focus()},onValueWrapperMouseDown:function(t){t.preventDefault()},onValueWrapperClick:function(){this.toggleMenu()},toggleMenu:function(){var t=o(this.menuWrapperEl);t.toggleClass("show"),t.is(":visible")&&this.input.focus()},showMenu:function(){var t=this.menuWrapperEl;o(t).addClass("show"),this.input.focus()},hideMenu:function(){var t=this.menuWrapperEl;o(t).removeClass("show"),o(this.input).val("")},reset:function(){this.hideMenu()}})}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){return n(103).extend({name:"img",label:"图片",defaultState:!1,state:!1,templateName:"toolbar-button-template",onClick:function(){var t=this.editor;t.trigger("yne-insert-photo",function(e){t.insertImage(e)})}})}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){return n(103).extend({name:"attachment",label:"附件",defaultState:!1,state:!1,templateName:"toolbar-button-template",onClick:function(){var t=this.editor;t.trigger("yne-insert-attachment",function(e){t.insertAttachment(e)})}})}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){return n(103).extend({name:"catalogue",label:"目录",defaultState:!1,state:!1,templateName:"toolbar-button-template",onClick:function(){this.editor.execCommandByToolbar("comp.InsertCatalogue")}})}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(173),o=n(8),i=n(0),r=n(7),a=n(2);return e.extend({name:"set-background",defaultValue:r.DEFAULT_BACKGROUND,label:"笔记背景",items:{},templateName:"toolbar-combo-box-set-background",editorEvents:{"set-all-backgrounds":"onAllBackgroundsSet","set-background":"onBackgroundChanged","yne-background-changed":"onBackgroundChanged"},_isAllBackgroundsReady:!1,_isVIPUser:!1,_normalBackground:null,_vipBackground:null,_CSS_SHADOW:"0px 0px 0px 1.5px #4C98EF",enable:function(){this._updateEnableState()},disable:function(){this._updateEnableState()},render:function(){i.isEmpty(this.items)&&this._isAllBackgroundsReady&&(this.items={normalUser:this._normalBackground,VIP:this._vipBackground}),e.prototype.render.apply(this)},onAllBackgroundsSet:function(t,e){var n=this,o=0,a=0,s={};n._isVIPUser=!!e,n._normalBackground=[],n._vipBackground=[],s.URI=r.DEFAULT_BACKGROUND,s.isForVIP=!1,t.unshift(s),i.each(t,function(t){t.isForVIP?(n._vipBackground[a]||(n._vipBackground[a]=[]),n._vipBackground[a].push(t.URI),3===n._vipBackground[a].length&&a++):(n._normalBackground[o]||(n._normalBackground[o]=[]),n._normalBackground[o].push(t.URI),3===n._normalBackground[o].length&&o++)}),n.items={},n._isAllBackgroundsReady=!0,n.render(),n.onBackgroundChanged(null,n.defaultValue),n.show(),n.trigger("re-shrink")},onBackgroundChanged:function(t,e){var n,r,s,l=this,c=[e,l.defaultValue];l._resetAllSelection(),i.some(c,function(t){return 0!==(r=l.$el.find('[data-value="'+t+'"]')).length&&(n=t,!0)}),o(r[0]).css("box-shadow",l._CSS_SHADOW),s=o(r[0]).find(".background-cell-check-mark"),o(s).css("visibility","visible"),l.value=n,n!==e&&(a.error("failed to find specified URI:",e),l.editor.trigger("background-failed-update",1,n))},onChange:function(t){this.editor.updateBackground(t)},onItemClick:function(t){var n=this,i=o(t).data("value");n.editor.trigger("yne-is-vip-user",function(t){null!==t&&(n._isVIPUser=!!t)}),n._isVIPUser||!n._isVIPBackground(i)?e.prototype.onItemClick.apply(n,[t]):n.editor.trigger("background-failed-update",0)},show:function(){var t=!1;return this._isAllBackgroundsReady?(t=!0,this.$el.show(),this._updateEnableState()):this.$el.hide(),t},reset:function(){this.value=null,this.$el.find(".background-cell").css("box-shadow",""),this.$el.find(".background-cell-check-mark").css("visibility","hidden"),this._updateEnableState()},_isBackgroundDisabled:function(){return(this.editor.getEditorProps()||{}).disableBackground},_isVIPBackground:function(t){var e=!0;return i.some(this._normalBackground,function(n){if(i.contains(n,t))return e=!1,!0}),e},_resetAllSelection:function(){this.$el.find(".background-cell-check-mark").css("visibility","hidden"),this.$el.find(".background-cell").css("box-shadow","")},_updateEnableState:function(){this._isBackgroundDisabled()?e.prototype.disable.apply(this):e.prototype.enable.apply(this)}})}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(0),o=n(8),i=n(19);return n(122).extend({className:"toolbar-item toolbar-combo-box toolbar-combo-more",name:"showmore",label:"查看更多",templateName:"toolbar-combo-box-show-more",events:{"click .combo-value-wrapper-showmore":"onValueWrapperClick",mousedown:"onMouseDown"},initialize:function(t){this.editor=t.editor,this.items=t.items,this.render(),this.bindDocumentEvents()},render:function(){var t,e=this.$el;t=i.render("web",this.templateName,{name:this.name,label:this.label}),e.html(t),this.menuWrapperEl=e.find(".combo-menu-wrapper")[0],this.menuItemContainer=e.find(".combo-menu")[0],this.$split=e.find(".toolbar-more-split"),e.find(".combo-display-wrapper").tooltipster({animation:"",animationDuration:0,theme:["tooltipster-borderless","tooltipster-borderless-customized"],side:"bottom",delay:[800,300]})},bindDocumentEvents:function(){e.bindAll(this,"onDocumentMouseDown"),o(document).on("mousedown",this.onDocumentMouseDown)},onDocumentMouseDown:function(t){var e=t.target;o.contains(this.el,e)||this.hideMenu()},onMouseDown:function(t){t.preventDefault()},onValueWrapperClick:function(){this.toggleMenu()},toggleMenu:function(){o(this.menuWrapperEl).toggleClass("show")},showMenu:function(){var t=this.menuWrapperEl;o(t).addClass("show")},hideMenu:function(){var t=this.menuWrapperEl;o(t).removeClass("show")},resetMenu:function(){var t,n=this.items,i=o(this.menuItemContainer);e.map(n,function(t){i.append(t.$el)}),i.children().length>0?(((t=this.$el.prev()).hasClass("toolbar-split")||t.hasClass("table-split"))&&t.hide(),this.$el.show()):this.$el.hide()}})}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(783),o=n(32),i=n(0),r=n(43),a=new e({}),s={color:{valueInView:"#393939",compareEqual:function(t,e){return r.equals(t,e)}},"font-family":{valueInView:["-apple-system","BlinkMacSystemFont","PingFang SC","Helvetica","Tahoma","Arial","Hiragino Sans GB","Microsoft YaHei","微软雅黑","SimSun","宋体","Heiti","黑体","sans-serif"].join(",")},"color-catalogue":{valueInView:"#003884",value:o.getDefault("color"),compareEqual:function(t,e){return r.equals(t,e)}}};return i.each(s,function(t,e){var n={name:e,valueInView:t.valueInView,value:o.getDefault(e)||t.value,compareEqual:t.compareEqual};a.addMappingRule(n)}),a}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){return n(784).extend({name:"InlineStyleViewMapper"})}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(26),o=n(2);return e.extend({initialize:function(){this._mappingRules={},delete this.options},_isValidMappingRule:function(t){return!(!t||!t.name||null==t.value||null==t.valueInView)},addMappingRule:function(t){var e,n=this._mappingRules;this._isValidMappingRule(t)?n[e=t.name]?o.error("Failed to add mapping rule, mapping rule do exists",t):this._mappingRules[e]=t:o.error("Failed to add mapping rule, parameter is not valid",t)},valueFromView:function(t,e){var n=this._mappingRules[t],i=e;return n&&(n.compareEqual?n.compareEqual(e,n.valueInView):e===n.valueInView)&&(i=n.value),o.log("valueFromView name/valueInView => value: "+t+"/"+e+" => "+i),i},valueToView:function(t,e){var n=this._mappingRules[t],o=e;return n&&(n.compareEqual?n.compareEqual(e,n.value):e===n.value)&&(o=n.valueInView),o}})}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e,o=n(786);return e=o.extend({render:function(){e.__super__.render.apply(this,arguments)}})}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(0),o=n(8),i=n(29),r=n(7),a=n(176),s=n(167),l=n(168),c=n(21),u=n(55),d=n(787),p=n(3),h=n(791),f=n(111),g=n(71),m=n(30),y=n(2),v=n(50),_=n(121),b=n(30),C=n(843),k=n(294),w=n(844),S=n(313);return i.View.extend({className:"note-view",attributes:{tabIndex:1,spellcheck:!1,contenteditable:"true"},directionKeyJustMoved:!1,_isOnMouseDown:!1,events:{textInput:"_onTextInput",compositionstart:"_onCompositionStart",compositionend:"_onCompositionEnd",mousedown:"_onMouseDown",mouseup:"_onMouseUp",selectstart:"_onSelectStart",contextmenu:"_onContextMenu",dragstart:"_onDragDropEvent",dragover:"_onDragDropEvent",drop:"_onDragDropEvent",dragend:"_onDragEnd",copy:"_onCopy",cut:"_onCut",paste:"_onPaste","click a[href]":"_onAnchorClick",click:"_onClick",blur:"_onBlur",focus:"_onFocus"},note:null,blockViews:null,tableViews:null,headerView:null,footerView:null,_keyMonitor:null,_inlineStyleViewMapper:null,isOnComposition:!1,_isSilent:!1,_noteEvents:{"insert-block":"_onInsertBlock","remove-block":"_onRemoveBlock","replace-block":"_onReplaceBlock","read-only-change":"_onReadOnlyChange","high-light":"_onHighlight","next-high-light":"_onNextHighlight","pre-high-light":"_onPreHighlight","content-parse-done":"_onContentParseDone","header-footer-changed":"_OnHeaderFooterChanged","clear-high-light":"_onClearHighlight","copy-prohibited":"_onCopyPSrohibited"},_docEvents:{selectionchange:"_onSelectionChange"},_shouldStopComposition:!1,_affectedViewsByComposition:null,_pageBatchTimer:null,_pageBatchPendingQueue:null,_viewMode:null,_renderBatchTimer:null,_currentZoom:null,_disableOCR:null,initialize:function(t){this._bindEventHandlers(),this.setOptions(t),this._bindEventsForDoc(),this._bindEventsForThis(),this.highlightView=new C,this._pageBatchPendingQueue=[],t.inlineStyleViewMapper&&(this._inlineStyleViewMapper=t.inlineStyleViewMapper),this._currentZoom=1},createHeaderFooterView:function(t){var e,n,o,i;if(null!=(n=(e=this).note))return(o=n.getHeaderFooter(t))||(o=k.createBlank(t),n.setHeaderFooter(o,t)),(i=new w(o,e.isReadOnly())).on("focus",function(){e.trigger("set-range",c.createForHeaderFooter(o),!0,!0)}).on("blur",function(t){e.trigger("selectionchange",t)}).on("text-input",function(t){e.trigger("header-footer-view-text-change",t,i.block)}),i},_renderHeaderFooterView:function(t){t.prepend(this.headerView.$el),t.append(this.footerView.$el)},_removeHeaderFooterView:function(){null!=this.headerView&&(this.headerView.remove(),this.headerView=null),null!=this.footerView&&(this.footerView.remove(),this.footerView=null)},_OnHeaderFooterChanged:function(t){var e=this.options.noteviewFrame;this.isInPageMode()&&(t?(null!=this.footerView&&this.footerView.remove(),this.footerView=this.createHeaderFooterView(t),null!=e&&e.append(this.footerView.$el)):(null!=this.headerView&&this.headerView.remove(),this.headerView=this.createHeaderFooterView(t),null!=e&&e.prepend(this.headerView.$el)))},_bindEventHandlers:function(){var t=this,n=function(n){y.log("bindHandlers: "+n),e.bindAll(t,n)};e.each(t._noteEvents,n),e.each(t._docEvents,n)},_setNote:function(t){this.removeNote(),this.note=t,this._bindEventsForNote()},removeNote:function(){this.note&&this._unbindEventsForNote(),this.note=null},reset:function(){var t;(this.removeNote(),this.$el.html(""),this.blockViews=this._clearBlockViews(this.blockViews),this.options&&(this.options.note=null,this.options.isNoteSet=!1,(t=this.options.noteviewFrame)&&(t.find(".header-footer-input").prop("contenteditable",!0),t.removeClass("has-handwrite"))),this.$el.removeClass("read-only"),this._keyMonitor&&this._keyMonitor.clearCache(),o(document.head).find("style.note-style").remove(),this._isSilent=!1,window.parent!==window)&&window.getSelection().removeAllRanges();this._pageBatchTimer&&(window.clearTimeout(this._pageBatchTimer),this._pageBatchTimer=null),this._renderBatchTimer&&(clearTimeout(this._renderBatchTimer),this._renderBatchTimer=null),this._pageBatchPendingQueue=[],this._removeHeaderFooterView()},setOptions:function(t){if(t=t||{},null==this.options)this.options=e.clone(t);else for(var n in t)t.hasOwnProperty(n)&&(this.options[n]=t[n]);null!=this.options.note&&this._setNote(this.options.note),null!=this.options.viewMode&&(this._viewMode=this.options.viewMode),this._disableOCR=!!this.options.disableOCR},render:function(){var t=this.$el,e=this.highlightView,n=this.options.noteviewFrame;this.blockViews=this.blockViews?this._clearBlockViews(this.blockViews):[],this.tableViews=[],t.html(""),o(document.head).find("style.note-style").remove(),o(document.head).append('<style class="note-style"></style>'),t.append(e.$el),this.isInPageMode()?this._enablePageMode(!1):this._disablePageMode(this._viewMode),window.YNE_PLATFORM&&t.addClass("platform-"+window.YNE_PLATFORM),null!=n&&n.find(".header-footer-input").prop("contenteditable",!this.isReadOnly()),null!=this._renderBatchTimer&&(clearTimeout(this._renderBatchTimer),this._renderBatchTimer=null),this._renderInBatch(0)},_renderInBatch:function(t){var e,n,o=this.note,i=Date.now();if(null!=o){for(;t<o.blocks.length&&(e=o.blocks[t],(n=this._createBlockView(e))||y.warn("Failed to create block view!"),this.blockViews.push(n),this.$el.append(n.$el),n.render(),this._bindEventsForBlockView(e,n),this._setPageInfo(t),t++,!(Date.now()-i>100)););t<o.blocks.length&&(this._renderBatchTimer=setTimeout(this._renderInBatch.bind(this,t),10))}},_repairBlockViews:function(t){var n,o,i,r=this,a=[];t&&t.length>0&&(n=t.shift(),a.push(n),t.length>0&&(o=t.pop(),a.push(o)),r._isElementExisting(n.cid)||((i=r.getBlockViewIndex(n)-1)>=0?r.getBlockViewAt(i).$el.after(n.$el):r.getBlockViewAt(0).$el.before(n.$el)),o&&!r._isElementExisting(o.cid)&&n.$el.after(o.$el),r.reRenderTextBlockView(a),e.each(t,function(t){r._isElementExisting(t.cid)||o.$el.before(t.$el)}))},_isElementExisting:function(t){return this.$el.find('[data-yne-cid="'+t+'"]').length>0},reRenderTextBlockView:function(t){t=t||this.blockViews,e.each(t,function(t){var e=t.block;p.isTextBlock(e)&&t.render()})},_listenerEventsForBlockView:function(t){var n={command:"onCommand","get-read-only-status":"_onGetReadOnlyStatus"};return p.isTable(t)&&(n=e.extend(n,{"select-all":"onSelectAll","save-content":"_onSaveContent"})),n},_bubbleEventsForBlockView:function(t){var n={"locked-change":!0};switch(p.getType(t)){case p.IMAGE:n=e.extend(n,{contextmenu:!0,"replace-img-url":!0,"get-exif-data":!0,"yne-replace-image":!0,"yne-open-image":!0,"yne-download-image":!0,"get-image-items":!0,"img-title-edit-start":!0,"img-title-edit-end":!0,"img-title-edit-focus":!0,"img-title-edit-exit":!0,"img-title-edit-update":!0,"yne-image-ocr":!0,"yne-request-image-rendered-src":!0});break;case p.ATTACHMENT:n=e.extend(n,{"yne-replace-attachment":!0,"yne-open-attachment":!0,"yne-download-attachment":!0,"yne-mac-preview":!0});break;case p.TABLE:n=e.extend(n,{"yne-download-attachment":!0,"yne-on-paste":!0,"get-note-range":!0,"link-menu-show":!0,"link-menu-hide":!0,"move-caret":!0,"set-range":!0,"global-redo":!0,"global-undo":!0,copy:!0,cut:!0,"cell-edit-view-selection-change":!0,"cell-edit-view-enter":!0,"cell-edit-view-exit":!0,"cell-edit-view-history-change":!0,"cell-edit-view-command-executed":!0,"yne-blob-paste":!0});break;case p.QUOTE:case p.TODO:case p.PARAGRAPH:case p.HEADING:n=e.extend(n,{"link-menu-show":!0,"link-menu-hide":!0,"get-entity":!0});break;case p.LIST_ITEM:n=e.extend(n,{"get-editing-styles":!0,"link-menu-show":!0,"link-menu-hide":!0});break;case p.CATALOGUE:n=e.extend(n,{"inner-goto":!0})}return n},_unbindEventsForBlockView:function(t,n){var o=function(t){t&&e.each(t,function(t,e){n.off(e)})};o(this._listenerEventsForBlockView(t)),o(this._bubbleEventsForBlockView(t))},_bindEventsForBlockView:function(t,e,n){var o;(n=!1!==n)&&this._unbindEventsForBlockView(t,e),o=this._listenerEventsForBlockView(t),v.addListeners(o,e,this),o=this._bubbleEventsForBlockView(t),v.bubble(o,e,this)},setHtmlContentEditable:function(t){this.$el.attr("contenteditable",!!t)},getHtmlContentEditable:function(){return"true"===this.el.contentEditable+""},updateFormatPainterCursorUI:function(t){t?this.$el.addClass("format-painter-active"):this.$el.removeClass("format-painter-active")},_handleNoteEvents:function(t){var n=this,o=n.note;o&&o.on&&o.off?e.each(n._noteEvents,function(e,i){t?o.on(i,n[e]):o.off(i,n[e])}):y.warn("Failed to bind note events!")},_bindEventsForNote:function(){this._handleNoteEvents(!0)},_unbindEventsForNote:function(){this._handleNoteEvents(!1)},_bindEventsForDoc:function(){var t=this,n=o(document);e.each(t._docEvents,function(e,o){y.log("bind document event: "+o+" -> "+e),y.log(t[e]),n.on(o,t[e])})},_bindEventsForThis:function(){this.on("draw-range",this._onDrawRange.bind(this)),this.on("resize",this._onResize.bind(this))},_onChangeHandwriteBlock:function(t){var e=this.options.noteviewFrame;t?e.addClass("has-handwrite"):this.note.hasHandWriteBlock()||e.removeClass("has-handwrite")},bindKey:function(t){var e=this,n=e._keyMonitor;t&&(n||(e._keyMonitor=n=new a({el:e.el})),n.unbind(t),n.bind(t,function(n){e.trigger("key-pressed",t,n)}),e._keyMonitor=n)},unbindKey:function(t){var e=this._keyMonitor;e&&t&&e.unbind(t)},_onDrawRange:function(t,e){var n=this;n._silentDo(function(){n._drawRange(t,e)})},_updateSelectionUI:function(t){var e,n,o,i,r,a;t?null!=this.note?(c.isNoteRange(t)?(o=t.getStartBlockRange(),i=t.getEndBlockRange(),e=this.note.getBlockIndex(o.block),n=this.note.getBlockIndex(i.block)):(r=this.getBlockViewContainer(t.startContainer),a=this.getBlockViewContainer(t.endContainer),e=this.getBlockViewIndex(r),n=this.getBlockViewIndex(a)),this._selectAttachments(e,n,t),this._selectCatalogueTables(e,n)):y.warn("Note has been dettached."):y.warn("The range is not valid!")},_selectAttachments:function(t,n){-1!==t&&-1!==n?t!==n&&e.each(this.blockViews,function(e,o){if(e){var i=o>=t&&o<=n;e.selectAttachment&&e.selectAttachment(i)}}):y.warn("start or end is -1")},_selectCatalogueTables:function(t,n){var o,i=[];-1!==t&&-1!==n&&e.each(this.blockViews,function(e,r){if(e){var a=r>=t&&r<=n;if(e.selectTable)e.selectTable(a);else if(e.selectCatalogue){if(o=e.getOwnerId(),!a&&i[o])return;i[o]=!0,e.selectCatalogue(a)}}})},_drawRange:function(t,e){if(t&&t.canDrawedByNative){var n,o,i,r,a=t.getStartBlockRange(),s=a.block;if(e=!1!==e,this._clearCustomSelectionUI(s),p.isCode(s)&&(r=this.getBlockViewByBlock(s)),t.canDrawedByNative())this.setHtmlContentEditable(!0),this._updateSelectionUI(t),n=t.toNativeRange(this),u.setRange(n,window),e&&this._scrollNativeSelectionIntoWrapper(n,r);else{if(this.setHtmlContentEditable(!1),t.isInMultiBlock())return void y.warn("The note range is note valid!");a=t.getStartBlockRange(),null!=this.note&&(o=this.note.getBlockIndex(a.block),(i=this.getBlockViewAt(o))&&i.trigger("draw-range",a,s))}}else y.log("note range is not valid!")},_isZeroRect:function(t){return!t||0===t.width&&0===t.height},_scrollNativeSelectionIntoWrapper:function(t,e){var n,o;this._isOnMouseDown||(t?(t.collapsed?(n=t.getClientRects()[0],this._isZeroRect(n)&&(n=t.getBoundingClientRect())):n=t.getBoundingClientRect(),this._isZeroRect(n)&&(1!==(o=t.commonAncestorContainer).nodeType&&(o=o.parentNode),n=o.getBoundingClientRect()),this._isZeroRect(n)?y.error("can not get selection client rect"):this._scrollRectIntoWrapper(n,e)):y.warn("range not found"))},_getWrapper:function(){for(var t=this.el.parentNode;t;){if(o(t).is(".note-view-wrapper"))return t;t=t.parentNode}},_scrollRectIntoWrapper:function(t,e){var n,o,i=this._getWrapper(),r=i.getBoundingClientRect(),a=r.top,s=r.bottom,l=r.height,c=r.left,u=r.right,d=t.top*this._currentZoom,p=t.bottom*this._currentZoom,h=t.height*this._currentZoom,f=t.left*this._currentZoom,g=null,m=null,y=c+30+10;this._isZeroRect(t)||(e&&(o=(n=e._getContentContainer().get(0)).clientWidth),i.scrollHeight!==i.clientHeight&&(s-=11,l-=11),i.scrollBarWidth!==i.clientWidth&&(u-=11),h>l?(p<0||d>l)&&(m=p-l):d<a||d-a<=10?m=-1*Math.abs(d-a):p>s||s-p<=10?m=Math.abs(p-s):p===s&&(m=10),f>=u||u-f<=10?g=Math.abs(f-u):(f<=c||f-c<=10)&&(g=-1*Math.abs(f-c)),this._scrollWrapperBy(g,m),n&&(f>o||f<y)&&(n.scrollLeft+=f-y))},_scrollWrapperBy:function(t,n){var o=this._getWrapper();t>0?t+=20:t<0&&(t-=20),n>0?n+=20:n<0&&(n-=20),e.isNumber(t)&&(o.scrollLeft+=t),e.isNumber(n)&&(o.scrollTop+=n)},parseNativeRange:function(t){if(t&&t.startContainer){var e=t.startContainer,n=t.endContainer;if(w.isHeaderView(e))return[new d[p.HEADER_FOOTER]({block:this.note.getHeaderFooter(!1)})];if(w.isFooterView(e))return[new d[p.HEADER_FOOTER]({block:this.note.getHeaderFooter(!0)})];var o,i,r,a,s=this.getBlockViewContainer(e),l=this.getBlockViewContainer(n),c=this.getBlockViewIndex(s),u=this.getBlockViewIndex(l),h=[];if(-1!==c&&-1!==u){if(null!=this.note){for(o=c;o<=u;o++)r=this.blockViews[o],i=this.note.getBlockAt(o),(a=r.parseNativeRange(t,i,o!==c&&o!==u))?h.push(a):y.warn("Failed to parse native range to block range!");return h}y.warn("note has been dettached.")}else y.warn("start/end block index is -1 !")}else y.warn("no native range!")},_isRangeInTableBlock:function(){return u.isRangeInSelector(".block-view.table-view")},_onSelectionChange:function(t){var e=!u.isRangeInNode(this.el),n=u.getRange(),o=null;if(this._updateSelectionUI(n),e?(o="The native range is not in note view!",y.log(o)):S.isRangeInCellEditArea(n)?(o="The native range is in table cell edit area",y.log(o)):this._isSilent?o="The _isSilent flag is true!":this.isOnComposition&&(o="The isOnComposition flag is true!"),!o){if(this._isRangeInTableBlock()){if(!this.directionKeyJustMoved)return o="The selection/range is in table box!",y.log("  selection change deprecated!XXXXXXX"),void y.log(o);this.directionKeyJustMoved=!1}this.trigger("selectionchange",t),this._scrollNativeSelectionIntoWrapper(n)}},_silentDo:function(t){var e=this;if(e._isSilent=!0,y.DEBUG)t();else try{t()}catch(t){y.warn("silent do error")}window.setTimeout(function(){e._isSilent=!1},0)},clearNativeSelectionUI:function(){u.getSelection(window).removeAllRanges()},_clearCustomSelectionUI:function(t){var n=this.blockViews;e.each(n,function(e){e.trigger("draw-range",null,t)})},_appendBlankLineIfNeed:function(){var t,e=this.note;e&&((t=e.getLastBlock())&&(!t||e.lastBlockIsEasyInput()&&!t.isLocked())||this.trigger("note-append-blankparagraph",t))},focusLastBlankLine:function(){var t=this;t._appendBlankLineIfNeed(),window.setTimeout(function(){var e=t.getLastBlockView();o(e.el).trigger("mousedown")},50)},isReadOnly:function(){var t=this.note;return null==t||t&&t.isReadOnly()},isDragProhibited:function(){var t=this.note;return null==t||t&&t.isDragProhibited()},isCopyProhibited:function(){var t=this.note;return null==t||t&&t.isCopyProhibited()},_onGetReadOnlyStatus:function(t){t&&t(this.isReadOnly())},_isAtEndOfTextBlock:function(t,e){if(!document.caretRangeFromPoint)return!1;var n,i,r=document.caretRangeFromPoint(t.clientX,t.clientY),a=e.querySelector(".para-text");if(!a||!r||!r.collapsed)return!1;if(n=r.commonAncestorContainer,g.isText(n)){if(r.startOffset!==n.nodeValue.length)return!1;n=n.parentNode}if(!o.contains(a,n))return!1;for(;n&&n!==a;){if((i=n.parentNode).lastChild!==n)return!1;n=i}return!0},_onMouseDown:function(t){var e,n,i,r,a,s,l,u=3===(t.keyCode||t.which);if(this._isOnMouseDown=!0,this._clearHighlight(),this.$el.removeClass("highlight"),!this.isReadOnly()&&(e=this.getBlockViewContainer(t.target),n=this.getBlock(t.target),this._preventSelectStart=!1,!u||(b.isSafari()&&e&&this._isAtEndOfTextBlock(t,e)&&(this._preventSelectStart=!0),o(e).is(".image-view, .attachment-view, .table-view")))){if(!n||n.isLocked())return y.log("_onMouseDown(): block is null or locked!"),void this.focusLastBlankLine();if(this.trigger("mouse-down",t),i=p.getType(n),s=d[i])switch(r=new s({block:n}),a=new c({startRange:r,endRange:r}),i){case p.IMAGE:case p.ATTACHMENT:case p.HANDWRITE:this.setHtmlContentEditable(!0),e.focus(),this.trigger("set-range",a,!0,!0);break;case p.QUOTE:case p.CODE:case p.TODO:case p.PARAGRAPH:case p.LIST_ITEM:case p.HEADING:case p.CATALOGUE:(t=t.originalEvent||t).detail>2?(t.preventDefault(),r.expandToEnd(),l=!0):(l=!1,a=document.caretRangeFromPoint(t.clientX,t.clientY)),this.setHtmlContentEditable(!0),this._clearCustomSelectionUI(n),this.trigger("backup-drag-range"),window.Cypress?setTimeout(function(){this.trigger("set-range",a,!0,!0)}.bind(this),0):this.trigger("set-range",a,l,!0);break;case p.TABLE:break;case p.HR:this.trigger("set-range",a,!0,!0);break;case p.UNKNOWN:this.setHtmlContentEditable(!1),this.trigger("set-range",a,!0,!0)}else y.warn("_onMouseDown is not handled, block type is "+i);this.lastBlock=n}},_clearHighlight:function(){this.highlightView.$el.remove(),this._onClearHighlight()},_onMouseUp:function(){this._isOnMouseDown=!1},_onAnchorClick:function(t){var e,n=t.currentTarget;if(t.preventDefault(),e=n&&n.getAttribute("href"))return _.isNoteLinkUrl(e)?this.trigger("open-link",_.getNoteId(e),!0):void this.trigger("open-link",e)},_onSelectStart:function(t){if(!0===this._preventSelectStart)return t.preventDefault(),t.stopPropagation(),!1;this.trigger("selectstart",t)},_onTextInput:function(t){var e,n;t.preventDefault(),this.isReadOnly()||(n=t.originalEvent||t)&&(e=n.data+"")&&this.trigger("text-input",e)},_onCompositionStart:function(t){var e=this;if(e.isReadOnly())t.preventDefault();else{if(y.log("note view compositionstart ----------\x3e>>>>>"),window.clearTimeout(e._compositionEndTimer),e.setCompositionState(!0),e._shouldStopComposition=!1,e._affectedViewsByComposition=null,e.trigger("onCompositionStart",function(t,n){e._shouldStopComposition=t,e._affectedViewsByComposition=n}),e._shouldStopComposition)return t.preventDefault(),void t.stopPropagation();e.trigger("delete-selection")}},_onCompositionEnd:function(t){var e=this,n=t.originalEvent||t;if(e.isReadOnly()||e._shouldStopComposition)return t.preventDefault(),void(e._affectedViewsByComposition&&e._repairBlockViews(e._affectedViewsByComposition));y.log("note view compositionend ----------\x3e>>>>>"),n.data||e.trigger("delete-selection"),e._compositionEndTimer=window.setTimeout(function(){e.setCompositionState(!1)},0)},setCompositionState:function(t){var e;t&&(e=u.getRange(),this.trigger("set-range",e,!1,!1)),this.isOnComposition=t},_onInsertBlock:function(t,e){var n=this._createBlockView(e);f(n),this._bindEventsForBlockView(e,n),this._insertBlockView(t,n)},_onRemoveBlock:function(t,e){this._removeBlockView(t),!1!==e&&this._setPageInfo(t)},_onReplaceBlock:function(t,e){var n=this._createBlockView(e);f(n),this._replaceBlockView(t,n)},_createBlockView:function(t){var e,n=p.getType(t),o=h(n),i={};return this.isInPageMode()?this.options.pageType===r.PAGE_TYPE_A4?(i.height=r.PAGE_HEIGHT_A4,i.width=r.PAGE_WIDTH_A4):this.options.pageType===r.PAGE_TYPE_B5?(i.height=r.PAGE_HEIGHT_B5,i.width=r.PAGE_WIDTH_B5):this.options.pageType===r.PAGE_TYPE_TEST?(i.height=r.PAGE_HEIGHT_TEST,i.width=r.PAGE_WIDTH_TEST):this.options.pageType===r.PAGE_TYPE_NONE?(i.height=r.PAGE_HEIGHT_NONE,i.width=r.PAGE_WIDTH_NONE):(y.debugAlert("Invalid pageType in PageMode:",this.options.pageType),i.height=r.PAGE_HEIGHT_NONE,i.width=r.PAGE_WIDTH_NONE):(i.height=r.PAGE_HEIGHT_NONE,i.width=r.PAGE_WIDTH_NONE),f(!!o),(e=new o({editor:this.options.editor,block:t,isReadOnly:t.isReadOnly(),inlineStyleViewMapper:this._inlineStyleViewMapper,pageSize:i,pageBreakContainer:this.options.noteviewFrame,noteView:this,disableOCR:this._disableOCR})).on("view-height-changed",this._onBlockViewHeightChanged.bind(this)),e.on("pageBreak-inserted",this._onPageBreakInserted.bind(this)),e.on("pageBreak-positionChanged",this._onPageBreakPosChanged.bind(this)),e instanceof h(p.HANDWRITE)&&this._onChangeHandwriteBlock(!0),e},_insertBlockView:function(t,e){var n,o=this.blockViews,i=e.block,r=this.$el,a=r.children().filter(".block-view"),s=a.length;p.isQuote(i)&&(n=i.getDefaultSetFont()),o.splice(t,0,e),t===s?r.append(e.$el):a.eq(t).before(e.$el),e.render(n)},_removeBlockView:function(t){var n,o,i,r,a=this.blockViews,s=this.$el,l=this.tableViews;n=a.splice(t,1)[0],(i=e.indexOf(l,n))>=0&&l.splice(i,1),(o=(r=s.children().filter(".block-view")).eq(t))&&(o.attr("data-yne-cid")===n.cid?r.eq(t).remove():y.warn("skip div deletion whose attr is "+o.attr("data-yne-cid"))),n instanceof h(p.HANDWRITE)&&this._onChangeHandwriteBlock(!1),n.clearPageBreaks(),n.off(),n.onDestroy()},_replaceBlockView:function(t,e){var n=this.blockViews,o=this.$el;this._clearBlockViews(n.splice(t,1,e)),o.children().filter(".block-view").eq(t).replaceWith(e.$el),e.render()},getBlockViewAt:function(t){return this.blockViews[t]},getLastBlockView:function(){var t=this.blockViews;return t[t.length-1]},getBlockViewContainer:function(t){var e,n;return o(t).is(".highlight-view")?(e=this.getBlockViewAt(0))&&(n=e.el):n=o(t).closest(".block-view")[0],n},getBlockViewIndex:function(t){if(!t)return-1;return this.$el.find(">.block-view").index(t)},getBlock:function(t){var e,n,o=this.note;if(null!=o)return e=this.getBlockViewContainer(t),n=this.getBlockViewIndex(e),o.getBlockAt(n)},getBlockViewByBlock:function(t){var e;if(null!=this.note)return e=this.note.getBlockIndex(t),this.getBlockViewAt(e)},onCommand:function(t,e){var n,o,i;null==e.range&&(e.imageBlockView?(n=e.imageBlockView,e.imageBlockView=null,i=new l({block:n.block}),o=new c({blockRanges:[i]}),e.range=o):e.attachmentBlockView&&(n=e.attachmentBlockView,e.attachmentBlockView=null,i=new s({block:n.block}),o=new c({blockRanges:[i]}),e.range=o)),this.trigger("command",t,e)},_onCopy:function(t){this.trigger("copy",t)},_onCut:function(t){this.isReadOnly()?t.preventDefault():this.trigger("cut",t)},_onPaste:function(t){this.isReadOnly()?t.preventDefault():this.trigger("paste",t)},_onContextMenu:function(t){t.preventDefault(),t.stopPropagation(),this.isReadOnly()||this.trigger("contextmenu",t)},_onDragDropEvent:function(t){var e;if(!this.isReadOnly()&&!this.isDragProhibited())switch((t=t.originalEvent).type){case"dragstart":e=this.getBlock(t.srcElement),this.trigger("dragstart",t,e);break;case"dragover":e=this.getBlock(t.srcElement),this.trigger("dragover",t,e);break;case"drop":this.trigger("drop",t)}},_onDragEnd:function(t){this.trigger("dragend",t)},_onBlur:function(){this.trigger("blur")},_onFocus:function(){window.parent!==window&&m.isSafari()&&window.parent.getSelection().removeAllRanges()},_onClick:function(){this.trigger("yne-click")},onSelectAll:function(){var t,n=document.createRange();t=p.isTodo(e.first(this.note.blocks))?this.el.firstChild.querySelector(".todo-input"):this.el.firstChild,n.setStart(t,0),n.setEnd(this.el.lastChild,1),u.setRange(n,window),this.parseNativeRange(n)},_onSaveContent:function(){this.trigger("save-content")},_onReadOnlyChange:function(){var t=this.isReadOnly(),e=this.options.noteviewFrame;this.setHtmlContentEditable(!t),t?(this.$el.addClass("read-only"),null!=e&&e.find(".header-footer-input").prop("contenteditable",!1)):(this.$el.removeClass("read-only"),null!=e&&e.find(".header-footer-input").prop("contenteditable",!0))},_checkHighlightView:function(){this.$el.children()[0]!==this.highlightView.$el.get(0)&&this.$el.prepend(this.highlightView.$el)},_onHighlight:function(t){var e,n=this.options.noteviewFrame,o=this.options.noteviewWrapper.get(0);t.length?(o.style.background=this.$el.css("background"),n.css("background","transparent"),this.$el.css("background",""),this.$el.addClass("highlight"),this._checkHighlightView()):((e=o.style.background)&&this.$el.css("background",e),this.$el.removeClass("highlight")),this.highlightView.showHighlight(this.el,t)},_onCopyPSrohibited:function(){this.isCopyProhibited()&&this.$el.addClass("copyProhibited")},_onClearHighlight:function(){e.each(this.blockViews,function(t){t.clearHighlight()})},_onNextHighlight:function(){this._checkHighlightView(),this.highlightView.nextHighlight()},_onPreHighlight:function(){this._checkHighlightView(),this.highlightView.preHighlight()},_onResize:function(t){var n=this;e.isNumber(t)&&(n._currentZoom=t),e.each(n.blockViews,function(t){t.trigger("resize"),n.isInPageMode()&&t.coincideAllPageBreaks()}),n._scrollNativeSelectionIntoWrapper(u.getRange())},_clearBlockViews:function(t){return e.each(t,function(t){t.onDestroy()}),[]},isInPageMode:function(){return 2===this._viewMode},setViewMode:function(t,e){this._viewMode=t,this.isInPageMode()?this._enablePageMode(e):this._disablePageMode(t)},_calcNoteViewFrameHeight:function(){var t,n,o,i,a,s=e.last(this.blockViews),l=this.options.noteviewFrame;if(null!=s){if(t=(s.getLastTransPageIndex()||0)+1,this.options.pageType===r.PAGE_TYPE_A4?n=r.PAGE_HEIGHT_A4:this.options.pageType===r.PAGE_TYPE_B5?n=r.PAGE_HEIGHT_B5:this.options.pageType===r.PAGE_TYPE_TEST&&(n=r.PAGE_HEIGHT_TEST),null!=n&&t>1){if(o=t-2,0===(i=l.find('[data-page-id="'+o+'"]')).length)return void y.debugAlert("Failed to find pageBreak:",o);i.length>1&&(y.debugAlert("Should not find more than one pageBreak:",o),i=i.first()),(a=n-(l.height()-parseInt(this.$el.css("padding-bottom"))-parseInt(i.css("top"))-i.height()))<0&&y.log("lastPageShortHeight < 0",a),l.height(l.height()+a),s.$el.position().top-parseInt(this.$el.css("padding-top"))+s.$el.height()>this.$el.height()&&(y.debugAlert("noteview content is overflowed"),l.height("auto"))}else l.height(n+parseInt(this.$el.css("padding-top"))+parseInt(this.$el.css("padding-bottom")));this._coincideAllPageBreaks()}},_coincideAllPageBreaks:function(){e.each(this.blockViews,function(t){t.coincideAllPageBreaks()})},_disablePageMode:function(t){var n=this.options.noteviewFrame;this._pageBatchTimer&&(window.clearTimeout(this._pageBatchTimer),this._pageBatchTimer=null),n?(n.removeClass(r.PAGE_CLASS_A4),n.removeClass(r.PAGE_CLASS_B5),n.removeClass(r.PAGE_CLASS_TEST),e.each(this.blockViews,function(t){t.disablePageMode()}),this._viewMode=t,this._removeHeaderFooterView(),n.css("height","auto")):y.debugAlert("noteviewFrame should NOT be null when _disablePageMode")},_enablePageMode:function(t){var n=this,o=n.options.noteviewFrame;n._pageBatchTimer&&(window.clearTimeout(n._pageBatchTimer),n._pageBatchTimer=null),n._pageBatchPendingQueue=[],o?(o.removeClass(r.PAGE_CLASS_A4),o.removeClass(r.PAGE_CLASS_B5),o.removeClass(r.PAGE_CLASS_TEST),n.options.pageType===r.PAGE_TYPE_A4?o.addClass(r.PAGE_CLASS_A4):n.options.pageType===r.PAGE_TYPE_B5?o.addClass(r.PAGE_CLASS_B5):n.options.pageType===r.PAGE_TYPE_TEST&&o.addClass(r.PAGE_CLASS_TEST),n._removeHeaderFooterView(),n.headerView=n.createHeaderFooterView(!1),n.footerView=n.createHeaderFooterView(!0),n._renderHeaderFooterView(o),!0===t&&null!=n.note&&(e.each(n.blockViews,function(t){t.enablePageMode(n.options.pageType)}),n._setPageInfo(0))):y.debugAlert("noteviewFrame should NOT be null when _enablePageMode")},_getBlockViewIndexByCID:function(t){var n;return e.some(this.blockViews,function(e,o){return e.cid===t&&(n=o,!0)}),n},_onBlockViewHeightChanged:function(t){var e;null!=(e=this._getBlockViewIndexByCID(t))&&this._setPageInfo(e)},_onContentParseDone:function(){this.isInPageMode()&&this._calcNoteViewFrameHeight()},_onPageBreakInserted:function(){},_onPageBreakPosChanged:function(){},_setPageInfo:function(t,e){var n,o,i,r;if(this.isInPageMode()&&null!=this.blockViews&&0!==this.blockViews.length&&null!=(n=this.blockViews[t])&&null!=n.cid)if(this._setPageInfoInBatch(t),!0===e&&(this._pageBatchTimer=null),this._pageBatchPendingQueue.length>0){if(null==this._pageBatchTimer){for(r=null;null==r&&this._pageBatchPendingQueue.length>0;)i=this._pageBatchPendingQueue.shift(),r=null!=(o=this.blockViews[i.index])&&o.cid===i.cid?i.index:this._getBlockViewIndexByCID(i.cid);y.log("resetPageInfo: startTimer for ",r),null!=r&&(this._pageBatchTimer=setTimeout(this._setPageInfo.bind(this,r,!0),10))}}else this._pageBatchTimer=null,this.note.isParsingData()?this.options.noteviewFrame.height("auto"):this._calcNoteViewFrameHeight()},_setPageInfoInBatch:function(t){var e,n,o,i,r,a,s,l,c=Date.now();if(null!=this.blockViews&&0!==this.blockViews.length&&null!=t&&null!=(o=this.blockViews[t]))for(y.log("Start PageInfoInBatch from:",o,t),e=0===t?0:o.getFirstTransPageIndex();t<this.blockViews.length;){if(o=this.blockViews[t],0===t)s=o.resetPageInfo(0,0),n=0;else{if(null==(n=(i=this.blockViews[t-1]).getLastTransPageIndex()))break;-1===(a=i.getBottomPosInPage(n))&&(a=0),s=o.resetPageInfo(n,a)}if(t++,null!=n&&null!=e&&n-e,!0===s){if(p.isImage(o.block)&&o.isOnFloat()&&(l=n+1),(null==l||l<=n)&&Date.now()-c>100){null!=(r=this.blockViews[t])&&this._pageBatchPendingQueue.push({cid:r.cid,index:t});break}}else if(null==l||l<=n)break}}})}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";o=[n,r,n(3),n(167),n(788),n(221),n(166),n(789),n(222),n(168),n(790),n(64),n(310),n(118),n(73),n(300),n(224)],void 0===(i=function(t,e,n,o,i,r,a,s,l,c,u,d,p,h,f,g,m){var y={};return y[n.ATTACHMENT]=o,y[n.CATALOGUE]=i,y[n.HEADING]=s,y[n.HR]=l,y[n.IMAGE]=c,y[n.LIST_ITEM]=u,y[n.PARAGRAPH]=d,y[n.TABLE]=f,y[n.TODO]=g,y[n.QUOTE]=p,y[n.CODE]=h,y[n.HANDWRITE]=r,y[n.HEADER_FOOTER]=a,y[n.UNKNOWN]=m,y}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";var a,s=this&&this.__extends||(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});o=[n,r,n(3),n(64)],void 0===(i=function(t,e,n,o){return function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.prototype.initialize=function(e){t.prototype.initialize.call(this,e),this.type=n.HEADING},e}(o)}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";var a,s=this&&this.__extends||(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});o=[n,r,n(3),n(64)],void 0===(i=function(t,e,n,o){return function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.prototype.initialize=function(e){t.prototype.initialize.call(this,e),this.type=n.HEADING},e}(o)}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";var a,s=this&&this.__extends||(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});o=[n,r,n(3),n(64)],void 0===(i=function(t,e,n,o){return function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.prototype.initialize=function(e){t.prototype.initialize.call(this,e),this.type=n.LIST_ITEM},e}(o)}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(3),o=n(66),i={};return i[e.ATTACHMENT]=n(793),i[e.CATALOGUE]=n(794),i[e.HANDWRITE]=n(795),i[e.HEADING]=n(796),i[e.HR]=n(797),i[e.IMAGE]=n(798),i[e.LIST_ITEM]=n(802),i[e.PARAGRAPH]=n(104),i[e.TABLE]=n(313),i[e.TODO]=n(838),i[e.QUOTE]=n(839),i[e.CODE]=n(840),i[e.UNKNOWN]=n(842),function(t){var e=i[t];return e||o}}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(29),o=n(7),i=n(19),r=n(2),a=n(8);return e.View.extend({className:"page-break-view",templateName:"page_break_view",PLACEHOLDER_PREFIX:"p_",_$placeholder:null,_$pageBreak:null,_$container:null,_isAtViewBeginning:null,_topBlankHeight:null,_bottomBlankHeight:null,coincide:function(){var t,e,n,o;t=this._getOffsetTopPos(this.getPlaceholder()),e=this.getTopBlankHeight(),n=this.getPageBreak(),o=t+e,r.log("placeHolderTop/pageBreakTop/topBlankHeight:",t,o,this.getTopBlankHeight()),n.offset({top:o}),n.css({"margin-top":-e})},destroy:function(){this._$pageBreak.remove(),this._$placeholder.remove()},getPlaceholder:function(){return this._$placeholder},getPageBreak:function(){return this._$pageBreak},getTopBlankHeight:function(){return this._topBlankHeight},initialize:function(t){var e,n,s,l,c=t.pageIndex;this._topBlankHeight=t.topBlankHeight||0,this._bottomBlankHeight=t.bottomBlankHeight||0,this._$placeholder=t.placeholder||a('<div class="page-break-placeholder"></div>'),this._$pageBreak=a(i.render("common",this.templateName,{})),this._$container=t.container,this._$pageBreak.prepend(t.noteView.createHeaderFooterView(!0).$el),this._$pageBreak.append(t.noteView.createHeaderFooterView(!1).$el),0!==(l=this._$container.find('[data-page-id="'+c+'"]')).length&&l.attr("data-page-cid")===this.cid&&(r.debugAlert("should not create existing pageBreak for same view"),l.remove()),this._topBlankHeight<0&&(r.debugAlert("topBlankHeight should not be less than 0"),this._topBlankHeight=0),this._bottomBlankHeight<0&&(r.debugAlert("bottomBlankHeight should not be less than 0"),this._bottomBlankHeight=0),this._$pageBreak.attr("data-page-id",c),this._$pageBreak.attr("data-page-cid",this.cid),this._$pageBreak.attr("contenteditable","false"),e=this._$pageBreak.find(".bottomSpan"),n=this._$pageBreak.find(".topSpan"),s=this._$pageBreak.find(".middleSpan"),n.outerHeight(o.PAGE_SPLIT_BLANK_HEIGHT),e.outerHeight(o.PAGE_SPLIT_BLANK_HEIGHT),s.outerHeight(o.PAGE_SPLIT_MIDDLE_HEIGHT),this._$pageBreak.appendTo(this._$container),this._$pageBreak.height(n.outerHeight()+s.outerHeight()+e.outerHeight()),this._$placeholder.attr("data-page-id",this.PLACEHOLDER_PREFIX+this._$pageBreak.attr("data-page-id")),this._$placeholder.attr("data-page-cid",this.PLACEHOLDER_PREFIX+this._$pageBreak.attr("data-page-cid")),this._$placeholder.attr("contenteditable","false"),this._$placeholder.height(this._$pageBreak.height()+this._topBlankHeight+this._bottomBlankHeight)},isAtViewBeginning:function(){return!0===this._isAtViewBeginning},setAtViewBeginning:function(t){this._isAtViewBeginning=!0===t},_getOffsetTopPos:function(t){return t.offset().top}})}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){n(307);var e=n(66),o=n(8),i=n(0),r=n(19),a=n(167),s=n(2),l=n(55),c=n(30),u=n(10),d=n(114),p=n(7),h=n(311);return e.extend({className:"block-view attachment-view",DEFAULT_HEIGHT:100,timer:null,events:{"dblclick .attachment-container":"_onImgDblclick","mousemove .attachment-container":"_onMouseMove","mouseout .attachment-container":"_onMouseOut","click .attachment-download":"_onDownloadClick","dragstart .attachment-mask":"_onDragstart","dragend .attachment-mask":"_onDragEnd"},_isFloatSwitch:!1,_viewFrameHeight:null,initialize:function(){e.prototype.initialize.apply(this,arguments),i.bindAll(this,"_onStyleChange","_onContentChange","_onMouseMove","_onMouseOut"),this.block.on("style-change",this._onStyleChange),this.block.on("content-change",i.debounce(this._onContentChange,100)),this.bindSelectionEvents()},render:function(){var t,n,i,a,l,f=this,g=f.block,m=g.getSource(!0),y=g.getFileName(),v=g.getFileLength();u.IS_PC&&(m=d(m)),(u.IS_WEB_NOTE||u.IS_WEB_GROUP)&&!0===g.getFakeLoading()&&(m=p.LOADING_IMAGE_PATH,g.setFakeLoading(!1)),n=(t=h.getFileType(y))?"src--svg--type_"+t+"_large":"src--svg--type_other_large",a=void 0===v?"未知大小":h.getSizeString(v),l=h.splitFileFullName(y),i=r.render("common","attachment-view-attachment-container",{name:n,fileName:l.fileName,fileType:l.fileType,size:a,title:y,draggable:!0}),f.$el.find(".attachment-container").remove(),f.$el.append(i),f._viewFrameHeight=f.$el.outerHeight(!0)-f.$el.height(),f.$el.find(".attachment-container").tooltipster({animation:"",animationDuration:0,theme:["tooltipster-attachment","tooltipster-attachment-customized"],side:"bottom",delay:[800,300],arrow:!1,functionPosition:function(t,e,n){var i,r,a=o(e.tooltipClone);return i=f.mousePosY+a.height()>document.body.clientHeight?f.mousePosY-a.height()+10:f.mousePosY-10,r=f.mousePosX+a.width()>document.body.clientWidth?f.mousePosX-a.width()-10:f.mousePosX+10,n.coord.top=i>0?i:0,n.coord.left=r>0?r:0,n}}),f._renderStyles(),c.isSafari()&&f.$el.find(".attachment-container").attr("contenteditable","true"),e.prototype.render.apply(f,arguments),s.log("Attachment width/height",f.$el.width(),f.$el.height())},_renderStyles:function(){var t=this,e=t.block.getBlockStyles();i.each(e,function(e,n){t._setStyle(n,e)})},_setStyle:function(t,e){var n=this.$el,o=n.find(".attachment-block-container");switch(t){case"align":n.css("text-align",e);break;case"float":n.css("float")!==e?(this._isFloatSwitch=!0,n.css("float",e)):this._isFloatSwitch=!1;break;case"back-color":o.css("background-color",e),e||n.css("margin","");break;case"padding":o.css("padding",e),"0px"===n.css("padding-top")&&n.find(".attachment-block-container").css({"padding-top":"4px","padding-bottom":"4px"})}},_onStyleChange:function(t,e){this._setStyle(t,e),this.trigger("view-height-changed",this.cid)},_onContentChange:function(){this.render(),s.log("redraw attachment"),this.trigger("view-height-changed",this.cid)},getImgElement:function(){return this.$el.find("img").get(0)},getAttachmentContainerElm:function(){return this.$el.find(".attachment-container").get(0)},convertToNativeRange:function(){var t=document.createRange(),e=this.$el.get(0);return t.setStart(e,0),t.setEnd(e,e.childNodes.length),t},parseNativeRange:function(t,e,n){if(n||l.isNodeInRange(this.getAttachmentContainerElm(),t)||l.isRangeInNode(this.el,t)||this._isSelected())return new a({block:e})},_removeFocusedClass:function(){this.$el.removeClass("focused")},_addFocusedClass:function(){this.$el.addClass("focused")},onDrawRange:function(t){var e;t?(this._addFocusedClass(),(e=document.createRange()).selectNodeContents(this.$el.find(".attachment-container")[0]),l.setRange(e,window)):(this._removeFocusedClass(),this.selectAttachment())},_onImgDblclick:function(){var t=this.block.getResource(),e=this.block.getFileName();u.IS_PC&&this.trigger("yne-open-attachment",t,e),u.IS_MAC&&this.trigger("yne-mac-preview",t,e)},_onDownloadClick:function(){var t=this.block,e=t.getResource(),n=t.getFileName();(u.IS_WEB_GROUP||u.IS_WEB_NOTE||u.IS_MAC||u.IS_PC)&&this.trigger("yne-download-attachment",e,n)},_onDragstart:function(){this.$el.find(".attachment-mask").css("opacity",1)},_onDragEnd:function(){this.$el.find(".attachment-mask").css("opacity",0)},_isSelected:function(){return this.$el.find(".attachment-container").hasClass("selected")},selectAttachment:function(t){t?this.$el.find(".attachment-container").addClass("selected"):this.$el.find(".attachment-container").removeClass("selected")},disablePageMode:function(){e.prototype.disablePageMode.apply(this),this.$el.css("max-height","none")},_isPagingContinue:function(){return this._isFloatSwitch},_setViewMaxHeight:function(t){var e,n=this._pageInfo[t-1],o=0,i=this._getTopPosInPage(t);n&&(o=this._getPageBreakBottomPosInView(t-1)),(e=this.PAGE_HEIGHT+o-this._viewFrameHeight-i)<p.PAGE_SPLIT_BLANK_HEIGHT/2&&(e=p.PAGE_SPLIT_BLANK_HEIGHT/2),this.$el.css("max-height",e),s.log("Attachment max-height",this.$el.css("max-height"))},_onMouseMove:function(t){var e=this;clearTimeout(e.timer),e.timer=setTimeout(function(){e.mousePosX=t.originalEvent.x||t.originalEvent.layerX||0,e.mousePosY=t.originalEvent.y||t.originalEvent.layerY||0},200)},_onMouseOut:function(){clearTimeout(this.timer)}})}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(8),o=n(19),i=n(7),r=n(43),a=n(104),s=n(64),l=n(53),c=n(164),u=n(32),d=n(51),p=n(121),h=a.extend({className:"block-view catalogue-view",events:{"click a":"_onAnchorClick"},_forcePageBreakBegin:!0,initialize:function(){a.prototype.initialize.apply(this,arguments);var t=this,e=t.block;e.on("sorting-change",function(){t._renderSorting()}),e.on("focus",t.focus.bind(t)),e.on("blur",t.blur.bind(t))},_renderTemplate:function(){this.$el.html(o.render("common","catalogue_view",{isFirst:this.block.isFirst()}))},_renderText:function(){var t,n=this.block.getReadOnlyText(),o=this._inlineStyleViewMapper,i=this.$el.find(".para-text"),a=e("<a></a>");t=l.rich2html(n,{styleRules:{color:function(t){var e=t.color;return t.href!==u.getDefault("href")&&r.equals(t.color,"blue")?"#003884":null!=e&&o?o.valueToView("color-catalogue",e):void 0},"font-family":function(t){var e,n=t["font-family"];return null!=n&&o&&(e=o.valueToView("font-family",n)),n!==e?e:d.getAllValueByFont(n)||n}}}),a.html(t),i.html(a),this._renderSorting(),this._addLinkMenu()},_onAnchorClick:function(t){var e=this.block.getHref();t.stopPropagation(),c.test(e)?this.trigger("open-link",e):this.trigger("inner-goto",e)},_addLinkMenu:function(){var t,e=this,n=e.block,o=e.$el.find("a");o.off("hover"),o.hover(function(){p.isNoteLinkUrl(n.getHref())||e.isCollabLocked()||(t=new s({start:0,end:n.getLength(),block:n}),e.trigger("link-menu-show",{linkNode:o[0],href:n.getViewHref(),range:t,block:n}))},function(){e.trigger("link-menu-hide")})},_renderSorting:function(){this._renderFirst(),this._renderLast()},_renderFirst:function(){var t,e,n=this,o=n.block,i=n.$el;if(!o.isFirst())return i.removeClass("catalogue-first");i.addClass("catalogue-first"),t=i.find(".catalogue-refresh"),e=i.find(".catalogue-delete"),t.off("click"),e.off("click"),t.on("click",function(){n.trigger("command","comp.RefreshCatalogue",{ownerId:o.getOwnerId()})}),e.on("click",function(){n.trigger("command","comp.RefreshCatalogue",{ownerId:o.getOwnerId(),delete:!0})})},_renderLast:function(){if(!this.block.isLast())return this.$el.removeClass("catalogue-last");this.$el.addClass("catalogue-last")},_setStyle:function(t,e){var n=this.$el,o=n.find(".para-text"),r=this.block;switch(t){case"indent":e=(e=r.getBlockStyle("text-indent")+e)>0?e:0,o.css("text-indent",e*i.INDENT_WIDTH||"");break;case"text-indent":e=(e=r.getBlockStyle("indent")+e)>0?e:0,o.css("text-indent",e*i.INDENT_WIDTH||"");break;case"href":n.find("a").attr("href",r.getViewHref());break;case"back-color":n.css("background-color",e);break;case"padding":n.css("padding",e),n.css("padding-top","0px");break;default:a.prototype._setStyle.call(this,t,e)}},_onLockedChange:function(t){var e=this.block.getOwnerList();a.prototype._onLockedChange.call(this,t),e.updateLockState(this.isLocked())},getOwnerId:function(){return this.block.getOwnerId()},selectCatalogue:function(t){var e=this.block;t?e.trigger("select"):e.trigger("remove-select")},focus:function(){this.$el.addClass("catalogue-focus")},blur:function(){this.$el.removeClass("catalogue-focus")},_getHeightInPage:function(t){var e=h.__super__._getHeightInPage.apply(this,[t]),n=parseInt(this.$el.css("marginTop")),o=parseInt(this.$el.css("marginBottom"));return isNaN(n)||(e+=n),isNaN(o)||(e+=o),e}});return h}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";var a,s=this&&this.__extends||(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});o=[n,r,n(66),n(19),n(10),n(221),n(55),n(30)],void 0===(i=function(t,e,n,o,i,r,a,l){var c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.prototype.initialize=function(e){t.prototype.initialize.call(this,e),this._viewProps={block:e.block},this.bindSelectionEvents()},e.prototype.convertToNativeRange=function(){var t=document.createRange(),e=this.$el.get(0);return t.setStart(e,0),t.setStart(e,e.childNodes.length),t},e.prototype.getImgElement=function(){return this.$el.find("img").get(0)},e.prototype.onDrawRange=function(t){var e;if(t){if(this._addFocusedClass(),e=document.createRange(),!this.$el.children(".handwrite-copy-hack")[0])return;e.selectNodeContents(this.$el.children(".handwrite-copy-hack")[0]),a.setRange(e,window)}else this._removeFocusedClass(),this.selectHandWrite(!1)},e.prototype.parseNativeRange=function(t,e,n){if(n||this._isHandWriteInNativeRange(t)||this._isNativeRangeInHandWriteView(t)||this._isSelected())return new r({block:e})},e.prototype.selectHandWrite=function(t){t?this.$el.find(".attachment-container").addClass("selected"):this.$el.find(".attachment-container").removeClass("selected")},e.prototype.render=function(){var e,n;t.prototype.render.call(this),n=this.block.getSource(i.IS_PC),e=o.render("common","handwrite-view-container",{src:n,needCopyHack:i.IS_MAC||l.isSafari()}),this.$el.html(e)},e.prototype._addFocusedClass=function(){this.$el.addClass("focused")},e.prototype._isHandWriteInNativeRange=function(t){var e,n=this.getImgElement(),o=window.Range;return(e=n.ownerDocument.createRange()).selectNode(n),t.compareBoundaryPoints(o.START_TO_START,e)<1&&t.compareBoundaryPoints(o.END_TO_END,e)>-1},e.prototype._isNativeRangeInHandWriteView=function(t){var e,n=this.el;return 3===(e=t.commonAncestorContainer).nodeType&&(e=e.parentNode),!(e!==n&&!$.contains(n,e))},e.prototype._isSelected=function(){return this.$el.find(".attachment-container").hasClass("selected")},e.prototype._removeFocusedClass=function(){this.$el.removeClass("focused")},e}(n);return delete c.prototype.constructor,c.prototype.className="block-view handwrite-view",n.extend(c.prototype)}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(104);return e.extend({initialize:function(){e.prototype.initialize.apply(this,arguments)},className:"block-view heading-view",_renderText:function(){this.$el.find(".para-text").attr("id",this.block.getId()),e.prototype._renderText.apply(this)}})}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(0),o=n(66),i=n(222);return o.extend({className:"block-view hr-view",initialize:function(){o.prototype.initialize.apply(this,arguments),e.bindAll(this,"_onStyleChange"),this.block.on("style-change",this._onStyleChange)},render:function(){var t=this.block,e=t.getBlockStyle("width"),n=t.getBlockStyle("height");this.$el.html('<div class="hr-container"></div>').css({"text-align":t.getBlockStyle("align")}).find(".hr-container").css({width:e+"%",height:n,backgroundColor:t.getBlockStyle("color")}),o.prototype.render.apply(this,arguments),this._renderStyles()},_renderStyles:function(){var t=this,n=t.block.getBlockStyles();e.each(n,function(e,n){t._setStyle(n,e)})},_setStyle:function(t,e){var n=this.$el;switch(t){case"back-color":n.css("background-color",e);break;case"padding":e?(n.css({padding:e,margin:"0 20px"}),"0px"===n.css("padding-top")&&n.css({"padding-top":"4px","padding-bottom":"4px"})):n.css({padding:e})}},_onStyleChange:function(t,e){this._setStyle(t,e)},convertToNativeRange:function(){var t=document.createRange(),e=this.$el.get(0);return t.setStart(e,0),t.setEnd(e,e.childNodes.length),t},parseNativeRange:function(t,e,n){if(n||this._isHrInNativeRange(t))return new i({block:e})},_isHrInNativeRange:function(t){var e,n=this.$el.find(".hr-container").get(0);return(e=n.ownerDocument.createRange()).selectNode(n),t.compareBoundaryPoints(Range.START_TO_START,e)<1&&t.compareBoundaryPoints(Range.END_TO_END,e)>-1}})}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(66),o=n(8),i=n(0),r=n(19),a=n(168),s=n(2),l=n(799),c=n(55),u=n(30),d=n(114),p=n(312),h=n(230),f=n(10),g=n(160),m=n(800),y=n(7),v=n(801);return e.extend({className:"block-view image-view",DEFAULT_HEIGHT:100,_isFloatSwitch:!1,_isImgError:!1,_$imgDiv:null,_$imgContainerDiv:null,_$imgTitle:null,_viewFrameHeight:null,_isImgLoaded:null,events:{contextmenu:"_onContextMenu","mousedown .resize-handle":"_onMouseDownResizeHandle","mousedown img":"_onMouseDownImgPreview",mouseenter:"_onMouseEnter",mouseleave:"_onMouseLeave","mouseleave .menu-wrapper":"_onMouseLeaveMenuWrapper","click .yne-button-item":"_onButtonItemClick","click .yne-popup-item":"_onPopupMenuItemClick","dblclick img":"_onImgDblclick","click img":"_onImgClick","mousedown .image-title":"_onMouseDownImageTitleHandle"},_imageResizeStartInfo:null,_imageResizeEventNS:null,_imgHeightInData:null,_imgWidthInData:null,_imgHeightBeforeLoad:null,_imgLoadWidth:null,_disableOCR:null,_OCRHighlightInfo:null,_OCRHighlightItem:null,initialize:function(t){var n=this;e.prototype.initialize.apply(n,[t]),n._imageResizeEventNS=".img-resize-"+i.uniqueId(),i.bindAll(n,"_onStyleChange","_onContentChange","_onChangeImageTitle","_onUpdateImageTitle","_editImgTitle","_handlerImgTitle","_onWinResize","_onHighlight","_onHideImageTitle"),n.block.on("edit-image-title",n._editImgTitle),n.block.on("style-change",n._onStyleChange),n.block.on("content-change",n._onContentChange),n.block.on("extra-info-change",n._onContentChange),n.block.on("view-resize",n._onWinResize),n.block.on("high-light",n._onHighlight),n.block.on("hide-image-title",n._onHideImageTitle),n.bindSelectionEvents(),n.on("resize",n._onWinResize),n.on("locked-change",function(){n.isLocked()&&(n.trigger("img-title-edit-exit"),n._removeFocusedClass())}),n._disableOCR=!!t.disableOCR||!f.IS_PC,n._OCRHighlightItem=[],n._OCRHighlightInfo=null},render:function(){var t=this.block,e=t.getSource(!0),n="";this.renderImageSource(e),g.isNoteImageSource(e)||(t.getResId()===t.getSource()&&(n=t.getResId()),this.trigger("replace-img-url",{resId:n,url:e,blockId:t.blockId}))},updateRenderedSource:function(t){f.IS_PC&&(t=d(t)),/^\//.test(t)&&!f.IS_MAC&&(t=window.location.origin+t),this._$imgDiv.attr("src",h.getURL(p.addIfNeeded(t))),this._$imgDiv.show()},rotateImage:function(t){this._$imgDiv=this.$el.find("img"),this._$imgDiv.css({transform:m.orentationMap[t.Orientation]||""})},renderImageSource:function(t){var n,o,i=this,r=i.block,a=r.getImageInfo(),s=null,l=r.getTitle(),c=t;a&&(t="/yws/res/thumb/"+a.resId,a.rawWide<=620?(s=a.rawWide,a.rawHeight):s=620),i._imgLoadWidth=s,f.IS_PC&&(t=d(t)),(f.IS_WEB_NOTE||f.IS_WEB_GROUP)&&!0===r.getFakeLoading()&&(t=y.LOADING_IMAGE_PATH,r.setFakeLoading(!1)),i._renderWithLoadedImage(t),i._isImgLoaded=!1,i._$imgContainerDiv=i.$el.find(".image-container"),i._$imgDiv=i.$el.find("img"),i._$imgTitle=i.$el.find(".image-title"),i._viewFrameHeight=i.$el.outerHeight(!0)-i.$el.height(),i._imgHeightInData=r.getBlockStyle("height",!0),i._imgWidthInData=r.getBlockStyle("width",!0),i._imgHeightBeforeLoad=i._$imgDiv.height(),n=i._imgWidthInData<=10||!i._imgWidthInData?620:i._imgWidthInData,o=i._imgHeightInData?i._imgHeightInData:6*i._imgWidthInData/8,i._$imgContainerDiv.css({width:n+"px",height:o+"px",background:"#F5F6F7"}),i._$imgDiv.load(function(){i.$el.hasClass("focused")&&i._onUpdateImageTitle(!0),i._$imgContainerDiv.css({width:"inherit",height:"inherit",background:"transparent"}),i._onImgLoaded()}),i._$imgDiv.error(function(){i._renderWithLoadedImage(null,!0)}),/^\//.test(t)&&!f.IS_MAC&&(t=window.location.origin+t),i._$imgDiv.attr("src",h.getURL(p.addIfNeeded(t))),i._renderStyles(),u.isSafari()&&i._$imgContainerDiv.attr("contenteditable","true"),e.prototype.render.apply(i,arguments),i.title=l,i._$imgTitle&&(l?i._$imgTitle.text(l):i._$imgTitle.hide()),(f.IS_WEB_NOTE||f.IS_WEB_GROUP)&&i._loadOriginImg(c)},_renderWithLoadedImage:function(t,e){var n,o,a,s=this.block.getImageInfo();s&&(s.rawWide<=620?(o=s.rawWide,a=s.rawHeight):o=620),this._imgLoadWidth=o,n=r.render("common","image-view-image-container",{randomId:i.uniqueId("img-view"),width:o,height:a,src:t,isImgError:e,hasOCR:!this._disableOCR,needCopyHack:f.IS_MAC||u.isSafari()}),this.$el.html(n)},_renderStyles:function(){var t=this,e=t.block.getBlockStyles();i.each(e,function(e,n){t._setStyle(n,e)})},_setStyle:function(t,e){var n,i=this.$el,r=i.find(".image-block-container"),a=r.find(".image-container"),l=o("body").find(".image-title-hidden");switch("100%"===e&&a.css("display","block"),t){case"align":i.css("text-align",e),l.length&&l.css("text-align",e);break;case"width":n=this.getImgElement(),null==e&&null==this._imgLoadWidth?o(n).css("width",""):null==e&&this._imgLoadWidth?o(n).css("width",this._imgLoadWidth):this._setImageWidth(e);break;case"float":i.css("float")!==e?(this._isFloatSwitch=!0,i.css("float",e)):this._isFloatSwitch=!1,!1===this.isOnFloat()&&this._resetImageMaxWidth();break;case"height":break;case"back-color":r.css("background-color",e),e?i.css({"padding-top":0,"padding-bottom":0}):i.css({"padding-top":"","padding-bottom":""});break;case"padding":r.css("padding",e),"0px"===r.css("padding-top")&&r.css({"padding-top":"4px","padding-bottom":"4px"});break;default:s.error("unkown style name:",t)}},_onStyleChange:function(t,e){this._setStyle(t,e),this.trigger("view-height-changed",this.cid)},_onContentChange:function(){var t=this.block,e=this.$el,n=t.getTitle(),o=t.getSource(!0);f.IS_PC&&(o=d(o)),o=h.getURL(p.addIfNeeded(o)),e.find("img").attr("src",o),this._$imgTitle&&(this._$imgTitle.text(n),this.title=n,this._handlerImgTitle(),this.trigger("img-title-edit-exit"),this.trigger("view-height-changed",this.cid))},getImgElement:function(){return this.$el.find("img").get(0)},convertToNativeRange:function(){var t=document.createRange(),e=this.$el.get(0);return t.setStart(e,0),t.setEnd(e,e.childNodes.length),t},parseNativeRange:function(t,e,n){if(n||c.isNodeInRange(this.getImgElement(),t)||c.isRangeInNode(this.el,t))return new a({block:e})},_showButtonGroup:function(){this._hidePopupMenu(),l.adjustMenu(this.$el)},_hideButtonGroup:function(){this.$el.find(".menu-wrapper").hide(),this._hidePopupMenu()},_onButtonItemClick:function(t){var e=t.currentTarget.dataset.buttonName;if(!this.isLocked())switch(e){case"menu":default:this._togglePopupMenu()}},_togglePopupMenu:function(){var t,e,n,o,i=this.$el.find(".yne-popup-menu");i.toggle(),i.is(":visible")?(t=this.$el.find(".yne-button-group").outerHeight(),n=(e=i.get(0).getBoundingClientRect()).top+(o=e.height)>document.documentElement.clientHeight?-(o+5):t+5,i.css({top:n+"px"})):i.css({top:""})},_hidePopupMenu:function(){var t=this.$el.find(".yne-popup-menu");t.hide(),t.css({top:""})},_onContextMenu:function(t){t.preventDefault(),t.stopPropagation(),this._isReadOnly||this._isImgError||this.trigger("contextmenu",t)},_onMouseEnter:function(){var t=this.block;this.isLocked()||t.isReadOnly()||this._showButtonGroup()},_onMouseLeave:function(){this.isLocked()||this._hideButtonGroup()},_onMouseLeaveMenuWrapper:function(){this.isLocked()||this._hidePopupMenu()},_onPopupMenuItemClick:function(t){var e=t.currentTarget,n=o(e).attr("data-cm-name"),r={},a=this.block;if(!this.isLocked()&&!a.isReadOnly()){switch(this._hidePopupMenu(),n){case"image-title":this._editImgTitle();break;case"float-left":case"float-right":case"clear-float":r.float="float-left"===n?"left":"float-right"===n?"right":"none";break;case"clear-resize":r.width=null;break;case"delete":this.trigger("command","comp.DeleteNoteRange",{range:null,imageBlockView:this});break;case"download":this.trigger("yne-download-image",a.getSource(!0));break;case"image-ocr":this.trigger("yne-image-ocr",v(a))}i.isEmpty(r)||this.trigger("command","comp.ApplyStyles",{range:null,imageBlockView:this,blockStyles:r})}},_removeFocusedClass:function(){!this.$el.hasClass("focused")||this.isLocked()||this.block.isReadOnly()||(this.trigger("img-title-edit-end"),this.trigger("img-title-edit-exit"),this._handlerImgTitle()),this.$el.removeClass("focused")},_onUpdateImageTitle:function(t){var e=this,n=function(){if(e._$imgTitle){var t=e._$imgTitle.offset();return{left:t.left,top:t.top,width:e.$el.width(),height:e._$imgTitle.height(),textAlign:e.block.getStyles("align")}}};e.isLocked()||e.block.isReadOnly()||(t?e.trigger("img-title-edit-update",n):e.$el.hasClass("focused")||e.trigger("img-title-edit-start",e.block.getTitle(),n,e._onChangeImageTitle,e._$imgTitle,e.block.getId()))},_addFocusedClass:function(){this._onUpdateImageTitle(),this.$el.addClass("focused")},_drawNativeRange:function(){var t=document.createRange(),e=this.getImgElement();t.selectNode(e),t.collapse(!0),c.setRange(t)},onDrawRange:function(t){var e;t&&!this.isLocked()?(this._addFocusedClass(),(e=document.createRange()).selectNode(this.$el.find(".image-container")[0]),c.setRange(e,window)):this._removeFocusedClass()},_onMouseDownResizeHandle:function(t){var e,n,i=this.getImgElement(),r=t.pageX,a=t.pageY,s={centerX:0,centerY:0,startWidth:0,startHeight:0,startToCenter:0},l=this.block;this.isLocked()||l.isReadOnly()||i&&(e=o(i),s.startWidth=e.width(),s.startHeight=e.height(),n=e.offset(),s.centerX=n.left+s.startWidth/2,s.centerY=n.top+s.startHeight/2,s.startToCenter=Math.sqrt(Math.pow(s.centerX-r,2)+Math.pow(s.centerY-a,2)),this._imageResizeStartInfo=s,this._bindEventsForResize(),t.preventDefault(),this.$el.css("height",this.$el.height()))},_bindEventsForResize:function(){var t=this.el.ownerDocument,e=this._imageResizeEventNS;this._unbindEventsForResize(),o(t).bind("mousemove"+e,this._onResizeMove.bind(this)).bind("mouseup"+e,this._onResizeEnd.bind(this))},_unbindEventsForResize:function(){var t=this.el.ownerDocument;o(t).unbind(this._imageResizeEventNS)},_onResizeMove:function(t){this._handleImageResize(t.pageX,t.pageY)},_onResizeEnd:function(t){this.$el.css("height","auto"),this._unbindEventsForResize(),this._handleImageResize(t.pageX,t.pageY,!0)},_handleImageResize:function(t,e,n){var o,i,r=this._imageResizeStartInfo,a={};r&&(i=(o=Math.sqrt(Math.pow(r.centerX-t,2)+Math.pow(r.centerY-e,2)))*r.startWidth/r.startToCenter,o*r.startHeight/r.startToCenter,this.getImgElement()?(this._setImageWidth(i),!0===n?(a.width=this._$imgDiv.width(),a.height=this._$imgDiv.height(),this.trigger("command","comp.ApplyStyles",{range:null,imageBlockView:this,blockStyles:a})):this._onUpdateImageTitle(!0)):s.warn("no image element!"))},_onImgDblclick:function(){var t=this.block.getSource(!0);f.IS_PC&&this.trigger("yne-open-image",t)},_onImgClick:function(t){this.trigger("img-title-edit-end"),(f.IS_WEB_GROUP||f.IS_WEB_NOTE||f.IS_MAC)&&(this.showImgPreview||this.isLocked()||this.block.isReadOnly())&&this.trigger("get-image-items",this.block),t.preventDefault(),t.stopPropagation()},_onMouseDownImgPreview:function(){this.showImgPreview=this.$el.hasClass("focused")},_onChangeImageTitle:function(t,e,n,o){var r=this.block,a=[],s=[],l={};return t!==r.getTitle()&&(a.push({source:r.getSource(),title:t}),s.push(r),i.extend(l,{resources:s,resProps:a}),e&&i.extend(l,{endingRange:n}),this.trigger("command","comp.ReplaceResource",l)),!t&&o&&this._$imgTitle.hide(),!0},_onMouseDownImageTitleHandle:function(t){t.preventDefault()},onDestroy:function(){this.trigger("img-title-edit-exit")},_onWinResize:function(){this.$el.hasClass("focused")&&this._onUpdateImageTitle(!0)},_onHighlight:function(t,e,n){var o=this.block.getHighlight(t,e);o&&this._convertToData(o,n)},_convertToData:function(t,e){var n=this;if(n._$imgTitle){var o,r=n._$imgTitle.get(0).firstChild;n._OCRHighlightInfo=null,i.each(t,function(t){null==t.imageInfo?((o=document.createRange()).setStart(r,t.start),o.setEnd(r,t.end),e(o)):n._OCRHighlightInfo=t.imageInfo}),n._createHighlightMark()}},_editImgTitle:function(){var t=this;setTimeout(function(){t._$imgTitle.show(),t._onUpdateImageTitle(!0),t.trigger("img-title-edit-focus")},0)},_onHideImageTitle:function(){this.trigger("img-title-edit-exit")},_handlerImgTitle:function(){this.title?this._$imgTitle.show():this._$imgTitle.hide()},clearHighlight:function(){this._OCRHighlightInfo=null,this._clearHighlightMark()},_clearHighlightMark:function(){i.each(this._OCRHighlightItem,function(t){t.remove()}),this._OCRHighlightItem=[]},disablePageMode:function(){e.prototype.disablePageMode.apply(this),this.$el.hasClass("focused")&&this._onUpdateImageTitle(!0),this.$el.css("max-height","none"),this._resetImageMaxWidth()},_contentHeightOverflowCheck:function(){var t,e,n,o,i=this._$imgTitle.height(),r=0,a=this._$imgDiv.height();return this._isInPageMode()?(null!=(t=this.getLastTransPageIndex())&&(e=this._getTopPosInPage(t),a=Math.ceil(a),r=Math.ceil(e+a+i+this._viewFrameHeight)-this.PAGE_HEIGHT),r>0&&((n=this._$imgDiv.height()-r)<y.PAGE_SPLIT_BLANK_HEIGHT/2&&(n=y.PAGE_SPLIT_BLANK_HEIGHT/2),o=this._$imgDiv.width()*n/this._$imgDiv.height(),this._$imgDiv.css("max-width",o)),r):r},_isPagingContinue:function(){return this._isFloatSwitch},_onImgLoaded:function(){var t;this._isImgLoaded=!0,this.$el.height("auto"),this._$imgDiv.height("auto"),t=this._$imgDiv.height(),this._imgHeightInData!==t||null==this._imgWidthInData?(this.block.setStyles("height",t),/^-?\d+%$/.test(this._imgWidthInData)?this.block.setStyles("width",this._imgWidthInData):this.block.setStyles("width",this._$imgDiv.width()),this._imgHeightInData=t):this._imgHeightBeforeLoad!==t?this.trigger("view-height-changed",this.cid):s.log("No height change after image loaded",this),this._createHighlightMark()},_createHighlightMark:function(){var t=this,e=t._OCRHighlightInfo;if(t._clearHighlightMark(),null!=e){var n=t._$imgContainerDiv.width()/e.width;i.each(e.pos,function(e){var i=o(r.render("common","high_light_item",{top:e.top*n-1,left:e.left*n-2,height:(e.bottom-e.top)*n,width:(e.right-e.left)*n}));i.appendTo(t._$imgContainerDiv),t._OCRHighlightItem.push(i)})}},_resetImageMaxWidth:function(){null!=this._$imgDiv&&this._$imgDiv.css("max-width","")},_setImageWidth:function(t){null!=t&&(/^-?\d+%$/.test(t)||(this._$imgContainerDiv.css("display","inline-block"),t=Math.ceil(t)),this._$imgDiv.width(t),this._resetImageMaxWidth(),null!=this._imgHeightInData&&!1===this._isImgLoaded&&this._$imgDiv.height(Math.ceil(this._imgHeightInData*this._$imgDiv.width()/t)))},_setViewMaxHeight:function(t){var e=this._pageInfo[t-1],n=0,o=this._getTopPosInPage(t);e&&(n=this._getPageBreakBottomPosInView(t-1)),this.$el.css("max-height",this.PAGE_HEIGHT+n-this._viewFrameHeight-o),this._contentHeightOverflowCheck()},_loadOriginImg:function(t){var e=this;t=h.getURL(p.addIfNeeded(t)),o("<img />").attr("src",t).load(function(){e._$imgDiv.attr("src",t),e._$imgDiv.removeClass("filter-blur")}).error(function(){e._$imgDiv.unbind("error")}),e._$imgDiv.error(function(){e._$imgDiv.attr("src",t),e._$imgDiv.removeClass("filter-blur")})}})}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(8);return{adjustMenu:function(t){var n=t.find(".menu-wrapper"),o=n.width(),i=e(t.children()[0]),r=t.offsetParent().width(),a=i.position().left;a<o&&i.width()<o?n.addClass("menu-wrapper-left"):n.removeClass("menu-wrapper-left"),r-a-i.width()<o?i.width()<o?(n.addClass("menu-wrapper-mini"),n.removeClass("menu-wrapper-right")):(n.addClass("menu-wrapper-right"),n.removeClass("menu-wrapper-mini")):(n.removeClass("menu-wrapper-mini"),n.removeClass("menu-wrapper-right")),n.show()}}}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.orentationMap={1:"",2:"scale(-1, 1)",3:"rotate(180deg)",4:"scale(-1, 1) rotate(180deg)",5:"scale(-1, 1) rotate(90deg) translateZ(0)",6:"rotate(90deg) translateZ(0)",7:"scale(-1, 1) rotate(270deg) translateZ(0)",8:"rotate(270deg) translateZ(0)"}}.apply(i,[n,i]))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t,e){return function(t){var e=t.getSource();if(e.startsWith("http")){var n=e.split("/");n.length>=2&&(e=n[n.length-2])}return e}}.apply(i,[n,i]))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(0),o=n(104),i=n(19),r=n(217);return o.extend({className:"block-view list-item-view paragraph-view",_template:i.getTemplate("common","list_item_view"),_styleSheet:null,initialize:function(){o.prototype.initialize.apply(this,arguments),this._initEvents()},_initEvents:function(){var t=this.block,n=t.getOwnerList();if(!n)throw"no ownerList!";e.bindAll(this,"_onLevelChange","_onIndexChange","_onTypeChange","_onStyleChange"),t.on("level-change",this._onLevelChange),t.on("index-change",this._onIndexChange),n.on("type-change",this._onTypeChange),t.on("style-change",this._onStyleChange)},_renderLevel:function(){var t=this.block,e=t.getLevel(),n=this.$el.find(".li-box"),o=r.makeHtmlMarker(t);n.attr("data-level",e),o&&o.listStyleType&&n.attr("data-style-type",o.listStyleType)},_renderText:function(){o.prototype._renderText.apply(this,arguments),this._renderMarkerText(),this._renderBlockstyles()},_renderMarkerText:function(){var t,e=this,n=e.block.getText(),o=e.$el.find("li");o.attr("style",""),n.getLength()?t=r.convertToCssStyle(n.getStylesAtIndex(0),e._inlineStyleViewMapper):e.trigger("get-editing-styles",function(n){t=r.convertToCssStyle(n,e._inlineStyleViewMapper)}),t&&o.css(t)},_renderIndex:function(){var t=this.block;this.$el.find(".li-box").attr("start",t.getIndex())},_setContainerStyles:function(){var t=this,n=t.block.getBlockStyles();e.each(n,function(e,n){t._setContainerStyle(n,e)})},_setContainerStyle:function(t,e){var n=this.$el.find(".li-box");switch(t){case"back-color":n.parent().css("background-color",e);break;case"padding":n.css("padding",e)}},render:function(){o.prototype.render.apply(this,arguments),this._renderLevel(),this._renderIndex(),this._setContainerStyles(),this.trigger("view-height-changed",this.cid)},_renderTemplate:function(){var t=this.block;this.$el.html(this._template({isOrdered:t.isOrdered()}))},_onLevelChange:function(){this._renderLevel(),this._renderIndex(),this.trigger("view-height-changed",this.cid)},_onIndexChange:function(){this._renderIndex(),this.trigger("view-height-changed",this.cid)},_onTypeChange:function(){this.block.setLocked(!1),this.render()},_onStyleChange:function(t,e){var n=this.$el.find("li");switch(o.prototype._onStyleChange.apply(this,arguments),this._setContainerStyle(t,e),t){case"align":n.css("text-align",e);break;case"line-height":n.css("line-height",e)}},_renderBlockstyles:function(){var t=this.$el.find("li"),e=this.block.getBlockStyle("align"),n=this.block.getBlockStyle("line-height");e&&t.css("text-align",e),n&&t.css("line-height",n)},_onContentChange:function(){0===this.$el.find(".para-text").length&&this.render(),this._renderText(),this.trigger("view-height-changed",this.cid)},_getContentContainer:function(){return this.$el.find(".li-box")}})}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(71);return function(t,n){if(e.isNode(t)){if(n=!1!==n,t.removeNode&&n)return t.removeNode(t,n);if(t.parentNode&&t.parentNode.removeChild){if(!n)for(;t.firstChild;)t.parentNode.insertBefore(t.firstChild,t);return t.parentNode.removeChild(t)}}}}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(29),o=n(223);return e.View.extend({tagName:"div",className:"selection-layer",initialize:function(t){var e=t.tableView;this._tableView=e},render:function(){this.$el.attr("contenteditable","false")},hide:function(){this.$el.hide()},_computeViewRect:function(t){if(t){var e,n,i,r,a=this._tableView,s=t.getAsRectRange();if(s&&(e=s.getFirstCell(),n=s.getLastCell(),e&&e.cell&&n&&n.cell))return i=a.getBoundingRectByCell(e.cell),r=a.getBoundingRectByCell(n.cell),o.union(i,r)}},draw:function(t){var e=this._computeViewRect(t);e&&e.width>0&&e.height>0?this.$el.css({top:e.top,left:e.left,width:e.width,height:e.height}).show():this.$el.hide()}})}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e,o=n(29),i=n(8),r=n(2),a=n(0),s=n(98),l=n(176),c=n(50),u=n(6),d=n(806),p=n(99),h=n(271),f=n(12),g=n(132),m=n(71),y=n(807),v=n(55),_=n(75),b=n(287),C=n(51),k=n(43),w=n(19),S=n(815),x=n(233),E=n(816),I=n(817),T=n(206),O=n(134);return n(818),e=o.View.extend({tagName:"div",className:"cell-edit",_editBox:null,_changeMonitor:null,_isDirty:!1,_editingCellId:null,_rangeWhenBlur:null,_editingInlineStates:null,events:{contextmenu:"_onPreventAndStop",mousedown:"_onStopPropagation",copy:"_onStopPropagation",cut:"_onStopPropagation",paste:"_onPaste",dblclick:"_onDblclick"},_onPreventAndStop:function(t){t.preventDefault(),t.stopPropagation()},_onStopPropagation:function(t){t.stopPropagation()},initialize:function(t){this._table=t.table,this._tableView=t.tableView,this._styleRules=t.styleRules,this._mapper=t.mapper,this._isRendered=!1,this._commander=y({editHost:this}),this._uid=a.unique("cell-edit-view-"),this._eventNS="."+this._uid,delete this.options},render:function(){var t=w.render("common","table_cell_edit",{}),e=this.el;!0!==this._isRendered&&(this._isRendered=!0,e.innerHTML=t,this._editBox=e.querySelector(".cell-edit-box"),this._initEvents())},_initEvents:function(){var t=this._editBox;c.addListeners({focus:"_onFocus",blur:"_onBlur",textInput:"_onTextInput",compositionstart:"_onCompositionStart",compositionend:"_onCompositionEnd",click:"_onClick"},i(t),this),this._initKeyHandlerManager(),this._changeMonitor=d.create({el:t}),c.addListeners({"content-change":"_onContentChange"},this._changeMonitor,this),this._history=I.create(),c.addListeners({undo:"_onHistoryUndo",redo:"_onHistoryRedo",change:"_onHistoryChange"},this._history,this)},_bindKey:function(t){var e=this,n=e._keyMonitor;t&&(n||(e._keyMonitor=n=new l({el:e._editBox,beforeMatch:function(t){t.stopPropagation()}})),n.unbind(t),n.bind(t,function(n){e._keyHandlerManager&&e._keyHandlerManager.execWithKey(t,e,n)}))},_unbindKey:function(t){var e=this._keyMonitor;e&&t&&e.unbind(t)},_initKeyHandlerManager:function(){var t=new u({scope:"table-cell-edit"}),e=t.getAvailableHandlerNames();t.on("bind-key",this._bindKey.bind(this)),t.on("unbind-key",this._unbindKey.bind(this)),a.each(e,function(e){t.bind(e)}),this._keyHandlerManager=t},blur:function(){this._editBox.blur()},_onBlur:function(){this._isOnToolbarLinkView()?this._rangeWhenBlur=this.getNativeRange():(this.trigger("blur"),this._commitChange())},_onFocus:function(){r.log("on focus")},_recognizeLink:function(t){var e,n,o=this.getNativeRange(),i=this.getEditBox(),r=x.getUrlInfoBeforeRange(o,i)||{};if((this._compositionStartUriInfo||{}).alreadyUrl||r.alreadyUrl)return t.preventDefault(),(n=document.createElement("div")).innerHTML=t.data,e=_.create({name:"insertHTML",value:"<span></span>"+n.innerText,isNative:!0}),void this.execCommand(e);r.startNode&&(" "!==t.data||r.alreadyUrl||(t.preventDefault(),(o=document.createRange()).setStart(r.startNode,r.startOffset),o.setEnd(r.endNode,r.endOffset),this.setNativeRange(o),e=_.create({name:"insertLink",value:r.uri}),this.execCommand(e),(o=this.getNativeRange()).collapse(!1),this.setNativeRange(o),e=_.create({name:"insertHTML",value:" ",isNative:!0}),this.execCommand(e)))},_onTextInput:function(t){var e=t.originalEvent||t;e.stopPropagation(),r.log("text",e.data),this._recognizeLink(e)},_onCompositionStart:function(t){var e=this.getNativeRange(),n=this.getEditBox();t.stopPropagation(),r.log("composition start"),this._isOnComposition=!0,this._compositionStartUriInfo=x.getUrlInfoBeforeRange(e,n)},_onCompositionEnd:function(t){t.stopPropagation(),r.log("composition end"),this._isOnComposition=!1,this._compositionStartUriInfo=null},_onClick:function(t){t.stopPropagation()},_onContentChange:function(){this._isDirty=!0,this._handleChangeWithDebounce()},_snapshot:function(){var t,e=this._editBox,n=this.getNativeRange();if(n)return t=E.jsonlify(e,n),{html:e.innerHTML,jsonRange:t};r.warn("Failed to create snapshot",n)},_saveHistory:function(){var t=this._lastSnapshot||this._baseSnapshot,e=this._snapshot();this._history.save({snapshotBefore:t,snapshotAfter:e}),this._lastSnapshot=e},_clearTimeoutOfHandleChange:function(){this._timeoutOfHandleChange&&(window.clearTimeout(this._timeoutOfHandleChange),this._timeoutOfHandleChange=null)},_handleChangeWithDebounce:function(){var t=this;t._clearTimeoutOfHandleChange(),t._timeoutOfHandleChange=window.setTimeout(function(){if(t._isOnComposition)return!1;t._saveHistory()},500)},_silentDo:function(t){this._changeMonitor&&!1===this._changeMonitor.isMonitoring()?t():(this._changeMonitor.disconnect(),t(),this._changeMonitor.observe())},silentDocSelectionChangeDo:function(t){var e=this;e._stopListenerDocSelectionChange?t():(e._stopListenerDocSelectionChange=!0,t(),window.clearTimeout(e._timeoutForStopListenerDocSelectionChange),e._timeoutForStopListenerDocSelectionChange=window.setTimeout(function(){e._stopListenerDocSelectionChange=!1},0))},undo:function(){var t=this._history;return this._clearTimeoutOfHandleChange(),!!t&&t.undo()},redo:function(){var t=this._history;return this._clearTimeoutOfHandleChange(),!!t&&t.redo()},_restoreSnapshot:function(t){if(t){var e=this;e._clearTimeoutOfHandleChange(),e._silentDo(function(){var n;e._editBox.innerHTML=t.html,n=E.parseJSON(e._editBox,t.jsonRange),e.setNativeRange(n)})}},_onHistoryUndo:function(t){this._restoreSnapshot(t)},_onHistoryRedo:function(t){this._restoreSnapshot(t)},_onHistoryChange:function(){var t=this._history;this.trigger("cell-edit-view-history-change",{canUndo:t.canUndo(),canRedo:t.canRedo()})},_handleContentWhenShowAndEdit:function(t,e){var n,o,i=!1;return null!=t?t instanceof g||(n=t instanceof f?t:f.create(t+""),i=!(o=g.create({richText:n})).isEmpty()):e.getType()===p.TEXT&&(o=e.getContent()).isEmpty()&&(o=null),{lines:o,isDirty:i}},showAndEdit:function(t){if(t&&null!=t.row&&null!=t.col){var e,n,o,s,l=this,c=l._table.getCell(t.row,t.col),u=l._tableView.$el.width(),d=i(".page-A4").get(0)?85:25,p=i(l._editBox),h={};c&&(l._changeMonitor.disconnect(),l._editingCellId=c.getCellId(),(e=l._tableView.getBoundingRectAt(t.row,t.col))&&((o=(n=l._handleContentWhenShowAndEdit(t.content,c)).lines)||(o=g.createBlank(!0),s=!0),l._isDirty=n.isDirty,e.width+e.left>u&&(e.width=u-e.left+d),d+e.left<0&&(e.left=-d,e.width=d+e.right),p.css({left:e.left,top:e.top,width:e.width,minHeight:e.height-3}),l._renderLines(o),l.$el.show(),l._focusEditBox(!0),s&&(a.each(c.getStylesForEmpty(),function(t,e){var n,o={};if(o[e]=t,n=S.createCmdBall("comp.ApplyStyles",{inlineStyles:o}),r.log("stylesForEmpty to cmdBall",e,t,n),!n)return!1;h[n.name]=n}),h.fontSize&&(l.execCommand(h.fontSize),delete h.fontSize),a.each(h,function(t){l.execCommand(t)})),l._changeMonitor.observe(),l._addListenerForDocSelectionChange(),l._baseSnapshot=l._snapshot(),l.trigger("cell-edit-view-enter",{canUndo:l._history.canUndo(),canRedo:l._history.canRedo()})))}else r.warn("Failed to show cell edit view, parameter is not valid",t)},_onSelectionChange:function(){var t=this.getNativeRange();this._clearEditingInlineStates(),this.trigger("cell-edit-view-selection-change",t)},_addListenerForDocSelectionChange:function(){var t=this;i(document).on("selectionchange"+t._eventNS,function(e){t.getNativeRange()?t._stopListenerDocSelectionChange?r.log("selection change NOT listener"):t._onSelectionChange(e):r.log("native range is not in cell edit view")})},_removeListenerForDocSelectionChange:function(){i(document).off("selectionchange"+this._eventNS)},_renderLines:function(t){var e=t.toHtml({styleRules:this._styleRules}),n=this._editBox;i(n).html(e)},_focusEditBox:function(t){var e,n=this._editBox;if(t){var o=v.getRange(),i=n.querySelector(".table-cell-line");if(!i||!o)return;e=i.lastChild||i,o.setStart(e,e.childNodes.length),o.setEnd(e,e.childNodes.length),v.setRange(o)}n.focus()},hide:function(){this.$el.hide()},_filterToLinesHtml:function(){var t=this._editBox,e=function(t){a.each(t,function(t){var n=t.style.textDecorationLine;n&&(t.style.textDecoration=n),t.hasChildNodes()&&e(t.children)})};e(t.children)},_getContentAsLines:function(){var t,e,n=g.createBlank();return this._viewStyleToData(),this._filterToLinesHtml(),t=this._editBox.innerHTML,e=h(t,{holdSpaces:!0})||[],a.each(e,function(t){var e=O.blockToCellContent(t);e instanceof g&&n.appendLines(e)}),n},_viewStyleToData:function(){var t=this,e=t._editBox,n=t._styleRules,o=t._mapper;a.map(n,function(n,i){var r,s,l;r=e.querySelectorAll("font"),"font-family"!==i?(t._elsViewStyleToData(r,o,i),t._elsViewStyleToData(e.querySelectorAll("span"),o,i)):a.forEach(r,function(t){s=t.getAttribute("face"),(s=C.getFontFirstValue(s))&&(l=o.valueFromView(i,s))&&t.setAttribute("face",l)})})},_elsViewStyleToData:function(t,e,n){var o,i,r=!1;a.forEach(t,function(t){(o=t.getAttribute(n))?r=!0:o=t.style[n],o&&("color"===n&&(o=k(o).toHexString()),(i=e.valueFromView(n,o))&&(r?t.setAttribute(n,i):t.style[n]=i))})},_commitChange:function(){var t;r.log("commit change"),this._isDirty&&(t=this._getContentAsLines(),this.trigger("set-cell-content",this._editingCellId,t)),this.exit()},_isOnToolbarLinkView:function(){return i(".combo-menu-link .link-input").is(":visible")},isFocused:function(){var t=document.activeElement;return t===this.el||i.contains(this.el,t)},_isShow:function(){return this.$el.is(":visible")},isOnEdit:function(){return!!this.isFocused()||this._isOnToolbarLinkView()&&this._isShow()},getNativeRange:function(){var t=v.getRange();if(v.isRangeInNode(this._editBox,t))return t;r.warn("native range is null or not in cell edit view",t)},setNativeRange:function(t){v.isRangeInNode(this._editBox,t)?v.setRange(t):r.warn("Failed to set native range to cell edit view",t)},_formatStyles:function(t){return t},_queryStyles:function(t){var e,n,o=this.getNativeRange();if(o)return e=o.startContainer,m.isText(e)&&(e=e.parentNode),n=window.getComputedStyle(e,null),n=this._formatStyles(n),t?n[t]:n},_queryInlineStylesForBulb:function(){var t=this._queryStyles(),e={},n={style:t},o=a.keys(S.INLINE_STYLES_CMD_MAP);return a.forEach(o,function(t){e[t]=T[t].action(n)}),e},queryInlineStylesForBulb:function(){var t,e,n,o=this.getNativeRange();if(o)return t=this._queryInlineStylesForBulb(),o.collapsed&&this._editingInlineStates?(e=a.clone(this._editingInlineStates),a.defaults(e,t),n=e):n=t,n.cellEditViewRangeCollapsed=o.collapsed,n},toggleInlineStyle:function(t){var e,n;-1!==a.keys(S.TOGGLE_INLINE_STYLES_CMD_MAP).indexOf(t)?(n=S.getCmdNameByStyleName(t),e=_.create({name:n,tryNativeIfNeeded:!0}),this.execCommand(e)):r.warn("toggleInlineStyle does NOT supprot",t)},_shouldModifyEditingInlineStates:function(t,e,n){return!!(t&&t.name&&e&&e.collapsed&&1===n)&&a.values(S.INLINE_STYLES_CMD_MAP).indexOf(t.name)>-1},_grabEditingInlineStates:function(t){if(t&&t.name){var e;this._editingInlineStates||(e=this._queryInlineStylesForBulb(),this._editingInlineStates=e)}},_updateEditingInlineStates:function(t){if(t&&t.name){var e=t.name,n=t.value,o=S.getStyleNameByCmdName(e),i=a.keys(S.TOGGLE_INLINE_STYLES_CMD_MAP);o&&this._editingInlineStates&&(i.indexOf(o)>-1&&!0!==n&&!1!==n&&(n=!this._editingInlineStates[o]),this._editingInlineStates[o]=n)}},_clearEditingInlineStates:function(){this._editingInlineStates=null},execCommand:function(t){var e,n,o=this.getNativeRange();return r.log("execCommand",t),o?(this._nestLevel||(this._nestLevel=0),this._nestLevel++,e=this._shouldModifyEditingInlineStates(t,o,this._nestLevel),1===this._nestLevel&&(e?this._grabEditingInlineStates(t):this._clearEditingInlineStates()),(n=this._commander.exec(t))&&1===this._nestLevel&&(e?this._updateEditingInlineStates(t):this._clearEditingInlineStates(),this.trigger("cell-edit-view-command-executed")),this._nestLevel--,n):(r.warn("nativeRange  is not in editBox"),!1)},exit:function(){this._isDirty=!1,this._editingCellId=null,this._clearTimeoutOfHandleChange(),this._lastSnapshot=null,this._baseSnapshot=null,this._removeListenerForDocSelectionChange(),this._changeMonitor.disconnect(),this._history.reset(),this.trigger("cell-edit-view-exit"),this.hide()},_filterTable:function(t){var e=t.querySelectorAll("table");a.each(e,function(t){var e=t.querySelectorAll("td"),n="";a.each(e,function(t){n+=t.innerHTML}),t.innerHTML=n})},_filterHtml:function(t){var e=s(t),n=["img"];return e?(this._filterTable(e),a.each(b,function(t,e){!1===t&&n.push(e)}),a.each(n,function(t){var n=e.querySelectorAll(t);a.each(n,function(t){t&&t.parentNode&&t.parentNode.removeChild(t)})}),e.innerHTML.trim()):""},_onPaste:function(t){var e,n,o=(t.originalEvent||t).clipboardData;t.stopPropagation(),t.preventDefault(),o&&o.types&&(-1!==a.indexOf(o.types,"text/html")?(e=o.getData("text/html"),e=this._filterHtml(e),n=_.create({name:"insertHTML",isNative:!0,value:e})):-1!==a.indexOf(o.types,"text/plain")&&(e=o.getData("text/plain"),n=_.create({name:"insertText",isNative:!0,value:e})),this.execCommand(n))},_onDblclick:function(t){t.stopPropagation()},editFromToolbar:function(t,e){var n,o=this.getNativeRange(),i=this.queryInlineStylesForBulb();return this._rangeWhenBlur&&(o=this._rangeWhenBlur,v.setRange(o)),!!o&&(!!(n=S.createCmdBall(t,e,i))&&(this.execCommand(n),this._rangeWhenBlur=null,!0))},getEditBox:function(){return this._editBox}},{create:function(t){if(t&&t.table&&t.tableView)return new e(t);r.warn("Failed to create CellEditView",t)},isRangeIn:function(t){if(!t)return!1;return v.isRangeInSelector("div.cell-edit",t)}})}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e,o=n(27),i=n(8),r=n(2),a=window.MutationObserver||window.WebKitMutationObserver;return e=o.extend({initialize:function(t){var e=this;t=t||{},e._el=t.el,e._monitoring=!1,e._hasBindDOMSubtreeModified=!1,delete e.options,a&&(e._observer=new a(function(){e._fireChange()}))},_fireChange:function(){!0===this._monitoring&&this.trigger("content-change")},observe:function(){this.isMonitoring()||(this._observer?this._observer.observe(this._el,{childList:!0,attributes:!0,subtree:!0,characterData:!0,attributeFilter:["style"]}):!1===this._hasBindDOMSubtreeModified&&(this._hasBindDOMSubtreeModified=!0,i(this._el).on("DOMSubtreeModified",this._fireChange.bind(this))),this._monitoring=!0)},disconnect:function(){this._monitoring=!1,this._observer&&this._observer.disconnect()},destroy:function(){this._observer?(this._observer.disconnect(),this._observer=null):!0===this._hasBindDOMSubtreeModified&&i(this._el).off("DOMSubtreeModified")},isMonitoring:function(){return this._monitoring}},{create:function(t){if(t&&t.el)return new e(t);r.warn("Failed to create ChangeMonitor")}})}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(808),o=n(809),i=[n(810),n(811),o,n(812),n(813),n(814)];return function(t){var n=e.create(t);return n.addCmds(i),n}}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e,o=n(0),i=n(2),r=n(26),a=["undo","redo","fontSize"];return e=r.extend({initialize:function(t){t=o.defaults(t||{},{editHost:null}),this._commands={},this._editHost=t.editHost,delete this.options},addCmd:function(t){var e=this._commands;if(t&&t.name&&t.action){if(e[t.name])return void i.warn("command has defined: ",t.name);e[t.name]=t}},addCmds:function(t){var e=this;o.each(t,function(t){e.addCmd(t)})},exec:function(t){var e,n=this;return t&&t.name?(!0===t.stopSelectionChange?n._editHost.silentDocSelectionChangeDo(function(){e=n._exec(t)}):e=n._exec(t),e):(i.warn("Failed to exec cmdBall",t),!1)},_exec:function(t){var e,n,o,r=this._commands;if(e=t.name,!t.isNative){if((o=r[e])&&o.action)return n=o.action.apply(o,[t.value,this,this._editHost]),t.callback&&t.callback(n),n;if(i.warn("no command",e),!t.tryNativeIfNeeded)return!1;i.warn("try to exec native command",e)}return a.indexOf(e)>-1?(i.error("native command is unvalid",e),!1):(n=this.execNative(e,t.value),t.callback&&t.callback(n),n)},execNative:function(t,e){if(document.queryCommandSupported(t)){document.execCommand("styleWithCSS",!1,!0);var n=document.execCommand(t,!1,e||"");return n||i.error("Failed to exec command",t,e),n}i.error("command is not supported",t)}},{create:function(t){return new e(t)}})}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(75);return{name:"fontSize",action:function(t,n,o){var i,r=o.getNativeRange();return!!r&&(r.collapsed?(o.execCommand(e.create({name:"insertHTML",isNative:!0,value:'<span style="font-size: '+t+'px;"> </span>'})),o.execCommand(e.create({name:"delete",isNative:!0}))):(i=e.create({name:"applyInlineStyle",value:{name:"fontSize",value:t+"px"},isNative:!1}),o.execCommand(i)))}}}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(0),o=n(71),i=n(2),r=function(t,e){for(var n=e.parentNode;null!==n;){if(n===t)return!0;n=n.parentNode}return!1},a=function(t,e,n){if(n===t)return null;if(t.firstChild&&!e)return t.firstChild;if(!t.parentNode)return null;for(var o=t.nextSibling||a(t.parentNode,!0,n);r(o,n);)o=o.firstChild;return o},s=function(t,e,n){var i,r=t.startContainer,s=t.startOffset,l=t.endContainer,c=t.endOffset;for(o.isElement(r)&&0!==s&&(r=(i=r.childNodes[s])||r.nextSibling,s=0),o.isElement(l)&&c!==l.length&&(c=(l=0===c?l.previousSibling:(i=l.childNodes[c-1])||l.previousSibling).length),i=r;i;i=a(i,e,l))n(i)},l=function(t){if(t.parentNode){var n=e.toArray(t.childNodes),o=t.parentNode;(function(t,e){if(t&&t.tagName)return(t.tagName+"").toLowerCase()===(e+"").toLowerCase()})(t,"span")&&0===t.attributes.length&&(e.each(n,function(e){t.removeChild(e),o.insertBefore(e,t)}),o.removeChild(t)),e.each(n,function(t){l(t)})}},c=function(t,e,n){var i;!function(t){var e,n=t.startContainer,i=t.endContainer,r=t.startOffset,a=t.endOffset;o.isText(i)&&a!==i.length&&i.splitText(a),o.isText(n)&&0!==r&&(e=n.splitText(r),n===i&&(i=e,a=e.length),n=e,r=0),t.setStart(n,r),t.setEnd(i,a)}(t),i=function(t){return{startNode:t.startContainer,endNode:t.endContainer,startOffset:t.startOffset,endOffset:t.endOffset}}(t),function(t,e){s(t,!1,function(t){o.isElement(t)&&(t.style[e]="")}),l(t.commonAncestorContainer)}(t,e),s(t,!0,function(i){var r;o.isElement(i)?i.style[e]=n:o.isText(i)&&!/^\s*$/.test(i.data)&&((r=t.startContainer.ownerDocument.createElement("span")).style[e]=n,i.parentNode.insertBefore(r,i),i.parentNode.removeChild(i),r.appendChild(i))}),function(t,e){t.setStart(e.startNode,e.startOffset),t.setEnd(e.endNode,e.endOffset)}(t,i)};return{name:"applyInlineStyle",action:function(t,e,n){var o=t.name,r=t.value,a=n.getNativeRange();return a&&!function(t){var e=t.startContainer,n=t.endContainer,o=t.startOffset,i=t.endOffset;return e===n&&o===i}(a)?(c(a,o,r),n.setNativeRange(a),!0):(i.warn("Failed to execute applyInlineStyle",a),!1)}}}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(0),o=n(75),i=n(315);return{name:"applyInlineStyles",action:function(t,n,r){var a=!1;return e.map(i.INLINE_STYLES_CMD_MAP,function(n,i){if(e.has(t,i)){if(null==t[i])return;r.execCommand(o.create({name:n,value:t[i],stopSelectionChange:"fontSize"===n})),a=!0}}),a}}}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(75),o=n(136),i=n(110);return{name:"insertLink",action:function(t,n,r){return!!(t=i.safeHref(t))&&(r.execCommand(e.create({name:"underline",value:!0})),r.execCommand(e.create({name:"createLink",value:o.completeUrl(t||"")})),!0)}}}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(){return{name:"undo",action:function(t,e,n){return n.undo()}}}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(){return{name:"redo",action:function(t,e,n){return n.redo()}}}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(75),o=n(51),i=n(0),r=n(2),a=n(315);return{TOGGLE_INLINE_STYLES_CMD_MAP:a.TOGGLE_INLINE_STYLES_CMD_MAP,INLINE_STYLES_CMD_MAP:a.INLINE_STYLES_CMD_MAP,getStyleNameByCmdName:function(t){var e;return i.some(this.INLINE_STYLES_CMD_MAP,function(n,o){if(n===t)return e=o,!0}),e},getCmdNameByStyleName:function(t){if(t)return this.INLINE_STYLES_CMD_MAP[t]},_createInlineStyleCmdBall:function(t){t=t||{};var n;return i.some(this.INLINE_STYLES_CMD_MAP,function(r,a){if(i.has(t,a))return"font-family"===a&&(t[a]=o.getAllValueByFont(t[a])||t[a]),n=e.create({name:r,value:t[a],stopSelectionChange:"fontSize"===r}),!0}),n},_createFormatPainterCmdBall:function(t,n){return i.map(n,function(e,o){t[o]===n[o]&&delete t[o]}),e.create({name:"applyInlineStyles",value:t})},createCmdBall:function(t,n,o){var i;switch(n=n||{},t){case"comp.RemoveFormat":i=e.create({name:"removeFormat"});break;case"comp.FormatPainter":if(!n.data||!n.data.inlineStyles)return;i=this._createFormatPainterCmdBall(n.data.inlineStyles,o);break;case"comp.ApplyStyles":n.inlineStyles&&(i=this._createInlineStyleCmdBall(n.inlineStyles));break;case"comp.InsertLink":if(!n.src)return;i=e.create({name:"insertLink",value:n.src});break;case"undo":i=e.create({name:"undo",isNative:!1,tryNativeIfNeeded:!1});break;case"redo":i=e.create({name:"redo",isNative:!1,tryNativeIfNeeded:!1})}return i?r.log("toolbarAdapter handles name/args/ball",t,n,i):r.warn("toolbarAdapter do NOT handle: ",t,n),i}}}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(0),o=n(71),i=n(2);return{jsonlify:function(t,n){if(t&&n){var r=function(n){var i,r={};return o.isText(n)?(i=n.parentNode,r.childIndex=e.indexOf(i.childNodes,n)):i=n,r.isRoot=i===t,r.isRoot?r:(r.tagName=i.tagName,r.tagIndex=e.indexOf(t.querySelectorAll(r.tagName),i),r)},a={collapsed:n.collapsed,startContainer:r(n.startContainer),startOffset:n.startOffset};return i.log(a),a.collapsed?a:(a.endContainer=r(n.endContainer),a.endOffset=n.endOffset,a)}},parseJSON:function(t,e){if(t&&e){var n,o=function(e){var n;return e.isRoot?null!=e.childIndex?t.childNodes[e.childIndex]:t:(n=t.querySelectorAll(e.tagName)[e.tagIndex],null!=e.childIndex?n.childNodes[e.childIndex]:n)},i=t.ownerDocument.createRange(),r=o(e.startContainer);return i.setStart(r,e.startOffset),e.collapsed?i.setEnd(r,e.startOffset):(n=o(e.endContainer),i.setEnd(n,e.endOffset)),i}}}}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e,o=n(27),i=n(2);return e=o.extend({initialize:function(){delete this.options,this.reset()},reset:function(){this._undo=[],this._redo=[],this.trigger("change")},save:function(t){if(!t||!t.snapshotBefore||!t.snapshotAfter)return i.warn("parameter is unvalid",t),!1;return this._undo.push(t),this._redo=[],this.trigger("change"),i.log("history save operation",this._undo.length,t),!0},canUndo:function(){return this._undo.length>0},canRedo:function(){return this._redo.length>0},undo:function(t){var e;for(t=t||1,i.log("history undo",t);t&&t>0&&this.canUndo();)e=this._undo.pop(),this._redo.push(e),t--;return!!e&&(i.log("history undo",e.snapshotBefore),this.trigger("undo",e.snapshotBefore),this.trigger("change"),!0)},redo:function(t){var e;for(t=t||1,i.log("history redo",t);t&&t>0&&this.canRedo();)e=this._redo.pop(),this._undo.push(e),t--;return!!e&&(i.log("history redo",e.snapshotAfter),this.trigger("redo",e.snapshotAfter),this.trigger("change"),!0)}},{create:function(t){return new e(t)}})}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){n(819),n(820),n(821),n(822),n(823),n(824),n(825)}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(6),o=n(75),i=n(233);e.register({name:"enter",scope:"table-cell-edit",key:"enter",action:function(t){var e,n,r=t.getNativeRange(),a=t.getEditBox();(e=i.getUrlInfoBeforeRange(r,a))?(e.alreadyUrl||((r=document.createRange()).setStart(e.startNode,e.startOffset),r.setEnd(e.endNode,e.endOffset),t.setNativeRange(r),n=o.create({name:"insertLink",value:e.uri}),t.execCommand(n),(r=t.getNativeRange()).collapse(!1),t.setNativeRange(r)),n=o.create({name:"insertHTML",value:"<div><br/></div>",isNative:!0})):n=o.create({name:"insertLineBreak",isNative:!0}),t.execCommand(n)}})}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(6),o=n(75),i=n(233),r=function(t){var e,n,r=t.getNativeRange(),a=t.getEditBox();(e=i.getUrlInfoBeforeRange(r,a))?(e.alreadyUrl||((r=document.createRange()).setStart(e.startNode,e.startOffset),r.setEnd(e.endNode,e.endOffset),t.setNativeRange(r),n=o.create({name:"insertLink",value:e.uri}),t.execCommand(n),(r=t.getNativeRange()).collapse(!1),t.setNativeRange(r)),n=o.create({name:"insertHTML",value:"<div><br/></div>",isNative:!0})):n=o.create({name:"insertLineBreak",isNative:!0}),t.execCommand(n)};e.register({name:"altEnter",scope:"table-cell-edit",key:"alt+enter",action:r}),e.register({name:"shiftEnter",scope:"table-cell-edit",key:"shift+enter",action:r})}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){n(6).register({name:"esc",scope:"table-cell-edit",key:"esc",action:function(t){t.exit()}})}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(6);n(0).each({"mod+b":"bold","mod+i":"italic","mod+e":"strike","mod+u":"underline"},function(t,n){e.register({name:t,scope:"table-cell-edit",key:n,action:function(e){e.toggleInlineStyle(t)}})})}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(6),o=n(75);e.register({name:"modZ",scope:"table-cell-edit",key:"mod+z",action:function(t){var e=o.create({name:"undo",isNative:!1,tryNativeIfNeeded:!1});t.execCommand(e)}})}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(6),o=n(75),i=function(t){var e=o.create({name:"redo",isNative:!1,tryNativeIfNeeded:!1});t.execCommand(e)};e.register({name:"modShiftZ",scope:"table-cell-edit",key:"mod+shift+z",action:i}),e.register({name:"modY",scope:"table-cell-edit",key:"mod+y",action:i})}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){n(6).register({name:"save",scope:"table-cell-edit",key:"mod+s",action:function(){}})}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e,o=n(29),i=n(0),r=n(2),a=n(50),s=n(176),l=n(55),c=new Array(3).join(" "),u=[8,9,13,16,17,18,19,20,27,33,34,35,36,37,38,39,40,45,46,91,92,93,112,113,114,115,116,117,118,119,120,121,122,123,144,145,229];return e=o.View.extend({tagName:"input",className:"hidden-input",_lastKeyDownCode:null,initialize:function(){this._initEvents(),delete this.options},_initEvents:function(){a.addListeners({keydown:"_onKeyDown",textInput:"_onTextInput",compositionstart:"_onCompositionStart",compositionend:"_onCompositionEnd",copy:"_onCopyCutPaste",cut:"_onCopyCutPaste",paste:"_onCopyCutPaste"},this.$el,this)},bindKey:function(t){var e=this,n=e._keyMonitor;t&&(n||(e._keyMonitor=n=new s({el:e.el,beforeMatch:function(t){t.stopPropagation()},afterMatch:function(t,n){n||-1!==i.indexOf(u,t.keyCode)||t.ctrlKey||t.metaKey||e._onPrintableKeyDown(t)}})),n.unbind(t),n.bind(t,function(n){e.trigger("key-monitor",t,n)}))},unbindKey:function(t){var e=this._keyMonitor;e&&t&&e.unbind(t)},render:function(){this.$el.val(c)},isFocused:function(){return document.activeElement===this.el},isOnEdit:function(){return this.isFocused()&&this.getValue()!==c},focus:function(t){var e=this.el;t&&this.setPosition(t.left,t.top),e.select()},blur:function(){this.el.blur()},setPosition:function(t,e){var n=this.el;n.style.left=t+"px",n.style.top=e+"px"},setWidth:function(t){this.el.style.width=t+"px"},bringToFront:function(){this.el.value="",this.el.style.zIndex=255},hideBehind:function(){this.el.style.zIndex=-255},_onPrintableKeyDown:function(t){this._printableKeyDown=!0,32===t.keyCode&&(t.preventDefault(),this.$el.trigger("textInput",t))},_onKeyDown:function(t){this._lastKeyDownCode=t.keyCode},_onTextInput:function(t){t=t.originalEvent||t,r.log("hiddenInputView textInput",t),t.stopPropagation();var e=this,n=t.data;if(this._printableKeyDown)return t.preventDefault(),this._triggerTextInput(n),void(this._printableKeyDown=!1);229===e._lastKeyDownCode&&window.setTimeout(function(){e._triggerTextInput(n)},50)},_onCompositionStart:function(t){r.log("hiddenInputView compositionstart",t),t.stopPropagation(),this.bringToFront()},_onCompositionEnd:function(t){if(t=t.originalEvent||t,r.log("hiddenInputView compositionend",t),t.stopPropagation(),!this.locked){var e=t.data||this.$el.val();e&&i.defer(function(){this._triggerTextInput(e)}),this.hideBehind()}},_onCopyCutPaste:function(t){var e=t.type;t.preventDefault(),t.stopPropagation(),r.log("on copy/cut/paste",e,t),this.trigger(e,t)},_triggerTextInput:function(t){this.trigger("text-input",t),this.clearValue()},clearValue:function(){this.el.value=c},getValue:function(){return this.el.value}},{create:function(t){return new e(t)},isRangeIn:function(t){if(t){return l.isRangeInSelector("input.hidden-input",t)}}})}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(29),o=n(314),i=n(50),r=n(74),a=n(19),s=n(0);return e.View.extend({className:"cell-resize-layer",initialize:function(t){var e=t.tableView,n=e.$el;this._tableView=e,this._draggable=new o({el:this.el,disableDocSelection:!0}),this._active=!0,this._onDrag=!1,this._resizeDirection=null,this._cellInfo=null,this._rowLine=n.find(".row-resize-line"),this._colLine=n.find(".col-resize-line"),this._bindEvents()},onDestroy:function(){this.draggable.off()},_bindEvents:function(){var t=this._draggable,e=this._tableView,n={};s.bindAll(this,"_onCellEnter"),n[o.DRAG_START]="_onDragStart",n[o.DRAGGING]="_onDragging",n[o.DRAG_END]="_onDragEnd",i.addListeners(n,t,this),e.on("cell-enter",this._onCellEnter)},render:function(){var t=a.render("common","table_cell_resize",{});this.$el.html(t),this.showAt()},showAt:function(t){t&&null!=t.width&&this.$el.css({width:t.width,height:t.height,top:t.top,left:t.left}).show()},hide:function(){this.$el.hide()},enable:function(){this._active=!0},disable:function(){this._active=!1,this.hide()},isActive:function(){return this._active},_parseType:function(t){var e,n=t.className;return s.some(r,function(t,o){var i=o.toLowerCase();if(n.indexOf(i)>-1)return e=t,!0}),e||r.UP},_onDragStart:function(t){var e,n=this._tableView;n&&!n.isLocked()&&(t.stopPropagation(),this._onDrag=!0,this._resizeDirection=this._parseType(t.target),e=n.getEventBoundingRect(t),this._startRect=e,this._updateResizeLine(e.left,e.top),n.focusOutTbody())},_onDragging:function(t){var e,n=this._tableView;n&&!n.isLocked()&&(t.stopPropagation(),this._onDrag=!0,e=n.getEventBoundingRect(t),this._updateResizeLine(e.left,e.top))},_onDragEnd:function(t){var e,n,o,i=this._tableView,a=this._cellInfo;i&&!i.isLocked()&&(t.stopPropagation(),this._onDrag=!1,e=i.getEventBoundingRect(t),this._updateResizeLine(e.left,e.top,!0),n=e.left-this._startRect.left,o=e.top-this._startRect.top,a&&(0===a.row&&this._resizeDirection===r.TOP&&(o=0-o),0===a.col&&this._resizeDirection===r.LEFT&&(n=0-n)),this._execResizeCommand(n,o))},_updateResizeLine:function(t,e,n){switch(this._resizeDirection){case r.UP:case r.DOWN:n?this._rowLine.hide():this._rowLine.css({top:e}).show();break;case r.RIGHT:case r.LEFT:n?this._colLine.hide():this._colLine.css({left:t}).show()}},_execResizeCommand:function(t,e){var n,o,i,a,l,c,u,d,p,h,f=this._tableView,g=f.block,m=this._cellInfo;switch(this._resizeDirection){case r.UP:case r.DOWN:n=m.row,this._resizeDirection===r.UP?n-=1:(c=g.getMergePointAttrAt(m.row,m.col).height||0)>1&&(n+=c-1),n=n<0?0:n,i=f.getRowElHeight(n),i+=e,i=s.max([i,10]),this.trigger("set-row-height",n,i);break;case r.RIGHT:case r.LEFT:if(o=m.col,this._resizeDirection===r.LEFT?o-=1:(l=g.getMergePointAttrAt(m.row,m.col).width||0)>1&&(o+=l-1),u=o+1,o=o<0?0:o,d=f.getColElWidth(o),a=s.max([d+t,35]),u>=g.getColumnCount()){this.trigger("set-col-width",o,d+t);break}u!==o?(p=d+g.getColumnWidth(u),h=s.max([p-a,35]),this.trigger("set-cells-size",[{col:u,width:h},{col:o,width:p-h}])):this.trigger("set-col-width",o,a)}},_onCellEnter:function(t){var e,n,o,i=this._tableView,r=i.block;!r.locked&&i&&this.isActive()&&!this._onDrag&&(n=i.getCellElementByTarget(t),(e=r.getCellById(n))&&(this._cellInfo={row:e.row,col:e.col},o=i.getBoundingRect(n),this.showAt(o)))}})}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(19),o=n(311),i=n(312),r=n(230);return{_renderWrap:function(t){return'<div class="resource-wrap">'+t+"</div>"},renderImage:function(t,e){var n=t.getSource(e),o=document.createElement("img");return o.setAttribute("draggable","false"),o.setAttribute("src",r.getURL(i.addIfNeeded(n))||""),o.setAttribute("width","100%"),o.setAttribute("height","auto"),this._renderWrap(o.outerHTML)},renderAttachment:function(t){var n,i,r,a,s=t.getInfo();return n=o.splitFileFullName(s.fileName),i=o.getSizeString(s.fileLength),a=o.getFileIconByName(s.fileName),r=e.render("common","attachment-view-attachment-container",{name:a,fileName:n.fileName.replace(/ /g,"&nbsp;"),fileType:n.fileType.replace(/ /g,"&nbsp;"),size:i,title:s.fileName.replace(/ /g,"&nbsp;"),draggable:!1}),this._renderWrap(r)}}}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){n(830),n(831),n(832),n(833),n(834),n(835),n(836),n(837)}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(6);n(0).each({"mod+b":"bold","mod+i":"italic","mod+u":"underline","mod+e":"strike"},function(t,n){e.register({name:t,scope:"table-hidden-input",key:n,action:function(e){e.toggleInlineStyle(t)}})})}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(6),o=n(74),i=n(0),r={left:o.LEFT,right:o.RIGHT,up:o.UP,down:o.DOWN,tab:o.RIGHT,"shift+tab":o.LEFT,enter:o.DOWN};i.each(r,function(t,n){e.register({name:n,scope:"table-hidden-input",key:n,action:function(e,n){e.moveWithDirection(t,n)}})})}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(6);n(0).each(["backspace","del"],function(t){e.register({name:t,scope:"table-hidden-input",key:t,action:function(t){t.clearSelectedCells()}})})}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){n(6).register({name:"save",scope:"table-hidden-input",key:"mod+s",action:function(t){t.trigger("save-content")}})}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){n(6).register({name:"select-all",scope:"table-hidden-input",key:"mod+a",action:function(t){t.selectAll(!0)}})}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(6);e.register({name:"undo",scope:"table-hidden-input",key:"mod+z",action:function(t){t.trigger("global-undo")}}),e.register({name:"redo",scope:"table-hidden-input",key:"mod+y",action:function(t){t.trigger("global-redo")}}),e.register({name:"redo_2",scope:"table-hidden-input",key:"mod+shift+z",action:function(t){t.trigger("global-redo")}})}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(6),o=n(0),i=n(2),r=n(10);n(30).isSafari()&&!r.IS_MAC||o.each(["mod+1","mod+2","mod+3","mod+4","mod+d","mod+h","mod+l","ctrl+q"],function(t){e.register({name:t,scope:"table-hidden-input",key:t,preventDefault:!0,action:function(){i.log("shortcut prevented on table")}}),e.register({name:t,scope:"table-cell-edit",key:t,action:function(){i.log("shortcut prevented on table")}})})}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(6);e.register({name:"paste",key:"mod+v",scope:"table-hidden-input",preventDefault:!1,action:function(t){t.setPasteAsText(!1)}}),e.register({name:"pasteAsText",key:"mod+shift+v",scope:"table-hidden-input",preventDefault:!1,action:function(t){t.setPasteAsText(!0)}})}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(104),o=n(0),i=n(19);return e.extend({$checkbox:null,_checked:!1,name:"todo",className:"block-view todo-view",events:{"mousedown .todo-mark":"_onClick"},initialize:function(t){e.prototype.initialize.apply(this,arguments),this.options=t,this.block=t.block,o.bindAll(this,"_blockCheckedChange","_onStyleChange"),this.block.on("checked-change",this._blockCheckedChange),this.block.on("style-change",this._onStyleChange)},_renderTemplate:function(){this.$el.html(i.render("common",this.name))},render:function(){var t=this.block;e.prototype.render.apply(this,arguments),this._blockCheckedChange(t.getChecked()),this._setContainerStyles()},_setContainerStyles:function(){var t=this,e=t.block.getBlockStyles();o.each(e,function(e,n){t._setContainerStyle(n,e)})},_setContainerStyle:function(t,e){var n=this.$el.find(".todo-content");switch(t){case"back-color":n.parent().css("background-color",e);break;case"padding":n.css("padding",e)}},_onStyleChange:function(t,n){e.prototype._onStyleChange.apply(this,arguments),this._setContainerStyle(t,n)},_blockCheckedChange:function(t){t?this.$el.addClass("checked"):this.$el.removeClass("checked"),this._checked=t},_onClick:function(t){t.preventDefault(),t.stopPropagation();var e=this._checked;this.trigger("command","comp.SetBlockProps",{blocks:[this.block],props:{checked:!e}})}})}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(0),o=n(8),i=n(104),r=n(66),a=n(310),s=n(53),l=n(43),c=n(32),u=n(121),d=n(219),p=n(51);return i.extend({name:"quote",className:"block-view paragraph-view quote-view",render:function(){this._renderTemplate(),this._renderText(d.getQuoteDefaultStyles()),this._renderStyles(),this._setContainerStyles(),r.prototype.render.apply(this,arguments)},_setContainerStyles:function(){var t=this,n=t.block.getBlockStyles();e.each(n,function(e,n){t._setContainerStyle(n,e)})},_setContainerStyle:function(t,e){var n=this.$el.find(".para-text");switch(t){case"back-color":n.parent().css("background-color",e);break;case"padding":n.css({padding:e,margin:e}),"0px"===n.css("padding-left")&&n.css("padding-left","17px"),n.css("padding-top","0px")}},_renderText:function(t){var n,i,r=this,h=r.block,f=h.getReadOnlyText(),g=r._inlineStyleViewMapper,m=r.$el.find(".para-text");n=f.isEmpty()?this._createHtmlForBlankLine(t):s.rich2html(f,{styles:t,styleRules:{color:function(t){var e=t.color;return t.href!==c.getDefault("href")&&l.equals(t.color,"#003884")?d.getQuoteColor():l.equals(t.color,"#393939")||e===c.getDefault("color")?d.getQuoteColor():null!=e&&g?g.valueToView("color",e):void 0},"font-family":function(t){var e,n=t["font-family"];return n!==c.getDefault("font-family")&&g&&(e=g.valueToView("font-family",n)),n!==e?e:p.getAllValueByFont(n)||n}}}),m.html(n),i=h.getStyleRanges("href"),e.each(i,function(t){var e,n,i;e=new a({start:t.from,end:t.to,block:h}),n=r.convertToNativeRange(e),(i=r._findLinkNode(n.endContainer))&&(o(i).off("hover"),o(i).hover(function(){u.isNoteLinkUrl(i.href)||r.isCollabLocked()||r.trigger("link-menu-show",{linkNode:i,range:e,block:h})},function(){r.trigger("link-menu-hide")}))})}})}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";var a,s=this&&this.__extends||(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});o=[n,r,n(104),n(66),n(8),n(0),n(841),n(118),n(82),n(110),n(55)],void 0===(i=function(t,e,n,o,i,r,a,l,c,u,d){var p=function(t){return(t.data||t.innerText||t.innerHTML)===u.escapeHtmlEntities(c.EMPTY_LINE_TAG)},h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.className="block-view code-view",e.name="code",e.isSelectedBlock=!1,e}return s(e,t),e.prototype._convertToData=function(){},e.prototype._getContentContainer=function(){return this.$el},e.prototype.getBlock=function(){return this.block},e.prototype.initialize=function(){o.prototype.initialize.apply(this,arguments),n.prototype.initialize.apply(this,arguments);var t=this.getBlock();t.injectTokenizer(a),t.injectRenderParams({YNE_HEAD_CLASS:"yne",PLAIN_STRING_CLASS:"plain"}),r.bindAll(this,"renderText","_onContentChange","onClickBlock","onDrawRange"),this.on("draw-range",this.onDrawRange),t.on("content-change",this.renderText),t.on("content-change",this._onContentChange)},e.prototype.render=function(){this.renderText(),this.renderBackColor(),o.prototype.render.apply(this,arguments)},e.prototype.renderText=function(t){t?this.update(t):(this.renderAll(),this.updateTheme(),this.getCodeLineContainer().on("mousedown",this.onClickBlock))},e.prototype.renderBackColor=function(){var t=this.getBlock().getBlockStyles()["back-color"];this._getContentContainer().css("background-color",t)},e.prototype.onClickBlock=function(t){this.isSelectedBlock=t.currentTarget===t.toElement,this.drawSelectAllRange()},e.prototype.onDrawRange=function(t,e){t||this.getBlock()===e||(this.isSelectedBlock=!1,this.drawSelectAllRange())},e.prototype.onSetRange=function(t){var e=document.createRange();t&&(e.selectNodeContents(this.getCodeLineContainer()[0]),d.setRange(e,window),this.isSelectedBlock=!0,this.getBlock().isSelectedBlock=!0,this.getCodeLineContainer().addClass("selectAll"))},e.prototype.drawSelectAllRange=function(t){var e=this,n=t||this.isSelectedBlock;this.isSelectedBlock=n,this.getBlock().isSelectedBlock=n,n?this.getCodeLineContainer().addClass("selectAll"):this.getCodeLineContainer().removeClass("selectAll"),n?setTimeout(function(){e._getContentContainer().parent().attr("contenteditable",!1)},0):this._getContentContainer().parent().attr("contenteditable",!0),this._getContentContainer().attr("draggable",n)},e.prototype.scrollToStart=function(){this._getContentContainer().scrollLeft(0)},e.prototype.scrollRightByIndex=function(t){var e,n=(e=t,this.get$CodeLine(e)).children(),o=this._getContentContainer(),i=0;n.each(function(t){var e=Number(n.eq(t).width());isNaN(e)||(i+=e)}),o.scrollLeft(i)},e.prototype.updateTheme=function(){var t=this.className+" "+("yne-code-theme-"+this.getBlock().getTheme());this._getContentContainer().attr("class",t)},e.prototype.renderAll=function(){var t=this.getBlock().code2html();this._getContentContainer().html('<div class="para-text"></div>'),this.getCodeLineContainer().html(t)},e.prototype.update=function(t){var e=this;for(var n=t.preRichText,o=t.newRichText,i=this.getBlock(),r=i.toCodeLines(n.toString()),a=i.toCodeLines(o.toString()),s=[],l=[];r.length>0&&a.length>0&&r[0]===a[0];)s.push(r[0]),r.shift(),a.shift();for(r.reverse(),a.reverse();r.length>0&&a.length>0&&r[0]===a[0];)l.push(r[0]),r.shift(),a.shift();var c=s.length,u=s.length;r.forEach(function(t,n){var o=c+1;e.get$CodeLine(o).remove()}),a.forEach(function(t,n){var o=i.codeLineToHtml(u+n+1);e.insertAfter(u+n,o)})},e.prototype.parseNativeRange=function(t,e,n){var o=function(t){for(var e=i(t);"PRE"!==e.prop("tagName")&&!(e=e.parent()).is(document.body););return 1+e.prevAll("pre").length},r=function(t,e){if(p(t)||p(t.parentElement))return 0;"drop-hint"===t.id&&(e=t.parentElement.innerText.length),t.nextSibling&&"drop-hint"===t.nextSibling.id&&(e=t.wholeText.length),t.previousSibling&&"drop-hint"===t.previousSibling.id&&(e=i(t.parentElement).text().length-t.wholeText.length);var n=t.parentElement;return i(n).prevAll().text().length+e},a=function(t){for(;;){if(/code-view/.test(t.className))return!0;if(/note-view/.test(t.className))return!1;t=t.parentElement}};if(this.isSelectedBlock)return new l({block:e,selectWholeBlock:!0});var s=t.commonAncestorContainer.className,c=t.startContainer.className,u=/para-text/;if(n||u.test(s)&&u.test(c))return l.createSelectToEndRange(e);if(/note-view/.test(s)){if(a(t.startContainer))return l.createSelectToEndRange(e,o(t.startContainer),r(t.startContainer,t.startOffset));if(a(t.endContainer)){var d=o(t.endContainer),h=r(t.endContainer,t.endOffset);return new l({block:e,startLineIndex:1,startLineCharIndex:0,endLineIndex:d,endLineCharIndex:h})}return l.createSelectToEndRange(e)}var f=r(t.startContainer,t.startOffset),g=r(t.endContainer,t.endOffset),m=o(t.startContainer),y=o(t.endContainer);return new l({block:e,startLineCharIndex:f,endLineCharIndex:g,startLineIndex:m,endLineIndex:y,selectWholeBlock:this.isSelectedBlock})},e.prototype.convertToNativeRange=function(t){var e=this,n=document.createRange();t.selectWholeBlock&&(this.drawSelectAllRange(!0),t=l.createBeginRange(t.block));var o=function(t){return e.get$CodeLine(t)},i=function(t,e){var n={node:null,offset:0};return t.children().each(function(){n.node||(p(this)?n.node=this:(e-=this.innerText.length)<=0&&(n.node=this.firstChild,n.offset=e+this.innerText.length))}),n},r=o(t.startLineIndex),a=o(t.endLineIndex),s=i(r,t.startLineCharIndex),c=i(a,t.endLineCharIndex);return n.setStart(s.node,s.offset),n.setEnd(c.node,c.offset),n},e.prototype.insertAfter=function(t,e){0===t?this.getCodeLineContainer().prepend(i(e)):this.get$CodeLine(t).after(e)},e.prototype.getCodeLineContainer=function(){return this._getContentContainer().find(".para-text")},e.prototype.get$CodeLine=function(t){return this.getCodeLineContainer().children("pre").eq(t-1)},e}(n);return delete h.prototype.constructor,h.prototype.className="block-view code-view",o.extend(h.prototype)}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){(function(o){var i;void 0===(i=function(e,n){"use strict";var i="undefined"!=typeof window?window:"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?self:{},r=function(){var t=/\blang(?:uage)?-([\w-]+)\b/i,e=0,n=i.Prism={manual:i.Prism&&i.Prism.manual,disableWorkerMessageHandler:i.Prism&&i.Prism.disableWorkerMessageHandler,util:{encode:function(t){return t instanceof o?new o(t.type,n.util.encode(t.content),t.alias):"Array"===n.util.type(t)?t.map(n.util.encode):t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/\u00a0/g," ")},type:function(t){return Object.prototype.toString.call(t).match(/\[object (\w+)\]/)[1]},objId:function(t){return t.__id||Object.defineProperty(t,"__id",{value:++e}),t.__id},clone:function(t,e){var o=n.util.type(t);switch(e=e||{},o){case"Object":if(e[n.util.objId(t)])return e[n.util.objId(t)];var i={};for(var r in e[n.util.objId(t)]=i,t)t.hasOwnProperty(r)&&(i[r]=n.util.clone(t[r],e));return i;case"Array":if(e[n.util.objId(t)])return e[n.util.objId(t)];i=[];return e[n.util.objId(t)]=i,t.forEach(function(t,o){i[o]=n.util.clone(t,e)}),i}return t}},languages:{extend:function(t,e){var o=n.util.clone(n.languages[t]);for(var i in e)o[i]=e[i];return o},insertBefore:function(t,e,o,i){var r=(i=i||n.languages)[t];if(2==arguments.length){for(var a in o=arguments[1])o.hasOwnProperty(a)&&(r[a]=o[a]);return r}var s={};for(var l in r)if(r.hasOwnProperty(l)){if(l==e)for(var a in o)o.hasOwnProperty(a)&&(s[a]=o[a]);s[l]=r[l]}var c=i[t];return i[t]=s,n.languages.DFS(n.languages,function(e,n){n===c&&e!=t&&(this[e]=s)}),s},DFS:function(t,e,o,i){for(var r in i=i||{},t)t.hasOwnProperty(r)&&(e.call(t,r,t[r],o||r),"Object"!==n.util.type(t[r])||i[n.util.objId(t[r])]?"Array"!==n.util.type(t[r])||i[n.util.objId(t[r])]||(i[n.util.objId(t[r])]=!0,n.languages.DFS(t[r],e,r,i)):(i[n.util.objId(t[r])]=!0,n.languages.DFS(t[r],e,null,i)))}},plugins:{},highlightAll:function(t,e){n.highlightAllUnder(document,t,e)},highlightAllUnder:function(t,e,o){var i={callback:o,selector:'code[class*="language-"], [class*="language-"] code, code[class*="lang-"], [class*="lang-"] code'};n.hooks.run("before-highlightall",i);for(var r,a=i.elements||t.querySelectorAll(i.selector),s=0;r=a[s++];)n.highlightElement(r,!0===e,i.callback)},highlightElement:function(e,o,r){for(var a,s,l=e;l&&!t.test(l.className);)l=l.parentNode;l&&(a=(l.className.match(t)||[,""])[1].toLowerCase(),s=n.languages[a]),e.className=e.className.replace(t,"").replace(/\s+/g," ")+" language-"+a,e.parentNode&&(l=e.parentNode,/pre/i.test(l.nodeName)&&(l.className=l.className.replace(t,"").replace(/\s+/g," ")+" language-"+a));var c={element:e,language:a,grammar:s,code:e.textContent};if(n.hooks.run("before-sanity-check",c),!c.code||!c.grammar)return c.code&&(n.hooks.run("before-highlight",c),c.element.textContent=c.code,n.hooks.run("after-highlight",c)),void n.hooks.run("complete",c);if(n.hooks.run("before-highlight",c),o&&i.Worker){var u=new Worker(n.filename);u.onmessage=function(t){c.highlightedCode=t.data,n.hooks.run("before-insert",c),c.element.innerHTML=c.highlightedCode,r&&r.call(c.element),n.hooks.run("after-highlight",c),n.hooks.run("complete",c)},u.postMessage(JSON.stringify({language:c.language,code:c.code,immediateClose:!0}))}else c.highlightedCode=n.highlight(c.code,c.grammar,c.language),n.hooks.run("before-insert",c),c.element.innerHTML=c.highlightedCode,r&&r.call(e),n.hooks.run("after-highlight",c),n.hooks.run("complete",c)},highlight:function(t,e,i){var r={code:t,grammar:e,language:i};return n.hooks.run("before-tokenize",r),r.tokens=n.tokenize(r.code,r.grammar),n.hooks.run("after-tokenize",r),o.stringify(n.util.encode(r.tokens),r.language)},matchGrammar:function(t,e,o,i,r,a,s){var l=n.Token;for(var c in o)if(o.hasOwnProperty(c)&&o[c]){if(c==s)return;var u=o[c];u="Array"===n.util.type(u)?u:[u];for(var d=0;d<u.length;++d){var p=u[d],h=p.inside,f=!!p.lookbehind,g=!!p.greedy,m=0,y=p.alias;if(g&&!p.pattern.global){var v=p.pattern.toString().match(/[imuy]*$/)[0];p.pattern=RegExp(p.pattern.source,v+"g")}p=p.pattern||p;for(var _=i,b=r;_<e.length;b+=e[_].length,++_){var C=e[_];if(e.length>t.length)return;if(!(C instanceof l)){if(g&&_!=e.length-1){if(p.lastIndex=b,!(I=p.exec(t)))break;for(var k=I.index+(f?I[1].length:0),w=I.index+I[0].length,S=_,x=b,E=e.length;E>S&&(w>x||!e[S].type&&!e[S-1].greedy);++S)k>=(x+=e[S].length)&&(++_,b=x);if(e[_]instanceof l)continue;T=S-_,C=t.slice(b,x),I.index-=b}else{p.lastIndex=0;var I=p.exec(C),T=1}if(I){f&&(m=I[1]?I[1].length:0);w=(k=I.index+m)+(I=I[0].slice(m)).length;var O=C.slice(0,k),A=C.slice(w),N=[_,T];O&&(++_,b+=O.length,N.push(O));var D=new l(c,h?n.tokenize(I,h):I,y,I,g);if(N.push(D),A&&N.push(A),Array.prototype.splice.apply(e,N),1!=T&&n.matchGrammar(t,e,o,_,b,!0,c),a)break}else if(a)break}}}}},tokenize:function(t,e){var o=[t],i=e.rest;if(i){for(var r in i)e[r]=i[r];delete e.rest}return n.matchGrammar(t,o,e,0,0,!1),o},hooks:{all:{},add:function(t,e){var o=n.hooks.all;o[t]=o[t]||[],o[t].push(e)},run:function(t,e){var o=n.hooks.all[t];if(o&&o.length)for(var i,r=0;i=o[r++];)i(e)}}},o=n.Token=function(t,e,n,o,i){this.type=t,this.content=e,this.alias=n,this.length=0|(o||"").length,this.greedy=!!i};if(o.stringify=function(t,e,i){if("string"==typeof t)return t;if("Array"===n.util.type(t))return t.map(function(n){return o.stringify(n,e,t)}).join("");var r={type:t.type,content:o.stringify(t.content,e,i),tag:"span",classes:["token",t.type],attributes:{},language:e,parent:i};if(t.alias){var a="Array"===n.util.type(t.alias)?t.alias:[t.alias];Array.prototype.push.apply(r.classes,a)}n.hooks.run("wrap",r);var s=Object.keys(r.attributes).map(function(t){return t+'="'+(r.attributes[t]||"").replace(/"/g,"&quot;")+'"'}).join(" ");return"<"+r.tag+' class="'+r.classes.join(" ")+'"'+(s?" "+s:"")+">"+r.content+"</"+r.tag+">"},!i.document)return i.addEventListener?(n.disableWorkerMessageHandler||i.addEventListener("message",function(t){var e=JSON.parse(t.data),o=e.language,r=e.code,a=e.immediateClose;i.postMessage(n.highlight(r,n.languages[o],o)),a&&i.close()},!1),i.Prism):i.Prism;var r=document.currentScript||[].slice.call(document.getElementsByTagName("script")).pop();return r&&(n.filename=r.src,n.manual||r.hasAttribute("data-manual")||("loading"!==document.readyState?window.requestAnimationFrame?window.requestAnimationFrame(n.highlightAll):window.setTimeout(n.highlightAll,16):document.addEventListener("DOMContentLoaded",n.highlightAll))),i.Prism}();t.exports&&(t.exports=r),void 0!==o&&(o.Prism=r),r.languages.markup={comment:/<!--[\s\S]*?-->/,prolog:/<\?[\s\S]+?\?>/,doctype:/<!DOCTYPE[\s\S]+?>/i,cdata:/<!\[CDATA\[[\s\S]*?]]>/i,tag:{pattern:/<\/?(?!\d)[^\s>\/=$<%]+(?:\s+[^\s>\/=]+(?:=(?:("|')(?:\\[\s\S]|(?!\1)[^\\])*\1|[^\s'">=]+))?)*\s*\/?>/i,greedy:!0,inside:{tag:{pattern:/^<\/?[^\s>\/]+/i,inside:{punctuation:/^<\/?/,namespace:/^[^\s>\/:]+:/}},"attr-value":{pattern:/=(?:("|')(?:\\[\s\S]|(?!\1)[^\\])*\1|[^\s'">=]+)/i,inside:{punctuation:[/^=/,{pattern:/(^|[^\\])["']/,lookbehind:!0}]}},punctuation:/\/?>/,"attr-name":{pattern:/[^\s>\/]+/,inside:{namespace:/^[^\s>\/:]+:/}}}},entity:/&#?[\da-z]{1,8};/i},r.languages.markup.tag.inside["attr-value"].inside.entity=r.languages.markup.entity,r.hooks.add("wrap",function(t){"entity"===t.type&&(t.attributes.title=t.content.replace(/&amp;/,"&"))}),r.languages.xml=r.languages.markup,r.languages.html=r.languages.markup,r.languages.mathml=r.languages.markup,r.languages.svg=r.languages.markup,r.languages.css={comment:/\/\*[\s\S]*?\*\//,atrule:{pattern:/@[\w-]+?.*?(?:;|(?=\s*\{))/i,inside:{rule:/@[\w-]+/}},url:/url\((?:(["'])(?:\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1|.*?)\)/i,selector:/[^{}\s][^{};]*?(?=\s*\{)/,string:{pattern:/("|')(?:\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1/,greedy:!0},property:/[-_a-z\xA0-\uFFFF][-\w\xA0-\uFFFF]*(?=\s*:)/i,important:/\B!important\b/i,function:/[-a-z0-9]+(?=\()/i,punctuation:/[(){};:]/},r.languages.css.atrule.inside.rest=r.languages.css,r.languages.markup&&(r.languages.insertBefore("markup","tag",{style:{pattern:/(<style[\s\S]*?>)[\s\S]*?(?=<\/style>)/i,lookbehind:!0,inside:r.languages.css,alias:"language-css",greedy:!0}}),r.languages.insertBefore("inside","attr-value",{"style-attr":{pattern:/\s*style=("|')(?:\\[\s\S]|(?!\1)[^\\])*\1/i,inside:{"attr-name":{pattern:/^\s*style/i,inside:r.languages.markup.tag.inside},punctuation:/^\s*=\s*['"]|['"]\s*$/,"attr-value":{pattern:/.+/i,inside:r.languages.css}},alias:"language-css"}},r.languages.markup.tag)),r.languages.clike={comment:[{pattern:/(^|[^\\])\/\*[\s\S]*?(?:\*\/|$)/,lookbehind:!0},{pattern:/(^|[^\\:])\/\/.*/,lookbehind:!0,greedy:!0}],string:{pattern:/(["'])(?:\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1/,greedy:!0},"class-name":{pattern:/((?:\b(?:class|interface|extends|implements|trait|instanceof|new)\s+)|(?:catch\s+\())[\w.\\]+/i,lookbehind:!0,inside:{punctuation:/[.\\]/}},keyword:/\b(?:if|else|while|do|for|return|in|instanceof|function|new|try|throw|catch|finally|null|break|continue)\b/,boolean:/\b(?:true|false)\b/,function:/\w+(?=\()/,number:/\b0x[\da-f]+\b|(?:\b\d+\.?\d*|\B\.\d+)(?:e[+-]?\d+)?/i,operator:/--?|\+\+?|!=?=?|<=?|>=?|==?=?|&&?|\|\|?|\?|\*|\/|~|\^|%/,punctuation:/[{}[\];(),.:]/},r.languages.javascript=r.languages.extend("clike",{"class-name":[r.languages.clike["class-name"],{pattern:/(^|[^$\w\xA0-\uFFFF])[_$A-Z\xA0-\uFFFF][$\w\xA0-\uFFFF]*(?=\.(?:prototype|constructor))/,lookbehind:!0}],keyword:[{pattern:/((?:^|})\s*)(?:catch|finally)\b/,lookbehind:!0},/\b(?:as|async|await|break|case|class|const|continue|debugger|default|delete|do|else|enum|export|extends|for|from|function|get|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|set|static|super|switch|this|throw|try|typeof|var|void|while|with|yield)\b/],number:/\b(?:(?:0[xX][\dA-Fa-f]+|0[bB][01]+|0[oO][0-7]+)n?|\d+n|NaN|Infinity)\b|(?:\b\d+\.?\d*|\B\.\d+)(?:[Ee][+-]?\d+)?/,function:/[_$a-zA-Z\xA0-\uFFFF][$\w\xA0-\uFFFF]*(?=\s*\(|\.(?:apply|bind|call)\()/,operator:/-[-=]?|\+[+=]?|!=?=?|<<?=?|>>?>?=?|=(?:==?|>)?|&[&=]?|\|[|=]?|\*\*?=?|\/=?|~|\^=?|%=?|\?|\.{3}/}),r.languages.javascript["class-name"][0].pattern=/(\b(?:class|interface|extends|implements|instanceof|new)\s+)[\w.\\]+/,r.languages.insertBefore("javascript","keyword",{regex:{pattern:/((?:^|[^$\w\xA0-\uFFFF."'\])\s])\s*)\/(\[[^\]\r\n]+]|\\.|[^\/\\\[\r\n])+\/[gimyu]{0,5}(?=\s*($|[\r\n,.;})\]]))/,lookbehind:!0,greedy:!0},"function-variable":{pattern:/[_$a-z\xA0-\uFFFF][$\w\xA0-\uFFFF]*(?=\s*[=:]\s*(?:function\b|(?:\([^()]*\)|[_$a-z\xA0-\uFFFF][$\w\xA0-\uFFFF]*)\s*=>))/i,alias:"function"},constant:/\b[A-Z][A-Z\d_]*\b/}),r.languages.insertBefore("javascript","string",{"template-string":{pattern:/`(?:\\[\s\S]|\${[^}]+}|[^\\`])*`/,greedy:!0,inside:{interpolation:{pattern:/\${[^}]+}/,inside:{"interpolation-punctuation":{pattern:/^\${|}$/,alias:"punctuation"},rest:r.languages.javascript}},string:/[\s\S]+/}}}),r.languages.markup&&r.languages.insertBefore("markup","tag",{script:{pattern:/(<script[\s\S]*?>)[\s\S]*?(?=<\/script>)/i,lookbehind:!0,inside:r.languages.javascript,alias:"language-javascript",greedy:!0}}),r.languages.js=r.languages.javascript,r.languages.c=r.languages.extend("clike",{keyword:/\b(?:_Alignas|_Alignof|_Atomic|_Bool|_Complex|_Generic|_Imaginary|_Noreturn|_Static_assert|_Thread_local|asm|typeof|inline|auto|break|case|char|const|continue|default|do|double|else|enum|extern|float|for|goto|if|int|long|register|return|short|signed|sizeof|static|struct|switch|typedef|union|unsigned|void|volatile|while)\b/,operator:/>>=?|<<=?|->|([-+&|:])\1|[?:~]|[-+*\/%&|^!=<>]=?/,number:/(?:\b0x[\da-f]+|(?:\b\d+\.?\d*|\B\.\d+)(?:e[+-]?\d+)?)[ful]*/i}),r.languages.insertBefore("c","string",{macro:{pattern:/(^\s*)#\s*[a-z]+(?:[^\r\n\\]|\\(?:\r\n|[\s\S]))*/im,lookbehind:!0,alias:"property",inside:{string:{pattern:/(#\s*include\s*)(?:<.+?>|("|')(?:\\?.)+?\2)/,lookbehind:!0},directive:{pattern:/(#\s*)\b(?:define|defined|elif|else|endif|error|ifdef|ifndef|if|import|include|line|pragma|undef|using)\b/,lookbehind:!0,alias:"keyword"}}},constant:/\b(?:__FILE__|__LINE__|__DATE__|__TIME__|__TIMESTAMP__|__func__|EOF|NULL|SEEK_CUR|SEEK_END|SEEK_SET|stdin|stdout|stderr)\b/}),delete r.languages.c["class-name"],delete r.languages.c.boolean,r.languages.csharp=r.languages.extend("clike",{keyword:/\b(?:abstract|add|alias|as|ascending|async|await|base|bool|break|byte|case|catch|char|checked|class|const|continue|decimal|default|delegate|descending|do|double|dynamic|else|enum|event|explicit|extern|false|finally|fixed|float|for|foreach|from|get|global|goto|group|if|implicit|in|int|interface|internal|into|is|join|let|lock|long|namespace|new|null|object|operator|orderby|out|override|params|partial|private|protected|public|readonly|ref|remove|return|sbyte|sealed|select|set|short|sizeof|stackalloc|static|string|struct|switch|this|throw|true|try|typeof|uint|ulong|unchecked|unsafe|ushort|using|value|var|virtual|void|volatile|where|while|yield)\b/,string:[{pattern:/@("|')(?:\1\1|\\[\s\S]|(?!\1)[^\\])*\1/,greedy:!0},{pattern:/("|')(?:\\.|(?!\1)[^\\\r\n])*?\1/,greedy:!0}],"class-name":[{pattern:/\b[A-Z]\w*(?:\.\w+)*\b(?=\s+\w+)/,inside:{punctuation:/\./}},{pattern:/(\[)[A-Z]\w*(?:\.\w+)*\b/,lookbehind:!0,inside:{punctuation:/\./}},{pattern:/(\b(?:class|interface)\s+[A-Z]\w*(?:\.\w+)*\s*:\s*)[A-Z]\w*(?:\.\w+)*\b/,lookbehind:!0,inside:{punctuation:/\./}},{pattern:/((?:\b(?:class|interface|new)\s+)|(?:catch\s+\())[A-Z]\w*(?:\.\w+)*\b/,lookbehind:!0,inside:{punctuation:/\./}}],number:/\b0x[\da-f]+\b|(?:\b\d+\.?\d*|\B\.\d+)f?/i}),r.languages.insertBefore("csharp","class-name",{"generic-method":{pattern:/\w+\s*<[^>\r\n]+?>\s*(?=\()/,inside:{function:/^\w+/,"class-name":{pattern:/\b[A-Z]\w*(?:\.\w+)*\b/,inside:{punctuation:/\./}},keyword:r.languages.csharp.keyword,punctuation:/[<>(),.:]/}},preprocessor:{pattern:/(^\s*)#.*/m,lookbehind:!0,alias:"property",inside:{directive:{pattern:/(\s*#)\b(?:define|elif|else|endif|endregion|error|if|line|pragma|region|undef|warning)\b/,lookbehind:!0,alias:"keyword"}}}}),r.languages.dotnet=r.languages.csharp,function(t){var e={variable:[{pattern:/\$?\(\([\s\S]+?\)\)/,inside:{variable:[{pattern:/(^\$\(\([\s\S]+)\)\)/,lookbehind:!0},/^\$\(\(/],number:/\b0x[\dA-Fa-f]+\b|(?:\b\d+\.?\d*|\B\.\d+)(?:[Ee]-?\d+)?/,operator:/--?|-=|\+\+?|\+=|!=?|~|\*\*?|\*=|\/=?|%=?|<<=?|>>=?|<=?|>=?|==?|&&?|&=|\^=?|\|\|?|\|=|\?|:/,punctuation:/\(\(?|\)\)?|,|;/}},{pattern:/\$\([^)]+\)|`[^`]+`/,greedy:!0,inside:{variable:/^\$\(|^`|\)$|`$/}},/\$(?:[\w#?*!@]+|\{[^}]+\})/i]};t.languages.bash={shebang:{pattern:/^#!\s*\/bin\/bash|^#!\s*\/bin\/sh/,alias:"important"},comment:{pattern:/(^|[^"{\\])#.*/,lookbehind:!0},string:[{pattern:/((?:^|[^<])<<\s*)["']?(\w+?)["']?\s*\r?\n(?:[\s\S])*?\r?\n\2/,lookbehind:!0,greedy:!0,inside:e},{pattern:/(["'])(?:\\[\s\S]|\$\([^)]+\)|`[^`]+`|(?!\1)[^\\])*\1/,greedy:!0,inside:e}],variable:e.variable,function:{pattern:/(^|[\s;|&])(?:alias|apropos|apt-get|aptitude|aspell|awk|basename|bash|bc|bg|builtin|bzip2|cal|cat|cd|cfdisk|chgrp|chmod|chown|chroot|chkconfig|cksum|clear|cmp|comm|command|cp|cron|crontab|csplit|curl|cut|date|dc|dd|ddrescue|df|diff|diff3|dig|dir|dircolors|dirname|dirs|dmesg|du|egrep|eject|enable|env|ethtool|eval|exec|expand|expect|export|expr|fdformat|fdisk|fg|fgrep|file|find|fmt|fold|format|free|fsck|ftp|fuser|gawk|getopts|git|grep|groupadd|groupdel|groupmod|groups|gzip|hash|head|help|hg|history|hostname|htop|iconv|id|ifconfig|ifdown|ifup|import|install|jobs|join|kill|killall|less|link|ln|locate|logname|logout|look|lpc|lpr|lprint|lprintd|lprintq|lprm|ls|lsof|make|man|mkdir|mkfifo|mkisofs|mknod|more|most|mount|mtools|mtr|mv|mmv|nano|netstat|nice|nl|nohup|notify-send|npm|nslookup|open|op|passwd|paste|pathchk|ping|pkill|popd|pr|printcap|printenv|printf|ps|pushd|pv|pwd|quota|quotacheck|quotactl|ram|rar|rcp|read|readarray|readonly|reboot|rename|renice|remsync|rev|rm|rmdir|rsync|screen|scp|sdiff|sed|seq|service|sftp|shift|shopt|shutdown|sleep|slocate|sort|source|split|ssh|stat|strace|su|sudo|sum|suspend|sync|tail|tar|tee|test|time|timeout|times|touch|top|traceroute|trap|tr|tsort|tty|type|ulimit|umask|umount|unalias|uname|unexpand|uniq|units|unrar|unshar|uptime|useradd|userdel|usermod|users|uuencode|uudecode|v|vdir|vi|vmstat|wait|watch|wc|wget|whereis|which|who|whoami|write|xargs|xdg-open|yes|zip)(?=$|[\s;|&])/,lookbehind:!0},keyword:{pattern:/(^|[\s;|&])(?:let|:|\.|if|then|else|elif|fi|for|break|continue|while|in|case|function|select|do|done|until|echo|exit|return|set|declare)(?=$|[\s;|&])/,lookbehind:!0},boolean:{pattern:/(^|[\s;|&])(?:true|false)(?=$|[\s;|&])/,lookbehind:!0},operator:/&&?|\|\|?|==?|!=?|<<<?|>>|<=?|>=?|=~/,punctuation:/\$?\(\(?|\)\)?|\.\.|[{}[\];]/};var n=e.variable[1].inside;n.string=t.languages.bash.string,n.function=t.languages.bash.function,n.keyword=t.languages.bash.keyword,n.boolean=t.languages.bash.boolean,n.operator=t.languages.bash.operator,n.punctuation=t.languages.bash.punctuation,t.languages.shell=t.languages.bash}(r),r.languages.cpp=r.languages.extend("c",{keyword:/\b(?:alignas|alignof|asm|auto|bool|break|case|catch|char|char16_t|char32_t|class|compl|const|constexpr|const_cast|continue|decltype|default|delete|do|double|dynamic_cast|else|enum|explicit|export|extern|float|for|friend|goto|if|inline|int|int8_t|int16_t|int32_t|int64_t|uint8_t|uint16_t|uint32_t|uint64_t|long|mutable|namespace|new|noexcept|nullptr|operator|private|protected|public|register|reinterpret_cast|return|short|signed|sizeof|static|static_assert|static_cast|struct|switch|template|this|thread_local|throw|try|typedef|typeid|typename|union|unsigned|using|virtual|void|volatile|wchar_t|while)\b/,boolean:/\b(?:true|false)\b/,operator:/>>=?|<<=?|->|([-+&|:])\1|[?:~]|[-+*\/%&|^!=<>]=?|\b(?:and|and_eq|bitand|bitor|not|not_eq|or|or_eq|xor|xor_eq)\b/}),r.languages.insertBefore("cpp","keyword",{"class-name":{pattern:/(class\s+)\w+/i,lookbehind:!0}}),r.languages.insertBefore("cpp","string",{"raw-string":{pattern:/R"([^()\\ ]{0,16})\([\s\S]*?\)\1"/,alias:"string",greedy:!0}}),function(t){t.languages.ruby=t.languages.extend("clike",{comment:[/#.*/,{pattern:/^=begin(?:\r?\n|\r)(?:.*(?:\r?\n|\r))*?=end/m,greedy:!0}],keyword:/\b(?:alias|and|BEGIN|begin|break|case|class|def|define_method|defined|do|each|else|elsif|END|end|ensure|false|for|if|in|module|new|next|nil|not|or|protected|private|public|raise|redo|require|rescue|retry|return|self|super|then|throw|true|undef|unless|until|when|while|yield)\b/});var e={pattern:/#\{[^}]+\}/,inside:{delimiter:{pattern:/^#\{|\}$/,alias:"tag"},rest:t.languages.ruby}};t.languages.insertBefore("ruby","keyword",{regex:[{pattern:/%r([^a-zA-Z0-9\s{(\[<])(?:(?!\1)[^\\]|\\[\s\S])*\1[gim]{0,3}/,greedy:!0,inside:{interpolation:e}},{pattern:/%r\((?:[^()\\]|\\[\s\S])*\)[gim]{0,3}/,greedy:!0,inside:{interpolation:e}},{pattern:/%r\{(?:[^#{}\\]|#(?:\{[^}]+\})?|\\[\s\S])*\}[gim]{0,3}/,greedy:!0,inside:{interpolation:e}},{pattern:/%r\[(?:[^\[\]\\]|\\[\s\S])*\][gim]{0,3}/,greedy:!0,inside:{interpolation:e}},{pattern:/%r<(?:[^<>\\]|\\[\s\S])*>[gim]{0,3}/,greedy:!0,inside:{interpolation:e}},{pattern:/(^|[^\/])\/(?!\/)(\[.+?]|\\.|[^\/\\\r\n])+\/[gim]{0,3}(?=\s*($|[\r\n,.;})]))/,lookbehind:!0,greedy:!0}],variable:/[@$]+[a-zA-Z_]\w*(?:[?!]|\b)/,symbol:{pattern:/(^|[^:]):[a-zA-Z_]\w*(?:[?!]|\b)/,lookbehind:!0}}),t.languages.insertBefore("ruby","number",{builtin:/\b(?:Array|Bignum|Binding|Class|Continuation|Dir|Exception|FalseClass|File|Stat|Fixnum|Float|Hash|Integer|IO|MatchData|Method|Module|NilClass|Numeric|Object|Proc|Range|Regexp|String|Struct|TMS|Symbol|ThreadGroup|Thread|Time|TrueClass)\b/,constant:/\b[A-Z]\w*(?:[?!]|\b)/}),t.languages.ruby.string=[{pattern:/%[qQiIwWxs]?([^a-zA-Z0-9\s{(\[<])(?:(?!\1)[^\\]|\\[\s\S])*\1/,greedy:!0,inside:{interpolation:e}},{pattern:/%[qQiIwWxs]?\((?:[^()\\]|\\[\s\S])*\)/,greedy:!0,inside:{interpolation:e}},{pattern:/%[qQiIwWxs]?\{(?:[^#{}\\]|#(?:\{[^}]+\})?|\\[\s\S])*\}/,greedy:!0,inside:{interpolation:e}},{pattern:/%[qQiIwWxs]?\[(?:[^\[\]\\]|\\[\s\S])*\]/,greedy:!0,inside:{interpolation:e}},{pattern:/%[qQiIwWxs]?<(?:[^<>\\]|\\[\s\S])*>/,greedy:!0,inside:{interpolation:e}},{pattern:/("|')(?:#\{[^}]+\}|\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1/,greedy:!0,inside:{interpolation:e}}]}(r),r.languages["markup-templating"]={},Object.defineProperties(r.languages["markup-templating"],{buildPlaceholders:{value:function(t,e,n,o){t.language===e&&(t.tokenStack=[],t.code=t.code.replace(n,function(n){if("function"==typeof o&&!o(n))return n;for(var i=t.tokenStack.length;-1!==t.code.indexOf("___"+e.toUpperCase()+i+"___");)++i;return t.tokenStack[i]=n,"___"+e.toUpperCase()+i+"___"}),t.grammar=r.languages.markup)}},tokenizePlaceholders:{value:function(t,e){if(t.language===e&&t.tokenStack){t.grammar=r.languages[e];var n=0,o=Object.keys(t.tokenStack),i=function(a){if(!(n>=o.length))for(var s=0;s<a.length;s++){var l=a[s];if("string"==typeof l||l.content&&"string"==typeof l.content){var c=o[n],u=t.tokenStack[c],d="string"==typeof l?l:l.content,p=d.indexOf("___"+e.toUpperCase()+c+"___");if(p>-1){++n;var h,f=d.substring(0,p),g=new r.Token(e,r.tokenize(u,t.grammar,e),"language-"+e,u),m=d.substring(p+("___"+e.toUpperCase()+c+"___").length);if(f||m?(h=[f,g,m].filter(function(t){return!!t}),i(h)):h=g,"string"==typeof l?Array.prototype.splice.apply(a,[s,1].concat(h)):l.content=h,n>=o.length)break}}else l.content&&"string"!=typeof l.content&&i(l.content)}};i(t.tokens)}}}}),r.languages.go=r.languages.extend("clike",{keyword:/\b(?:break|case|chan|const|continue|default|defer|else|fallthrough|for|func|go(?:to)?|if|import|interface|map|package|range|return|select|struct|switch|type|var)\b/,builtin:/\b(?:bool|byte|complex(?:64|128)|error|float(?:32|64)|rune|string|u?int(?:8|16|32|64)?|uintptr|append|cap|close|complex|copy|delete|imag|len|make|new|panic|print(?:ln)?|real|recover)\b/,boolean:/\b(?:_|iota|nil|true|false)\b/,operator:/[*\/%^!=]=?|\+[=+]?|-[=-]?|\|[=|]?|&(?:=|&|\^=?)?|>(?:>=?|=)?|<(?:<=?|=|-)?|:=|\.\.\./,number:/(?:\b0x[a-f\d]+|(?:\b\d+\.?\d*|\B\.\d+)(?:e[-+]?\d+)?)i?/i,string:{pattern:/(["'`])(\\[\s\S]|(?!\1)[^\\])*\1/,greedy:!0}}),delete r.languages.go["class-name"],r.languages.java=r.languages.extend("clike",{keyword:/\b(?:var|abstract|continue|for|new|switch|assert|default|goto|package|synchronized|boolean|do|if|private|this|break|double|implements|protected|throw|byte|else|import|public|throws|case|enum|instanceof|return|transient|catch|extends|int|short|try|char|final|interface|static|void|class|finally|long|strictfp|volatile|const|float|native|super|while)\b/,number:/\b0b[01]+\b|\b0x[\da-f]*\.?[\da-fp-]+\b|(?:\b\d+\.?\d*|\B\.\d+)(?:e[+-]?\d+)?[df]?/i,operator:{pattern:/(^|[^.])(?:<<=?|>>>?=?|->|([-+&|])\2|[?:~]|[-+*\/%&|^!=<>]=?)/m,lookbehind:!0}}),r.languages.insertBefore("java","function",{annotation:{alias:"punctuation",pattern:/(^|[^.])@\w+/,lookbehind:!0}}),r.languages.insertBefore("java","class-name",{generics:{pattern:/<\s*\w+(?:\.\w+)?(?:\s*,\s*\w+(?:\.\w+)?)*>/i,alias:"function",inside:{keyword:r.languages.java.keyword,punctuation:/[<>(),.:]/}}}),r.languages.json={property:/"(?:\\.|[^\\"\r\n])*"(?=\s*:)/i,string:{pattern:/"(?:\\.|[^\\"\r\n])*"(?!\s*:)/,greedy:!0},number:/-?\d+\.?\d*([Ee][+-]?\d+)?/,punctuation:/[{}[\],]/,operator:/:/g,boolean:/\b(?:true|false)\b/i,null:/\bnull\b/i},r.languages.jsonp=r.languages.json,function(t){t.languages.kotlin=t.languages.extend("clike",{keyword:{pattern:/(^|[^.])\b(?:abstract|actual|annotation|as|break|by|catch|class|companion|const|constructor|continue|crossinline|data|do|dynamic|else|enum|expect|external|final|finally|for|fun|get|if|import|in|infix|init|inline|inner|interface|internal|is|lateinit|noinline|null|object|open|operator|out|override|package|private|protected|public|reified|return|sealed|set|super|suspend|tailrec|this|throw|to|try|typealias|val|var|vararg|when|where|while)\b/,lookbehind:!0},function:[/\w+(?=\s*\()/,{pattern:/(\.)\w+(?=\s*\{)/,lookbehind:!0}],number:/\b(?:0[xX][\da-fA-F]+(?:_[\da-fA-F]+)*|0[bB][01]+(?:_[01]+)*|\d+(?:_\d+)*(?:\.\d+(?:_\d+)*)?(?:[eE][+-]?\d+(?:_\d+)*)?[fFL]?)\b/,operator:/\+[+=]?|-[-=>]?|==?=?|!(?:!|==?)?|[\/*%<>]=?|[?:]:?|\.\.|&&|\|\||\b(?:and|inv|or|shl|shr|ushr|xor)\b/}),delete t.languages.kotlin["class-name"],t.languages.insertBefore("kotlin","string",{"raw-string":{pattern:/("""|''')[\s\S]*?\1/,alias:"string"}}),t.languages.insertBefore("kotlin","keyword",{annotation:{pattern:/\B@(?:\w+:)?(?:[A-Z]\w*|\[[^\]]+\])/,alias:"builtin"}}),t.languages.insertBefore("kotlin","function",{label:{pattern:/\w+@|@\w+/,alias:"symbol"}});var e=[{pattern:/\$\{[^}]+\}/,inside:{delimiter:{pattern:/^\$\{|\}$/,alias:"variable"},rest:t.languages.kotlin}},{pattern:/\$\w+/,alias:"variable"}];t.languages.kotlin.string.inside=t.languages.kotlin["raw-string"].inside={interpolation:e}}(r),r.languages.markdown=r.languages.extend("markup",{}),r.languages.insertBefore("markdown","prolog",{blockquote:{pattern:/^>(?:[\t ]*>)*/m,alias:"punctuation"},code:[{pattern:/^(?: {4}|\t).+/m,alias:"keyword"},{pattern:/``.+?``|`[^`\n]+`/,alias:"keyword"}],title:[{pattern:/\w+.*(?:\r?\n|\r)(?:==+|--+)/,alias:"important",inside:{punctuation:/==+$|--+$/}},{pattern:/(^\s*)#+.+/m,lookbehind:!0,alias:"important",inside:{punctuation:/^#+|#+$/}}],hr:{pattern:/(^\s*)([*-])(?:[\t ]*\2){2,}(?=\s*$)/m,lookbehind:!0,alias:"punctuation"},list:{pattern:/(^\s*)(?:[*+-]|\d+\.)(?=[\t ].)/m,lookbehind:!0,alias:"punctuation"},"url-reference":{pattern:/!?\[[^\]]+\]:[\t ]+(?:\S+|<(?:\\.|[^>\\])+>)(?:[\t ]+(?:"(?:\\.|[^"\\])*"|'(?:\\.|[^'\\])*'|\((?:\\.|[^)\\])*\)))?/,inside:{variable:{pattern:/^(!?\[)[^\]]+/,lookbehind:!0},string:/(?:"(?:\\.|[^"\\])*"|'(?:\\.|[^'\\])*'|\((?:\\.|[^)\\])*\))$/,punctuation:/^[\[\]!:]|[<>]/},alias:"url"},bold:{pattern:/(^|[^\\])(\*\*|__)(?:(?:\r?\n|\r)(?!\r?\n|\r)|.)+?\2/,lookbehind:!0,inside:{punctuation:/^\*\*|^__|\*\*$|__$/}},italic:{pattern:/(^|[^\\])([*_])(?:(?:\r?\n|\r)(?!\r?\n|\r)|.)+?\2/,lookbehind:!0,inside:{punctuation:/^[*_]|[*_]$/}},url:{pattern:/!?\[[^\]]+\](?:\([^\s)]+(?:[\t ]+"(?:\\.|[^"\\])*")?\)| ?\[[^\]\n]*\])/,inside:{variable:{pattern:/(!?\[)[^\]]+(?=\]$)/,lookbehind:!0},string:{pattern:/"(?:\\.|[^"\\])*"(?=\)$)/}}}}),r.languages.markdown.bold.inside.url=r.languages.markdown.url,r.languages.markdown.italic.inside.url=r.languages.markdown.url,r.languages.markdown.bold.inside.italic=r.languages.markdown.italic,r.languages.markdown.italic.inside.bold=r.languages.markdown.bold,r.languages.matlab={comment:[/%\{[\s\S]*?\}%/,/%.+/],string:{pattern:/\B'(?:''|[^'\r\n])*'/,greedy:!0},number:/(?:\b\d+\.?\d*|\B\.\d+)(?:[eE][+-]?\d+)?(?:[ij])?|\b[ij]\b/,keyword:/\b(?:break|case|catch|continue|else|elseif|end|for|function|if|inf|NaN|otherwise|parfor|pause|pi|return|switch|try|while)\b/,function:/(?!\d)\w+(?=\s*\()/,operator:/\.?[*^\/\\']|[+\-:@]|[<>=~]=?|&&?|\|\|?/,punctuation:/\.{3}|[.,;\[\](){}!]/},r.languages.objectivec=r.languages.extend("c",{keyword:/\b(?:asm|typeof|inline|auto|break|case|char|const|continue|default|do|double|else|enum|extern|float|for|goto|if|int|long|register|return|short|signed|sizeof|static|struct|switch|typedef|union|unsigned|void|volatile|while|in|self|super)\b|(?:@interface|@end|@implementation|@protocol|@class|@public|@protected|@private|@property|@try|@catch|@finally|@throw|@synthesize|@dynamic|@selector)\b/,string:/("|')(?:\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1|@"(?:\\(?:\r\n|[\s\S])|[^"\\\r\n])*"/,operator:/-[->]?|\+\+?|!=?|<<?=?|>>?=?|==?|&&?|\|\|?|[~^%?*\/@]/}),function(t){t.languages.php=t.languages.extend("clike",{keyword:/\b(?:and|or|xor|array|as|break|case|cfunction|class|const|continue|declare|default|die|do|else|elseif|enddeclare|endfor|endforeach|endif|endswitch|endwhile|extends|for|foreach|function|include|include_once|global|if|new|return|static|switch|use|require|require_once|var|while|abstract|interface|public|implements|private|protected|parent|throw|null|echo|print|trait|namespace|final|yield|goto|instanceof|finally|try|catch)\b/i,constant:/\b[A-Z0-9_]{2,}\b/,comment:{pattern:/(^|[^\\])(?:\/\*[\s\S]*?\*\/|\/\/.*)/,lookbehind:!0}}),t.languages.insertBefore("php","string",{"shell-comment":{pattern:/(^|[^\\])#.*/,lookbehind:!0,alias:"comment"}}),t.languages.insertBefore("php","keyword",{delimiter:{pattern:/\?>|<\?(?:php|=)?/i,alias:"important"},variable:/\$+(?:\w+\b|(?={))/i,package:{pattern:/(\\|namespace\s+|use\s+)[\w\\]+/,lookbehind:!0,inside:{punctuation:/\\/}}}),t.languages.insertBefore("php","operator",{property:{pattern:/(->)[\w]+/,lookbehind:!0}});var e={pattern:/{\$(?:{(?:{[^{}]+}|[^{}]+)}|[^{}])+}|(^|[^\\{])\$+(?:\w+(?:\[.+?]|->\w+)*)/,lookbehind:!0,inside:{rest:t.languages.php}};t.languages.insertBefore("php","string",{"nowdoc-string":{pattern:/<<<'([^']+)'(?:\r\n?|\n)(?:.*(?:\r\n?|\n))*?\1;/,greedy:!0,alias:"string",inside:{delimiter:{pattern:/^<<<'[^']+'|[a-z_]\w*;$/i,alias:"symbol",inside:{punctuation:/^<<<'?|[';]$/}}}},"heredoc-string":{pattern:/<<<(?:"([^"]+)"(?:\r\n?|\n)(?:.*(?:\r\n?|\n))*?\1;|([a-z_]\w*)(?:\r\n?|\n)(?:.*(?:\r\n?|\n))*?\2;)/i,greedy:!0,alias:"string",inside:{delimiter:{pattern:/^<<<(?:"[^"]+"|[a-z_]\w*)|[a-z_]\w*;$/i,alias:"symbol",inside:{punctuation:/^<<<"?|[";]$/}},interpolation:e}},"single-quoted-string":{pattern:/'(?:\\[\s\S]|[^\\'])*'/,greedy:!0,alias:"string"},"double-quoted-string":{pattern:/"(?:\\[\s\S]|[^\\"])*"/,greedy:!0,alias:"string",inside:{interpolation:e}}}),delete t.languages.php.string,t.hooks.add("before-tokenize",function(e){if(/(?:<\?php|<\?)/gi.test(e.code)){t.languages["markup-templating"].buildPlaceholders(e,"php",/(?:<\?php|<\?)[\s\S]*?(?:\?>|$)/gi)}}),t.hooks.add("after-tokenize",function(e){t.languages["markup-templating"].tokenizePlaceholders(e,"php")})}(r),r.languages.sql={comment:{pattern:/(^|[^\\])(?:\/\*[\s\S]*?\*\/|(?:--|\/\/|#).*)/,lookbehind:!0},variable:[{pattern:/@(["'`])(?:\\[\s\S]|(?!\1)[^\\])+\1/,greedy:!0},/@[\w.$]+/],string:{pattern:/(^|[^@\\])("|')(?:\\[\s\S]|(?!\2)[^\\]|\2\2)*\2/,greedy:!0,lookbehind:!0},function:/\b(?:AVG|COUNT|FIRST|FORMAT|LAST|LCASE|LEN|MAX|MID|MIN|MOD|NOW|ROUND|SUM|UCASE)(?=\s*\()/i,keyword:/\b(?:ACTION|ADD|AFTER|ALGORITHM|ALL|ALTER|ANALYZE|ANY|APPLY|AS|ASC|AUTHORIZATION|AUTO_INCREMENT|BACKUP|BDB|BEGIN|BERKELEYDB|BIGINT|BINARY|BIT|BLOB|BOOL|BOOLEAN|BREAK|BROWSE|BTREE|BULK|BY|CALL|CASCADED?|CASE|CHAIN|CHAR(?:ACTER|SET)?|CHECK(?:POINT)?|CLOSE|CLUSTERED|COALESCE|COLLATE|COLUMNS?|COMMENT|COMMIT(?:TED)?|COMPUTE|CONNECT|CONSISTENT|CONSTRAINT|CONTAINS(?:TABLE)?|CONTINUE|CONVERT|CREATE|CROSS|CURRENT(?:_DATE|_TIME|_TIMESTAMP|_USER)?|CURSOR|CYCLE|DATA(?:BASES?)?|DATE(?:TIME)?|DAY|DBCC|DEALLOCATE|DEC|DECIMAL|DECLARE|DEFAULT|DEFINER|DELAYED|DELETE|DELIMITERS?|DENY|DESC|DESCRIBE|DETERMINISTIC|DISABLE|DISCARD|DISK|DISTINCT|DISTINCTROW|DISTRIBUTED|DO|DOUBLE|DROP|DUMMY|DUMP(?:FILE)?|DUPLICATE|ELSE(?:IF)?|ENABLE|ENCLOSED|END|ENGINE|ENUM|ERRLVL|ERRORS|ESCAPED?|EXCEPT|EXEC(?:UTE)?|EXISTS|EXIT|EXPLAIN|EXTENDED|FETCH|FIELDS|FILE|FILLFACTOR|FIRST|FIXED|FLOAT|FOLLOWING|FOR(?: EACH ROW)?|FORCE|FOREIGN|FREETEXT(?:TABLE)?|FROM|FULL|FUNCTION|GEOMETRY(?:COLLECTION)?|GLOBAL|GOTO|GRANT|GROUP|HANDLER|HASH|HAVING|HOLDLOCK|HOUR|IDENTITY(?:_INSERT|COL)?|IF|IGNORE|IMPORT|INDEX|INFILE|INNER|INNODB|INOUT|INSERT|INT|INTEGER|INTERSECT|INTERVAL|INTO|INVOKER|ISOLATION|ITERATE|JOIN|KEYS?|KILL|LANGUAGE|LAST|LEAVE|LEFT|LEVEL|LIMIT|LINENO|LINES|LINESTRING|LOAD|LOCAL|LOCK|LONG(?:BLOB|TEXT)|LOOP|MATCH(?:ED)?|MEDIUM(?:BLOB|INT|TEXT)|MERGE|MIDDLEINT|MINUTE|MODE|MODIFIES|MODIFY|MONTH|MULTI(?:LINESTRING|POINT|POLYGON)|NATIONAL|NATURAL|NCHAR|NEXT|NO|NONCLUSTERED|NULLIF|NUMERIC|OFF?|OFFSETS?|ON|OPEN(?:DATASOURCE|QUERY|ROWSET)?|OPTIMIZE|OPTION(?:ALLY)?|ORDER|OUT(?:ER|FILE)?|OVER|PARTIAL|PARTITION|PERCENT|PIVOT|PLAN|POINT|POLYGON|PRECEDING|PRECISION|PREPARE|PREV|PRIMARY|PRINT|PRIVILEGES|PROC(?:EDURE)?|PUBLIC|PURGE|QUICK|RAISERROR|READS?|REAL|RECONFIGURE|REFERENCES|RELEASE|RENAME|REPEAT(?:ABLE)?|REPLACE|REPLICATION|REQUIRE|RESIGNAL|RESTORE|RESTRICT|RETURNS?|REVOKE|RIGHT|ROLLBACK|ROUTINE|ROW(?:COUNT|GUIDCOL|S)?|RTREE|RULE|SAVE(?:POINT)?|SCHEMA|SECOND|SELECT|SERIAL(?:IZABLE)?|SESSION(?:_USER)?|SET(?:USER)?|SHARE|SHOW|SHUTDOWN|SIMPLE|SMALLINT|SNAPSHOT|SOME|SONAME|SQL|START(?:ING)?|STATISTICS|STATUS|STRIPED|SYSTEM_USER|TABLES?|TABLESPACE|TEMP(?:ORARY|TABLE)?|TERMINATED|TEXT(?:SIZE)?|THEN|TIME(?:STAMP)?|TINY(?:BLOB|INT|TEXT)|TOP?|TRAN(?:SACTIONS?)?|TRIGGER|TRUNCATE|TSEQUAL|TYPES?|UNBOUNDED|UNCOMMITTED|UNDEFINED|UNION|UNIQUE|UNLOCK|UNPIVOT|UNSIGNED|UPDATE(?:TEXT)?|USAGE|USE|USER|USING|VALUES?|VAR(?:BINARY|CHAR|CHARACTER|YING)|VIEW|WAITFOR|WARNINGS|WHEN|WHERE|WHILE|WITH(?: ROLLUP|IN)?|WORK|WRITE(?:TEXT)?|YEAR)\b/i,boolean:/\b(?:TRUE|FALSE|NULL)\b/i,number:/\b0x[\da-f]+\b|\b\d+\.?\d*|\B\.\d+\b/i,operator:/[-+*\/=%^~]|&&?|\|\|?|!=?|<(?:=>?|<|>)?|>[>=]?|\b(?:AND|BETWEEN|IN|LIKE|NOT|OR|IS|DIV|REGEXP|RLIKE|SOUNDS LIKE|XOR)\b/i,punctuation:/[;[\]()`,.]/},r.languages.python={comment:{pattern:/(^|[^\\])#.*/,lookbehind:!0},"triple-quoted-string":{pattern:/("""|''')[\s\S]+?\1/,greedy:!0,alias:"string"},string:{pattern:/("|')(?:\\.|(?!\1)[^\\\r\n])*\1/,greedy:!0},function:{pattern:/((?:^|\s)def[ \t]+)[a-zA-Z_]\w*(?=\s*\()/g,lookbehind:!0},"class-name":{pattern:/(\bclass\s+)\w+/i,lookbehind:!0},keyword:/\b(?:as|assert|async|await|break|class|continue|def|del|elif|else|except|exec|finally|for|from|global|if|import|in|is|lambda|nonlocal|pass|print|raise|return|try|while|with|yield)\b/,builtin:/\b(?:__import__|abs|all|any|apply|ascii|basestring|bin|bool|buffer|bytearray|bytes|callable|chr|classmethod|cmp|coerce|compile|complex|delattr|dict|dir|divmod|enumerate|eval|execfile|file|filter|float|format|frozenset|getattr|globals|hasattr|hash|help|hex|id|input|int|intern|isinstance|issubclass|iter|len|list|locals|long|map|max|memoryview|min|next|object|oct|open|ord|pow|property|range|raw_input|reduce|reload|repr|reversed|round|set|setattr|slice|sorted|staticmethod|str|sum|super|tuple|type|unichr|unicode|vars|xrange|zip)\b/,boolean:/\b(?:True|False|None)\b/,number:/(?:\b(?=\d)|\B(?=\.))(?:0[bo])?(?:(?:\d|0x[\da-f])[\da-f]*\.?\d*|\.\d+)(?:e[+-]?\d+)?j?\b/i,operator:/[-+%=]=?|!=|\*\*?=?|\/\/?=?|<[<=>]?|>[=>]?|[&|^~]|\b(?:or|and|not)\b/,punctuation:/[{}[\];(),.:]/},r.languages.r={comment:/#.*/,string:{pattern:/(['"])(?:\\.|(?!\1)[^\\\r\n])*\1/,greedy:!0},"percent-operator":{pattern:/%[^%\s]*%/,alias:"operator"},boolean:/\b(?:TRUE|FALSE)\b/,ellipsis:/\.\.(?:\.|\d+)/,number:[/\b(?:NaN|Inf)\b/,/(?:\b0x[\dA-Fa-f]+(?:\.\d*)?|\b\d+\.?\d*|\B\.\d+)(?:[EePp][+-]?\d+)?[iL]?/],keyword:/\b(?:if|else|repeat|while|function|for|in|next|break|NULL|NA|NA_integer_|NA_real_|NA_complex_|NA_character_)\b/,operator:/->?>?|<(?:=|<?-)?|[>=!]=?|::?|&&?|\|\|?|[+*\/^$@~]/,punctuation:/[(){}\[\],;]/},r.languages.typescript=r.languages.extend("javascript",{keyword:/\b(?:as|async|await|break|case|catch|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally|for|from|function|get|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|set|static|super|switch|this|throw|try|typeof|var|void|while|with|yield|module|declare|constructor|namespace|abstract|require|type)\b/,builtin:/\b(?:string|Function|any|number|boolean|Array|symbol|console)\b/}),r.languages.ts=r.languages.typescript,r.languages.scala=r.languages.extend("java",{keyword:/<-|=>|\b(?:abstract|case|catch|class|def|do|else|extends|final|finally|for|forSome|if|implicit|import|lazy|match|new|null|object|override|package|private|protected|return|sealed|self|super|this|throw|trait|try|type|val|var|while|with|yield)\b/,string:[{pattern:/"""[\s\S]*?"""/,greedy:!0},{pattern:/("|')(?:\\.|(?!\1)[^\\\r\n])*\1/,greedy:!0}],builtin:/\b(?:String|Int|Long|Short|Byte|Boolean|Double|Float|Char|Any|AnyRef|AnyVal|Unit|Nothing)\b/,number:/\b0x[\da-f]*\.?[\da-f]+|(?:\b\d+\.?\d*|\B\.\d+)(?:e\d+)?[dfl]?/i,symbol:/'[^\d\s\\]\w*/}),delete r.languages.scala["class-name"],delete r.languages.scala.function,r.languages.swift=r.languages.extend("clike",{string:{pattern:/("|')(\\(?:\((?:[^()]|\([^)]+\))+\)|\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1/,greedy:!0,inside:{interpolation:{pattern:/\\\((?:[^()]|\([^)]+\))+\)/,inside:{delimiter:{pattern:/^\\\(|\)$/,alias:"variable"}}}}},keyword:/\b(?:as|associativity|break|case|catch|class|continue|convenience|default|defer|deinit|didSet|do|dynamic(?:Type)?|else|enum|extension|fallthrough|final|for|func|get|guard|if|import|in|infix|init|inout|internal|is|lazy|left|let|mutating|new|none|nonmutating|operator|optional|override|postfix|precedence|prefix|private|protocol|public|repeat|required|rethrows|return|right|safe|self|Self|set|static|struct|subscript|super|switch|throws?|try|Type|typealias|unowned|unsafe|var|weak|where|while|willSet|__(?:COLUMN__|FILE__|FUNCTION__|LINE__))\b/,number:/\b(?:[\d_]+(?:\.[\de_]+)?|0x[a-f0-9_]+(?:\.[a-f0-9p_]+)?|0b[01_]+|0o[0-7_]+)\b/i,constant:/\b(?:nil|[A-Z_]{2,}|k[A-Z][A-Za-z_]+)\b/,atrule:/@\b(?:IB(?:Outlet|Designable|Action|Inspectable)|class_protocol|exported|noreturn|NS(?:Copying|Managed)|objc|UIApplicationMain|auto_closure)\b/,builtin:/\b(?:[A-Z]\S+|abs|advance|alignof(?:Value)?|assert|contains|count(?:Elements)?|debugPrint(?:ln)?|distance|drop(?:First|Last)|dump|enumerate|equal|filter|find|first|getVaList|indices|isEmpty|join|last|lexicographicalCompare|map|max(?:Element)?|min(?:Element)?|numericCast|overlaps|partition|print(?:ln)?|reduce|reflect|reverse|sizeof(?:Value)?|sort(?:ed)?|split|startsWith|stride(?:of(?:Value)?)?|suffix|swap|toDebugString|toString|transcode|underestimateCount|unsafeBitCast|with(?:ExtendedLifetime|Unsafe(?:MutablePointers?|Pointers?)|VaList))\b/}),r.languages.swift.string.inside.interpolation.inside.rest=r.languages.swift}.apply(e,[n,e]))||(t.exports=i)}).call(this,n(67))},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(66),o=n(224);return e.extend({className:"block-view unknown-view",initialize:function(){e.prototype.initialize.apply(this,arguments)},render:function(){this.$el.html("<div>当前版本不支持的内容</div>"),e.prototype.render.apply(this,arguments)},convertToNativeRange:function(){},parseNativeRange:function(t,e,n){if(n)return new o({block:e})}})}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(29),o=n(8),i=n(0),r=n(19);return e.View.extend({className:"highlight-view",_baseRect:null,_focusIndex:-1,_list:[],initialize:function(){i.bindAll(this,"_extractData","onHide","nextHighlight")},_extractData:function(t){var e=this,n=t.getClientRects(),a=[];i.each(n,function(t){t.width<2||a.push(o(r.render("common","high_light_item",{top:t.top-e._baseRect.top-1,left:t.left-e._baseRect.left-2,height:t.height-2,width:t.width})).appendTo(e.$el).get(0))}),e._list.push(o(a))},_reset:function(){this._list=[],this._focusIndex=-1,this.$el.empty()},showHighlight:function(t,e){return t&&e?0===e.length?(this._reset(),void this.onHide()):(this.$el.empty(),this.$el.show(),this._list=[],this._baseRect=this.el.getBoundingClientRect(),i.each(e,this._extractData),this._focusIndex=0,this._list[this._focusIndex].addClass("focused"),void this._list[this._focusIndex].get(0).scrollIntoViewIfNeeded()):(this._reset(),void this.onHide())},nextHighlight:function(t){0!==this._list.length&&(this.$el.show(),t=t||1,this._list[this._focusIndex].removeClass("focused"),this._focusIndex=(this._focusIndex+this._list.length+t)%this._list.length,this._list[this._focusIndex].addClass("focused"),this._list[this._focusIndex].get(0).scrollIntoViewIfNeeded())},preHighlight:function(){this.nextHighlight(-1)},onHide:function(){this.$el.hide()}})}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t){var e=n(29),o=n(19),i=n(8),r=n(0),a=n(2),s=n(176),l=n(306),c=i('<div class="collab-editing-view-wrapper"><div class="collab-session-view"></div></div>'),u="header-footer-view";function d(t){var e=null;do{r.contains(t.classList,u)&&(r.contains(t.classList,"page-header")?e="header":r.contains(t.classList,"page-footer")&&(e="footer")),t=t.parentElement}while(t);return e}return e.View.extend({className:u,name:"header-footer",_focus:!1,_isReadOnly:!1,$input:null,events:{"focus .header-footer-input":"_onFocus","blur .header-footer-input":"_onBlur","keydown .header-footer-input":"_onKeyDown","input .header-footer-input":"_onTextInput","paste .header-footer-input":"_onPaste"},initialize:function(t,e){t=t||{};this.block=t,this._contentOnFocus=null,this._keyMonitor=new s({el:this.el}),this.isFooter=!0===t.isFooter,this._isReadOnly=!!e,r.bindAll(this,"_onLockedChange","_updateViewByModel","_onPaste","_onHighlight"),t.on("high-light",this._onHighlight),t.on("locked-change",this._onLockedChange),t.on("change",this._updateViewByModel),this.render()},render:function(){var t,e=this.block,n=this.$el,i="page-"+(e.isFooter?"footer":"header"),r="点击编辑"+(e.isFooter?"页脚":"页眉");t=o.render("common",this.name,{readonly:this._isReadOnly}),n.html(t),n.addClass(i).attr("title",r),this.$input=n.find(".header-footer-input"),this._updateViewByModel(e.getContent(),e.getAlign()),this._updateLockState(this.isLocked())},_updateViewByModel:function(t,e){this._focus||void 0===t||this.setContent(t),void 0!==e&&this.setAlign(e)},_onHighlight:function(t,e,n){var o=this.block.getHighlight(t,e);o&&this._convertToData(o,n)},_convertToData:function(t,e){var n,o=this.$input.get(0).firstChild;r.each(t,function(t){(n=document.createRange()).setStart(o,t.start),n.setEnd(o,t.end),e(n)})},_onPaste:function(t){var e,n,o=t.originalEvent;t.preventDefault(),o.clipboardData&&o.clipboardData.getData?(n=(e=o.clipboardData.getData("text/plain"))&&e.replace(/\r?\n/g," "),document.execCommand("insertHTML",!1,n)):window.clipboardData&&window.clipboardData.getData&&(e=window.clipboardData.getData("Text"),l(e))},_onLockedChange:function(t){this._updateLockState(this.isLocked()),this._updateLockIndicator(this.block.isLocked(),t),this.trigger("locked-change")},isLocked:function(){var t=this.block,e=!1;return t&&(e=t.isLocked()),e},_updateLockIndicator:function(t,e){var n=c.clone(),o=n.find(".collab-session-view"),i=e&&e.lockColor,r=e&&e.nickname;t?(this.$el.addClass("collab-editing-view"),void 0!==r&&(o.css("background-color",i),o.text(r),this.$el.find(".collab-editing-view-wrapper").remove(),this.$el.prepend(n))):(this.$el.removeClass("collab-editing-view"),this.$el.find(".collab-editing-view-wrapper").remove())},_updateLockState:function(t){t?this.$el.addClass("collab-locked"):this.$el.removeClass("collab-locked")},_onTextInput:function(){this.trigger("text-input",this.$input.text())},_onFocus:function(){this._focus=!0,this._contentOnFocus=this.$input.text()||"",a.log("content on focus: "+this._contentOnFocus),this.trigger("focus")},_onBlur:function(){var t=this.$input.text();this._focus=!1,a.log("content on blur: "+t),t!==this._contentOnFocus&&this.trigger("text-change",t),this.trigger("blur"),this._contentOnFocus=null},_stopPropagation:function(t){t.stopPropagation()},_onKeyDown:function(t){var e=this._keyMonitor;e.isEventMatchKey(t,"enter")?(t.stopPropagation(),t.preventDefault(),this.$el.blur()):e.isEventMatchKey(t,"tab")?(t.stopPropagation(),t.preventDefault(),document.execCommand("insertHTML",!1,"&emsp;")):e.isEventMatchKey(t,"mod+z")||e.isEventMatchKey(t,"mod+y")?(t.stopPropagation(),t.preventDefault()):r.some(["mod+s","mod+shift+r","mod+f"],function(n){return e.isEventMatchKey(t,n)})?t.preventDefault():t.stopPropagation()},getAlign:function(){return this.$input.css("text-align")},setAlign:function(t){var e="left"===t||"right"===t?t:"center";this.$input.css("text-align",e)},setContent:function(t){this.$input.text(t)},getContent:function(){return this.$input.text()},checkChange:function(){var t=this.$input.text()||"";null!=this._contentOnFocus&&t!==this._contentOnFocus&&(this.trigger("text-change",t),this._contentOnFocus=t)}},{isHeaderView:function(t){return"header"===d(t)},isFooterView:function(t){return"footer"===d(t)}})}.call(i,n,i,t))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";var a,s=this&&this.__extends||(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});o=[n,r,n(27),n(0)],void 0===(i=function(t,e,n,o){return function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.prototype.stop=function(){this.trigger("progress-stop")},e.prototype.updateContentSetProgress=function(t){o.isNumber(t.percent)&&this.trigger("progress-update",t)},e.prototype.initialize=function(t){},e}(n)}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";var a,s=this&&this.__extends||(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});o=[n,r,n(0),n(847),n(849),n(21),n(28),n(12),n(4)],void 0===(i=function(t,e,n,o,i,r,a,l,c){var u=i.convertor,d=i.utils;return function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.prototype.canRedo=function(){return this.coreEditor.canRedo()},e.prototype.canUndo=function(){return this.coreEditor.canUndo()},e.prototype.clearHighlight=function(){this.coreEditor.clearHighlight()},e.prototype.focusHighlight=function(t){!0!==t?this.coreEditor.nextHighlight():this.coreEditor.preHighlight()},e.prototype.getPlain=function(){return this.coreEditor.getPlainContent()},e.prototype.highlight=function(t,e){t&&0!==t.length&&this.coreEditor.highlight(t,e)},e.prototype.insertAttachment=function(t){this.coreEditor.execCommand("comp.InsertAttachment",n.extend({retainStartBlock:!0},t))},e.prototype.insertImage=function(t){this.coreEditor.execCommand("comp.InsertImage",{retainStartBlock:!0,src:t})},e.prototype.redo=function(){return this.coreEditor.redo()},e.prototype.setDefaultFont=function(t,e,n){e=parseInt(e+"",10),this.coreEditor.setDefaultFont(t,e,n)},e.prototype.undo=function(){return this.coreEditor.undo()},e.prototype.setPrintNote=function(){this.coreEditor.setPrintNote(!0)},e.prototype.getNoteContentStatus=function(){return this.coreEditor.getNoteContentStatus()},e.prototype.getFirstLineTextContent=function(){return this.coreEditor.getFirstLineTextContent()},e.prototype.updateImageByOrigSrc=function(t,e){this.coreEditor.updateImageByOrigSrc(t,e)},e.prototype.rotateImage=function(t,e){this.coreEditor.rotateImage(t,e)},e.prototype.setContent=function(e,n,o,i){var r=d.getActualContent(e),a="html";r&&r.type&&(a=r.type),r.content&&(this.coreEditor.setDataFixed(e!==r.content),e=r.content),this.coreEditor.setInputType(a),"json"===a&&(e=u.json2xml(e)),t.prototype.setContent.call(this,e,"html"===a,n,o,i)},e.prototype.getContent=function(e,n,o,i){var r=this.coreEditor.getOutputType(e),a=t.prototype.getContent.call(this,"html"===r,n?function(t){var e=t.content;"json"===r&&(e=u.xml2json(e)),n({content:e,status:t.status})}:n,o,i);return a&&"json"===r&&(a=u.xml2json(a)),a},e.prototype.getCollabContent=function(e,n,o){var i,r=this.coreEditor.getOutputType(e);return(i=t.prototype.getCollabContent.call(this,n?function(t){var e=t.content;e&&"json"===r&&(t.content=u.xml2json(e)),n(t)}:n,o))&&i.content&&"json"===r&&(i.content=u.xml2json(i.content)),i},e.prototype.replaceEditorText=function(t,e,n){var o=r.fromNativeRange(e,this.coreEditor.getNoteView()),i=new a({blockId:c.newGUID(),text:new l({text:t})});if(o&&o.isInSingleBlock()){var s=this.coreEditor.getController().querySelectionInlineStyles(o);Object.keys(s).forEach(function(t){i.setTextStyle(t,s[t],0,i.getLength())})}this.coreEditor.execCommand("comp.InsertBlocks",{blocks:[i],range:o}),"function"==typeof n&&n()},e}(o)}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";var a,s=this&&this.__extends||(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});o=[n,r,n(7),n(848),n(2)],void 0===(i=function(t,e,n,o,i){return function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.prototype.buildCollabSession=function(t,e){var n,o=0;try{if(e=e||function(){},n=this.coreEditor.getEditorProps(),null==t&&((t={}).shareKey=n.shareKey,t.sessionType=n.sessionType,null!=n.sessionId&&(t.sessionId=n.sessionId)),t.buildVersion=n.buildVersion,t.userInfo=n.userInfo,t.collabServer=n.collabServer,null==t.shareKey||"undefined"===t.shareKey)return e({resultCode:0,message:"shareKey should NOT be null"}),0;this.closeCollabSession(),this.coreEditor.buildCollabSession(t,e),o=1}catch(t){e({resultCode:0,message:t.message})}return o},e.prototype.closeCollabSession=function(){this.coreEditor.closeCollabSession(n.WSEVENTID_HOST_CLOSE,"NormalQuit")},e.prototype.getCollabContent=function(t,e){var n;t=t||function(){};try{return this.coreEditor&&this.coreEditor.isCollabEnabled()?n=this.coreEditor.getCollabContent(t,e):(t(n={status:2,resultCode:2,message:"Not-Collab-Enabled"}),n)}catch(e){return t(n={status:3,resultCode:3,message:e.message}),n}},e.prototype.getModifiers=function(t,e){var n;e=e||function(){};try{return this.coreEditor&&this.coreEditor.isCollabEnabled()?this.coreEditor.getModifiers(t,e):(e(n={status:2,resultCode:2,message:"Not-Collab-Enabled"}),n)}catch(t){return e(n={status:3,resultCode:3,message:t.message}),n}},e.prototype.isReadyToClose=function(){var t=!0;return this.coreEditor&&!this.coreEditor.isLegacyHost()?(i.debugAlert("isReadyToClose should NOT be called in new host"),!1):(this.coreEditor&&this.coreEditor.isCollabEnabled()&&(t=!this.coreEditor.hasCachedDataCmd()),t)},e.prototype.reset=function(){this.coreEditor.reset()},e.prototype.resetEditorOptions=function(t){!this.coreEditor||this.coreEditor.isLegacyHost()?this.coreEditor.updateEditorOptions(t):i.debugAlert("resetEditorOptions should NOT be called in new Host")},e.prototype.saveNotification=function(t,e){this.coreEditor&&this.coreEditor.isCollabEnabled()&&this.coreEditor.saveNotification(t,e)},e.prototype.toggleAttendeeHint=function(t){!this.coreEditor||this.coreEditor.isLegacyHost()||i.debugAlert("toggleAttendeeHint should NOT be called in New Host")},e.prototype.destroyCollabEngine=function(){this.closeCollabSession()},e.prototype.isNotSetContent=function(){return this.coreEditor.isNotSetContent()},e.prototype.saveFile=function(t){this.coreEditor.testSendMsgToCollabServer(t)},e}(o)}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";var a,s=this&&this.__extends||(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});o=[n,r,n(0),n(7),n(27),n(2)],void 0===(i=function(t,e,n,o,i,r){return function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.prototype.focus=function(){return this.coreEditor.focus()},e.prototype.getContent=function(t,e,n,o){t=!!t||this.coreEditor.hasHandWriteBlock(),o=!!o;try{return!0===t?this.coreEditor.getHtmlContent(o,e,n):this.coreEditor.getXmlContent(e,n)}catch(t){null!=e&&e({status:0,resultCode:2,message:t.message})}},e.prototype.getNoteVersion=function(){return this.coreEditor.getNoteVersion()},e.prototype.getSchemaVersion=function(){return this.coreEditor.getSchemaVersion()},e.prototype.getEditorVersion=function(){return 160264273e4},e.prototype.resetFont=function(){return this.coreEditor.resetFont()},e.prototype.setAllBackgrounds=function(t,e){if(!this.coreEditor||this.coreEditor.isLegacyHost())return this.coreEditor.setAllBackgrounds(t,e);r.debugAlert("setAllBackgrounds shoud NOT be called in new host")},e.prototype.setBackground=function(t){if(!this.coreEditor||this.coreEditor.isLegacyHost()||!this.coreEditor.isNotSetContent())return this.coreEditor.setBackground(t);r.debugAlert("setBackground shoud NOT be called before setContent")},e.prototype.setContent=function(t,e,i,a,s){var l=this;try{var c=function(t){l.coreEditor.isCollabEnabled()&&1===t.resultCode&&l.coreEditor.noteSetNotification(),null!=s&&s(t)};null==a&&(a=this.options||{}),a=n.defaults(a,{bgImageId:o.DEFAULT_BACKGROUND,disableBackground:!1,isCollabEnabled:!1,isReadOnly:!1,isAsync:!1}),!0===e?this.coreEditor.setHtmlContent(t,i,a,c):this.coreEditor.setXmlContent(t,i,a,c)}catch(t){r.error(t),null!=s&&s({resultCode:0,message:t.message})}},e.prototype.setFont=function(t,e){return this.coreEditor.setFont(t,e)},e.prototype.setReadOnly=function(t){!this.coreEditor||this.coreEditor.isLegacyHost()?this.coreEditor.setReadOnly(t):r.debugAlert("setReadOnly shoud NOT be called in new host")},e.prototype.setDragProhibited=function(t){this.coreEditor.setDragProhibited(t)},e.prototype.setCopyProhibited=function(t){this.coreEditor.setReadOnly(t)},e.prototype.setEntity=function(t,e){null!=t&&n.isString(t)&&""!==t.trim()&&(t=JSON.parse(t)),this.coreEditor.setEntity(t,e)},e.prototype.refreshPageMode=function(){var t=this.coreEditor.getNote();t&&t.blocks&&t.blocks[0]&&t.blocks[0].trigger("content-change")},e.prototype.initialize=function(t){},e}(i)}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){(function(o,i){var r,a,s=this&&this.__extends||(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),l=this&&this.__generator||function(t,e){var n,o,i,r,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(i=2&r[0]?o.return:r[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,r[1])).done)return i;switch(o=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,o=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){a=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){a.label=r[1];break}if(6===r[0]&&a.label<i[1]){a.label=i[1],i=r;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(r);break}i[2]&&a.ops.pop(),a.trys.pop();continue}r=e.call(t,a)}catch(t){r=[6,t],o=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}};void 0===(r=function(e,r){"use strict";t.exports=function(t){var e={};function n(o){if(e[o])return e[o].exports;var i=e[o]={i:o,l:!1,exports:{}};return t[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,o){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(o,i,function(e){return t[e]}.bind(null,i));return o},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=356)}([function(t,e,n){var o=n(2),i=n(8),r=n(15),a=n(12),s=n(19),l=function(t,e,n){var c,u,d,p,h=t&l.F,f=t&l.G,g=t&l.S,m=t&l.P,y=t&l.B,v=f?o:g?o[e]||(o[e]={}):(o[e]||{}).prototype,_=f?i:i[e]||(i[e]={}),b=_.prototype||(_.prototype={});for(c in f&&(n=e),n)d=((u=!h&&v&&void 0!==v[c])?v:n)[c],p=y&&u?s(d,o):m&&"function"==typeof d?s(Function.call,d):d,v&&a(v,c,d,t&l.U),_[c]!=d&&r(_,c,p),m&&b[c]!=d&&(b[c]=d)};o.core=i,l.F=1,l.G=2,l.S=4,l.P=8,l.B=16,l.W=32,l.U=64,l.R=128,t.exports=l},function(t,e,n){t.exports=n(358)},function(t,e){var n=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},function(t,e){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,e,n){var o=n(5);t.exports=function(t){if(!o(t))throw TypeError(t+" is not an object!");return t}},function(t,e){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},function(t,e,n){var o=n(60)("wks"),i=n(37),r=n(2).Symbol,a="function"==typeof r;(t.exports=function(t){return o[t]||(o[t]=a&&r[t]||(a?r:i)("Symbol."+t))}).store=o},function(t,e,n){var o=n(21),i=Math.min;t.exports=function(t){return t>0?i(o(t),9007199254740991):0}},function(t,e){var n=t.exports={version:"2.6.11"};"number"==typeof __e&&(__e=n)},function(t,e,n){t.exports=!n(3)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(t,e,n){var o=n(4),i=n(114),r=n(32),a=Object.defineProperty;e.f=n(9)?Object.defineProperty:function(t,e,n){if(o(t),e=r(e,!0),o(n),i)try{return a(t,e,n)}catch(t){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(t[e]=n.value),t}},function(t,e,n){var o=n(28);t.exports=function(t){return Object(o(t))}},function(t,e,n){var o=n(2),i=n(15),r=n(14),a=n(37)("src"),s=n(154),l=(""+s).split("toString");n(8).inspectSource=function(t){return s.call(t)},(t.exports=function(t,e,n,s){var c="function"==typeof n;c&&(r(n,"name")||i(n,"name",e)),t[e]!==n&&(c&&(r(n,a)||i(n,a,t[e]?""+t[e]:l.join(String(e)))),t===o?t[e]=n:s?t[e]?t[e]=n:i(t,e,n):(delete t[e],i(t,e,n)))})(Function.prototype,"toString",function(){return"function"==typeof this&&this[a]||s.call(this)})},function(t,e,n){var o=n(0),i=n(3),r=n(28),a=/"/g,s=function(t,e,n,o){var i=String(r(t)),s="<"+e;return""!==n&&(s+=" "+n+'="'+String(o).replace(a,"&quot;")+'"'),s+">"+i+"</"+e+">"};t.exports=function(t,e){var n={};n[t]=e(s),o(o.P+o.F*i(function(){var e=""[t]('"');return e!==e.toLowerCase()||e.split('"').length>3}),"String",n)}},function(t,e){var n={}.hasOwnProperty;t.exports=function(t,e){return n.call(t,e)}},function(t,e,n){var o=n(10),i=n(36);t.exports=n(9)?function(t,e,n){return o.f(t,e,i(1,n))}:function(t,e,n){return t[e]=n,t}},function(t,e,n){var o=n(53),i=n(28);t.exports=function(t){return o(i(t))}},function(t,e,n){var o=n(3);t.exports=function(t,e){return!!t&&o(function(){e?t.call(null,function(){},1):t.call(null)})}},function(t,e,n){n.d(e,"a",function(){return o});var o=function(t,e){var n=function(t){if(Array.isArray(t))return t.forEach(n);t&&"object"==typeof t&&Object.keys(t).forEach(function(o){var i=t[o];e(o,i,t),i&&n(i)})};n(t)}},function(t,e,n){var o=n(20);t.exports=function(t,e,n){if(o(t),void 0===e)return t;switch(n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,o){return t.call(e,n,o)};case 3:return function(n,o,i){return t.call(e,n,o,i)}}return function(){return t.apply(e,arguments)}}},function(t,e){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},function(t,e){var n=Math.ceil,o=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?o:n)(t)}},function(t,e,n){var o=n(54),i=n(36),r=n(16),a=n(32),s=n(14),l=n(114),c=Object.getOwnPropertyDescriptor;e.f=n(9)?c:function(t,e){if(t=r(t),e=a(e,!0),l)try{return c(t,e)}catch(t){}if(s(t,e))return i(!o.f.call(t,e),t[e])}},function(t,e,n){var o=n(0),i=n(8),r=n(3);t.exports=function(t,e){var n=(i.Object||{})[t]||Object[t],a={};a[t]=e(n),o(o.S+o.F*r(function(){n(1)}),"Object",a)}},function(t,e,n){var o=n(19),i=n(53),r=n(11),a=n(7),s=n(130);t.exports=function(t,e){var n=1==t,l=2==t,c=3==t,u=4==t,d=6==t,p=5==t||d,h=e||s;return function(e,s,f){for(var g,m,y=r(e),v=i(y),_=o(s,f,3),b=a(v.length),C=0,k=n?h(e,b):l?h(e,0):void 0;b>C;C++)if((p||C in v)&&(m=_(g=v[C],C,y),t))if(n)k[C]=m;else if(m)switch(t){case 3:return!0;case 5:return g;case 6:return C;case 2:k.push(g)}else if(u)return!1;return d?-1:c||u?u:k}}},function(t,e,n){var o=n(72),i="object"==typeof self&&self&&self.Object===Object&&self,r=o.a||i||Function("return this")();e.a=r},function(t,e,n){e.a=function(t){return null!=t&&"object"==typeof t}},function(t,e){var n={}.toString;t.exports=function(t){return n.call(t).slice(8,-1)}},function(t,e){t.exports=function(t){if(null==t)throw TypeError("Can't call method on  "+t);return t}},function(t,e,n){if(n(9)){var o=n(38),i=n(2),r=n(3),a=n(0),s=n(71),l=n(102),c=n(19),u=n(51),d=n(36),p=n(15),h=n(52),f=n(21),g=n(7),m=n(141),y=n(40),v=n(32),_=n(14),b=n(55),C=n(5),k=n(11),w=n(94),S=n(41),x=n(43),E=n(42).f,I=n(96),T=n(37),O=n(6),A=n(24),N=n(61),D=n(56),B=n(98),R=n(49),L=n(64),P=n(50),M=n(97),F=n(132),H=n(10),j=n(22),V=H.f,U=j.f,z=i.RangeError,G=i.TypeError,J=i.Uint8Array,W=Array.prototype,$=l.ArrayBuffer,K=l.DataView,Y=A(0),X=A(2),q=A(3),Q=A(4),Z=A(5),tt=A(6),et=N(!0),nt=N(!1),ot=B.values,it=B.keys,rt=B.entries,at=W.lastIndexOf,st=W.reduce,lt=W.reduceRight,ct=W.join,ut=W.sort,dt=W.slice,pt=W.toString,ht=W.toLocaleString,ft=O("iterator"),gt=O("toStringTag"),mt=T("typed_constructor"),yt=T("def_constructor"),vt=s.CONSTR,_t=s.TYPED,bt=s.VIEW,Ct=A(1,function(t,e){return Et(D(t,t[yt]),e)}),kt=r(function(){return 1===new J(new Uint16Array([1]).buffer)[0]}),wt=!!J&&!!J.prototype.set&&r(function(){new J(1).set({})}),St=function(t,e){var n=f(t);if(n<0||n%e)throw z("Wrong offset!");return n},xt=function(t){if(C(t)&&_t in t)return t;throw G(t+" is not a typed array!")},Et=function(t,e){if(!(C(t)&&mt in t))throw G("It is not a typed array constructor!");return new t(e)},It=function(t,e){return Tt(D(t,t[yt]),e)},Tt=function(t,e){for(var n=0,o=e.length,i=Et(t,o);o>n;)i[n]=e[n++];return i},Ot=function(t,e,n){V(t,e,{get:function(){return this._d[n]}})},At=function(t){var e,n,o,i,r,a,s=k(t),l=arguments.length,u=l>1?arguments[1]:void 0,d=void 0!==u,p=I(s);if(null!=p&&!w(p)){for(a=p.call(s),o=[],e=0;!(r=a.next()).done;e++)o.push(r.value);s=o}for(d&&l>2&&(u=c(u,arguments[2],2)),e=0,n=g(s.length),i=Et(this,n);n>e;e++)i[e]=d?u(s[e],e):s[e];return i},Nt=function(){for(var t=0,e=arguments.length,n=Et(this,e);e>t;)n[t]=arguments[t++];return n},Dt=!!J&&r(function(){ht.call(new J(1))}),Bt=function(){return ht.apply(Dt?dt.call(xt(this)):xt(this),arguments)},Rt={copyWithin:function(t,e){return F.call(xt(this),t,e,arguments.length>2?arguments[2]:void 0)},every:function(t){return Q(xt(this),t,arguments.length>1?arguments[1]:void 0)},fill:function(t){return M.apply(xt(this),arguments)},filter:function(t){return It(this,X(xt(this),t,arguments.length>1?arguments[1]:void 0))},find:function(t){return Z(xt(this),t,arguments.length>1?arguments[1]:void 0)},findIndex:function(t){return tt(xt(this),t,arguments.length>1?arguments[1]:void 0)},forEach:function(t){Y(xt(this),t,arguments.length>1?arguments[1]:void 0)},indexOf:function(t){return nt(xt(this),t,arguments.length>1?arguments[1]:void 0)},includes:function(t){return et(xt(this),t,arguments.length>1?arguments[1]:void 0)},join:function(t){return ct.apply(xt(this),arguments)},lastIndexOf:function(t){return at.apply(xt(this),arguments)},map:function(t){return Ct(xt(this),t,arguments.length>1?arguments[1]:void 0)},reduce:function(t){return st.apply(xt(this),arguments)},reduceRight:function(t){return lt.apply(xt(this),arguments)},reverse:function(){for(var t,e=xt(this).length,n=Math.floor(e/2),o=0;o<n;)t=this[o],this[o++]=this[--e],this[e]=t;return this},some:function(t){return q(xt(this),t,arguments.length>1?arguments[1]:void 0)},sort:function(t){return ut.call(xt(this),t)},subarray:function(t,e){var n=xt(this),o=n.length,i=y(t,o);return new(D(n,n[yt]))(n.buffer,n.byteOffset+i*n.BYTES_PER_ELEMENT,g((void 0===e?o:y(e,o))-i))}},Lt=function(t,e){return It(this,dt.call(xt(this),t,e))},Pt=function(t){xt(this);var e=St(arguments[1],1),n=this.length,o=k(t),i=g(o.length),r=0;if(i+e>n)throw z("Wrong length!");for(;r<i;)this[e+r]=o[r++]},Mt={entries:function(){return rt.call(xt(this))},keys:function(){return it.call(xt(this))},values:function(){return ot.call(xt(this))}},Ft=function(t,e){return C(t)&&t[_t]&&"symbol"!=typeof e&&e in t&&String(+e)==String(e)},Ht=function(t,e){return Ft(t,e=v(e,!0))?d(2,t[e]):U(t,e)},jt=function(t,e,n){return!(Ft(t,e=v(e,!0))&&C(n)&&_(n,"value"))||_(n,"get")||_(n,"set")||n.configurable||_(n,"writable")&&!n.writable||_(n,"enumerable")&&!n.enumerable?V(t,e,n):(t[e]=n.value,t)};vt||(j.f=Ht,H.f=jt),a(a.S+a.F*!vt,"Object",{getOwnPropertyDescriptor:Ht,defineProperty:jt}),r(function(){pt.call({})})&&(pt=ht=function(){return ct.call(this)});var Vt=h({},Rt);h(Vt,Mt),p(Vt,ft,Mt.values),h(Vt,{slice:Lt,set:Pt,constructor:function(){},toString:pt,toLocaleString:Bt}),Ot(Vt,"buffer","b"),Ot(Vt,"byteOffset","o"),Ot(Vt,"byteLength","l"),Ot(Vt,"length","e"),V(Vt,gt,{get:function(){return this[_t]}}),t.exports=function(t,e,n,l){var c=t+((l=!!l)?"Clamped":"")+"Array",d="get"+t,h="set"+t,f=i[c],y=f||{},v=f&&x(f),_=!f||!s.ABV,k={},w=f&&f.prototype,I=function(t,n){V(t,n,{get:function(){return function(t,n){var o=t._d;return o.v[d](n*e+o.o,kt)}(this,n)},set:function(t){return function(t,n,o){var i=t._d;l&&(o=(o=Math.round(o))<0?0:o>255?255:255&o),i.v[h](n*e+i.o,o,kt)}(this,n,t)},enumerable:!0})};_?(f=n(function(t,n,o,i){u(t,f,c,"_d");var r,a,s,l,d=0,h=0;if(C(n)){if(!(n instanceof $||"ArrayBuffer"==(l=b(n))||"SharedArrayBuffer"==l))return _t in n?Tt(f,n):At.call(f,n);r=n,h=St(o,e);var y=n.byteLength;if(void 0===i){if(y%e)throw z("Wrong length!");if((a=y-h)<0)throw z("Wrong length!")}else if((a=g(i)*e)+h>y)throw z("Wrong length!");s=a/e}else s=m(n),r=new $(a=s*e);for(p(t,"_d",{b:r,o:h,l:a,e:s,v:new K(r)});d<s;)I(t,d++)}),w=f.prototype=S(Vt),p(w,"constructor",f)):r(function(){f(1)})&&r(function(){new f(-1)})&&L(function(t){new f,new f(null),new f(1.5),new f(t)},!0)||(f=n(function(t,n,o,i){var r;return u(t,f,c),C(n)?n instanceof $||"ArrayBuffer"==(r=b(n))||"SharedArrayBuffer"==r?void 0!==i?new y(n,St(o,e),i):void 0!==o?new y(n,St(o,e)):new y(n):_t in n?Tt(f,n):At.call(f,n):new y(m(n))}),Y(v!==Function.prototype?E(y).concat(E(v)):E(y),function(t){t in f||p(f,t,y[t])}),f.prototype=w,o||(w.constructor=f));var T=w[ft],O=!!T&&("values"==T.name||null==T.name),A=Mt.values;p(f,mt,!0),p(w,_t,c),p(w,bt,!0),p(w,yt,f),(l?new f(1)[gt]==c:gt in w)||V(w,gt,{get:function(){return c}}),k[c]=f,a(a.G+a.W+a.F*(f!=y),k),a(a.S,c,{BYTES_PER_ELEMENT:e}),a(a.S+a.F*r(function(){y.of.call(f,1)}),c,{from:At,of:Nt}),"BYTES_PER_ELEMENT"in w||p(w,"BYTES_PER_ELEMENT",e),a(a.P,c,Rt),P(c),a(a.P+a.F*wt,c,{set:Pt}),a(a.P+a.F*!O,c,Mt),o||w.toString==pt||(w.toString=pt),a(a.P+a.F*r(function(){new f(1).slice()}),c,{slice:Lt}),a(a.P+a.F*(r(function(){return[1,2].toLocaleString()!=new f([1,2]).toLocaleString()})||!r(function(){w.toLocaleString.call([1,2])})),c,{toLocaleString:Bt}),R[c]=O?T:A,o||O||p(w,ft,A)}}else t.exports=function(){}},function(t,e,n){var o=n(25).a.Symbol;e.a=o},function(t,e,n){var o=n(30),i=Object.prototype,r=i.hasOwnProperty,a=i.toString,s=o.a?o.a.toStringTag:void 0,l=Object.prototype.toString,c=o.a?o.a.toStringTag:void 0;e.a=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":c&&c in Object(t)?function(t){var e=r.call(t,s),n=t[s];try{t[s]=void 0;var o=!0}catch(t){}var i=a.call(t);return o&&(e?t[s]=n:delete t[s]),i}(t):function(t){return l.call(t)}(t)}},function(t,e,n){var o=n(5);t.exports=function(t,e){if(!o(t))return t;var n,i;if(e&&"function"==typeof(n=t.toString)&&!o(i=n.call(t)))return i;if("function"==typeof(n=t.valueOf)&&!o(i=n.call(t)))return i;if(!e&&"function"==typeof(n=t.toString)&&!o(i=n.call(t)))return i;throw TypeError("Can't convert object to primitive value")}},function(t,e,n){var o=n(37)("meta"),i=n(5),r=n(14),a=n(10).f,s=0,l=Object.isExtensible||function(){return!0},c=!n(3)(function(){return l(Object.preventExtensions({}))}),u=function(t){a(t,o,{value:{i:"O"+ ++s,w:{}}})},d=t.exports={KEY:o,NEED:!1,fastKey:function(t,e){if(!i(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!r(t,o)){if(!l(t))return"F";if(!e)return"E";u(t)}return t[o].i},getWeak:function(t,e){if(!r(t,o)){if(!l(t))return!0;if(!e)return!1;u(t)}return t[o].w},onFreeze:function(t){return c&&d.NEED&&l(t)&&!r(t,o)&&u(t),t}}},function(t,e,n){e.a=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}},function(t,e,n){var o=Array.isArray;e.a=o},function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},function(t,e){var n=0,o=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++n+o).toString(36))}},function(t,e){t.exports=!1},function(t,e,n){var o=n(116),i=n(81);t.exports=Object.keys||function(t){return o(t,i)}},function(t,e,n){var o=n(21),i=Math.max,r=Math.min;t.exports=function(t,e){return(t=o(t))<0?i(t+e,0):r(t,e)}},function(t,e,n){var o=n(4),i=n(117),r=n(81),a=n(80)("IE_PROTO"),s=function(){},l=function(){var t,e=n(78)("iframe"),o=r.length;for(e.style.display="none",n(82).appendChild(e),e.src="javascript:",(t=e.contentWindow.document).open(),t.write("<script>document.F=Object<\/script>"),t.close(),l=t.F;o--;)delete l.prototype[r[o]];return l()};t.exports=Object.create||function(t,e){var n;return null!==t?(s.prototype=o(t),n=new s,s.prototype=null,n[a]=t):n=l(),void 0===e?n:i(n,e)}},function(t,e,n){var o=n(116),i=n(81).concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return o(t,i)}},function(t,e,n){var o=n(14),i=n(11),r=n(80)("IE_PROTO"),a=Object.prototype;t.exports=Object.getPrototypeOf||function(t){return t=i(t),o(t,r)?t[r]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?a:null}},function(t,e,n){var o=n(6)("unscopables"),i=Array.prototype;null==i[o]&&n(15)(i,o,{}),t.exports=function(t){i[o][t]=!0}},function(t,e,n){var o=n(5);t.exports=function(t,e){if(!o(t)||t._t!==e)throw TypeError("Incompatible receiver, "+e+" required!");return t}},,function(t,e,n){var o=n(10).f,i=n(14),r=n(6)("toStringTag");t.exports=function(t,e,n){t&&!i(t=n?t:t.prototype,r)&&o(t,r,{configurable:!0,value:e})}},function(t,e,n){var o=n(0),i=n(28),r=n(3),a=n(84),s="["+a+"]",l=RegExp("^"+s+s+"*"),c=RegExp(s+s+"*$"),u=function(t,e,n){var i={},s=r(function(){return!!a[t]()||"​"!="​"[t]()}),l=i[t]=s?e(d):a[t];n&&(i[n]=l),o(o.P+o.F*s,"String",i)},d=u.trim=function(t,e){return t=String(i(t)),1&e&&(t=t.replace(l,"")),2&e&&(t=t.replace(c,"")),t};t.exports=u},function(t,e){t.exports={}},function(t,e,n){var o=n(2),i=n(10),r=n(9),a=n(6)("species");t.exports=function(t){var e=o[t];r&&e&&!e[a]&&i.f(e,a,{configurable:!0,get:function(){return this}})}},function(t,e){t.exports=function(t,e,n,o){if(!(t instanceof e)||void 0!==o&&o in t)throw TypeError(n+": incorrect invocation!");return t}},function(t,e,n){var o=n(12);t.exports=function(t,e,n){for(var i in e)o(t,i,e[i],n);return t}},function(t,e,n){var o=n(27);t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==o(t)?t.split(""):Object(t)}},function(t,e){e.f={}.propertyIsEnumerable},function(t,e,n){var o=n(27),i=n(6)("toStringTag"),r="Arguments"==o(function(){return arguments}());t.exports=function(t){var e,n,a;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=function(t,e){try{return t[e]}catch(t){}}(e=Object(t),i))?n:r?o(e):"Object"==(a=o(e))&&"function"==typeof e.callee?"Arguments":a}},function(t,e,n){var o=n(4),i=n(20),r=n(6)("species");t.exports=function(t,e){var n,a=o(t).constructor;return void 0===a||null==(n=o(a)[r])?e:i(n)}},function(t,e,n){(function(t){var o=n(72),i=r&&!r.nodeType&&r,a=i&&"object"==typeof t&&t&&!t.nodeType&&t,s=a&&a.exports===i&&o.a.process,l=function(){try{var t=a&&a.require&&a.require("util").types;return t||s&&s.binding&&s.binding("util")}catch(t){}}();e.a=l}).call(this,n(113)(t))},function(t,e,n){e.a=function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991}},function(t,e,n){var o=n(112),i=n(74),r=n(107),a=Object(r.a)(Object.keys,Object),s=Object.prototype.hasOwnProperty,l=n(108);e.a=function(t){return Object(l.a)(t)?Object(o.a)(t):function(t){if(!Object(i.a)(t))return a(t);var e=[];for(var n in Object(t))s.call(t,n)&&"constructor"!=n&&e.push(n);return e}(t)}},function(t,e,n){var o=n(8),i=n(2),r=i["__core-js_shared__"]||(i["__core-js_shared__"]={});(t.exports=function(t,e){return r[t]||(r[t]=void 0!==e?e:{})})("versions",[]).push({version:o.version,mode:n(38)?"pure":"global",copyright:"© 2019 Denis Pushkarev (zloirock.ru)"})},function(t,e,n){var o=n(16),i=n(7),r=n(40);t.exports=function(t){return function(e,n,a){var s,l=o(e),c=i(l.length),u=r(a,c);if(t&&n!=n){for(;c>u;)if((s=l[u++])!=s)return!0}else for(;c>u;u++)if((t||u in l)&&l[u]===n)return t||u||0;return!t&&-1}}},function(t,e){e.f=Object.getOwnPropertySymbols},function(t,e,n){var o=n(27);t.exports=Array.isArray||function(t){return"Array"==o(t)}},function(t,e,n){var o=n(6)("iterator"),i=!1;try{var r=[7][o]();r.return=function(){i=!0},Array.from(r,function(){throw 2})}catch(t){}t.exports=function(t,e){if(!e&&!i)return!1;var n=!1;try{var r=[7],a=r[o]();a.next=function(){return{done:n=!0}},r[o]=function(){return a},t(r)}catch(t){}return n}},function(t,e,n){var o=n(4);t.exports=function(){var t=o(this),e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.unicode&&(e+="u"),t.sticky&&(e+="y"),e}},function(t,e,n){var o=n(55),i=RegExp.prototype.exec;t.exports=function(t,e){var n=t.exec;if("function"==typeof n){var r=n.call(t,e);if("object"!=typeof r)throw new TypeError("RegExp exec method returned something other than an Object or null");return r}if("RegExp"!==o(t))throw new TypeError("RegExp#exec called on incompatible receiver");return i.call(t,e)}},function(t,e,n){n(134);var o=n(12),i=n(15),r=n(3),a=n(28),s=n(6),l=n(99),c=s("species"),u=!r(function(){var t=/./;return t.exec=function(){var t=[];return t.groups={a:"7"},t},"7"!=="".replace(t,"$<a>")}),d=function(){var t=/(?:)/,e=t.exec;t.exec=function(){return e.apply(this,arguments)};var n="ab".split(t);return 2===n.length&&"a"===n[0]&&"b"===n[1]}();t.exports=function(t,e,n){var p=s(t),h=!r(function(){var e={};return e[p]=function(){return 7},7!=""[t](e)}),f=h?!r(function(){var e=!1,n=/a/;return n.exec=function(){return e=!0,null},"split"===t&&(n.constructor={},n.constructor[c]=function(){return n}),n[p](""),!e}):void 0;if(!h||!f||"replace"===t&&!u||"split"===t&&!d){var g=/./[p],m=n(a,p,""[t],function(t,e,n,o,i){return e.exec===l?h&&!i?{done:!0,value:g.call(e,n,o)}:{done:!0,value:t.call(n,e,o)}:{done:!1}}),y=m[0],v=m[1];o(String.prototype,t,y),i(RegExp.prototype,p,2==e?function(t,e){return v.call(t,this,e)}:function(t){return v.call(t,this)})}}},function(t,e,n){var o=n(19),i=n(129),r=n(94),a=n(4),s=n(7),l=n(96),c={},u={};(e=t.exports=function(t,e,n,d,p){var h,f,g,m,y=p?function(){return t}:l(t),v=o(n,d,e?2:1),_=0;if("function"!=typeof y)throw TypeError(t+" is not iterable!");if(r(y)){for(h=s(t.length);h>_;_++)if((m=e?v(a(f=t[_])[0],f[1]):v(t[_]))===c||m===u)return m}else for(g=y.call(t);!(f=g.next()).done;)if((m=i(g,v,f.value,e))===c||m===u)return m}).BREAK=c,e.RETURN=u},function(t,e,n){var o=n(2).navigator;t.exports=o&&o.userAgent||""},function(t,e,n){var o=n(2),i=n(0),r=n(12),a=n(52),s=n(33),l=n(68),c=n(51),u=n(5),d=n(3),p=n(64),h=n(47),f=n(85);t.exports=function(t,e,n,g,m,y){var v=o[t],_=v,b=m?"set":"add",C=_&&_.prototype,k={},w=function(t){var e=C[t];r(C,t,"delete"==t||"has"==t?function(t){return!(y&&!u(t))&&e.call(this,0===t?0:t)}:"get"==t?function(t){return y&&!u(t)?void 0:e.call(this,0===t?0:t)}:"add"==t?function(t){return e.call(this,0===t?0:t),this}:function(t,n){return e.call(this,0===t?0:t,n),this})};if("function"==typeof _&&(y||C.forEach&&!d(function(){(new _).entries().next()}))){var S=new _,x=S[b](y?{}:-0,1)!=S,E=d(function(){S.has(1)}),I=p(function(t){new _(t)}),T=!y&&d(function(){for(var t=new _,e=5;e--;)t[b](e,e);return!t.has(-0)});I||((_=e(function(e,n){c(e,_,t);var o=f(new v,e,_);return null!=n&&l(n,m,o[b],o),o})).prototype=C,C.constructor=_),(E||T)&&(w("delete"),w("has"),m&&w("get")),(T||x)&&w(b),y&&C.clear&&delete C.clear}else _=g.getConstructor(e,t,m,b),a(_.prototype,n),s.NEED=!0;return h(_,t),k[t]=_,i(i.G+i.W+i.F*(_!=v),k),y||g.setStrong(_,t,m),_}},function(t,e,n){for(var o,i=n(2),r=n(15),a=n(37),s=a("typed_array"),l=a("view"),c=!(!i.ArrayBuffer||!i.DataView),u=c,d=0,p="Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array".split(",");d<9;)(o=i[p[d++]])?(r(o.prototype,s,!0),r(o.prototype,l,!0)):u=!1;t.exports={ABV:c,CONSTR:u,TYPED:s,VIEW:l}},function(t,e,n){var i="object"==typeof o&&o&&o.Object===Object&&o;e.a=i},function(t,e,n){(function(t){var o=n(25),i=n(147),a=r&&!r.nodeType&&r,s=a&&"object"==typeof t&&t&&!t.nodeType&&t,l=s&&s.exports===a?o.a.Buffer:void 0,c=(l?l.isBuffer:void 0)||i.a;e.a=c}).call(this,n(113)(t))},function(t,e,n){var o=Object.prototype;e.a=function(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||o)}},function(t,e,n){e.a=function(t){return function(e){return t(e)}}},function(t,e,n){var o=/^(?:0|[1-9]\d*)$/;e.a=function(t,e){var n=typeof t;return!!(e=null==e?9007199254740991:e)&&("number"==n||"symbol"!=n&&o.test(t))&&t>-1&&t%1==0&&t<e}},function(t,e,n){n.d(e,"a",function(){return p});var o=n(352),i=n(18);function r(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,o)}return n}function a(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?r(Object(n),!0).forEach(function(e){s(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function s(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var l=Object.freeze(a({},{value:"0",document:"1",type:"2",id:"3",data:"4",nodes:"5",name:"6",leaves:"7",text:"8",marks:"9"},{},{footer:"ft",page:"p",level:"l",style:"s",href:"hf",url:"u",width:"w",height:"h",targetId:"ta",header:"hd",language:"la",theme:"th",resource:"re",source:"sr",fileName:"fn",fileLength:"fl",colsWidth:"cw",rowsHeight:"rh",colSpan:"cs",rowSpan:"rs",checked:"c",resourceId:"ri",listId:"li",listType:"lt",listLevel:"ll",templateId:"tp",fileVersion:"fv"},{},{textAlign:"t",textIndent:"ti",lineHeight:"lh",backgroundColor:"bg",padding:"pd",margin:"mg",color:"co",float:"fo",indent:"in"})),c=Object.freeze(a({},{block:"0",document:"1",text:"2",inline:"3"},{},{paragraph:"p",heading:"h",link:"li",image:"im",attachment:"a",todo:"td",quote:"q",catalog:"ca","catalog-item":"ci",code:"cd","code-line":"cl",handwriting:"hw","list-item":"l",table:"t","table-row":"tr","table-cell":"tc",layout:"la"},{},{bold:"b",italic:"i",underline:"u",delete:"d",color:"c",backgroundColor:"bg",fontFamily:"ff",fontSize:"fs",href:"hf"})),u=Object(o.a)(l),d=Object(o.a)(c),p=function(){function t(){}return t.compress=function(e){return t.checkCanCompress(e),t.removeEmpty(e),t.removeDefault(e),e.__compress__&&(Object(i.a)(e,t.compressValue),Object(i.a)(e,t.compressKey)),e},t.decompress=function(e){return e.__compress__&&(Object(i.a)(e,t.decompressKey),Object(i.a)(e,t.decompressValue)),t.addDefault(e),e},t.removeEmpty=function(e){Object(i.a)(e,function(e,n,o){"data"===e&&t.removeEmptyData(e,n,o),"leaves"===e&&t.removeEmptyLeaf(e,n,o),"nodes"===e&&t.removeEmptyNodes(e,n,o),"marks"===e&&t.removeEmptyMarks(e,n,o)})},t.checkCanCompress=function(t){var e=!0;Object(i.a)(t,function(t,n){u.hasOwnProperty(t)&&(e=!1),"type"!==t&&"name"!==t||!d.hasOwnProperty(n)||(e=!1)}),t.__compress__=e},t.compressKey=function(t,e,n){l.hasOwnProperty(t)&&(delete n[t],n[l[t]]=e)},t.compressValue=function(t,e,n){"type"!==t&&"name"!==t||!c.hasOwnProperty(e)||(n[t]=c[e])},t.decompressKey=function(t,e,n){u.hasOwnProperty(t)&&(delete n[t],n[u[t]]=e)},t.decompressValue=function(t,e,n){"type"!==t&&"name"!==t||!d.hasOwnProperty(e)||(n[t]=d[e])},t.removeEmptyLeaf=function(t,e,n){var o=e;if(1===o.length){var i=o[0];""!==i.text||i.marks&&0!==i.marks.length||delete n[t]}},t.removeEmptyMarks=function(t,e,n){e&&0===e.length&&delete n[t]},t.removeEmptyNodes=function(t,e,n){e&&0===e.length&&delete n[t]},t.removeEmptyData=function(t,e,n){var o=Object.keys(e),i=o.findIndex(function(t){return"style"===t});i>=0&&0===Object.keys(e.style||{}).length&&(delete n[t].style,o.splice(i,1)),0===o.length&&delete n[t]},t.removeDefault=function(t){Object(i.a)(t,function(t,e,n){("type"===t&&"block"===e||"name"===t&&"paragraph"===e)&&n.id&&delete n[t]})},t.addDefault=function(t){Object(i.a)(t,function(t,e,n){n.id&&(n.type||(n.type="block"),n.name||"block"!==n.type||(n.name="paragraph"))})},t}()},function(t,e,n){var o=n(5),i=n(2).document,r=o(i)&&o(i.createElement);t.exports=function(t){return r?i.createElement(t):{}}},function(t,e,n){e.f=n(6)},function(t,e,n){var o=n(60)("keys"),i=n(37);t.exports=function(t){return o[t]||(o[t]=i(t))}},function(t,e){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(t,e,n){var o=n(2).document;t.exports=o&&o.documentElement},function(t,e,n){var o=n(5),i=n(4),r=function(t,e){if(i(t),!o(e)&&null!==e)throw TypeError(e+": can't set as prototype!")};t.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(t,e,o){try{(o=n(19)(Function.call,n(22).f(Object.prototype,"__proto__").set,2))(t,[]),e=!(t instanceof Array)}catch(t){e=!0}return function(t,n){return r(t,n),e?t.__proto__=n:o(t,n),t}}({},!1):void 0),check:r}},function(t,e){t.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"},function(t,e,n){var o=n(5),i=n(83).set;t.exports=function(t,e,n){var r,a=e.constructor;return a!==n&&"function"==typeof a&&(r=a.prototype)!==n.prototype&&o(r)&&i&&i(t,r),t}},function(t,e,n){var o=n(21),i=n(28);t.exports=function(t){var e=String(i(this)),n="",r=o(t);if(r<0||r==1/0)throw RangeError("Count can't be negative");for(;r>0;(r>>>=1)&&(e+=e))1&r&&(n+=e);return n}},function(t,e){t.exports=Math.sign||function(t){return 0==(t=+t)||t!=t?t:t<0?-1:1}},function(t,e){var n=Math.expm1;t.exports=!n||n(10)>22025.465794806718||n(10)<22025.465794806718||-2e-17!=n(-2e-17)?function(t){return 0==(t=+t)?t:t>-1e-6&&t<1e-6?t+t*t/2:Math.exp(t)-1}:n},function(t,e,n){var o=n(21),i=n(28);t.exports=function(t){return function(e,n){var r,a,s=String(i(e)),l=o(n),c=s.length;return l<0||l>=c?t?"":void 0:(r=s.charCodeAt(l))<55296||r>56319||l+1===c||(a=s.charCodeAt(l+1))<56320||a>57343?t?s.charAt(l):r:t?s.slice(l,l+2):a-56320+(r-55296<<10)+65536}}},function(t,e,n){var o=n(38),i=n(0),r=n(12),a=n(15),s=n(49),l=n(128),c=n(47),u=n(43),d=n(6)("iterator"),p=!([].keys&&"next"in[].keys()),h=function(){return this};t.exports=function(t,e,n,f,g,m,y){l(n,e,f);var v,_,b,C=function(t){if(!p&&t in x)return x[t];switch(t){case"keys":case"values":return function(){return new n(this,t)}}return function(){return new n(this,t)}},k=e+" Iterator",w="values"==g,S=!1,x=t.prototype,E=x[d]||x["@@iterator"]||g&&x[g],I=E||C(g),T=g?w?C("entries"):I:void 0,O="Array"==e&&x.entries||E;if(O&&(b=u(O.call(new t)))!==Object.prototype&&b.next&&(c(b,k,!0),o||"function"==typeof b[d]||a(b,d,h)),w&&E&&"values"!==E.name&&(S=!0,I=function(){return E.call(this)}),o&&!y||!p&&!S&&x[d]||a(x,d,I),s[e]=I,s[k]=h,g)if(v={values:w?I:C("values"),keys:m?I:C("keys"),entries:T},y)for(_ in v)_ in x||r(x,_,v[_]);else i(i.P+i.F*(p||S),e,v);return v}},function(t,e,n){var o=n(92),i=n(28);t.exports=function(t,e,n){if(o(e))throw TypeError("String#"+n+" doesn't accept regex!");return String(i(t))}},function(t,e,n){var o=n(5),i=n(27),r=n(6)("match");t.exports=function(t){var e;return o(t)&&(void 0!==(e=t[r])?!!e:"RegExp"==i(t))}},function(t,e,n){var o=n(6)("match");t.exports=function(t){var e=/./;try{"/./"[t](e)}catch(n){try{return e[o]=!1,!"/./"[t](e)}catch(t){}}return!0}},function(t,e,n){var o=n(49),i=n(6)("iterator"),r=Array.prototype;t.exports=function(t){return void 0!==t&&(o.Array===t||r[i]===t)}},function(t,e,n){var o=n(10),i=n(36);t.exports=function(t,e,n){e in t?o.f(t,e,i(0,n)):t[e]=n}},function(t,e,n){var o=n(55),i=n(6)("iterator"),r=n(49);t.exports=n(8).getIteratorMethod=function(t){if(null!=t)return t[i]||t["@@iterator"]||r[o(t)]}},function(t,e,n){var o=n(11),i=n(40),r=n(7);t.exports=function(t){for(var e=o(this),n=r(e.length),a=arguments.length,s=i(a>1?arguments[1]:void 0,n),l=a>2?arguments[2]:void 0,c=void 0===l?n:i(l,n);c>s;)e[s++]=t;return e}},function(t,e,n){var o=n(44),i=n(133),r=n(49),a=n(16);t.exports=n(90)(Array,"Array",function(t,e){this._t=a(t),this._i=0,this._k=e},function(){var t=this._t,e=this._k,n=this._i++;return!t||n>=t.length?(this._t=void 0,i(1)):i(0,"keys"==e?n:"values"==e?t[n]:[n,t[n]])},"values"),r.Arguments=r.Array,o("keys"),o("values"),o("entries")},function(t,e,n){var o,i,r=n(65),a=RegExp.prototype.exec,s=String.prototype.replace,l=a,c=(o=/a/,i=/b*/g,a.call(o,"a"),a.call(i,"a"),0!==o.lastIndex||0!==i.lastIndex),u=void 0!==/()??/.exec("")[1];(c||u)&&(l=function(t){var e,n,o,i,l=this;return u&&(n=new RegExp("^"+l.source+"$(?!\\s)",r.call(l))),c&&(e=l.lastIndex),o=a.call(l,t),c&&o&&(l.lastIndex=l.global?o.index+o[0].length:e),u&&o&&o.length>1&&s.call(o[0],n,function(){for(i=1;i<arguments.length-2;i++)void 0===arguments[i]&&(o[i]=void 0)}),o}),t.exports=l},function(t,e,n){var o=n(89)(!0);t.exports=function(t,e,n){return e+(n?o(t,e).length:1)}},function(t,e,n){var o,i,r,a=n(19),s=n(122),l=n(82),c=n(78),u=n(2),d=u.process,p=u.setImmediate,h=u.clearImmediate,f=u.MessageChannel,g=u.Dispatch,m=0,y={},v=function(){var t=+this;if(y.hasOwnProperty(t)){var e=y[t];delete y[t],e()}},_=function(t){v.call(t.data)};p&&h||(p=function(t){for(var e=[],n=1;arguments.length>n;)e.push(arguments[n++]);return y[++m]=function(){s("function"==typeof t?t:Function(t),e)},o(m),m},h=function(t){delete y[t]},"process"==n(27)(d)?o=function(t){d.nextTick(a(v,t,1))}:g&&g.now?o=function(t){g.now(a(v,t,1))}:f?(r=(i=new f).port2,i.port1.onmessage=_,o=a(r.postMessage,r,1)):u.addEventListener&&"function"==typeof postMessage&&!u.importScripts?(o=function(t){u.postMessage(t+"","*")},u.addEventListener("message",_,!1)):o="onreadystatechange"in c("script")?function(t){l.appendChild(c("script")).onreadystatechange=function(){l.removeChild(this),v.call(t)}}:function(t){setTimeout(a(v,t,1),0)}),t.exports={set:p,clear:h}},function(t,e,n){var o=n(2),i=n(9),r=n(38),a=n(71),s=n(15),l=n(52),c=n(3),u=n(51),d=n(21),p=n(7),h=n(141),f=n(42).f,g=n(10).f,m=n(97),y=n(47),v=o.ArrayBuffer,_=o.DataView,b=o.Math,C=o.RangeError,k=o.Infinity,w=v,S=b.abs,x=b.pow,E=b.floor,I=b.log,T=b.LN2,O=i?"_b":"buffer",A=i?"_l":"byteLength",N=i?"_o":"byteOffset";function D(t,e,n){var o,i,r,a=new Array(n),s=8*n-e-1,l=(1<<s)-1,c=l>>1,u=23===e?x(2,-24)-x(2,-77):0,d=0,p=t<0||0===t&&1/t<0?1:0;for((t=S(t))!=t||t===k?(i=t!=t?1:0,o=l):(o=E(I(t)/T),t*(r=x(2,-o))<1&&(o--,r*=2),(t+=o+c>=1?u/r:u*x(2,1-c))*r>=2&&(o++,r/=2),o+c>=l?(i=0,o=l):o+c>=1?(i=(t*r-1)*x(2,e),o+=c):(i=t*x(2,c-1)*x(2,e),o=0));e>=8;a[d++]=255&i,i/=256,e-=8);for(o=o<<e|i,s+=e;s>0;a[d++]=255&o,o/=256,s-=8);return a[--d]|=128*p,a}function B(t,e,n){var o,i=8*n-e-1,r=(1<<i)-1,a=r>>1,s=i-7,l=n-1,c=t[l--],u=127&c;for(c>>=7;s>0;u=256*u+t[l],l--,s-=8);for(o=u&(1<<-s)-1,u>>=-s,s+=e;s>0;o=256*o+t[l],l--,s-=8);if(0===u)u=1-a;else{if(u===r)return o?NaN:c?-k:k;o+=x(2,e),u-=a}return(c?-1:1)*o*x(2,u-e)}function R(t){return t[3]<<24|t[2]<<16|t[1]<<8|t[0]}function L(t){return[255&t]}function P(t){return[255&t,t>>8&255]}function M(t){return[255&t,t>>8&255,t>>16&255,t>>24&255]}function F(t){return D(t,52,8)}function H(t){return D(t,23,4)}function j(t,e,n){g(t.prototype,e,{get:function(){return this[n]}})}function V(t,e,n,o){var i=h(+n);if(i+e>t[A])throw C("Wrong index!");var r=t[O]._b,a=i+t[N],s=r.slice(a,a+e);return o?s:s.reverse()}function U(t,e,n,o,i,r){var a=h(+n);if(a+e>t[A])throw C("Wrong index!");for(var s=t[O]._b,l=a+t[N],c=o(+i),u=0;u<e;u++)s[l+u]=c[r?u:e-u-1]}if(a.ABV){if(!c(function(){v(1)})||!c(function(){new v(-1)})||c(function(){return new v,new v(1.5),new v(NaN),"ArrayBuffer"!=v.name})){for(var z,G=(v=function(t){return u(this,v),new w(h(t))}).prototype=w.prototype,J=f(w),W=0;J.length>W;)(z=J[W++])in v||s(v,z,w[z]);r||(G.constructor=v)}var $=new _(new v(2)),K=_.prototype.setInt8;$.setInt8(0,2147483648),$.setInt8(1,2147483649),!$.getInt8(0)&&$.getInt8(1)||l(_.prototype,{setInt8:function(t,e){K.call(this,t,e<<24>>24)},setUint8:function(t,e){K.call(this,t,e<<24>>24)}},!0)}else v=function(t){u(this,v,"ArrayBuffer");var e=h(t);this._b=m.call(new Array(e),0),this[A]=e},_=function(t,e,n){u(this,_,"DataView"),u(t,v,"DataView");var o=t[A],i=d(e);if(i<0||i>o)throw C("Wrong offset!");if(i+(n=void 0===n?o-i:p(n))>o)throw C("Wrong length!");this[O]=t,this[N]=i,this[A]=n},i&&(j(v,"byteLength","_l"),j(_,"buffer","_b"),j(_,"byteLength","_l"),j(_,"byteOffset","_o")),l(_.prototype,{getInt8:function(t){return V(this,1,t)[0]<<24>>24},getUint8:function(t){return V(this,1,t)[0]},getInt16:function(t){var e=V(this,2,t,arguments[1]);return(e[1]<<8|e[0])<<16>>16},getUint16:function(t){var e=V(this,2,t,arguments[1]);return e[1]<<8|e[0]},getInt32:function(t){return R(V(this,4,t,arguments[1]))},getUint32:function(t){return R(V(this,4,t,arguments[1]))>>>0},getFloat32:function(t){return B(V(this,4,t,arguments[1]),23,4)},getFloat64:function(t){return B(V(this,8,t,arguments[1]),52,8)},setInt8:function(t,e){U(this,1,t,L,e)},setUint8:function(t,e){U(this,1,t,L,e)},setInt16:function(t,e){U(this,2,t,P,e,arguments[2])},setUint16:function(t,e){U(this,2,t,P,e,arguments[2])},setInt32:function(t,e){U(this,4,t,M,e,arguments[2])},setUint32:function(t,e){U(this,4,t,M,e,arguments[2])},setFloat32:function(t,e){U(this,4,t,H,e,arguments[2])},setFloat64:function(t,e){U(this,8,t,F,e,arguments[2])}});y(v,"ArrayBuffer"),y(_,"DataView"),s(_.prototype,a.VIEW,!0),e.ArrayBuffer=v,e.DataView=_},function(t,e){var n=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},function(t,e){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},function(t,e,n){t.exports=!n(146)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(t,e,n){var o=n(31),i=n(34);e.a=function(t){if(!Object(i.a)(t))return!1;var e=Object(o.a)(t);return"[object Function]"==e||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e}},function(t,e,n){e.a=function(t,e){return function(n){return t(e(n))}}},function(t,e,n){var o=n(106),i=n(58);e.a=function(t){return null!=t&&Object(i.a)(t.length)&&!Object(o.a)(t)}},function(t,e,n){e.a=function(t){return t}},function(t,e,n){var o=n(31),i=n(26),r=function(t){return Object(i.a)(t)&&"[object Arguments]"==Object(o.a)(t)},a=Object.prototype,s=a.hasOwnProperty,l=a.propertyIsEnumerable,c=r(function(){return arguments}())?r:function(t){return Object(i.a)(t)&&s.call(t,"callee")&&!l.call(t,"callee")};e.a=c},function(t,e,n){var o=n(31),i=n(58),r=n(26),a={};a["[object Float32Array]"]=a["[object Float64Array]"]=a["[object Int8Array]"]=a["[object Int16Array]"]=a["[object Int32Array]"]=a["[object Uint8Array]"]=a["[object Uint8ClampedArray]"]=a["[object Uint16Array]"]=a["[object Uint32Array]"]=!0,a["[object Arguments]"]=a["[object Array]"]=a["[object ArrayBuffer]"]=a["[object Boolean]"]=a["[object DataView]"]=a["[object Date]"]=a["[object Error]"]=a["[object Function]"]=a["[object Map]"]=a["[object Number]"]=a["[object Object]"]=a["[object RegExp]"]=a["[object Set]"]=a["[object String]"]=a["[object WeakMap]"]=!1;var s=n(75),l=n(57),c=l.a&&l.a.isTypedArray,u=c?Object(s.a)(c):function(t){return Object(r.a)(t)&&Object(i.a)(t.length)&&!!a[Object(o.a)(t)]};e.a=u},function(t,e,n){var o=n(110),i=n(35),r=n(73),a=n(76),s=n(111),l=Object.prototype.hasOwnProperty;e.a=function(t,e){var n=Object(i.a)(t),c=!n&&Object(o.a)(t),u=!n&&!c&&Object(r.a)(t),d=!n&&!c&&!u&&Object(s.a)(t),p=n||c||u||d,h=p?function(t,e){for(var n=-1,o=Array(t);++n<t;)o[n]=e(n);return o}(t.length,String):[],f=h.length;for(var g in t)!e&&!l.call(t,g)||p&&("length"==g||u&&("offset"==g||"parent"==g)||d&&("buffer"==g||"byteLength"==g||"byteOffset"==g)||Object(a.a)(g,f))||h.push(g);return h}},function(t,e){t.exports=function(t){if(!t.webpackPolyfill){var e=Object.create(t);e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),Object.defineProperty(e,"exports",{enumerable:!0}),e.webpackPolyfill=1}return e}},function(t,e,n){t.exports=!n(9)&&!n(3)(function(){return 7!=Object.defineProperty(n(78)("div"),"a",{get:function(){return 7}}).a})},function(t,e,n){var o=n(2),i=n(8),r=n(38),a=n(79),s=n(10).f;t.exports=function(t){var e=i.Symbol||(i.Symbol=r?{}:o.Symbol||{});"_"==t.charAt(0)||t in e||s(e,t,{value:a.f(t)})}},function(t,e,n){var o=n(14),i=n(16),r=n(61)(!1),a=n(80)("IE_PROTO");t.exports=function(t,e){var n,s=i(t),l=0,c=[];for(n in s)n!=a&&o(s,n)&&c.push(n);for(;e.length>l;)o(s,n=e[l++])&&(~r(c,n)||c.push(n));return c}},function(t,e,n){var o=n(10),i=n(4),r=n(39);t.exports=n(9)?Object.defineProperties:function(t,e){i(t);for(var n,a=r(e),s=a.length,l=0;s>l;)o.f(t,n=a[l++],e[n]);return t}},function(t,e,n){var o=n(16),i=n(42).f,r={}.toString,a="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];t.exports.f=function(t){return a&&"[object Window]"==r.call(t)?function(t){try{return i(t)}catch(t){return a.slice()}}(t):i(o(t))}},function(t,e,n){var o=n(9),i=n(39),r=n(62),a=n(54),s=n(11),l=n(53),c=Object.assign;t.exports=!c||n(3)(function(){var t={},e={},n=Symbol(),o="abcdefghijklmnopqrst";return t[n]=7,o.split("").forEach(function(t){e[t]=t}),7!=c({},t)[n]||Object.keys(c({},e)).join("")!=o})?function(t,e){for(var n=s(t),c=arguments.length,u=1,d=r.f,p=a.f;c>u;)for(var h,f=l(arguments[u++]),g=d?i(f).concat(d(f)):i(f),m=g.length,y=0;m>y;)h=g[y++],o&&!p.call(f,h)||(n[h]=f[h]);return n}:c},function(t,e){t.exports=Object.is||function(t,e){return t===e?0!==t||1/t==1/e:t!=t&&e!=e}},function(t,e,n){var o=n(20),i=n(5),r=n(122),a=[].slice,s={},l=function(t,e,n){if(!(e in s)){for(var o=[],i=0;i<e;i++)o[i]="a["+i+"]";s[e]=Function("F,a","return new F("+o.join(",")+")")}return s[e](t,n)};t.exports=Function.bind||function(t){var e=o(this),n=a.call(arguments,1),s=function(){var o=n.concat(a.call(arguments));return this instanceof s?l(e,o.length,o):r(e,o,t)};return i(e.prototype)&&(s.prototype=e.prototype),s}},function(t,e){t.exports=function(t,e,n){var o=void 0===n;switch(e.length){case 0:return o?t():t.call(n);case 1:return o?t(e[0]):t.call(n,e[0]);case 2:return o?t(e[0],e[1]):t.call(n,e[0],e[1]);case 3:return o?t(e[0],e[1],e[2]):t.call(n,e[0],e[1],e[2]);case 4:return o?t(e[0],e[1],e[2],e[3]):t.call(n,e[0],e[1],e[2],e[3])}return t.apply(n,e)}},function(t,e,n){var o=n(2).parseInt,i=n(48).trim,r=n(84),a=/^[-+]?0[xX]/;t.exports=8!==o(r+"08")||22!==o(r+"0x16")?function(t,e){var n=i(String(t),3);return o(n,e>>>0||(a.test(n)?16:10))}:o},function(t,e,n){var o=n(2).parseFloat,i=n(48).trim;t.exports=1/o(n(84)+"-0")!=-1/0?function(t){var e=i(String(t),3),n=o(e);return 0===n&&"-"==e.charAt(0)?-0:n}:o},function(t,e,n){var o=n(27);t.exports=function(t,e){if("number"!=typeof t&&"Number"!=o(t))throw TypeError(e);return+t}},function(t,e,n){var o=n(5),i=Math.floor;t.exports=function(t){return!o(t)&&isFinite(t)&&i(t)===t}},function(t,e){t.exports=Math.log1p||function(t){return(t=+t)>-1e-8&&t<1e-8?t-t*t/2:Math.log(1+t)}},function(t,e,n){var o=n(41),i=n(36),r=n(47),a={};n(15)(a,n(6)("iterator"),function(){return this}),t.exports=function(t,e,n){t.prototype=o(a,{next:i(1,n)}),r(t,e+" Iterator")}},function(t,e,n){var o=n(4);t.exports=function(t,e,n,i){try{return i?e(o(n)[0],n[1]):e(n)}catch(e){var r=t.return;throw void 0!==r&&o(r.call(t)),e}}},function(t,e,n){var o=n(244);t.exports=function(t,e){return new(o(t))(e)}},function(t,e,n){var o=n(20),i=n(11),r=n(53),a=n(7);t.exports=function(t,e,n,s,l){o(e);var c=i(t),u=r(c),d=a(c.length),p=l?d-1:0,h=l?-1:1;if(n<2)for(;;){if(p in u){s=u[p],p+=h;break}if(p+=h,l?p<0:d<=p)throw TypeError("Reduce of empty array with no initial value")}for(;l?p>=0:d>p;p+=h)p in u&&(s=e(s,u[p],p,c));return s}},function(t,e,n){var o=n(11),i=n(40),r=n(7);t.exports=[].copyWithin||function(t,e){var n=o(this),a=r(n.length),s=i(t,a),l=i(e,a),c=arguments.length>2?arguments[2]:void 0,u=Math.min((void 0===c?a:i(c,a))-l,a-s),d=1;for(l<s&&s<l+u&&(d=-1,l+=u-1,s+=u-1);u-- >0;)l in n?n[s]=n[l]:delete n[s],s+=d,l+=d;return n}},function(t,e){t.exports=function(t,e){return{value:e,done:!!t}}},function(t,e,n){var o=n(99);n(0)({target:"RegExp",proto:!0,forced:o!==/./.exec},{exec:o})},function(t,e,n){n(9)&&"g"!=/./g.flags&&n(10).f(RegExp.prototype,"flags",{configurable:!0,get:n(65)})},function(t,e,n){var o,i,r,a,s=n(38),l=n(2),c=n(19),u=n(55),d=n(0),p=n(5),h=n(20),f=n(51),g=n(68),m=n(56),y=n(101).set,v=n(264)(),_=n(137),b=n(265),C=n(69),k=n(138),w=l.TypeError,S=l.process,x=S&&S.versions,E=x&&x.v8||"",I=l.Promise,T="process"==u(S),O=function(){},A=i=_.f,N=!!function(){try{var t=I.resolve(1),e=(t.constructor={})[n(6)("species")]=function(t){t(O,O)};return(T||"function"==typeof PromiseRejectionEvent)&&t.then(O)instanceof e&&0!==E.indexOf("6.6")&&-1===C.indexOf("Chrome/66")}catch(t){}}(),D=function(t){var e;return!(!p(t)||"function"!=typeof(e=t.then))&&e},B=function(t,e){if(!t._n){t._n=!0;var n=t._c;v(function(){for(var o=t._v,i=1==t._s,r=0,a=function(e){var n,r,a,s=i?e.ok:e.fail,l=e.resolve,c=e.reject,u=e.domain;try{s?(i||(2==t._h&&P(t),t._h=1),!0===s?n=o:(u&&u.enter(),n=s(o),u&&(u.exit(),a=!0)),n===e.promise?c(w("Promise-chain cycle")):(r=D(n))?r.call(n,l,c):l(n)):c(o)}catch(t){u&&!a&&u.exit(),c(t)}};n.length>r;)a(n[r++]);t._c=[],t._n=!1,e&&!t._h&&R(t)})}},R=function(t){y.call(l,function(){var e,n,o,i=t._v,r=L(t);if(r&&(e=b(function(){T?S.emit("unhandledRejection",i,t):(n=l.onunhandledrejection)?n({promise:t,reason:i}):(o=l.console)&&o.error&&o.error("Unhandled promise rejection",i)}),t._h=T||L(t)?2:1),t._a=void 0,r&&e.e)throw e.v})},L=function(t){return 1!==t._h&&0===(t._a||t._c).length},P=function(t){y.call(l,function(){var e;T?S.emit("rejectionHandled",t):(e=l.onrejectionhandled)&&e({promise:t,reason:t._v})})},M=function(t){var e=this;e._d||(e._d=!0,(e=e._w||e)._v=t,e._s=2,e._a||(e._a=e._c.slice()),B(e,!0))},F=function(t){var e,n=this;if(!n._d){n._d=!0,n=n._w||n;try{if(n===t)throw w("Promise can't be resolved itself");(e=D(t))?v(function(){var o={_w:n,_d:!1};try{e.call(t,c(F,o,1),c(M,o,1))}catch(t){M.call(o,t)}}):(n._v=t,n._s=1,B(n,!1))}catch(t){M.call({_w:n,_d:!1},t)}}};N||(I=function(t){f(this,I,"Promise","_h"),h(t),o.call(this);try{t(c(F,this,1),c(M,this,1))}catch(t){M.call(this,t)}},(o=function(t){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=n(52)(I.prototype,{then:function(t,e){var n=A(m(this,I));return n.ok="function"!=typeof t||t,n.fail="function"==typeof e&&e,n.domain=T?S.domain:void 0,this._c.push(n),this._a&&this._a.push(n),this._s&&B(this,!1),n.promise},catch:function(t){return this.then(void 0,t)}}),r=function(){var t=new o;this.promise=t,this.resolve=c(F,t,1),this.reject=c(M,t,1)},_.f=A=function(t){return t===I||t===a?new r(t):i(t)}),d(d.G+d.W+d.F*!N,{Promise:I}),n(47)(I,"Promise"),n(50)("Promise"),a=n(8).Promise,d(d.S+d.F*!N,"Promise",{reject:function(t){var e=A(this);return(0,e.reject)(t),e.promise}}),d(d.S+d.F*(s||!N),"Promise",{resolve:function(t){return k(s&&this===a?I:this,t)}}),d(d.S+d.F*!(N&&n(64)(function(t){I.all(t).catch(O)})),"Promise",{all:function(t){var e=this,n=A(e),o=n.resolve,i=n.reject,r=b(function(){var n=[],r=0,a=1;g(t,!1,function(t){var s=r++,l=!1;n.push(void 0),a++,e.resolve(t).then(function(t){l||(l=!0,n[s]=t,--a||o(n))},i)}),--a||o(n)});return r.e&&i(r.v),n.promise},race:function(t){var e=this,n=A(e),o=n.reject,i=b(function(){g(t,!1,function(t){e.resolve(t).then(n.resolve,o)})});return i.e&&o(i.v),n.promise}})},function(t,e,n){var o=n(20);function i(t){var e,n;this.promise=new t(function(t,o){if(void 0!==e||void 0!==n)throw TypeError("Bad Promise constructor");e=t,n=o}),this.resolve=o(e),this.reject=o(n)}t.exports.f=function(t){return new i(t)}},function(t,e,n){var o=n(4),i=n(5),r=n(137);t.exports=function(t,e){if(o(t),i(e)&&e.constructor===t)return e;var n=r.f(t);return(0,n.resolve)(e),n.promise}},function(t,e,n){var o=n(10).f,i=n(41),r=n(52),a=n(19),s=n(51),l=n(68),c=n(90),u=n(133),d=n(50),p=n(9),h=n(33).fastKey,f=n(45),g=p?"_s":"size",m=function(t,e){var n,o=h(e);if("F"!==o)return t._i[o];for(n=t._f;n;n=n.n)if(n.k==e)return n};t.exports={getConstructor:function(t,e,n,c){var u=t(function(t,o){s(t,u,e,"_i"),t._t=e,t._i=i(null),t._f=void 0,t._l=void 0,t[g]=0,null!=o&&l(o,n,t[c],t)});return r(u.prototype,{clear:function(){for(var t=f(this,e),n=t._i,o=t._f;o;o=o.n)o.r=!0,o.p&&(o.p=o.p.n=void 0),delete n[o.i];t._f=t._l=void 0,t[g]=0},delete:function(t){var n=f(this,e),o=m(n,t);if(o){var i=o.n,r=o.p;delete n._i[o.i],o.r=!0,r&&(r.n=i),i&&(i.p=r),n._f==o&&(n._f=i),n._l==o&&(n._l=r),n[g]--}return!!o},forEach:function(t){f(this,e);for(var n,o=a(t,arguments.length>1?arguments[1]:void 0,3);n=n?n.n:this._f;)for(o(n.v,n.k,this);n&&n.r;)n=n.p},has:function(t){return!!m(f(this,e),t)}}),p&&o(u.prototype,"size",{get:function(){return f(this,e)[g]}}),u},def:function(t,e,n){var o,i,r=m(t,e);return r?r.v=n:(t._l=r={i:i=h(e,!0),k:e,v:n,p:o=t._l,n:void 0,r:!1},t._f||(t._f=r),o&&(o.n=r),t[g]++,"F"!==i&&(t._i[i]=r)),t},getEntry:m,setStrong:function(t,e,n){c(t,e,function(t,n){this._t=f(t,e),this._k=n,this._l=void 0},function(){for(var t=this._k,e=this._l;e&&e.r;)e=e.p;return this._t&&(this._l=e=e?e.n:this._t._f)?u(0,"keys"==t?e.k:"values"==t?e.v:[e.k,e.v]):(this._t=void 0,u(1))},n?"entries":"values",!n,!0),d(e)}}},function(t,e,n){var o=n(52),i=n(33).getWeak,r=n(4),a=n(5),s=n(51),l=n(68),c=n(24),u=n(14),d=n(45),p=c(5),h=c(6),f=0,g=function(t){return t._l||(t._l=new m)},m=function(){this.a=[]},y=function(t,e){return p(t.a,function(t){return t[0]===e})};m.prototype={get:function(t){var e=y(this,t);if(e)return e[1]},has:function(t){return!!y(this,t)},set:function(t,e){var n=y(this,t);n?n[1]=e:this.a.push([t,e])},delete:function(t){var e=h(this.a,function(e){return e[0]===t});return~e&&this.a.splice(e,1),!!~e}},t.exports={getConstructor:function(t,e,n,r){var c=t(function(t,o){s(t,c,e,"_i"),t._t=e,t._i=f++,t._l=void 0,null!=o&&l(o,n,t[r],t)});return o(c.prototype,{delete:function(t){if(!a(t))return!1;var n=i(t);return!0===n?g(d(this,e)).delete(t):n&&u(n,this._i)&&delete n[this._i]},has:function(t){if(!a(t))return!1;var n=i(t);return!0===n?g(d(this,e)).has(t):n&&u(n,this._i)}}),c},def:function(t,e,n){var o=i(r(e),!0);return!0===o?g(t).set(e,n):o[t._i]=n,t},ufstore:g}},function(t,e,n){var o=n(21),i=n(7);t.exports=function(t){if(void 0===t)return 0;var e=o(t),n=i(e);if(e!==n)throw RangeError("Wrong length!");return n}},function(t,e,n){var o=n(42),i=n(62),r=n(4),a=n(2).Reflect;t.exports=a&&a.ownKeys||function(t){var e=o.f(r(t)),n=i.f;return n?e.concat(n(t)):e}},function(t,e,n){var o=n(7),i=n(86),r=n(28);t.exports=function(t,e,n,a){var s=String(r(t)),l=s.length,c=void 0===n?" ":String(n),u=o(e);if(u<=l||""==c)return s;var d=u-l,p=i.call(c,Math.ceil(d/c.length));return p.length>d&&(p=p.slice(0,d)),a?p+s:s+p}},function(t,e,n){var o=n(9),i=n(39),r=n(16),a=n(54).f;t.exports=function(t){return function(e){for(var n,s=r(e),l=i(s),c=l.length,u=0,d=[];c>u;)n=l[u++],o&&!a.call(s,n)||d.push(t?[n,s[n]]:s[n]);return d}}},function(t,e){var n=t.exports={version:"2.6.11"};"number"==typeof __e&&(__e=n)},function(t,e){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,e,n){e.a=function(){return!1}},,,function(t,e,n){n(151);var o,i=(o=n(323))&&o.__esModule?o:{default:o};i.default._babelPolyfill&&"undefined"!=typeof console&&console.warn&&console.warn("@babel/polyfill is loaded more than once on this page. This is probably not desirable/intended and may have consequences if different versions of the polyfills are applied sequentially. If you do need to load the polyfill more than once, use @babel/polyfill/noConflict instead to bypass the warning."),i.default._babelPolyfill=!0},function(t,e,n){n(152),n(295),n(297),n(300),n(302),n(304),n(306),n(308),n(310),n(312),n(314),n(316),n(318),n(322)},function(t,e,n){n(153),n(156),n(157),n(158),n(159),n(160),n(161),n(162),n(163),n(164),n(165),n(166),n(167),n(168),n(169),n(170),n(171),n(172),n(173),n(174),n(175),n(176),n(177),n(178),n(179),n(180),n(181),n(182),n(183),n(184),n(185),n(186),n(187),n(188),n(189),n(190),n(191),n(192),n(193),n(194),n(195),n(196),n(197),n(199),n(200),n(201),n(202),n(203),n(204),n(205),n(206),n(207),n(208),n(209),n(210),n(211),n(212),n(213),n(214),n(215),n(216),n(217),n(218),n(219),n(220),n(221),n(222),n(223),n(224),n(225),n(226),n(227),n(228),n(229),n(230),n(231),n(232),n(234),n(235),n(237),n(238),n(239),n(240),n(241),n(242),n(243),n(245),n(246),n(247),n(248),n(249),n(250),n(251),n(252),n(253),n(254),n(255),n(256),n(257),n(98),n(258),n(134),n(259),n(135),n(260),n(261),n(262),n(263),n(136),n(266),n(267),n(268),n(269),n(270),n(271),n(272),n(273),n(274),n(275),n(276),n(277),n(278),n(279),n(280),n(281),n(282),n(283),n(284),n(285),n(286),n(287),n(288),n(289),n(290),n(291),n(292),n(293),n(294),t.exports=n(8)},function(t,e,n){var o=n(2),i=n(14),r=n(9),a=n(0),s=n(12),l=n(33).KEY,c=n(3),u=n(60),d=n(47),p=n(37),h=n(6),f=n(79),g=n(115),m=n(155),y=n(63),v=n(4),_=n(5),b=n(11),C=n(16),k=n(32),w=n(36),S=n(41),x=n(118),E=n(22),I=n(62),T=n(10),O=n(39),A=E.f,N=T.f,D=x.f,B=o.Symbol,R=o.JSON,L=R&&R.stringify,P=h("_hidden"),M=h("toPrimitive"),F={}.propertyIsEnumerable,H=u("symbol-registry"),j=u("symbols"),V=u("op-symbols"),U=Object.prototype,z="function"==typeof B&&!!I.f,G=o.QObject,J=!G||!G.prototype||!G.prototype.findChild,W=r&&c(function(){return 7!=S(N({},"a",{get:function(){return N(this,"a",{value:7}).a}})).a})?function(t,e,n){var o=A(U,e);o&&delete U[e],N(t,e,n),o&&t!==U&&N(U,e,o)}:N,$=function(t){var e=j[t]=S(B.prototype);return e._k=t,e},K=z&&"symbol"==typeof B.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof B},Y=function(t,e,n){return t===U&&Y(V,e,n),v(t),e=k(e,!0),v(n),i(j,e)?(n.enumerable?(i(t,P)&&t[P][e]&&(t[P][e]=!1),n=S(n,{enumerable:w(0,!1)})):(i(t,P)||N(t,P,w(1,{})),t[P][e]=!0),W(t,e,n)):N(t,e,n)},X=function(t,e){v(t);for(var n,o=m(e=C(e)),i=0,r=o.length;r>i;)Y(t,n=o[i++],e[n]);return t},q=function(t){var e=F.call(this,t=k(t,!0));return!(this===U&&i(j,t)&&!i(V,t))&&(!(e||!i(this,t)||!i(j,t)||i(this,P)&&this[P][t])||e)},Q=function(t,e){if(t=C(t),e=k(e,!0),t!==U||!i(j,e)||i(V,e)){var n=A(t,e);return!n||!i(j,e)||i(t,P)&&t[P][e]||(n.enumerable=!0),n}},Z=function(t){for(var e,n=D(C(t)),o=[],r=0;n.length>r;)i(j,e=n[r++])||e==P||e==l||o.push(e);return o},tt=function(t){for(var e,n=t===U,o=D(n?V:C(t)),r=[],a=0;o.length>a;)!i(j,e=o[a++])||n&&!i(U,e)||r.push(j[e]);return r};z||(s((B=function(){if(this instanceof B)throw TypeError("Symbol is not a constructor!");var t=p(arguments.length>0?arguments[0]:void 0),e=function(n){this===U&&e.call(V,n),i(this,P)&&i(this[P],t)&&(this[P][t]=!1),W(this,t,w(1,n))};return r&&J&&W(U,t,{configurable:!0,set:e}),$(t)}).prototype,"toString",function(){return this._k}),E.f=Q,T.f=Y,n(42).f=x.f=Z,n(54).f=q,I.f=tt,r&&!n(38)&&s(U,"propertyIsEnumerable",q,!0),f.f=function(t){return $(h(t))}),a(a.G+a.W+a.F*!z,{Symbol:B});for(var et="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),nt=0;et.length>nt;)h(et[nt++]);for(var ot=O(h.store),it=0;ot.length>it;)g(ot[it++]);a(a.S+a.F*!z,"Symbol",{for:function(t){return i(H,t+="")?H[t]:H[t]=B(t)},keyFor:function(t){if(!K(t))throw TypeError(t+" is not a symbol!");for(var e in H)if(H[e]===t)return e},useSetter:function(){J=!0},useSimple:function(){J=!1}}),a(a.S+a.F*!z,"Object",{create:function(t,e){return void 0===e?S(t):X(S(t),e)},defineProperty:Y,defineProperties:X,getOwnPropertyDescriptor:Q,getOwnPropertyNames:Z,getOwnPropertySymbols:tt});var rt=c(function(){I.f(1)});a(a.S+a.F*rt,"Object",{getOwnPropertySymbols:function(t){return I.f(b(t))}}),R&&a(a.S+a.F*(!z||c(function(){var t=B();return"[null]"!=L([t])||"{}"!=L({a:t})||"{}"!=L(Object(t))})),"JSON",{stringify:function(t){for(var e,n,o=[t],i=1;arguments.length>i;)o.push(arguments[i++]);if(n=e=o[1],(_(e)||void 0!==t)&&!K(t))return y(e)||(e=function(t,e){if("function"==typeof n&&(e=n.call(this,t,e)),!K(e))return e}),o[1]=e,L.apply(R,o)}}),B.prototype[M]||n(15)(B.prototype,M,B.prototype.valueOf),d(B,"Symbol"),d(Math,"Math",!0),d(o.JSON,"JSON",!0)},function(t,e,n){t.exports=n(60)("native-function-to-string",Function.toString)},function(t,e,n){var o=n(39),i=n(62),r=n(54);t.exports=function(t){var e=o(t),n=i.f;if(n)for(var a,s=n(t),l=r.f,c=0;s.length>c;)l.call(t,a=s[c++])&&e.push(a);return e}},function(t,e,n){var o=n(0);o(o.S,"Object",{create:n(41)})},function(t,e,n){var o=n(0);o(o.S+o.F*!n(9),"Object",{defineProperty:n(10).f})},function(t,e,n){var o=n(0);o(o.S+o.F*!n(9),"Object",{defineProperties:n(117)})},function(t,e,n){var o=n(16),i=n(22).f;n(23)("getOwnPropertyDescriptor",function(){return function(t,e){return i(o(t),e)}})},function(t,e,n){var o=n(11),i=n(43);n(23)("getPrototypeOf",function(){return function(t){return i(o(t))}})},function(t,e,n){var o=n(11),i=n(39);n(23)("keys",function(){return function(t){return i(o(t))}})},function(t,e,n){n(23)("getOwnPropertyNames",function(){return n(118).f})},function(t,e,n){var o=n(5),i=n(33).onFreeze;n(23)("freeze",function(t){return function(e){return t&&o(e)?t(i(e)):e}})},function(t,e,n){var o=n(5),i=n(33).onFreeze;n(23)("seal",function(t){return function(e){return t&&o(e)?t(i(e)):e}})},function(t,e,n){var o=n(5),i=n(33).onFreeze;n(23)("preventExtensions",function(t){return function(e){return t&&o(e)?t(i(e)):e}})},function(t,e,n){var o=n(5);n(23)("isFrozen",function(t){return function(e){return!o(e)||!!t&&t(e)}})},function(t,e,n){var o=n(5);n(23)("isSealed",function(t){return function(e){return!o(e)||!!t&&t(e)}})},function(t,e,n){var o=n(5);n(23)("isExtensible",function(t){return function(e){return!!o(e)&&(!t||t(e))}})},function(t,e,n){var o=n(0);o(o.S+o.F,"Object",{assign:n(119)})},function(t,e,n){var o=n(0);o(o.S,"Object",{is:n(120)})},function(t,e,n){var o=n(0);o(o.S,"Object",{setPrototypeOf:n(83).set})},function(t,e,n){var o=n(55),i={};i[n(6)("toStringTag")]="z",i+""!="[object z]"&&n(12)(Object.prototype,"toString",function(){return"[object "+o(this)+"]"},!0)},function(t,e,n){var o=n(0);o(o.P,"Function",{bind:n(121)})},function(t,e,n){var o=n(10).f,i=Function.prototype,r=/^\s*function ([^ (]*)/;"name"in i||n(9)&&o(i,"name",{configurable:!0,get:function(){try{return(""+this).match(r)[1]}catch(t){return""}}})},function(t,e,n){var o=n(5),i=n(43),r=n(6)("hasInstance"),a=Function.prototype;r in a||n(10).f(a,r,{value:function(t){if("function"!=typeof this||!o(t))return!1;if(!o(this.prototype))return t instanceof this;for(;t=i(t);)if(this.prototype===t)return!0;return!1}})},function(t,e,n){var o=n(0),i=n(123);o(o.G+o.F*(parseInt!=i),{parseInt:i})},function(t,e,n){var o=n(0),i=n(124);o(o.G+o.F*(parseFloat!=i),{parseFloat:i})},function(t,e,n){var o=n(2),i=n(14),r=n(27),a=n(85),s=n(32),l=n(3),c=n(42).f,u=n(22).f,d=n(10).f,p=n(48).trim,h=o.Number,f=h,g=h.prototype,m="Number"==r(n(41)(g)),y="trim"in String.prototype,v=function(t){var e=s(t,!1);if("string"==typeof e&&e.length>2){var n,o,i,r=(e=y?e.trim():p(e,3)).charCodeAt(0);if(43===r||45===r){if(88===(n=e.charCodeAt(2))||120===n)return NaN}else if(48===r){switch(e.charCodeAt(1)){case 66:case 98:o=2,i=49;break;case 79:case 111:o=8,i=55;break;default:return+e}for(var a,l=e.slice(2),c=0,u=l.length;c<u;c++)if((a=l.charCodeAt(c))<48||a>i)return NaN;return parseInt(l,o)}}return+e};if(!h(" 0o1")||!h("0b1")||h("+0x1")){h=function(t){var e=arguments.length<1?0:t,n=this;return n instanceof h&&(m?l(function(){g.valueOf.call(n)}):"Number"!=r(n))?a(new f(v(e)),n,h):v(e)};for(var _,b=n(9)?c(f):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),C=0;b.length>C;C++)i(f,_=b[C])&&!i(h,_)&&d(h,_,u(f,_));h.prototype=g,g.constructor=h,n(12)(o,"Number",h)}},function(t,e,n){var o=n(0),i=n(21),r=n(125),a=n(86),s=1..toFixed,l=Math.floor,c=[0,0,0,0,0,0],u="Number.toFixed: incorrect invocation!",d=function(t,e){for(var n=-1,o=e;++n<6;)o+=t*c[n],c[n]=o%1e7,o=l(o/1e7)},p=function(t){for(var e=6,n=0;--e>=0;)n+=c[e],c[e]=l(n/t),n=n%t*1e7},h=function(){for(var t=6,e="";--t>=0;)if(""!==e||0===t||0!==c[t]){var n=String(c[t]);e=""===e?n:e+a.call("0",7-n.length)+n}return e},f=function(t,e,n){return 0===e?n:e%2==1?f(t,e-1,n*t):f(t*t,e/2,n)};o(o.P+o.F*(!!s&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!n(3)(function(){s.call({})})),"Number",{toFixed:function(t){var e,n,o,s,l=r(this,u),c=i(t),g="",m="0";if(c<0||c>20)throw RangeError(u);if(l!=l)return"NaN";if(l<=-1e21||l>=1e21)return String(l);if(l<0&&(g="-",l=-l),l>1e-21)if(n=(e=function(t){for(var e=0,n=t;n>=4096;)e+=12,n/=4096;for(;n>=2;)e+=1,n/=2;return e}(l*f(2,69,1))-69)<0?l*f(2,-e,1):l/f(2,e,1),n*=4503599627370496,(e=52-e)>0){for(d(0,n),o=c;o>=7;)d(1e7,0),o-=7;for(d(f(10,o,1),0),o=e-1;o>=23;)p(1<<23),o-=23;p(1<<o),d(1,1),p(2),m=h()}else d(0,n),d(1<<-e,0),m=h()+a.call("0",c);return m=c>0?g+((s=m.length)<=c?"0."+a.call("0",c-s)+m:m.slice(0,s-c)+"."+m.slice(s-c)):g+m}})},function(t,e,n){var o=n(0),i=n(3),r=n(125),a=1..toPrecision;o(o.P+o.F*(i(function(){return"1"!==a.call(1,void 0)})||!i(function(){a.call({})})),"Number",{toPrecision:function(t){var e=r(this,"Number#toPrecision: incorrect invocation!");return void 0===t?a.call(e):a.call(e,t)}})},function(t,e,n){var o=n(0);o(o.S,"Number",{EPSILON:Math.pow(2,-52)})},function(t,e,n){var o=n(0),i=n(2).isFinite;o(o.S,"Number",{isFinite:function(t){return"number"==typeof t&&i(t)}})},function(t,e,n){var o=n(0);o(o.S,"Number",{isInteger:n(126)})},function(t,e,n){var o=n(0);o(o.S,"Number",{isNaN:function(t){return t!=t}})},function(t,e,n){var o=n(0),i=n(126),r=Math.abs;o(o.S,"Number",{isSafeInteger:function(t){return i(t)&&r(t)<=9007199254740991}})},function(t,e,n){var o=n(0);o(o.S,"Number",{MAX_SAFE_INTEGER:9007199254740991})},function(t,e,n){var o=n(0);o(o.S,"Number",{MIN_SAFE_INTEGER:-9007199254740991})},function(t,e,n){var o=n(0),i=n(124);o(o.S+o.F*(Number.parseFloat!=i),"Number",{parseFloat:i})},function(t,e,n){var o=n(0),i=n(123);o(o.S+o.F*(Number.parseInt!=i),"Number",{parseInt:i})},function(t,e,n){var o=n(0),i=n(127),r=Math.sqrt,a=Math.acosh;o(o.S+o.F*!(a&&710==Math.floor(a(Number.MAX_VALUE))&&a(1/0)==1/0),"Math",{acosh:function(t){return(t=+t)<1?NaN:t>94906265.62425156?Math.log(t)+Math.LN2:i(t-1+r(t-1)*r(t+1))}})},function(t,e,n){var o=n(0),i=Math.asinh;o(o.S+o.F*!(i&&1/i(0)>0),"Math",{asinh:function t(e){return isFinite(e=+e)&&0!=e?e<0?-t(-e):Math.log(e+Math.sqrt(e*e+1)):e}})},function(t,e,n){var o=n(0),i=Math.atanh;o(o.S+o.F*!(i&&1/i(-0)<0),"Math",{atanh:function(t){return 0==(t=+t)?t:Math.log((1+t)/(1-t))/2}})},function(t,e,n){var o=n(0),i=n(87);o(o.S,"Math",{cbrt:function(t){return i(t=+t)*Math.pow(Math.abs(t),1/3)}})},function(t,e,n){var o=n(0);o(o.S,"Math",{clz32:function(t){return(t>>>=0)?31-Math.floor(Math.log(t+.5)*Math.LOG2E):32}})},function(t,e,n){var o=n(0),i=Math.exp;o(o.S,"Math",{cosh:function(t){return(i(t=+t)+i(-t))/2}})},function(t,e,n){var o=n(0),i=n(88);o(o.S+o.F*(i!=Math.expm1),"Math",{expm1:i})},function(t,e,n){var o=n(0);o(o.S,"Math",{fround:n(198)})},function(t,e,n){var o=n(87),i=Math.pow,r=i(2,-52),a=i(2,-23),s=i(2,127)*(2-a),l=i(2,-126);t.exports=Math.fround||function(t){var e,n,i=Math.abs(t),c=o(t);return i<l?c*(i/l/a+1/r-1/r)*l*a:(n=(e=(1+a/r)*i)-(e-i))>s||n!=n?c*(1/0):c*n}},function(t,e,n){var o=n(0),i=Math.abs;o(o.S,"Math",{hypot:function(t,e){for(var n,o,r=0,a=0,s=arguments.length,l=0;a<s;)l<(n=i(arguments[a++]))?(r=r*(o=l/n)*o+1,l=n):r+=n>0?(o=n/l)*o:n;return l===1/0?1/0:l*Math.sqrt(r)}})},function(t,e,n){var o=n(0),i=Math.imul;o(o.S+o.F*n(3)(function(){return-5!=i(4294967295,5)||2!=i.length}),"Math",{imul:function(t,e){var n=+t,o=+e,i=65535&n,r=65535&o;return 0|i*r+((65535&n>>>16)*r+i*(65535&o>>>16)<<16>>>0)}})},function(t,e,n){var o=n(0);o(o.S,"Math",{log10:function(t){return Math.log(t)*Math.LOG10E}})},function(t,e,n){var o=n(0);o(o.S,"Math",{log1p:n(127)})},function(t,e,n){var o=n(0);o(o.S,"Math",{log2:function(t){return Math.log(t)/Math.LN2}})},function(t,e,n){var o=n(0);o(o.S,"Math",{sign:n(87)})},function(t,e,n){var o=n(0),i=n(88),r=Math.exp;o(o.S+o.F*n(3)(function(){return-2e-17!=!Math.sinh(-2e-17)}),"Math",{sinh:function(t){return Math.abs(t=+t)<1?(i(t)-i(-t))/2:(r(t-1)-r(-t-1))*(Math.E/2)}})},function(t,e,n){var o=n(0),i=n(88),r=Math.exp;o(o.S,"Math",{tanh:function(t){var e=i(t=+t),n=i(-t);return e==1/0?1:n==1/0?-1:(e-n)/(r(t)+r(-t))}})},function(t,e,n){var o=n(0);o(o.S,"Math",{trunc:function(t){return(t>0?Math.floor:Math.ceil)(t)}})},function(t,e,n){var o=n(0),i=n(40),r=String.fromCharCode,a=String.fromCodePoint;o(o.S+o.F*(!!a&&1!=a.length),"String",{fromCodePoint:function(t){for(var e,n=[],o=arguments.length,a=0;o>a;){if(e=+arguments[a++],i(e,1114111)!==e)throw RangeError(e+" is not a valid code point");n.push(e<65536?r(e):r(55296+((e-=65536)>>10),e%1024+56320))}return n.join("")}})},function(t,e,n){var o=n(0),i=n(16),r=n(7);o(o.S,"String",{raw:function(t){for(var e=i(t.raw),n=r(e.length),o=arguments.length,a=[],s=0;n>s;)a.push(String(e[s++])),s<o&&a.push(String(arguments[s]));return a.join("")}})},function(t,e,n){n(48)("trim",function(t){return function(){return t(this,3)}})},function(t,e,n){var o=n(89)(!0);n(90)(String,"String",function(t){this._t=String(t),this._i=0},function(){var t,e=this._t,n=this._i;return n>=e.length?{value:void 0,done:!0}:(t=o(e,n),this._i+=t.length,{value:t,done:!1})})},function(t,e,n){var o=n(0),i=n(89)(!1);o(o.P,"String",{codePointAt:function(t){return i(this,t)}})},function(t,e,n){var o=n(0),i=n(7),r=n(91),a="".endsWith;o(o.P+o.F*n(93)("endsWith"),"String",{endsWith:function(t){var e=r(this,t,"endsWith"),n=arguments.length>1?arguments[1]:void 0,o=i(e.length),s=void 0===n?o:Math.min(i(n),o),l=String(t);return a?a.call(e,l,s):e.slice(s-l.length,s)===l}})},function(t,e,n){var o=n(0),i=n(91);o(o.P+o.F*n(93)("includes"),"String",{includes:function(t){return!!~i(this,t,"includes").indexOf(t,arguments.length>1?arguments[1]:void 0)}})},function(t,e,n){var o=n(0);o(o.P,"String",{repeat:n(86)})},function(t,e,n){var o=n(0),i=n(7),r=n(91),a="".startsWith;o(o.P+o.F*n(93)("startsWith"),"String",{startsWith:function(t){var e=r(this,t,"startsWith"),n=i(Math.min(arguments.length>1?arguments[1]:void 0,e.length)),o=String(t);return a?a.call(e,o,n):e.slice(n,n+o.length)===o}})},function(t,e,n){n(13)("anchor",function(t){return function(e){return t(this,"a","name",e)}})},function(t,e,n){n(13)("big",function(t){return function(){return t(this,"big","","")}})},function(t,e,n){n(13)("blink",function(t){return function(){return t(this,"blink","","")}})},function(t,e,n){n(13)("bold",function(t){return function(){return t(this,"b","","")}})},function(t,e,n){n(13)("fixed",function(t){return function(){return t(this,"tt","","")}})},function(t,e,n){n(13)("fontcolor",function(t){return function(e){return t(this,"font","color",e)}})},function(t,e,n){n(13)("fontsize",function(t){return function(e){return t(this,"font","size",e)}})},function(t,e,n){n(13)("italics",function(t){return function(){return t(this,"i","","")}})},function(t,e,n){n(13)("link",function(t){return function(e){return t(this,"a","href",e)}})},function(t,e,n){n(13)("small",function(t){return function(){return t(this,"small","","")}})},function(t,e,n){n(13)("strike",function(t){return function(){return t(this,"strike","","")}})},function(t,e,n){n(13)("sub",function(t){return function(){return t(this,"sub","","")}})},function(t,e,n){n(13)("sup",function(t){return function(){return t(this,"sup","","")}})},function(t,e,n){var o=n(0);o(o.S,"Date",{now:function(){return(new Date).getTime()}})},function(t,e,n){var o=n(0),i=n(11),r=n(32);o(o.P+o.F*n(3)(function(){return null!==new Date(NaN).toJSON()||1!==Date.prototype.toJSON.call({toISOString:function(){return 1}})}),"Date",{toJSON:function(t){var e=i(this),n=r(e);return"number"!=typeof n||isFinite(n)?e.toISOString():null}})},function(t,e,n){var o=n(0),i=n(233);o(o.P+o.F*(Date.prototype.toISOString!==i),"Date",{toISOString:i})},function(t,e,n){var o=n(3),i=Date.prototype.getTime,r=Date.prototype.toISOString,a=function(t){return t>9?t:"0"+t};t.exports=o(function(){return"0385-07-25T07:06:39.999Z"!=r.call(new Date(-50000000000001))})||!o(function(){r.call(new Date(NaN))})?function(){if(!isFinite(i.call(this)))throw RangeError("Invalid time value");var t=this,e=t.getUTCFullYear(),n=t.getUTCMilliseconds(),o=e<0?"-":e>9999?"+":"";return o+("00000"+Math.abs(e)).slice(o?-6:-4)+"-"+a(t.getUTCMonth()+1)+"-"+a(t.getUTCDate())+"T"+a(t.getUTCHours())+":"+a(t.getUTCMinutes())+":"+a(t.getUTCSeconds())+"."+(n>99?n:"0"+a(n))+"Z"}:r},function(t,e,n){var o=Date.prototype,i=o.toString,r=o.getTime;new Date(NaN)+""!="Invalid Date"&&n(12)(o,"toString",function(){var t=r.call(this);return t==t?i.call(this):"Invalid Date"})},function(t,e,n){var o=n(6)("toPrimitive"),i=Date.prototype;o in i||n(15)(i,o,n(236))},function(t,e,n){var o=n(4),i=n(32);t.exports=function(t){if("string"!==t&&"number"!==t&&"default"!==t)throw TypeError("Incorrect hint");return i(o(this),"number"!=t)}},function(t,e,n){var o=n(0);o(o.S,"Array",{isArray:n(63)})},function(t,e,n){var o=n(19),i=n(0),r=n(11),a=n(129),s=n(94),l=n(7),c=n(95),u=n(96);i(i.S+i.F*!n(64)(function(t){Array.from(t)}),"Array",{from:function(t){var e,n,i,d,p=r(t),h="function"==typeof this?this:Array,f=arguments.length,g=f>1?arguments[1]:void 0,m=void 0!==g,y=0,v=u(p);if(m&&(g=o(g,f>2?arguments[2]:void 0,2)),null==v||h==Array&&s(v))for(n=new h(e=l(p.length));e>y;y++)c(n,y,m?g(p[y],y):p[y]);else for(d=v.call(p),n=new h;!(i=d.next()).done;y++)c(n,y,m?a(d,g,[i.value,y],!0):i.value);return n.length=y,n}})},function(t,e,n){var o=n(0),i=n(95);o(o.S+o.F*n(3)(function(){function t(){}return!(Array.of.call(t)instanceof t)}),"Array",{of:function(){for(var t=0,e=arguments.length,n=new("function"==typeof this?this:Array)(e);e>t;)i(n,t,arguments[t++]);return n.length=e,n}})},function(t,e,n){var o=n(0),i=n(16),r=[].join;o(o.P+o.F*(n(53)!=Object||!n(17)(r)),"Array",{join:function(t){return r.call(i(this),void 0===t?",":t)}})},function(t,e,n){var o=n(0),i=n(82),r=n(27),a=n(40),s=n(7),l=[].slice;o(o.P+o.F*n(3)(function(){i&&l.call(i)}),"Array",{slice:function(t,e){var n=s(this.length),o=r(this);if(e=void 0===e?n:e,"Array"==o)return l.call(this,t,e);for(var i=a(t,n),c=a(e,n),u=s(c-i),d=new Array(u),p=0;p<u;p++)d[p]="String"==o?this.charAt(i+p):this[i+p];return d}})},function(t,e,n){var o=n(0),i=n(20),r=n(11),a=n(3),s=[].sort,l=[1,2,3];o(o.P+o.F*(a(function(){l.sort(void 0)})||!a(function(){l.sort(null)})||!n(17)(s)),"Array",{sort:function(t){return void 0===t?s.call(r(this)):s.call(r(this),i(t))}})},function(t,e,n){var o=n(0),i=n(24)(0),r=n(17)([].forEach,!0);o(o.P+o.F*!r,"Array",{forEach:function(t){return i(this,t,arguments[1])}})},function(t,e,n){var o=n(5),i=n(63),r=n(6)("species");t.exports=function(t){var e;return i(t)&&("function"!=typeof(e=t.constructor)||e!==Array&&!i(e.prototype)||(e=void 0),o(e)&&null===(e=e[r])&&(e=void 0)),void 0===e?Array:e}},function(t,e,n){var o=n(0),i=n(24)(1);o(o.P+o.F*!n(17)([].map,!0),"Array",{map:function(t){return i(this,t,arguments[1])}})},function(t,e,n){var o=n(0),i=n(24)(2);o(o.P+o.F*!n(17)([].filter,!0),"Array",{filter:function(t){return i(this,t,arguments[1])}})},function(t,e,n){var o=n(0),i=n(24)(3);o(o.P+o.F*!n(17)([].some,!0),"Array",{some:function(t){return i(this,t,arguments[1])}})},function(t,e,n){var o=n(0),i=n(24)(4);o(o.P+o.F*!n(17)([].every,!0),"Array",{every:function(t){return i(this,t,arguments[1])}})},function(t,e,n){var o=n(0),i=n(131);o(o.P+o.F*!n(17)([].reduce,!0),"Array",{reduce:function(t){return i(this,t,arguments.length,arguments[1],!1)}})},function(t,e,n){var o=n(0),i=n(131);o(o.P+o.F*!n(17)([].reduceRight,!0),"Array",{reduceRight:function(t){return i(this,t,arguments.length,arguments[1],!0)}})},function(t,e,n){var o=n(0),i=n(61)(!1),r=[].indexOf,a=!!r&&1/[1].indexOf(1,-0)<0;o(o.P+o.F*(a||!n(17)(r)),"Array",{indexOf:function(t){return a?r.apply(this,arguments)||0:i(this,t,arguments[1])}})},function(t,e,n){var o=n(0),i=n(16),r=n(21),a=n(7),s=[].lastIndexOf,l=!!s&&1/[1].lastIndexOf(1,-0)<0;o(o.P+o.F*(l||!n(17)(s)),"Array",{lastIndexOf:function(t){if(l)return s.apply(this,arguments)||0;var e=i(this),n=a(e.length),o=n-1;for(arguments.length>1&&(o=Math.min(o,r(arguments[1]))),o<0&&(o=n+o);o>=0;o--)if(o in e&&e[o]===t)return o||0;return-1}})},function(t,e,n){var o=n(0);o(o.P,"Array",{copyWithin:n(132)}),n(44)("copyWithin")},function(t,e,n){var o=n(0);o(o.P,"Array",{fill:n(97)}),n(44)("fill")},function(t,e,n){var o=n(0),i=n(24)(5),r=!0;"find"in[]&&Array(1).find(function(){r=!1}),o(o.P+o.F*r,"Array",{find:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),n(44)("find")},function(t,e,n){var o=n(0),i=n(24)(6),r="findIndex",a=!0;r in[]&&Array(1)[r](function(){a=!1}),o(o.P+o.F*a,"Array",{findIndex:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),n(44)(r)},function(t,e,n){n(50)("Array")},function(t,e,n){var o=n(2),i=n(85),r=n(10).f,a=n(42).f,s=n(92),l=n(65),c=o.RegExp,u=c,d=c.prototype,p=/a/g,h=/a/g,f=new c(p)!==p;if(n(9)&&(!f||n(3)(function(){return h[n(6)("match")]=!1,c(p)!=p||c(h)==h||"/a/i"!=c(p,"i")}))){c=function(t,e){var n=this instanceof c,o=s(t),r=void 0===e;return!n&&o&&t.constructor===c&&r?t:i(f?new u(o&&!r?t.source:t,e):u((o=t instanceof c)?t.source:t,o&&r?l.call(t):e),n?this:d,c)};for(var g=function(t){t in c||r(c,t,{configurable:!0,get:function(){return u[t]},set:function(e){u[t]=e}})},m=a(u),y=0;m.length>y;)g(m[y++]);d.constructor=c,c.prototype=d,n(12)(o,"RegExp",c)}n(50)("RegExp")},function(t,e,n){n(135);var o=n(4),i=n(65),r=n(9),a=/./.toString,s=function(t){n(12)(RegExp.prototype,"toString",t,!0)};n(3)(function(){return"/a/b"!=a.call({source:"a",flags:"b"})})?s(function(){var t=o(this);return"/".concat(t.source,"/","flags"in t?t.flags:!r&&t instanceof RegExp?i.call(t):void 0)}):"toString"!=a.name&&s(function(){return a.call(this)})},function(t,e,n){var o=n(4),i=n(7),r=n(100),a=n(66);n(67)("match",1,function(t,e,n,s){return[function(n){var o=t(this),i=null==n?void 0:n[e];return void 0!==i?i.call(n,o):new RegExp(n)[e](String(o))},function(t){var e=s(n,t,this);if(e.done)return e.value;var l=o(t),c=String(this);if(!l.global)return a(l,c);var u=l.unicode;l.lastIndex=0;for(var d,p=[],h=0;null!==(d=a(l,c));){var f=String(d[0]);p[h]=f,""===f&&(l.lastIndex=r(c,i(l.lastIndex),u)),h++}return 0===h?null:p}]})},function(t,e,n){var o=n(4),i=n(11),r=n(7),a=n(21),s=n(100),l=n(66),c=Math.max,u=Math.min,d=Math.floor,p=/\$([$&`']|\d\d?|<[^>]*>)/g,h=/\$([$&`']|\d\d?)/g;n(67)("replace",2,function(t,e,n,f){return[function(o,i){var r=t(this),a=null==o?void 0:o[e];return void 0!==a?a.call(o,r,i):n.call(String(r),o,i)},function(t,e){var i=f(n,t,this,e);if(i.done)return i.value;var d=o(t),p=String(this),h="function"==typeof e;h||(e=String(e));var m=d.global;if(m){var y=d.unicode;d.lastIndex=0}for(var v=[];;){var _=l(d,p);if(null===_)break;if(v.push(_),!m)break;""===String(_[0])&&(d.lastIndex=s(p,r(d.lastIndex),y))}for(var b,C="",k=0,w=0;w<v.length;w++){_=v[w];for(var S=String(_[0]),x=c(u(a(_.index),p.length),0),E=[],I=1;I<_.length;I++)E.push(void 0===(b=_[I])?b:String(b));var T=_.groups;if(h){var O=[S].concat(E,x,p);void 0!==T&&O.push(T);var A=String(e.apply(void 0,O))}else A=g(S,p,x,E,T,e);x>=k&&(C+=p.slice(k,x)+A,k=x+S.length)}return C+p.slice(k)}];function g(t,e,o,r,a,s){var l=o+t.length,c=r.length,u=h;return void 0!==a&&(a=i(a),u=p),n.call(s,u,function(n,i){var s;switch(i.charAt(0)){case"$":return"$";case"&":return t;case"`":return e.slice(0,o);case"'":return e.slice(l);case"<":s=a[i.slice(1,-1)];break;default:var u=+i;if(0===u)return n;if(u>c){var p=d(u/10);return 0===p?n:p<=c?void 0===r[p-1]?i.charAt(1):r[p-1]+i.charAt(1):n}s=r[u-1]}return void 0===s?"":s})}})},function(t,e,n){var o=n(4),i=n(120),r=n(66);n(67)("search",1,function(t,e,n,a){return[function(n){var o=t(this),i=null==n?void 0:n[e];return void 0!==i?i.call(n,o):new RegExp(n)[e](String(o))},function(t){var e=a(n,t,this);if(e.done)return e.value;var s=o(t),l=String(this),c=s.lastIndex;i(c,0)||(s.lastIndex=0);var u=r(s,l);return i(s.lastIndex,c)||(s.lastIndex=c),null===u?-1:u.index}]})},function(t,e,n){var o=n(92),i=n(4),r=n(56),a=n(100),s=n(7),l=n(66),c=n(99),u=n(3),d=Math.min,p=[].push,h="length",f=!u(function(){RegExp(4294967295,"y")});n(67)("split",2,function(t,e,n,u){var g;return g="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1)[h]||2!="ab".split(/(?:ab)*/)[h]||4!=".".split(/(.?)(.?)/)[h]||".".split(/()()/)[h]>1||"".split(/.?/)[h]?function(t,e){var i=String(this);if(void 0===t&&0===e)return[];if(!o(t))return n.call(i,t,e);for(var r,a,s,l=[],u=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),d=0,f=void 0===e?4294967295:e>>>0,g=new RegExp(t.source,u+"g");(r=c.call(g,i))&&!((a=g.lastIndex)>d&&(l.push(i.slice(d,r.index)),r[h]>1&&r.index<i[h]&&p.apply(l,r.slice(1)),s=r[0][h],d=a,l[h]>=f));)g.lastIndex===r.index&&g.lastIndex++;return d===i[h]?!s&&g.test("")||l.push(""):l.push(i.slice(d)),l[h]>f?l.slice(0,f):l}:"0".split(void 0,0)[h]?function(t,e){return void 0===t&&0===e?[]:n.call(this,t,e)}:n,[function(n,o){var i=t(this),r=null==n?void 0:n[e];return void 0!==r?r.call(n,i,o):g.call(String(i),n,o)},function(t,e){var o=u(g,t,this,e,g!==n);if(o.done)return o.value;var c=i(t),p=String(this),h=r(c,RegExp),m=c.unicode,y=(c.ignoreCase?"i":"")+(c.multiline?"m":"")+(c.unicode?"u":"")+(f?"y":"g"),v=new h(f?c:"^(?:"+c.source+")",y),_=void 0===e?4294967295:e>>>0;if(0===_)return[];if(0===p.length)return null===l(v,p)?[p]:[];for(var b=0,C=0,k=[];C<p.length;){v.lastIndex=f?C:0;var w,S=l(v,f?p:p.slice(C));if(null===S||(w=d(s(v.lastIndex+(f?0:C)),p.length))===b)C=a(p,C,m);else{if(k.push(p.slice(b,C)),k.length===_)return k;for(var x=1;x<=S.length-1;x++)if(k.push(S[x]),k.length===_)return k;C=b=w}}return k.push(p.slice(b)),k}]})},function(t,e,n){var o=n(2),i=n(101).set,r=o.MutationObserver||o.WebKitMutationObserver,a=o.process,s=o.Promise,l="process"==n(27)(a);t.exports=function(){var t,e,n,c=function(){var o,i;for(l&&(o=a.domain)&&o.exit();t;){i=t.fn,t=t.next;try{i()}catch(o){throw t?n():e=void 0,o}}e=void 0,o&&o.enter()};if(l)n=function(){a.nextTick(c)};else if(!r||o.navigator&&o.navigator.standalone)if(s&&s.resolve){var u=s.resolve(void 0);n=function(){u.then(c)}}else n=function(){i.call(o,c)};else{var d=!0,p=document.createTextNode("");new r(c).observe(p,{characterData:!0}),n=function(){p.data=d=!d}}return function(o){var i={fn:o,next:void 0};e&&(e.next=i),t||(t=i,n()),e=i}}},function(t,e){t.exports=function(t){try{return{e:!1,v:t()}}catch(t){return{e:!0,v:t}}}},function(t,e,n){var o=n(139),i=n(45);t.exports=n(70)("Map",function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{get:function(t){var e=o.getEntry(i(this,"Map"),t);return e&&e.v},set:function(t,e){return o.def(i(this,"Map"),0===t?0:t,e)}},o,!0)},function(t,e,n){var o=n(139),i=n(45);t.exports=n(70)("Set",function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{add:function(t){return o.def(i(this,"Set"),t=0===t?0:t,t)}},o)},function(t,e,n){var o,i=n(2),r=n(24)(0),a=n(12),s=n(33),l=n(119),c=n(140),u=n(5),d=n(45),p=n(45),h=!i.ActiveXObject&&"ActiveXObject"in i,f=s.getWeak,g=Object.isExtensible,m=c.ufstore,y=function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},v={get:function(t){if(u(t)){var e=f(t);return!0===e?m(d(this,"WeakMap")).get(t):e?e[this._i]:void 0}},set:function(t,e){return c.def(d(this,"WeakMap"),t,e)}},_=t.exports=n(70)("WeakMap",y,v,c,!0,!0);p&&h&&(l((o=c.getConstructor(y,"WeakMap")).prototype,v),s.NEED=!0,r(["delete","has","get","set"],function(t){var e=_.prototype,n=e[t];a(e,t,function(e,i){if(u(e)&&!g(e)){this._f||(this._f=new o);var r=this._f[t](e,i);return"set"==t?this:r}return n.call(this,e,i)})}))},function(t,e,n){var o=n(140),i=n(45);n(70)("WeakSet",function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{add:function(t){return o.def(i(this,"WeakSet"),t,!0)}},o,!1,!0)},function(t,e,n){var o=n(0),i=n(71),r=n(102),a=n(4),s=n(40),l=n(7),c=n(5),u=n(2).ArrayBuffer,d=n(56),p=r.ArrayBuffer,h=r.DataView,f=i.ABV&&u.isView,g=p.prototype.slice,m=i.VIEW;o(o.G+o.W+o.F*(u!==p),{ArrayBuffer:p}),o(o.S+o.F*!i.CONSTR,"ArrayBuffer",{isView:function(t){return f&&f(t)||c(t)&&m in t}}),o(o.P+o.U+o.F*n(3)(function(){return!new p(2).slice(1,void 0).byteLength}),"ArrayBuffer",{slice:function(t,e){if(void 0!==g&&void 0===e)return g.call(a(this),t);for(var n=a(this).byteLength,o=s(t,n),i=s(void 0===e?n:e,n),r=new(d(this,p))(l(i-o)),c=new h(this),u=new h(r),f=0;o<i;)u.setUint8(f++,c.getUint8(o++));return r}}),n(50)("ArrayBuffer")},function(t,e,n){var o=n(0);o(o.G+o.W+o.F*!n(71).ABV,{DataView:n(102).DataView})},function(t,e,n){n(29)("Int8",1,function(t){return function(e,n,o){return t(this,e,n,o)}})},function(t,e,n){n(29)("Uint8",1,function(t){return function(e,n,o){return t(this,e,n,o)}})},function(t,e,n){n(29)("Uint8",1,function(t){return function(e,n,o){return t(this,e,n,o)}},!0)},function(t,e,n){n(29)("Int16",2,function(t){return function(e,n,o){return t(this,e,n,o)}})},function(t,e,n){n(29)("Uint16",2,function(t){return function(e,n,o){return t(this,e,n,o)}})},function(t,e,n){n(29)("Int32",4,function(t){return function(e,n,o){return t(this,e,n,o)}})},function(t,e,n){n(29)("Uint32",4,function(t){return function(e,n,o){return t(this,e,n,o)}})},function(t,e,n){n(29)("Float32",4,function(t){return function(e,n,o){return t(this,e,n,o)}})},function(t,e,n){n(29)("Float64",8,function(t){return function(e,n,o){return t(this,e,n,o)}})},function(t,e,n){var o=n(0),i=n(20),r=n(4),a=(n(2).Reflect||{}).apply,s=Function.apply;o(o.S+o.F*!n(3)(function(){a(function(){})}),"Reflect",{apply:function(t,e,n){var o=i(t),l=r(n);return a?a(o,e,l):s.call(o,e,l)}})},function(t,e,n){var o=n(0),i=n(41),r=n(20),a=n(4),s=n(5),l=n(3),c=n(121),u=(n(2).Reflect||{}).construct,d=l(function(){function t(){}return!(u(function(){},[],t)instanceof t)}),p=!l(function(){u(function(){})});o(o.S+o.F*(d||p),"Reflect",{construct:function(t,e){r(t),a(e);var n=arguments.length<3?t:r(arguments[2]);if(p&&!d)return u(t,e,n);if(t==n){switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3])}var o=[null];return o.push.apply(o,e),new(c.apply(t,o))}var l=n.prototype,h=i(s(l)?l:Object.prototype),f=Function.apply.call(t,h,e);return s(f)?f:h}})},function(t,e,n){var o=n(10),i=n(0),r=n(4),a=n(32);i(i.S+i.F*n(3)(function(){Reflect.defineProperty(o.f({},1,{value:1}),1,{value:2})}),"Reflect",{defineProperty:function(t,e,n){r(t),e=a(e,!0),r(n);try{return o.f(t,e,n),!0}catch(t){return!1}}})},function(t,e,n){var o=n(0),i=n(22).f,r=n(4);o(o.S,"Reflect",{deleteProperty:function(t,e){var n=i(r(t),e);return!(n&&!n.configurable)&&delete t[e]}})},function(t,e,n){var o=n(0),i=n(4),r=function(t){this._t=i(t),this._i=0;var e,n=this._k=[];for(e in t)n.push(e)};n(128)(r,"Object",function(){var t,e=this._k;do{if(this._i>=e.length)return{value:void 0,done:!0}}while(!((t=e[this._i++])in this._t));return{value:t,done:!1}}),o(o.S,"Reflect",{enumerate:function(t){return new r(t)}})},function(t,e,n){var o=n(22),i=n(43),r=n(14),a=n(0),s=n(5),l=n(4);a(a.S,"Reflect",{get:function t(e,n){var a,c,u=arguments.length<3?e:arguments[2];return l(e)===u?e[n]:(a=o.f(e,n))?r(a,"value")?a.value:void 0!==a.get?a.get.call(u):void 0:s(c=i(e))?t(c,n,u):void 0}})},function(t,e,n){var o=n(22),i=n(0),r=n(4);i(i.S,"Reflect",{getOwnPropertyDescriptor:function(t,e){return o.f(r(t),e)}})},function(t,e,n){var o=n(0),i=n(43),r=n(4);o(o.S,"Reflect",{getPrototypeOf:function(t){return i(r(t))}})},function(t,e,n){var o=n(0);o(o.S,"Reflect",{has:function(t,e){return e in t}})},function(t,e,n){var o=n(0),i=n(4),r=Object.isExtensible;o(o.S,"Reflect",{isExtensible:function(t){return i(t),!r||r(t)}})},function(t,e,n){var o=n(0);o(o.S,"Reflect",{ownKeys:n(142)})},function(t,e,n){var o=n(0),i=n(4),r=Object.preventExtensions;o(o.S,"Reflect",{preventExtensions:function(t){i(t);try{return r&&r(t),!0}catch(t){return!1}}})},function(t,e,n){var o=n(10),i=n(22),r=n(43),a=n(14),s=n(0),l=n(36),c=n(4),u=n(5);s(s.S,"Reflect",{set:function t(e,n,s){var d,p,h=arguments.length<4?e:arguments[3],f=i.f(c(e),n);if(!f){if(u(p=r(e)))return t(p,n,s,h);f=l(0)}if(a(f,"value")){if(!1===f.writable||!u(h))return!1;if(d=i.f(h,n)){if(d.get||d.set||!1===d.writable)return!1;d.value=s,o.f(h,n,d)}else o.f(h,n,l(0,s));return!0}return void 0!==f.set&&(f.set.call(h,s),!0)}})},function(t,e,n){var o=n(0),i=n(83);i&&o(o.S,"Reflect",{setPrototypeOf:function(t,e){i.check(t,e);try{return i.set(t,e),!0}catch(t){return!1}}})},function(t,e,n){n(296),t.exports=n(8).Array.includes},function(t,e,n){var o=n(0),i=n(61)(!0);o(o.P,"Array",{includes:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),n(44)("includes")},function(t,e,n){n(298),t.exports=n(8).Array.flatMap},function(t,e,n){var o=n(0),i=n(299),r=n(11),a=n(7),s=n(20),l=n(130);o(o.P,"Array",{flatMap:function(t){var e,n,o=r(this);return s(t),e=a(o.length),n=l(o,0),i(n,o,o,e,0,1,t,arguments[1]),n}}),n(44)("flatMap")},function(t,e,n){var o=n(63),i=n(5),r=n(7),a=n(19),s=n(6)("isConcatSpreadable");t.exports=function t(e,n,l,c,u,d,p,h){for(var f,g,m=u,y=0,v=!!p&&a(p,h,3);y<c;){if(y in l){if(f=v?v(l[y],y,n):l[y],g=!1,i(f)&&(g=void 0!==(g=f[s])?!!g:o(f)),g&&d>0)m=t(e,n,f,r(f.length),m,d-1)-1;else{if(m>=9007199254740991)throw TypeError();e[m]=f}m++}y++}return m}},function(t,e,n){n(301),t.exports=n(8).String.padStart},function(t,e,n){var o=n(0),i=n(143),r=n(69),a=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(r);o(o.P+o.F*a,"String",{padStart:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0,!0)}})},function(t,e,n){n(303),t.exports=n(8).String.padEnd},function(t,e,n){var o=n(0),i=n(143),r=n(69),a=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(r);o(o.P+o.F*a,"String",{padEnd:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0,!1)}})},function(t,e,n){n(305),t.exports=n(8).String.trimLeft},function(t,e,n){n(48)("trimLeft",function(t){return function(){return t(this,1)}},"trimStart")},function(t,e,n){n(307),t.exports=n(8).String.trimRight},function(t,e,n){n(48)("trimRight",function(t){return function(){return t(this,2)}},"trimEnd")},function(t,e,n){n(309),t.exports=n(79).f("asyncIterator")},function(t,e,n){n(115)("asyncIterator")},function(t,e,n){n(311),t.exports=n(8).Object.getOwnPropertyDescriptors},function(t,e,n){var o=n(0),i=n(142),r=n(16),a=n(22),s=n(95);o(o.S,"Object",{getOwnPropertyDescriptors:function(t){for(var e,n,o=r(t),l=a.f,c=i(o),u={},d=0;c.length>d;)void 0!==(n=l(o,e=c[d++]))&&s(u,e,n);return u}})},function(t,e,n){n(313),t.exports=n(8).Object.values},function(t,e,n){var o=n(0),i=n(144)(!1);o(o.S,"Object",{values:function(t){return i(t)}})},function(t,e,n){n(315),t.exports=n(8).Object.entries},function(t,e,n){var o=n(0),i=n(144)(!0);o(o.S,"Object",{entries:function(t){return i(t)}})},function(t,e,n){n(136),n(317),t.exports=n(8).Promise.finally},function(t,e,n){var o=n(0),i=n(8),r=n(2),a=n(56),s=n(138);o(o.P+o.R,"Promise",{finally:function(t){var e=a(this,i.Promise||r.Promise),n="function"==typeof t;return this.then(n?function(n){return s(e,t()).then(function(){return n})}:t,n?function(n){return s(e,t()).then(function(){throw n})}:t)}})},function(t,e,n){n(319),n(320),n(321),t.exports=n(8)},function(t,e,n){var o=n(2),i=n(0),r=n(69),a=[].slice,s=/MSIE .\./.test(r),l=function(t){return function(e,n){var o=arguments.length>2,i=!!o&&a.call(arguments,2);return t(o?function(){("function"==typeof e?e:Function(e)).apply(this,i)}:e,n)}};i(i.G+i.B+i.F*s,{setTimeout:l(o.setTimeout),setInterval:l(o.setInterval)})},function(t,e,n){var o=n(0),i=n(101);o(o.G+o.B,{setImmediate:i.set,clearImmediate:i.clear})},function(t,e,n){for(var o=n(98),i=n(39),r=n(12),a=n(2),s=n(15),l=n(49),c=n(6),u=c("iterator"),d=c("toStringTag"),p=l.Array,h={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},f=i(h),g=0;g<f.length;g++){var m,y=f[g],v=h[y],_=a[y],b=_&&_.prototype;if(b&&(b[u]||s(b,u,p),b[d]||s(b,d,y),l[y]=p,v))for(m in o)b[m]||r(b,m,o[m],!0)}},function(t,e,n){var o=function(t){var e=Object.prototype,n=e.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",r=o.asyncIterator||"@@asyncIterator",a=o.toStringTag||"@@toStringTag";function s(t,e,n,o){var i=e&&e.prototype instanceof u?e:u,r=Object.create(i.prototype),a=new k(o||[]);return r._invoke=function(t,e,n){var o="suspendedStart";return function(i,r){if("executing"===o)throw new Error("Generator is already running");if("completed"===o){if("throw"===i)throw r;return{value:void 0,done:!0}}for(n.method=i,n.arg=r;;){var a=n.delegate;if(a){var s=_(a,n);if(s){if(s===c)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===o)throw o="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o="executing";var u=l(t,e,n);if("normal"===u.type){if(o=n.done?"completed":"suspendedYield",u.arg===c)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o="completed",n.method="throw",n.arg=u.arg)}}}(t,n,a),r}function l(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}t.wrap=s;var c={};function u(){}function d(){}function p(){}var h={};h[i]=function(){return this};var f=Object.getPrototypeOf,g=f&&f(f(w([])));g&&g!==e&&n.call(g,i)&&(h=g);var m=p.prototype=u.prototype=Object.create(h);function y(t){["next","throw","return"].forEach(function(e){t[e]=function(t){return this._invoke(e,t)}})}function v(t,e){var o;this._invoke=function(i,r){function a(){return new e(function(o,a){!function o(i,r,a,s){var c=l(t[i],t,r);if("throw"!==c.type){var u=c.arg,d=u.value;return d&&"object"==typeof d&&n.call(d,"__await")?e.resolve(d.__await).then(function(t){o("next",t,a,s)},function(t){o("throw",t,a,s)}):e.resolve(d).then(function(t){u.value=t,a(u)},function(t){return o("throw",t,a,s)})}s(c.arg)}(i,r,o,a)})}return o=o?o.then(a,a):a()}}function _(t,e){var n=t.iterator[e.method];if(void 0===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,_(t,e),"throw"===e.method))return c;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return c}var o=l(n,t.iterator,e.arg);if("throw"===o.type)return e.method="throw",e.arg=o.arg,e.delegate=null,c;var i=o.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,c):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,c)}function b(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function C(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function k(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(b,this),this.reset(!0)}function w(t){if(t){var e=t[i];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,r=function e(){for(;++o<t.length;)if(n.call(t,o))return e.value=t[o],e.done=!1,e;return e.value=void 0,e.done=!0,e};return r.next=r}}return{next:S}}function S(){return{value:void 0,done:!0}}return d.prototype=m.constructor=p,p.constructor=d,p[a]=d.displayName="GeneratorFunction",t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===d||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,a in t||(t[a]="GeneratorFunction")),t.prototype=Object.create(m),t},t.awrap=function(t){return{__await:t}},y(v.prototype),v.prototype[r]=function(){return this},t.AsyncIterator=v,t.async=function(e,n,o,i,r){void 0===r&&(r=Promise);var a=new v(s(e,n,o,i),r);return t.isGeneratorFunction(n)?a:a.next().then(function(t){return t.done?t.value:a.next()})},y(m),m[a]="Generator",m[i]=function(){return this},m.toString=function(){return"[object Generator]"},t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var o=e.pop();if(o in t)return n.value=o,n.done=!1,n}return n.done=!0,n}},t.values=w,k.prototype={constructor:k,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(C),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function o(n,o){return a.type="throw",a.arg=t,e.next=n,o&&(e.method="next",e.arg=void 0),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var r=this.tryEntries[i],a=r.completion;if("root"===r.tryLoc)return o("end");if(r.tryLoc<=this.prev){var s=n.call(r,"catchLoc"),l=n.call(r,"finallyLoc");if(s&&l){if(this.prev<r.catchLoc)return o(r.catchLoc,!0);if(this.prev<r.finallyLoc)return o(r.finallyLoc)}else if(s){if(this.prev<r.catchLoc)return o(r.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return o(r.finallyLoc)}}}},abrupt:function(t,e){for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var r=i;break}}r&&("break"===t||"continue"===t)&&r.tryLoc<=e&&e<=r.finallyLoc&&(r=null);var a=r?r.completion:{};return a.type=t,a.arg=e,r?(this.method="next",this.next=r.finallyLoc,c):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),c},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),C(n),c}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var o=n.completion;if("throw"===o.type){var i=o.arg;C(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:w(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),c}},t}(t.exports);try{regeneratorRuntime=o}catch(t){Function("r","regeneratorRuntime = r")(o)}},function(t,e,n){n(324),t.exports=n(145).global},function(t,e,n){var o=n(325);o(o.G,{global:n(103)})},function(t,e,n){var o=n(103),i=n(145),r=n(326),a=n(328),s=n(335),l=function(t,e,n){var c,u,d,p=t&l.F,h=t&l.G,f=t&l.S,g=t&l.P,m=t&l.B,y=t&l.W,v=h?i:i[e]||(i[e]={}),_=v.prototype,b=h?o:f?o[e]:(o[e]||{}).prototype;for(c in h&&(n=e),n)(u=!p&&b&&void 0!==b[c])&&s(v,c)||(d=u?b[c]:n[c],v[c]=h&&"function"!=typeof b[c]?n[c]:m&&u?r(d,o):y&&b[c]==d?function(t){var e=function(e,n,o){if(this instanceof t){switch(arguments.length){case 0:return new t;case 1:return new t(e);case 2:return new t(e,n)}return new t(e,n,o)}return t.apply(this,arguments)};return e.prototype=t.prototype,e}(d):g&&"function"==typeof d?r(Function.call,d):d,g&&((v.virtual||(v.virtual={}))[c]=d,t&l.R&&_&&!_[c]&&a(_,c,d)))};l.F=1,l.G=2,l.S=4,l.P=8,l.B=16,l.W=32,l.U=64,l.R=128,t.exports=l},function(t,e,n){var o=n(327);t.exports=function(t,e,n){if(o(t),void 0===e)return t;switch(n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,o){return t.call(e,n,o)};case 3:return function(n,o,i){return t.call(e,n,o,i)}}return function(){return t.apply(e,arguments)}}},function(t,e){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},function(t,e,n){var o=n(329),i=n(334);t.exports=n(105)?function(t,e,n){return o.f(t,e,i(1,n))}:function(t,e,n){return t[e]=n,t}},function(t,e,n){var o=n(330),i=n(331),r=n(333),a=Object.defineProperty;e.f=n(105)?Object.defineProperty:function(t,e,n){if(o(t),e=r(e,!0),o(n),i)try{return a(t,e,n)}catch(t){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(t[e]=n.value),t}},function(t,e,n){var o=n(104);t.exports=function(t){if(!o(t))throw TypeError(t+" is not an object!");return t}},function(t,e,n){t.exports=!n(105)&&!n(146)(function(){return 7!=Object.defineProperty(n(332)("div"),"a",{get:function(){return 7}}).a})},function(t,e,n){var o=n(104),i=n(103).document,r=o(i)&&o(i.createElement);t.exports=function(t){return r?i.createElement(t):{}}},function(t,e,n){var o=n(104);t.exports=function(t,e){if(!o(t))return t;var n,i;if(e&&"function"==typeof(n=t.toString)&&!o(i=n.call(t)))return i;if("function"==typeof(n=t.valueOf)&&!o(i=n.call(t)))return i;if(!e&&"function"==typeof(n=t.toString)&&!o(i=n.call(t)))return i;throw TypeError("Can't convert object to primitive value")}},function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},function(t,e){var n={}.hasOwnProperty;t.exports=function(t,e){return n.call(t,e)}},,,,,,,,,,,,,,function(t,e){t.exports=function(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}},function(t,e,n){t.exports=function(t){var e=[];return e.toString=function(){return this.map(function(e){var n=function(t,e){var n,o=t[1]||"",i=t[3];if(!i)return o;if(e&&"function"==typeof btoa){var r=(n=i,"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(n))))+" */"),a=i.sources.map(function(t){return"/*# sourceURL="+i.sourceRoot+t+" */"});return[o].concat(a).concat([r]).join("\n")}return[o].join("\n")}(e,t);return e[2]?"@media "+e[2]+"{"+n+"}":n}).join("")},e.i=function(t,n){"string"==typeof t&&(t=[[null,t,""]]);for(var o={},i=0;i<this.length;i++){var r=this[i][0];null!=r&&(o[r]=!0)}for(i=0;i<t.length;i++){var a=t[i];null!=a[0]&&o[a[0]]||(n&&!a[2]?a[2]=n:n&&(a[2]="("+a[2]+") and ("+n+")"),e.push(a))}},e}},function(t,e,n){var o,i,r={},a=(o=function(){return window&&document&&document.all&&!window.atob},function(){return void 0===i&&(i=o.apply(this,arguments)),i}),s=function(t){var e={};return function(t,n){if("function"==typeof t)return t();if(void 0===e[t]){var o=function(t,e){return e?e.querySelector(t):document.querySelector(t)}.call(this,t,n);if(window.HTMLIFrameElement&&o instanceof window.HTMLIFrameElement)try{o=o.contentDocument.head}catch(t){o=null}e[t]=o}return e[t]}}(),l=null,c=0,u=[],d=n(362);function p(t,e){for(var n=0;n<t.length;n++){var o=t[n],i=r[o.id];if(i){i.refs++;for(var a=0;a<i.parts.length;a++)i.parts[a](o.parts[a]);for(;a<o.parts.length;a++)i.parts.push(v(o.parts[a],e))}else{var s=[];for(a=0;a<o.parts.length;a++)s.push(v(o.parts[a],e));r[o.id]={id:o.id,refs:1,parts:s}}}}function h(t,e){for(var n=[],o={},i=0;i<t.length;i++){var r=t[i],a=e.base?r[0]+e.base:r[0],s={css:r[1],media:r[2],sourceMap:r[3]};o[a]?o[a].parts.push(s):n.push(o[a]={id:a,parts:[s]})}return n}function f(t,e){var n=s(t.insertInto);if(!n)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var o=u[u.length-1];if("top"===t.insertAt)o?o.nextSibling?n.insertBefore(e,o.nextSibling):n.appendChild(e):n.insertBefore(e,n.firstChild),u.push(e);else if("bottom"===t.insertAt)n.appendChild(e);else{if("object"!=typeof t.insertAt||!t.insertAt.before)throw new Error("[Style Loader]\n\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\n Must be 'top', 'bottom', or Object.\n (https://github.com/webpack-contrib/style-loader#insertat)\n");var i=s(t.insertAt.before,n);n.insertBefore(e,i)}}function g(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t);var e=u.indexOf(t);e>=0&&u.splice(e,1)}function m(t){var e=document.createElement("style");if(void 0===t.attrs.type&&(t.attrs.type="text/css"),void 0===t.attrs.nonce){var o=n.nc;o&&(t.attrs.nonce=o)}return y(e,t.attrs),f(t,e),e}function y(t,e){Object.keys(e).forEach(function(n){t.setAttribute(n,e[n])})}function v(t,e){var n,o,i,r;if(e.transform&&t.css){if(!(r="function"==typeof e.transform?e.transform(t.css):e.transform.default(t.css)))return function(){};t.css=r}if(e.singleton){var a=c++;n=l||(l=m(e)),o=C.bind(null,n,a,!1),i=C.bind(null,n,a,!0)}else t.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(n=function(t){var e=document.createElement("link");return void 0===t.attrs.type&&(t.attrs.type="text/css"),t.attrs.rel="stylesheet",y(e,t.attrs),f(t,e),e}(e),o=function(t,e,n){var o=n.css,i=n.sourceMap,r=void 0===e.convertToAbsoluteUrls&&i;(e.convertToAbsoluteUrls||r)&&(o=d(o)),i&&(o+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(i))))+" */");var a=new Blob([o],{type:"text/css"}),s=t.href;t.href=URL.createObjectURL(a),s&&URL.revokeObjectURL(s)}.bind(null,n,e),i=function(){g(n),n.href&&URL.revokeObjectURL(n.href)}):(n=m(e),o=function(t,e){var n=e.css,o=e.media;if(o&&t.setAttribute("media",o),t.styleSheet)t.styleSheet.cssText=n;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(n))}}.bind(null,n),i=function(){g(n)});return o(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;o(t=e)}else i()}}t.exports=function(t,e){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");(e=e||{}).attrs="object"==typeof e.attrs?e.attrs:{},e.singleton||"boolean"==typeof e.singleton||(e.singleton=a()),e.insertInto||(e.insertInto="head"),e.insertAt||(e.insertAt="bottom");var n=h(t,e);return p(n,e),function(t){for(var o=[],i=0;i<n.length;i++){var a=n[i];(s=r[a.id]).refs--,o.push(s)}for(t&&p(h(t,e),e),i=0;i<o.length;i++){var s;if(0===(s=o[i]).refs){for(var l=0;l<s.parts.length;l++)s.parts[l]();delete r[s.id]}}}};var _,b=(_=[],function(t,e){return _[t]=e,_.filter(Boolean).join("\n")});function C(t,e,n,o){var i=n?"":o.css;if(t.styleSheet)t.styleSheet.cssText=b(e,i);else{var r=document.createTextNode(i),a=t.childNodes;a[e]&&t.removeChild(a[e]),a.length?t.insertBefore(r,a[e]):t.appendChild(r)}}},function(t,e,n){var o=function(t,e,n){for(var o=-1,i=Object(t),r=n(t),a=r.length;a--;){var s=r[++o];if(!1===e(i[s],s,i))break}return t},i=n(59),r=function(t,e,n,r){return function(t,e){t&&o(t,e,i.a)}(t,function(t,o,i){e(r,n(t),o,i)}),r},a=n(109),s=Object.prototype.toString,l=function(t,e){return function(n,o){return r(n,t,e(o),{})}}(function(t,e,n){null!=e&&"function"!=typeof e.toString&&(e=s.call(e)),t[e]=n},function(t){return function(){return t}}(a.a));e.a=l},function(t,e,n){(function(t){var o=n(25),i=r&&!r.nodeType&&r,a=i&&"object"==typeof t&&t&&!t.nodeType&&t,s=a&&a.exports===i?o.a.Buffer:void 0,l=s?s.allocUnsafe:void 0;e.a=function(t,e){if(e)return t.slice();var n=t.length,o=l?l(n):new t.constructor(n);return t.copy(o),o}}).call(this,n(113)(t))},function(t,e){t.exports=function(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}},function(t,e){t.exports=n(851)},function(t,e,n){n(150),t.exports=n(367)},function(t,e){
/*! *****************************************************************************
                Copyright (C) Microsoft. All rights reserved.
                Licensed under the Apache License, Version 2.0 (the "License"); you may not use
                this file except in compliance with the License. You may obtain a copy of the
                License at http://www.apache.org/licenses/LICENSE-2.0
                
                THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
                KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
                WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
                MERCHANTABLITY OR NON-INFRINGEMENT.
                
                See the Apache Version 2.0 License for specific language governing permissions
                and limitations under the License.
                ***************************************************************************** */
var n;!function(t){!function(e){var n="object"==typeof o?o:"object"==typeof self?self:"object"==typeof this?this:Function("return this;")(),r=a(t);function a(t,e){return function(n,o){"function"!=typeof t[n]&&Object.defineProperty(t,n,{configurable:!0,writable:!0,value:o}),e&&e(n,o)}}void 0===n.Reflect?n.Reflect=t:r=a(n.Reflect,r),function(t){var e=Object.prototype.hasOwnProperty,n="function"==typeof Symbol,o=n&&void 0!==Symbol.toPrimitive?Symbol.toPrimitive:"@@toPrimitive",r=n&&void 0!==Symbol.iterator?Symbol.iterator:"@@iterator",a="function"==typeof Object.create,s={__proto__:[]}instanceof Array,l=!a&&!s,c={create:a?function(){return D(Object.create(null))}:s?function(){return D({__proto__:null})}:function(){return D({})},has:l?function(t,n){return e.call(t,n)}:function(t,e){return e in t},get:l?function(t,n){return e.call(t,n)?t[n]:void 0}:function(t,e){return t[e]}},u=Object.getPrototypeOf(Function),d="object"==typeof i&&i.env&&"true"===i.env.REFLECT_METADATA_USE_MAP_POLYFILL,p=d||"function"!=typeof Map||"function"!=typeof Map.prototype.entries?function(){var t={},e=[],n=function(){function t(t,e,n){this._index=0,this._keys=t,this._values=e,this._selector=n}return t.prototype["@@iterator"]=function(){return this},t.prototype[r]=function(){return this},t.prototype.next=function(){var t=this._index;if(t>=0&&t<this._keys.length){var n=this._selector(this._keys[t],this._values[t]);return t+1>=this._keys.length?(this._index=-1,this._keys=e,this._values=e):this._index++,{value:n,done:!1}}return{value:void 0,done:!0}},t.prototype.throw=function(t){throw this._index>=0&&(this._index=-1,this._keys=e,this._values=e),t},t.prototype.return=function(t){return this._index>=0&&(this._index=-1,this._keys=e,this._values=e),{value:t,done:!0}},t}();return function(){function e(){this._keys=[],this._values=[],this._cacheKey=t,this._cacheIndex=-2}return Object.defineProperty(e.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),e.prototype.has=function(t){return this._find(t,!1)>=0},e.prototype.get=function(t){var e=this._find(t,!1);return e>=0?this._values[e]:void 0},e.prototype.set=function(t,e){var n=this._find(t,!0);return this._values[n]=e,this},e.prototype.delete=function(e){var n=this._find(e,!1);if(n>=0){for(var o=this._keys.length,i=n+1;i<o;i++)this._keys[i-1]=this._keys[i],this._values[i-1]=this._values[i];return this._keys.length--,this._values.length--,e===this._cacheKey&&(this._cacheKey=t,this._cacheIndex=-2),!0}return!1},e.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=t,this._cacheIndex=-2},e.prototype.keys=function(){return new n(this._keys,this._values,o)},e.prototype.values=function(){return new n(this._keys,this._values,i)},e.prototype.entries=function(){return new n(this._keys,this._values,a)},e.prototype["@@iterator"]=function(){return this.entries()},e.prototype[r]=function(){return this.entries()},e.prototype._find=function(t,e){return this._cacheKey!==t&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=t)),this._cacheIndex<0&&e&&(this._cacheIndex=this._keys.length,this._keys.push(t),this._values.push(void 0)),this._cacheIndex},e}();function o(t,e){return t}function i(t,e){return e}function a(t,e){return[t,e]}}():Map,h=d||"function"!=typeof Set||"function"!=typeof Set.prototype.entries?function(){function t(){this._map=new p}return Object.defineProperty(t.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),t.prototype.has=function(t){return this._map.has(t)},t.prototype.add=function(t){return this._map.set(t,t),this},t.prototype.delete=function(t){return this._map.delete(t)},t.prototype.clear=function(){this._map.clear()},t.prototype.keys=function(){return this._map.keys()},t.prototype.values=function(){return this._map.values()},t.prototype.entries=function(){return this._map.entries()},t.prototype["@@iterator"]=function(){return this.keys()},t.prototype[r]=function(){return this.keys()},t}():Set,f=new(d||"function"!=typeof WeakMap?function(){var t=c.create(),n=o();return function(){function t(){this._key=o()}return t.prototype.has=function(t){var e=i(t,!1);return void 0!==e&&c.has(e,this._key)},t.prototype.get=function(t){var e=i(t,!1);return void 0!==e?c.get(e,this._key):void 0},t.prototype.set=function(t,e){return i(t,!0)[this._key]=e,this},t.prototype.delete=function(t){var e=i(t,!1);return void 0!==e&&delete e[this._key]},t.prototype.clear=function(){this._key=o()},t}();function o(){var e;do{e="@@WeakMap@@"+a()}while(c.has(t,e));return t[e]=!0,e}function i(t,o){if(!e.call(t,n)){if(!o)return;Object.defineProperty(t,n,{value:c.create()})}return t[n]}function r(t,e){for(var n=0;n<e;++n)t[n]=255*Math.random()|0;return t}function a(){var t,e=(t=16,"function"==typeof Uint8Array?"undefined"!=typeof crypto?crypto.getRandomValues(new Uint8Array(t)):"undefined"!=typeof msCrypto?msCrypto.getRandomValues(new Uint8Array(t)):r(new Uint8Array(t),t):r(new Array(t),t));e[6]=79&e[6]|64,e[8]=191&e[8]|128;for(var n="",o=0;o<16;++o){var i=e[o];4!==o&&6!==o&&8!==o||(n+="-"),i<16&&(n+="0"),n+=i.toString(16).toLowerCase()}return n}}():WeakMap);function g(t,e,n){var o=f.get(t);if(C(o)){if(!n)return;o=new p,f.set(t,o)}var i=o.get(e);if(C(i)){if(!n)return;i=new p,o.set(e,i)}return i}function m(t,e,n){var o=g(e,n,!1);return!C(o)&&!!o.has(t)}function y(t,e,n){var o=g(e,n,!1);if(!C(o))return o.get(t)}function v(t,e,n,o){g(n,o,!0).set(t,e)}function _(t,e){var n=[],o=g(t,e,!1);if(C(o))return n;for(var i=function(t){var e=T(t,r);if(!E(e))throw new TypeError;var n=e.call(t);if(!w(n))throw new TypeError;return n}(o.keys()),a=0;;){var s=O(i);if(!s)return n.length=a,n;var l=s.value;try{n[a]=l}catch(t){try{A(i)}finally{throw t}}a++}}function b(t){if(null===t)return 1;switch(typeof t){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return null===t?1:6;default:return 6}}function C(t){return void 0===t}function k(t){return null===t}function w(t){return"object"==typeof t?null!==t:"function"==typeof t}function S(t){var e=function(t,e){switch(b(t)){case 0:case 1:case 2:case 3:case 4:case 5:return t}var n=3===e?"string":5===e?"number":"default",i=T(t,o);if(void 0!==i){var r=i.call(t,n);if(w(r))throw new TypeError;return r}return function(t,e){if("string"===e){var n=t.toString;if(E(n)&&!w(i=n.call(t)))return i;if(E(o=t.valueOf)&&!w(i=o.call(t)))return i}else{var o;if(E(o=t.valueOf)&&!w(i=o.call(t)))return i;var i,r=t.toString;if(E(r)&&!w(i=r.call(t)))return i}throw new TypeError}(t,"default"===n?"number":n)}(t,3);return"symbol"==typeof e?e:function(t){return""+t}(e)}function x(t){return Array.isArray?Array.isArray(t):t instanceof Object?t instanceof Array:"[object Array]"===Object.prototype.toString.call(t)}function E(t){return"function"==typeof t}function I(t){return"function"==typeof t}function T(t,e){var n=t[e];if(null!=n){if(!E(n))throw new TypeError;return n}}function O(t){var e=t.next();return!e.done&&e}function A(t){var e=t.return;e&&e.call(t)}function N(t){var e=Object.getPrototypeOf(t);if("function"!=typeof t||t===u)return e;if(e!==u)return e;var n=t.prototype,o=n&&Object.getPrototypeOf(n);if(null==o||o===Object.prototype)return e;var i=o.constructor;return"function"!=typeof i||i===t?e:i}function D(t){return t.__=void 0,delete t.__,t}t("decorate",function(t,e,n,o){if(C(n)){if(!x(t))throw new TypeError;if(!I(e))throw new TypeError;return function(t,e){for(var n=t.length-1;n>=0;--n){var o=(0,t[n])(e);if(!C(o)&&!k(o)){if(!I(o))throw new TypeError;e=o}}return e}(t,e)}if(!x(t))throw new TypeError;if(!w(e))throw new TypeError;if(!w(o)&&!C(o)&&!k(o))throw new TypeError;return k(o)&&(o=void 0),function(t,e,n,o){for(var i=t.length-1;i>=0;--i){var r=(0,t[i])(e,n,o);if(!C(r)&&!k(r)){if(!w(r))throw new TypeError;o=r}}return o}(t,e,n=S(n),o)}),t("metadata",function(t,e){return function(n,o){if(!w(n))throw new TypeError;if(!C(o)&&!function(t){switch(b(t)){case 3:case 4:return!0;default:return!1}}(o))throw new TypeError;v(t,e,n,o)}}),t("defineMetadata",function(t,e,n,o){if(!w(n))throw new TypeError;return C(o)||(o=S(o)),v(t,e,n,o)}),t("hasMetadata",function(t,e,n){if(!w(e))throw new TypeError;return C(n)||(n=S(n)),function t(e,n,o){if(m(e,n,o))return!0;var i=N(n);return!k(i)&&t(e,i,o)}(t,e,n)}),t("hasOwnMetadata",function(t,e,n){if(!w(e))throw new TypeError;return C(n)||(n=S(n)),m(t,e,n)}),t("getMetadata",function(t,e,n){if(!w(e))throw new TypeError;return C(n)||(n=S(n)),function t(e,n,o){if(m(e,n,o))return y(e,n,o);var i=N(n);return k(i)?void 0:t(e,i,o)}(t,e,n)}),t("getOwnMetadata",function(t,e,n){if(!w(e))throw new TypeError;return C(n)||(n=S(n)),y(t,e,n)}),t("getMetadataKeys",function(t,e){if(!w(t))throw new TypeError;return C(e)||(e=S(e)),function t(e,n){var o=_(e,n),i=N(e);if(null===i)return o;var r=t(i,n);if(r.length<=0)return o;if(o.length<=0)return r;for(var a=new h,s=[],l=0,c=o;l<c.length;l++){var u=c[l];a.has(u)||(a.add(u),s.push(u))}for(var d=0,p=r;d<p.length;d++)u=p[d],a.has(u)||(a.add(u),s.push(u));return s}(t,e)}),t("getOwnMetadataKeys",function(t,e){if(!w(t))throw new TypeError;return C(e)||(e=S(e)),_(t,e)}),t("deleteMetadata",function(t,e,n){if(!w(e))throw new TypeError;C(n)||(n=S(n));var o=g(e,n,!1);if(C(o))return!1;if(!o.delete(t))return!1;if(o.size>0)return!0;var i=f.get(e);return i.delete(n),i.size>0||f.delete(e),!0})}(r)}()}(n||(n={}))},function(t,e,n){
/** @license React v16.13.1
                 * react.production.min.js
                 *
                 * Copyright (c) Facebook, Inc. and its affiliates.
                 *
                 * This source code is licensed under the MIT license found in the
                 * LICENSE file in the root directory of this source tree.
                 */
var o=n(359),i="function"==typeof Symbol&&Symbol.for,r=i?Symbol.for("react.element"):60103,a=i?Symbol.for("react.portal"):60106,s=i?Symbol.for("react.fragment"):60107,l=i?Symbol.for("react.strict_mode"):60108,c=i?Symbol.for("react.profiler"):60114,u=i?Symbol.for("react.provider"):60109,d=i?Symbol.for("react.context"):60110,p=i?Symbol.for("react.forward_ref"):60112,h=i?Symbol.for("react.suspense"):60113,f=i?Symbol.for("react.memo"):60115,g=i?Symbol.for("react.lazy"):60116,m="function"==typeof Symbol&&Symbol.iterator;function y(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var v={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},_={};function b(t,e,n){this.props=t,this.context=e,this.refs=_,this.updater=n||v}function C(){}function k(t,e,n){this.props=t,this.context=e,this.refs=_,this.updater=n||v}b.prototype.isReactComponent={},b.prototype.setState=function(t,e){if("object"!=typeof t&&"function"!=typeof t&&null!=t)throw Error(y(85));this.updater.enqueueSetState(this,t,e,"setState")},b.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")},C.prototype=b.prototype;var w=k.prototype=new C;w.constructor=k,o(w,b.prototype),w.isPureReactComponent=!0;var S={current:null},x=Object.prototype.hasOwnProperty,E={key:!0,ref:!0,__self:!0,__source:!0};function I(t,e,n){var o,i={},a=null,s=null;if(null!=e)for(o in void 0!==e.ref&&(s=e.ref),void 0!==e.key&&(a=""+e.key),e)x.call(e,o)&&!E.hasOwnProperty(o)&&(i[o]=e[o]);var l=arguments.length-2;if(1===l)i.children=n;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];i.children=c}if(t&&t.defaultProps)for(o in l=t.defaultProps)void 0===i[o]&&(i[o]=l[o]);return{$$typeof:r,type:t,key:a,ref:s,props:i,_owner:S.current}}function T(t){return"object"==typeof t&&null!==t&&t.$$typeof===r}var O=/\/+/g,A=[];function N(t,e,n,o){if(A.length){var i=A.pop();return i.result=t,i.keyPrefix=e,i.func=n,i.context=o,i.count=0,i}return{result:t,keyPrefix:e,func:n,context:o,count:0}}function D(t){t.result=null,t.keyPrefix=null,t.func=null,t.context=null,t.count=0,10>A.length&&A.push(t)}function B(t,e,n){return null==t?0:function t(e,n,o,i){var s=typeof e;"undefined"!==s&&"boolean"!==s||(e=null);var l=!1;if(null===e)l=!0;else switch(s){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case r:case a:l=!0}}if(l)return o(i,e,""===n?"."+R(e,0):n),1;if(l=0,n=""===n?".":n+":",Array.isArray(e))for(var c=0;c<e.length;c++){var u=n+R(s=e[c],c);l+=t(s,u,o,i)}else if("function"==typeof(u=null===e||"object"!=typeof e?null:"function"==typeof(u=m&&e[m]||e["@@iterator"])?u:null))for(e=u.call(e),c=0;!(s=e.next()).done;)l+=t(s=s.value,u=n+R(s,c++),o,i);else if("object"===s)throw o=""+e,Error(y(31,"[object Object]"===o?"object with keys {"+Object.keys(e).join(", ")+"}":o,""));return l}(t,"",e,n)}function R(t,e){return"object"==typeof t&&null!==t&&null!=t.key?function(t){var e={"=":"=0",":":"=2"};return"$"+(""+t).replace(/[=:]/g,function(t){return e[t]})}(t.key):e.toString(36)}function L(t,e){t.func.call(t.context,e,t.count++)}function P(t,e,n){var o=t.result,i=t.keyPrefix;t=t.func.call(t.context,e,t.count++),Array.isArray(t)?M(t,o,n,function(t){return t}):null!=t&&(T(t)&&(t=function(t,e){return{$$typeof:r,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}(t,i+(!t.key||e&&e.key===t.key?"":(""+t.key).replace(O,"$&/")+"/")+n)),o.push(t))}function M(t,e,n,o,i){var r="";null!=n&&(r=(""+n).replace(O,"$&/")+"/"),B(t,P,e=N(e,r,o,i)),D(e)}var F={current:null};function H(){var t=F.current;if(null===t)throw Error(y(321));return t}var j={ReactCurrentDispatcher:F,ReactCurrentBatchConfig:{suspense:null},ReactCurrentOwner:S,IsSomeRendererActing:{current:!1},assign:o};e.Children={map:function(t,e,n){if(null==t)return t;var o=[];return M(t,o,null,e,n),o},forEach:function(t,e,n){if(null==t)return t;B(t,L,e=N(null,null,e,n)),D(e)},count:function(t){return B(t,function(){return null},null)},toArray:function(t){var e=[];return M(t,e,null,function(t){return t}),e},only:function(t){if(!T(t))throw Error(y(143));return t}},e.Component=b,e.Fragment=s,e.Profiler=c,e.PureComponent=k,e.StrictMode=l,e.Suspense=h,e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=j,e.cloneElement=function(t,e,n){if(null==t)throw Error(y(267,t));var i=o({},t.props),a=t.key,s=t.ref,l=t._owner;if(null!=e){if(void 0!==e.ref&&(s=e.ref,l=S.current),void 0!==e.key&&(a=""+e.key),t.type&&t.type.defaultProps)var c=t.type.defaultProps;for(u in e)x.call(e,u)&&!E.hasOwnProperty(u)&&(i[u]=void 0===e[u]&&void 0!==c?c[u]:e[u])}var u=arguments.length-2;if(1===u)i.children=n;else if(1<u){c=Array(u);for(var d=0;d<u;d++)c[d]=arguments[d+2];i.children=c}return{$$typeof:r,type:t.type,key:a,ref:s,props:i,_owner:l}},e.createContext=function(t,e){return void 0===e&&(e=null),(t={$$typeof:d,_calculateChangedBits:e,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null}).Provider={$$typeof:u,_context:t},t.Consumer=t},e.createElement=I,e.createFactory=function(t){var e=I.bind(null,t);return e.type=t,e},e.createRef=function(){return{current:null}},e.forwardRef=function(t){return{$$typeof:p,render:t}},e.isValidElement=T,e.lazy=function(t){return{$$typeof:g,_ctor:t,_status:-1,_result:null}},e.memo=function(t,e){return{$$typeof:f,type:t,compare:void 0===e?null:e}},e.useCallback=function(t,e){return H().useCallback(t,e)},e.useContext=function(t,e){return H().useContext(t,e)},e.useDebugValue=function(){},e.useEffect=function(t,e){return H().useEffect(t,e)},e.useImperativeHandle=function(t,e,n){return H().useImperativeHandle(t,e,n)},e.useLayoutEffect=function(t,e){return H().useLayoutEffect(t,e)},e.useMemo=function(t,e){return H().useMemo(t,e)},e.useReducer=function(t,e,n){return H().useReducer(t,e,n)},e.useRef=function(t){return H().useRef(t)},e.useState=function(t){return H().useState(t)},e.version="16.13.1"},function(t,e,n){
/*
                object-assign
                (c) Sindre Sorhus
                @license MIT
                */
var o=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable;t.exports=function(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de","5"===Object.getOwnPropertyNames(t)[0])return!1;for(var e={},n=0;n<10;n++)e["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(e).map(function(t){return e[t]}).join(""))return!1;var o={};return"abcdefghijklmnopqrst".split("").forEach(function(t){o[t]=t}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},o)).join("")}catch(t){return!1}}()?Object.assign:function(t,e){for(var n,a,s=function(t){if(null==t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}(t),l=1;l<arguments.length;l++){for(var c in n=Object(arguments[l]))i.call(n,c)&&(s[c]=n[c]);if(o){a=o(n);for(var u=0;u<a.length;u++)r.call(n,a[u])&&(s[a[u]]=n[a[u]])}}return s}},function(t,e,n){var o=n(361);"string"==typeof o&&(o=[[t.i,o,""]]),n(351)(o,{hmr:!0,transform:void 0,insertInto:void 0}),o.locals&&(t.exports=o.locals)},function(t,e,n){(t.exports=n(350)(!1)).push([t.i,"@keyframes blinkAnimation {\n  50% {\n    border-color: transparent;\n  }\n}\n.caret.blink {\n  animation: 1s blinkAnimation step-end infinite;\n}\n@keyframes blinkAnimation-restart {\n  50% {\n    border-color: transparent;\n  }\n}\n.caret.blink-restart {\n  animation: 1s blinkAnimation-restart step-end infinite;\n}\n",""])},function(t,e){t.exports=function(t){var e="undefined"!=typeof window&&window.location;if(!e)throw new Error("fixUrls requires window.location");if(!t||"string"!=typeof t)return t;var n=e.protocol+"//"+e.host,o=n+e.pathname.replace(/\/[^\/]*$/,"/");return t.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,function(t,e){var i,r=e.trim().replace(/^"(.*)"$/,function(t,e){return e}).replace(/^'(.*)'$/,function(t,e){return e});return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/|\s*$)/i.test(r)?t:(i=0===r.indexOf("//")?r:0===r.indexOf("/")?n+r:o+r.replace(/^\.\//,""),"url("+JSON.stringify(i)+")")})}},function(t,e,n){var o=n(364);"string"==typeof o&&(o=[[t.i,o,""]]),n(351)(o,{hmr:!0,transform:void 0,insertInto:void 0}),o.locals&&(t.exports=o.locals)},function(t,e,n){(t.exports=n(350)(!1)).push([t.i,".bulb-drag-shadow > * {\n  position: absolute;\n  -webkit-mask-image: -webkit-gradient(linear, left top, right bottom, from(rgba(0, 0, 0, 0.8)), to(rgba(0, 0, 0, 0)));\n  pointer-events: none;\n}\n",""])},,,function(t,e,n){var o,r,a,c,u,d;n.r(e),n.d(e,"serializer",function(){return Ed}),n.d(e,"convertor",function(){return Id}),n.d(e,"utils",function(){return Td});var p={};n.r(p),n.d(p,"KeyBoardEventHandler",function(){return bi}),n.d(p,"MouseEventHandler",function(){return Li}),n.d(p,"CompositionEventHandler",function(){return Pi}),n.d(p,"InputEventHandler",function(){return Mi}),n.d(p,"DragEventHandler",function(){return Fi}),n.d(p,"ClipboardEventHandler",function(){return Hi}),n(357);var h,f,g,m="data-bulb-node-id";function y(t){var e=Reflect.getMetadata("design:paramtypes",t)||[],n=Reflect.getOwnMetadata("injectionTokens",t)||{};return Object.keys(n).forEach(function(t){e[+t]=n[t]}),e}function v(t){return!!t.useFactory}function _(t){return"string"==typeof t||"symbol"==typeof t}function b(t){return"object"==typeof t&&"token"in t&&"multiple"in t}function C(t){return null!=t.useValue}!function(t){t.VALUE_CHANGE="valueChange",t.DOCUMENT_DID_UPDATE="documentDidUpdate",t.SELECTION_DID_UPDATE="selectionDidUpdate",t.SELECT="select",t.DRAW_DRAG_SHADOW="drawDragShadow",t.DRAW_SELECTION="drawSelection"}(h||(h={})),function(t){t[t.FORWARD=1]="FORWARD",t[t.BACKWARD=-1]="BACKWARD"}(f||(f={})),function(t){t.ON_REGISTER_PLUGIN="onRegisterPlugin",t.ON_REGISTER_COMPONENT="onRegisterComponent",t.ON_LOAD_DATA="onLoadData",t.ON_READY="onReady",t.AFTER_SET_VALUE="afterSetValue",t.ON_PARSE_CLIPBOARD_DATA="onParseClipboardData",t.ON_COPY_CONTENT="onCopyContent",t.ON_SET_CLIPBOARD_DATA="onSetClipboardData",t.AFTER_SET_CLIPBOARD_DATA="afterSetClipboardData",t.ON_EVENT="onEvent",t.AFTER_EVENT="afterEvent",t.ON_RANGE_PARSING="onRangeParsing",t.BEFORE_RENDER_NODE="beforeRenderNode",t.AFTER_RENDER_NODE="afterRenderNode",t.ON_EXECUTE_COMMAND="onExecuteCommand",t.BEFORE_INSERT_BLOCK="beforeInsertBlock",t.BEFORE_GEN_NODE_ID="beforeGenerateNodeId",t.ON_ERROR="onError",t.ON_WARNING="onWarning",t.ON_LOG="onLog",t.ON_DEBUG="onDebug",t.BEFORE_CONVERT_RECTS="beforeConvertRects",t.AFTER_CONVERT_RECTS="afterConvertRects"}(g||(g={}));var k=function(){function t(){this._registryMap=new Map}return t.prototype.getAll=function(t){return this.ensure(t),this._registryMap.get(t)},t.prototype.get=function(t){this.ensure(t);var e=this._registryMap.get(t);return e[e.length-1]||null},t.prototype.set=function(t,e){this.ensure(t),this._registryMap.get(t).push(e)},t.prototype.has=function(t){return this.ensure(t),this._registryMap.get(t).length>0},t.prototype.clear=function(){this._registryMap.clear()},t.prototype.ensure=function(t){this._registryMap.has(t)||this._registryMap.set(t,[])},t}();function w(t,e,n){return(w=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}()?Reflect.construct:function(t,e,n){var o=[null];o.push.apply(o,e);var i=new(Function.bind.apply(t,o));return n&&function(t,e){(Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}(i,n.prototype),i}).apply(null,arguments)}function S(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}var x,E=new Map,I=function(){function t(t){this.parent=t,this._registry=new k}return t.prototype.register=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{singleton:!1};if(n.singleton&&(C(e)||v(e)))throw"Cannot use {singleton: true} with ValueProviders or FactoryProviders";return this._registry.set(t,{provider:e,options:n}),this},t.prototype.registerType=function(t,e){return _(e)?this.register(t,{useToken:e}):this.register(t,{useClass:e})},t.prototype.registerInstance=function(t,e){return this.register(t,{useValue:e})},t.prototype.registerSingleton=function(t,e){if(_(t)){if(_(e))return this.register(t,{useToken:e},{singleton:!0});if(e)return this.register(t,{useClass:e},{singleton:!0});throw'Cannot register a type name as a singleton without a "to" token'}var n=t;return e&&!_(e)&&(n=e),this.register(t,{useClass:n},{singleton:!0})},t.prototype.resolve=function(t){var e=this.getRegistration(t);if(!e&&_(t))throw"Attempted to resolve unregistered dependency token: "+t.toString();return e?this.resolveRegistration(e):this.construct(t)},t.prototype.resolveRegistration=function(t){return C(t.provider)?t.provider.useValue:t.provider.useToken?t.options.singleton?t.instance||(t.instance=this.resolve(t.provider.useToken)):this.resolve(t.provider.useToken):function(t){return!!t.useClass}(t.provider)?t.options.singleton?t.instance||(t.instance=this.construct(t.provider.useClass)):this.construct(t.provider.useClass):v(t.provider)?t.provider.useFactory(this):this.construct(t.provider)},t.prototype.resolveAll=function(t){var e=this,n=this.getAllRegistrations(t);if(!n&&_(t))throw"Attempted to resolve unregistered dependency token: "+t.toString();return n?n.map(function(t){return e.resolveRegistration(t)}):[this.construct(t)]},t.prototype.isRegistered=function(t){return this._registry.has(t)},t.prototype.reset=function(){this._registry.clear()},t.prototype.createChildContainer=function(){return new t(this)},t.prototype.getRegistration=function(t){return this.isRegistered(t)?this._registry.get(t):this.parent?this.parent.getRegistration(t):null},t.prototype.getAllRegistrations=function(t){return this.isRegistered(t)?this._registry.getAll(t):this.parent?this.parent.getAllRegistrations(t):null},t.prototype.construct=function(t){var e=this;if(0===t.length)return new t;var n=E.get(t);if(!n||0===n.length)throw"TypeInfo not known for "+t;return w(t,function(t){return function(t){if(Array.isArray(t))return S(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return S(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?S(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(n.map(function(t){return b(t)?t.multiple?e.resolveAll(t.token):e.resolve(t.token):e.resolve(t)})))},t}(),T=new I,O=function(){return function(t){E.set(t,y(t))}},A=function(){return function(t){O()(t),T.registerSingleton(t)}};if("undefined"==typeof Reflect||!Reflect.getMetadata)throw"tsyringe requires a reflect polyfill. Please add 'import \"reflect-metadata\"' to the top of your entry point.";var N="undefined"!=typeof Symbol?Symbol("immer-nothing"):((x={})["immer-nothing"]=!0,x),D="undefined"!=typeof Symbol&&Symbol.for?Symbol.for("immer-draftable"):"__$immer_draftable",B="undefined"!=typeof Symbol&&Symbol.for?Symbol.for("immer-state"):"__$immer_state";function R(t){return!!t&&!!t[B]}function L(t){return!!t&&(function(t){if(!t||"object"!=typeof t)return!1;if(Array.isArray(t))return!0;var e=Object.getPrototypeOf(t);return!e||e===Object.prototype}(t)||!!t[D]||!!t.constructor[D])}var P=Object.assign||function(t,e){for(var n in e)V(e,n)&&(t[n]=e[n]);return t},M="undefined"!=typeof Reflect&&Reflect.ownKeys?Reflect.ownKeys:void 0!==Object.getOwnPropertySymbols?function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:Object.getOwnPropertyNames;function F(t,e){if(void 0===e&&(e=!1),Array.isArray(t))return t.slice();var n=Object.create(Object.getPrototypeOf(t));return M(t).forEach(function(o){if(o!==B){var i=Object.getOwnPropertyDescriptor(t,o),r=i.value;if(i.get){if(!e)throw new Error("Immer drafts cannot have computed properties");r=i.get.call(t)}i.enumerable?n[o]=r:Object.defineProperty(n,o,{value:r,writable:!0,configurable:!0})}}),n}function H(t,e){if(Array.isArray(t))for(var n=0;n<t.length;n++)e(n,t[n],t);else M(t).forEach(function(n){return e(n,t[n],t)})}function j(t,e){var n=Object.getOwnPropertyDescriptor(t,e);return!!n&&n.enumerable}function V(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function U(t,e){return t===e?0!==t||1/t==1/e:t!=t&&e!=e}function z(t){if(!L(t))return t;if(Array.isArray(t))return t.map(z);var e=Object.create(Object.getPrototypeOf(t));for(var n in t)e[n]=z(t[n]);return e}var G=function(t){this.drafts=[],this.parent=t,this.canAutoFreeze=!0,this.patches=null};function J(t){t[B].revoke()}G.prototype.usePatches=function(t){t&&(this.patches=[],this.inversePatches=[],this.patchListener=t)},G.prototype.revoke=function(){this.leave(),this.drafts.forEach(J),this.drafts=null},G.prototype.leave=function(){this===G.current&&(G.current=this.parent)},G.current=null,G.enter=function(){return this.current=new G(this.current)};var W={};function $(){this.revoked=!0}function K(t){return t.copy||t.base}function Y(t,e){var n=t[B];if(n&&!n.finalizing){n.finalizing=!0;var o=t[e];return n.finalizing=!1,o}return t[e]}function X(t){t.modified||(t.modified=!0,t.parent&&X(t.parent))}function q(t){t.copy||(t.copy=Q(t.base))}function Q(t){var e=t&&t[B];if(e){e.finalizing=!0;var n=F(e.draft,!0);return e.finalizing=!1,n}return F(t)}function Z(t){if(!0===t.revoked)throw new Error("Cannot use a proxy that has been revoked. Did you pass an object from inside an immer function to an async process? "+JSON.stringify(K(t)))}function tt(t){for(var e=t.length-1;e>=0;e--){var n=t[e][B];n.modified||(Array.isArray(n.base)?nt(n)&&X(n):et(n)&&X(n))}}function et(t){for(var e=t.base,n=t.draft,o=Object.keys(n),i=o.length-1;i>=0;i--){var r=o[i],a=e[r];if(void 0===a&&!V(e,r))return!0;var s=n[r],l=s&&s[B];if(l?l.base!==a:!U(s,a))return!0}return o.length!==Object.keys(e).length}function nt(t){var e=t.draft;if(e.length!==t.base.length)return!0;var n=Object.getOwnPropertyDescriptor(e,e.length-1);return!(!n||n.get)}var ot=Object.freeze({willFinalize:function(t,e,n){t.drafts.forEach(function(t){t[B].finalizing=!0}),n?R(e)&&e[B].scope===t&&tt(t.drafts):(t.patches&&function t(e){if(e&&"object"==typeof e){var n=e[B];if(n){var o=n.base,i=n.draft,r=n.assigned;if(Array.isArray(e)){if(nt(n)){if(X(n),r.length=!0,i.length<o.length)for(var a=i.length;a<o.length;a++)r[a]=!1;else for(var s=o.length;s<i.length;s++)r[s]=!0;for(var l=0;l<i.length;l++)void 0===r[l]&&t(i[l])}}else Object.keys(i).forEach(function(e){void 0!==o[e]||V(o,e)?r[e]||t(i[e]):(r[e]=!0,X(n))}),Object.keys(o).forEach(function(t){void 0!==i[t]||V(i,t)||(r[t]=!1,X(n))})}}}(t.drafts[0]),tt(t.drafts))},createProxy:function t(e,n){var o=Array.isArray(e),i=Q(e);H(i,function(n){!function(e,n,o){var i=W[n];i?i.enumerable=o:W[n]=i={configurable:!0,enumerable:o,get:function(){return function(e,n){Z(e);var o=Y(K(e),n);return e.finalizing?o:o===Y(e.base,n)&&L(o)?(q(e),e.copy[n]=t(o,e)):o}(this[B],n)},set:function(t){!function(t,e,n){if(Z(t),t.assigned[e]=!0,!t.modified){if(U(n,Y(K(t),e)))return;X(t),q(t)}t.copy[e]=n}(this[B],n,t)}},Object.defineProperty(e,n,i)}(i,n,o||j(e,n))});var r,a,s,l=n?n.scope:G.current;return r=i,a=B,s={scope:l,modified:!1,finalizing:!1,finalized:!1,assigned:{},parent:n,base:e,draft:i,copy:null,revoke:$,revoked:!1},Object.defineProperty(r,a,{value:s,enumerable:!1,writable:!0}),l.drafts.push(i),i}});function it(t,e){var n=e?e.scope:G.current,o={scope:n,modified:!1,finalized:!1,assigned:{},parent:e,base:t,draft:null,drafts:{},copy:null,revoke:null},i=Array.isArray(t)?Proxy.revocable([o],at):Proxy.revocable(o,rt),r=i.revoke,a=i.proxy;return o.draft=a,o.revoke=r,n.drafts.push(a),a}var rt={get:function(t,e){if(e===B)return t;var n=t.drafts;if(!t.modified&&V(n,e))return n[e];var o=st(t)[e];if(t.finalized||!L(o))return o;if(t.modified){if(o!==lt(t.base,e))return o;n=t.copy}return n[e]=it(o,t)},has:function(t,e){return e in st(t)},ownKeys:function(t){return Reflect.ownKeys(st(t))},set:function(t,e,n){if(!t.modified){var o=lt(t.base,e);if(n?U(o,n)||n===t.drafts[e]:U(o,n)&&e in t.base)return!0;ct(t)}return t.assigned[e]=!0,t.copy[e]=n,!0},deleteProperty:function(t,e){return void 0!==lt(t.base,e)||e in t.base?(t.assigned[e]=!1,ct(t)):t.assigned[e]&&delete t.assigned[e],t.copy&&delete t.copy[e],!0},getOwnPropertyDescriptor:function(t,e){var n=st(t),o=Reflect.getOwnPropertyDescriptor(n,e);return o&&(o.writable=!0,o.configurable=!Array.isArray(n)||"length"!==e),o},defineProperty:function(){throw new Error("Object.defineProperty() cannot be used on an Immer draft")},getPrototypeOf:function(t){return Object.getPrototypeOf(t.base)},setPrototypeOf:function(){throw new Error("Object.setPrototypeOf() cannot be used on an Immer draft")}},at={};function st(t){return t.copy||t.base}function lt(t,e){var n=t[B],o=Reflect.getOwnPropertyDescriptor(n?st(n):t,e);return o&&o.value}function ct(t){t.modified||(t.modified=!0,t.copy=P(F(t.base),t.drafts),t.drafts=null,t.parent&&ct(t.parent))}H(rt,function(t,e){at[t]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}}),at.deleteProperty=function(t,e){if(isNaN(parseInt(e)))throw new Error("Immer only supports deleting array indices");return rt.deleteProperty.call(this,t[0],e)},at.set=function(t,e,n){if("length"!==e&&isNaN(parseInt(e)))throw new Error("Immer only supports setting array indices and the 'length' property");return rt.set.call(this,t[0],e,n)};var ut=Object.freeze({willFinalize:function(){},createProxy:it}),dt=function(t,e){for(var n=0,o=e;n<o.length;n+=1){var i=o[n],r=i.path,a=i.op,s=z(i.value);if(!r.length)throw new Error("Illegal state");for(var l=t,c=0;c<r.length-1;c++)if(!(l=l[r[c]])||"object"!=typeof l)throw new Error("Cannot apply patch, path doesn't resolve: "+r.join("/"));var u=r[r.length-1];switch(a){case"replace":l[u]=s;break;case"add":Array.isArray(l)?l.splice(u,0,s):l[u]=s;break;case"remove":Array.isArray(l)?l.splice(u,1):delete l[u];break;default:throw new Error("Unsupported patch operation: "+a)}}return t},pt={useProxies:"undefined"!=typeof Proxy&&"undefined"!=typeof Reflect,autoFreeze:void 0===i&&"verifyMinified"===function(){}.name,onAssign:null,onDelete:null,onCopy:null},ht=function(t){P(this,pt,t),this.setUseProxies(this.useProxies),this.produce=this.produce.bind(this)};ht.prototype.produce=function(t,e,n){var o,i=this;if("function"==typeof t&&"function"!=typeof e){var r=e;e=t;var a=this;return function(t){var n=this;void 0===t&&(t=r);for(var o=[],i=arguments.length-1;i-- >0;)o[i]=arguments[i+1];return a.produce(t,function(t){return e.call.apply(e,[n,t].concat(o))})}}if("function"!=typeof e)throw new Error("The first or second argument to `produce` must be a function");if(void 0!==n&&"function"!=typeof n)throw new Error("The third argument to `produce` must be a function or undefined");if(L(t)){var s=G.enter(),l=this.createProxy(t),c=!0;try{o=e(l),c=!1}finally{c?s.revoke():s.leave()}return o instanceof Promise?o.then(function(t){return s.usePatches(n),i.processResult(t,s)},function(t){throw s.revoke(),t}):(s.usePatches(n),this.processResult(o,s))}return void 0===(o=e(t))?t:o!==N?o:void 0},ht.prototype.produceWithPatches=function(t,e,n){var o,i,r=this;if("function"==typeof t)return function(e){for(var n=[],o=arguments.length-1;o-- >0;)n[o]=arguments[o+1];return r.produceWithPatches(e,function(e){return t.apply(void 0,[e].concat(n))})};if(n)throw new Error("A patch listener cannot be passed to produceWithPatches");return[this.produce(t,e,function(t,e){o=t,i=e}),o,i]},ht.prototype.createDraft=function(t){if(!L(t))throw new Error("First argument to `createDraft` must be a plain object, an array, or an immerable object");var e=G.enter(),n=this.createProxy(t);return n[B].isManual=!0,e.leave(),n},ht.prototype.finishDraft=function(t,e){var n=t&&t[B];if(!n||!n.isManual)throw new Error("First argument to `finishDraft` must be a draft returned by `createDraft`");if(n.finalized)throw new Error("The given draft is already finalized");var o=n.scope;return o.usePatches(e),this.processResult(void 0,o)},ht.prototype.setAutoFreeze=function(t){this.autoFreeze=t},ht.prototype.setUseProxies=function(t){this.useProxies=t,P(this,t?ut:ot)},ht.prototype.applyPatches=function(t,e){var n;for(n=e.length-1;n>=0;n--){var o=e[n];if(0===o.path.length&&"replace"===o.op){t=o.value;break}}return R(t)?dt(t,e):this.produce(t,function(t){return dt(t,e.slice(n+1))})},ht.prototype.processResult=function(t,e){var n=e.drafts[0],o=void 0!==t&&t!==n;if(this.willFinalize(e,t,o),o){if(n[B].modified)throw e.revoke(),new Error("An immer producer returned a new value *and* modified its draft. Either return a new value *or* modify the draft.");L(t)&&(t=this.finalize(t,null,e)),e.patches&&(e.patches.push({op:"replace",path:[],value:t}),e.inversePatches.push({op:"replace",path:[],value:n[B].base}))}else t=this.finalize(n,[],e);return e.revoke(),e.patches&&e.patchListener(e.patches,e.inversePatches),t!==N?t:void 0},ht.prototype.finalize=function(t,e,n){var o=this,i=t[B];if(!i)return Object.isFrozen(t)?t:this.finalizeTree(t,null,n);if(i.scope!==n)return t;if(!i.modified)return i.base;if(!i.finalized){if(i.finalized=!0,this.finalizeTree(i.draft,e,n),this.onDelete)if(this.useProxies){var r=i.assigned;for(var a in r)r[a]||this.onDelete(i,a)}else{var s=i.base,l=i.copy;H(s,function(t){V(l,t)||o.onDelete(i,t)})}this.onCopy&&this.onCopy(i),this.autoFreeze&&n.canAutoFreeze&&Object.freeze(i.copy),e&&n.patches&&function(t,e,n,o){Array.isArray(t.base)?function(t,e,n,o){var i,r,a=t.base,s=t.copy,l=t.assigned;s.length<a.length&&(a=(i=[s,a])[0],s=i[1],n=(r=[o,n])[0],o=r[1]);for(var c=s.length-a.length,u=0;a[u]===s[u]&&u<a.length;)++u;for(var d=a.length;d>u&&a[d-1]===s[d+c-1];)--d;for(var p=u;p<d;++p)if(l[p]&&s[p]!==a[p]){var h=e.concat([p]);n.push({op:"replace",path:h,value:s[p]}),o.push({op:"replace",path:h,value:a[p]})}for(var f=n.length,g=d+c-1;g>=d;--g){var m=e.concat([g]);n[f+g-d]={op:"add",path:m,value:s[g]},o.push({op:"remove",path:m})}}(t,e,n,o):function(t,e,n,o){var i=t.base,r=t.copy;H(t.assigned,function(t,a){var s=i[t],l=r[t],c=a?t in i?"replace":"add":"remove";if(s!==l||"replace"!==c){var u=e.concat(t);n.push("remove"===c?{op:c,path:u}:{op:c,path:u,value:l}),o.push("add"===c?{op:"remove",path:u}:"remove"===c?{op:"add",path:u,value:s}:{op:"replace",path:u,value:s})}})}(t,e,n,o)}(i,e,n.patches,n.inversePatches)}return i.copy},ht.prototype.finalizeTree=function(t,e,n){var o=this,i=t[B];i&&(this.useProxies||(i.copy=F(i.draft,!0)),t=i.copy);var r=!!e&&!!n.patches,a=function(s,l,c){if(l===c)throw Error("Immer forbids circular references");var u=!!i&&c===t;if(R(l)){var d=u&&r&&!i.assigned[s]?e.concat(s):null;if(R(l=o.finalize(l,d,n))&&(n.canAutoFreeze=!1),Array.isArray(c)||j(c,s)?c[s]=l:Object.defineProperty(c,s,{value:l}),u&&l===i.base[s])return}else{if(u&&U(l,i.base[s]))return;L(l)&&!Object.isFrozen(l)&&H(l,a)}u&&o.onAssign&&o.onAssign(i,s,l)};return H(t,a),t};var ft,gt,mt,yt=new ht,vt=yt.produce,_t=(yt.produceWithPatches.bind(yt),yt.setAutoFreeze.bind(yt),yt.setUseProxies.bind(yt),yt.applyPatches.bind(yt),yt.createDraft.bind(yt),yt.finishDraft.bind(yt),vt);!function(t){t.Document="document",t.Block="block",t.Inline="inline",t.Text="text",t.Unknown="unknown"}(ft||(ft={})),function(t){t[t.DepthFirst=0]="DepthFirst"}(gt||(gt={}));var bt=new ht({autoFreeze:!1}).produce,Ct=function(){this[mt]=!0};mt=D;var kt=0,wt=function(){return ir.generateNodeId(kt++)};function St(t){return function(t){if(Array.isArray(t))return xt(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return xt(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?xt(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function xt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}var Et=function(t){function e(e){var n=this;(n=t.call(this)||this).nodes=[],n.parent=null;var o=e.id,i=void 0===o?wt():o,r=e.nodes,a=void 0===r?[]:r;return n.id=i,n.nodes=a,n}return s(e,t),e.findCommonAncestor=function(t,n){var o=t.getDepth();if(0===o)return t;var i=n.getDepth();if(0===i)return n;if(o<i)return e.findCommonAncestor(n,t);for(var r=o-i,a=0;a<r;a++)t=t.parent;for(;t.id!==n.id;)t=t.parent,n=n.parent;return t},e.fromJSON=function(t){var e=t.id;return{id:e}},e.prototype.toJSON=function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e={type:this.type};return t&&(e.id=this.id),e},e.prototype.find=function(t){return this.nodes.find(t)},e.prototype.deepFind=function(t){if(t(this))return this;for(var e,n=0,o=this.nodes;n<o.length;n++){var i=o[n],r=i.deepFind(t);if(r){e=r;break}}return e},e.prototype.findLast=function(t){return St(this.nodes).reverse().find(t)},e.prototype.deepFindLast=function(t){for(var e=0,n=St(this.nodes).reverse();e<n.length;e++){var o=n[e],i=o.deepFindLast(t);if(i)return i}return t(this)?this:null},e.prototype.forEach=function(t){this.nodes.forEach(t)},e.prototype.deepForEach=function(t){t(this),this.nodes.forEach(function(e){e.deepForEach(t)})},e.prototype.deepRemove=function(t){return t(this)?this.parent&&this.parent.remove(this.index()):this.isBlock()||this.isDocument()||this.isInline()?this.nodes.forEach(function(e){return e.deepRemove(t)}):void 0},e.prototype.indexOf=function(t){return this.nodes.findIndex(function(e){return e.id===t.id})},e.prototype.deepIndexOf=function(t){if(!t)return-1;for(var e=t;e.parent&&e.parent.id!==this.id;)e=e.parent;return this.indexOf(e)},e.prototype.findNodeById=function(t){return this.deepFind(function(e){return e.id===t})},e.prototype.remove=function(t){if(t>this.nodes.length)throw Error("error param: slotIndex!");this.nodes.splice(t,1)},e.prototype.insert=function(t,e){if(t.isDocument())throw Error("cannot insert document!");if(!t.nodes)throw Error("cannot insert Node into a empty Node!");if(e>this.nodes.length)throw Error("error param: slotIndex!");this.nodes.splice(e,0,t)},e.prototype.index=function(){if(!this.isDocument())return this.parent.indexOf(this)},e.prototype.isDocument=function(){return this.type===ft.Document},e.prototype.isBlock=function(){return this.type===ft.Block},e.prototype.isInline=function(){return this.type===ft.Inline},e.prototype.isText=function(){return this.type===ft.Text},e.prototype.nextSibling=function(){if(this.isDocument())return null;var t=this.index();return this.parent.nodes.length!==t+1?this.parent.nodes[t+1]:null},e.prototype.preSibling=function(){if(this.isDocument())return null;var t=this.index();return 0!==t?this.parent.nodes[t-1]:null},e.prototype.next=function(){if((arguments.length>0&&void 0!==arguments[0]?arguments[0]:gt.DepthFirst)===gt.DepthFirst){if(this.nodes.length)return this.nodes[0];for(var t,e=this;e;){if(t=e.nextSibling())return t;e=e.parent}return null}},e.prototype.pre=function(){if((arguments.length>0&&void 0!==arguments[0]?arguments[0]:gt.DepthFirst)===gt.DepthFirst){var t=this.preSibling();if(t){for(;t.nodes.length;)t=t.nodes[t.nodes.length-1];return t}return this.parent}},e.prototype.getDepth=function(){for(var t=0,e=this.parent;e;)t++,e=e.parent;return t},e.prototype.getLast=function(){for(var t=this;t.nodes&&t.nodes.length>0;)t=t.nodes[t.nodes.length-1];return t},e.prototype.getFirst=function(){for(var t=this;t.nodes&&t.nodes.length>0;)t=t.nodes[0];return t},e.prototype.getFirstText=function(){return this.isText()?this:this.deepFind(function(t){return t.isText()})},e.prototype.getLastText=function(){return this.isText()?this:this.deepFindLast(function(t){return t.isText()})},e.prototype.contains=function(t){var e=this;return!!t.closest(function(t){return t.equals(e)})},e.prototype.hasText=function(){return!!this.find(function(t){return t.isText()})},e.prototype.deepHasText=function(){return!!this.deepFind(function(t){return t.isText()})},e.prototype.hasInline=function(){return!!this.find(function(t){return t.isInline()})},e.prototype.hasBlock=function(){return!!this.find(function(t){return t.isBlock()})},e.prototype.equals=function(t){return t.id===this.id},e.prototype.isBefore=function(t){if(!t)return!1;var n=e.findCommonAncestor(this,t);return!!n&&n.deepIndexOf(this)<n.deepIndexOf(t)},e.prototype.isAfter=function(t){if(!t)return!1;var n=e.findCommonAncestor(this,t);return!!n&&n.deepIndexOf(this)>n.deepIndexOf(t)},e.prototype.closest=function(t){if(t(this,0))return this;for(var e=this.parent,n=1;e;){if(t(e,n))return e;e=e.parent,n++}},e.prototype.getPath=function(t){if(!t)return[];for(var e=t,n=[];e.parent&&e.id!==this.id;)n.push(e.index()),e=e.parent;return n.reverse()},e.prototype.updateParent=function(t){var e=this;this.parent=t,this.nodes.forEach(function(n){return n.updateParent(null===t?null:e)})},e.prototype.getLength=function(){return this.getText().length},e.prototype.getText=function(){return this.nodes.map(function(t){return t.getText()}).join("")},e}(Ct),It=function(t,e){return t===e||t!=t&&e!=e},Tt=function(t,e){for(var n=t.length;n--;)if(It(t[n][0],e))return n;return-1},Ot=Array.prototype.splice;function At(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var o=t[e];this.set(o[0],o[1])}}At.prototype.clear=function(){this.__data__=[],this.size=0},At.prototype.delete=function(t){var e=this.__data__,n=Tt(e,t);return!(n<0||(n==e.length-1?e.pop():Ot.call(e,n,1),--this.size,0))},At.prototype.get=function(t){var e=this.__data__,n=Tt(e,t);return n<0?void 0:e[n][1]},At.prototype.has=function(t){return Tt(this.__data__,t)>-1},At.prototype.set=function(t,e){var n=this.__data__,o=Tt(n,t);return o<0?(++this.size,n.push([t,e])):n[o][1]=e,this};var Nt,Dt=At,Bt=n(106),Rt=n(25),Lt=Rt.a["__core-js_shared__"],Pt=(Nt=/[^.]+$/.exec(Lt&&Lt.keys&&Lt.keys.IE_PROTO||""))?"Symbol(src)_1."+Nt:"",Mt=n(34),Ft=Function.prototype.toString,Ht=function(t){if(null!=t){try{return Ft.call(t)}catch(t){}try{return t+""}catch(t){}}return""},jt=/^\[object .+?Constructor\]$/,Vt=Function.prototype,Ut=Object.prototype,zt=Vt.toString,Gt=Ut.hasOwnProperty,Jt=RegExp("^"+zt.call(Gt).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Wt=function(t){return!(!Object(Mt.a)(t)||function(t){return!!Pt&&Pt in t}(t))&&(Object(Bt.a)(t)?Jt:jt).test(Ht(t))},$t=function(t,e){var n=function(t,e){return null==t?void 0:t[e]}(t,e);return Wt(n)?n:void 0},Kt=$t(Rt.a,"Map"),Yt=$t(Object,"create"),Xt=Object.prototype.hasOwnProperty,qt=Object.prototype.hasOwnProperty;function Qt(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var o=t[e];this.set(o[0],o[1])}}Qt.prototype.clear=function(){this.__data__=Yt?Yt(null):{},this.size=0},Qt.prototype.delete=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},Qt.prototype.get=function(t){var e=this.__data__;if(Yt){var n=e[t];return"__lodash_hash_undefined__"===n?void 0:n}return Xt.call(e,t)?e[t]:void 0},Qt.prototype.has=function(t){var e=this.__data__;return Yt?void 0!==e[t]:qt.call(e,t)},Qt.prototype.set=function(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=Yt&&void 0===e?"__lodash_hash_undefined__":e,this};var Zt=Qt,te=function(t,e){var n=t.__data__;return function(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t}(e)?n["string"==typeof e?"string":"hash"]:n.map};function ee(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var o=t[e];this.set(o[0],o[1])}}ee.prototype.clear=function(){this.size=0,this.__data__={hash:new Zt,map:new(Kt||Dt),string:new Zt}},ee.prototype.delete=function(t){var e=te(this,t).delete(t);return this.size-=e?1:0,e},ee.prototype.get=function(t){return te(this,t).get(t)},ee.prototype.has=function(t){return te(this,t).has(t)},ee.prototype.set=function(t,e){var n=te(this,t),o=n.size;return n.set(t,e),this.size+=n.size==o?0:1,this};var ne=ee;function oe(t){var e=this.__data__=new Dt(t);this.size=e.size}oe.prototype.clear=function(){this.__data__=new Dt,this.size=0},oe.prototype.delete=function(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n},oe.prototype.get=function(t){return this.__data__.get(t)},oe.prototype.has=function(t){return this.__data__.has(t)},oe.prototype.set=function(t,e){var n=this.__data__;if(n instanceof Dt){var o=n.__data__;if(!Kt||o.length<199)return o.push([t,e]),this.size=++n.size,this;n=this.__data__=new ne(o)}return n.set(t,e),this.size=n.size,this};var ie=oe,re=function(){try{var t=$t(Object,"defineProperty");return t({},"",{}),t}catch(t){}}(),ae=function(t,e,n){"__proto__"==e&&re?re(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n},se=Object.prototype.hasOwnProperty,le=function(t,e,n){var o=t[e];se.call(t,e)&&It(o,n)&&(void 0!==n||e in t)||ae(t,e,n)},ce=function(t,e,n,o){var i=!n;n||(n={});for(var r=-1,a=e.length;++r<a;){var s=e[r],l=o?o(n[s],t[s],s,n,t):void 0;void 0===l&&(l=t[s]),i?ae(n,s,l):le(n,s,l)}return n},ue=n(59),de=n(112),pe=n(74),he=Object.prototype.hasOwnProperty,fe=function(t){if(!Object(Mt.a)(t))return function(t){var e=[];if(null!=t)for(var n in Object(t))e.push(n);return e}(t);var e=Object(pe.a)(t),n=[];for(var o in t)("constructor"!=o||!e&&he.call(t,o))&&n.push(o);return n},ge=n(108),me=function(t){return Object(ge.a)(t)?Object(de.a)(t,!0):fe(t)},ye=n(353),ve=function(){return[]},_e=Object.prototype.propertyIsEnumerable,be=Object.getOwnPropertySymbols,Ce=be?function(t){return null==t?[]:(t=Object(t),function(t,e){for(var n=-1,o=null==t?0:t.length,i=0,r=[];++n<o;){var a=t[n];e(a,n,t)&&(r[i++]=a)}return r}(be(t),function(e){return _e.call(t,e)}))}:ve,ke=function(t,e){for(var n=-1,o=e.length,i=t.length;++n<o;)t[i+n]=e[n];return t},we=n(107),Se=Object(we.a)(Object.getPrototypeOf,Object),xe=Object.getOwnPropertySymbols?function(t){for(var e=[];t;)ke(e,Ce(t)),t=Se(t);return e}:ve,Ee=n(35),Ie=function(t,e,n){var o=e(t);return Object(Ee.a)(t)?o:ke(o,n(t))},Te=function(t){return Ie(t,ue.a,Ce)},Oe=function(t){return Ie(t,me,xe)},Ae=$t(Rt.a,"DataView"),Ne=$t(Rt.a,"Promise"),De=$t(Rt.a,"Set"),Be=$t(Rt.a,"WeakMap"),Re=n(31),Le=Ht(Ae),Pe=Ht(Kt),Me=Ht(Ne),Fe=Ht(De),He=Ht(Be),je=Re.a;(Ae&&"[object DataView]"!=je(new Ae(new ArrayBuffer(1)))||Kt&&"[object Map]"!=je(new Kt)||Ne&&"[object Promise]"!=je(Ne.resolve())||De&&"[object Set]"!=je(new De)||Be&&"[object WeakMap]"!=je(new Be))&&(je=function(t){var e=Object(Re.a)(t),n="[object Object]"==e?t.constructor:void 0,o=n?Ht(n):"";if(o)switch(o){case Le:return"[object DataView]";case Pe:return"[object Map]";case Me:return"[object Promise]";case Fe:return"[object Set]";case He:return"[object WeakMap]"}return e});var Ve=je,Ue=Object.prototype.hasOwnProperty,ze=Rt.a.Uint8Array,Ge=function(t){var e=new t.constructor(t.byteLength);return new ze(e).set(new ze(t)),e},Je=/\w*$/,We=n(30),$e=We.a?We.a.prototype:void 0,Ke=$e?$e.valueOf:void 0,Ye=function(t,e,n){var o=t.constructor;switch(e){case"[object ArrayBuffer]":return Ge(t);case"[object Boolean]":case"[object Date]":return new o(+t);case"[object DataView]":return function(t,e){var n=e?Ge(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.byteLength)}(t,n);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return function(t,e){var n=e?Ge(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.length)}(t,n);case"[object Map]":return new o;case"[object Number]":case"[object String]":return new o(t);case"[object RegExp]":return function(t){var e=new t.constructor(t.source,Je.exec(t));return e.lastIndex=t.lastIndex,e}(t);case"[object Set]":return new o;case"[object Symbol]":return function(t){return Ke?Object(Ke.call(t)):{}}(t)}},Xe=Object.create,qe=function(){function t(){}return function(e){if(!Object(Mt.a)(e))return{};if(Xe)return Xe(e);t.prototype=e;var n=new t;return t.prototype=void 0,n}}(),Qe=n(73),Ze=n(26),tn=n(75),en=n(57),nn=en.a&&en.a.isMap,on=nn?Object(tn.a)(nn):function(t){return Object(Ze.a)(t)&&"[object Map]"==Ve(t)},rn=en.a&&en.a.isSet,an=rn?Object(tn.a)(rn):function(t){return Object(Ze.a)(t)&&"[object Set]"==Ve(t)},sn={};sn["[object Arguments]"]=sn["[object Array]"]=sn["[object ArrayBuffer]"]=sn["[object DataView]"]=sn["[object Boolean]"]=sn["[object Date]"]=sn["[object Float32Array]"]=sn["[object Float64Array]"]=sn["[object Int8Array]"]=sn["[object Int16Array]"]=sn["[object Int32Array]"]=sn["[object Map]"]=sn["[object Number]"]=sn["[object Object]"]=sn["[object RegExp]"]=sn["[object Set]"]=sn["[object String]"]=sn["[object Symbol]"]=sn["[object Uint8Array]"]=sn["[object Uint8ClampedArray]"]=sn["[object Uint16Array]"]=sn["[object Uint32Array]"]=!0,sn["[object Error]"]=sn["[object Function]"]=sn["[object WeakMap]"]=!1;var ln,cn=function t(e,n,o,i,r,a){var s,l=1&n,c=2&n,u=4&n;if(o&&(s=r?o(e,i,r,a):o(e)),void 0!==s)return s;if(!Object(Mt.a)(e))return e;var d=Object(Ee.a)(e);if(d){if(s=function(t){var e=t.length,n=new t.constructor(e);return e&&"string"==typeof t[0]&&Ue.call(t,"index")&&(n.index=t.index,n.input=t.input),n}(e),!l)return function(t,e){var n=-1,o=t.length;for(e||(e=Array(o));++n<o;)e[n]=t[n];return e}(e,s)}else{var p=Ve(e),h="[object Function]"==p||"[object GeneratorFunction]"==p;if(Object(Qe.a)(e))return Object(ye.a)(e,l);if("[object Object]"==p||"[object Arguments]"==p||h&&!r){if(s=c||h?{}:function(t){return"function"!=typeof t.constructor||Object(pe.a)(t)?{}:qe(Se(t))}(e),!l)return c?function(t,e){return ce(t,xe(t),e)}(e,function(t,e){return t&&ce(e,me(e),t)}(s,e)):function(t,e){return ce(t,Ce(t),e)}(e,function(t,e){return t&&ce(e,Object(ue.a)(e),t)}(s,e))}else{if(!sn[p])return r?e:{};s=Ye(e,p,l)}}a||(a=new ie);var f=a.get(e);if(f)return f;a.set(e,s),an(e)?e.forEach(function(i){s.add(t(i,n,o,i,e,a))}):on(e)&&e.forEach(function(i,r){s.set(r,t(i,n,o,r,e,a))});var g=u?c?Oe:Te:c?keysIn:ue.a,m=d?void 0:g(e);return function(t,e){for(var n=-1,o=null==t?0:t.length;++n<o&&!1!==e(t[n],n,t););}(m||e,function(i,r){m&&(i=e[r=i]),le(s,r,t(i,n,o,r,e,a))}),s},un=function(t){return cn(t,5)};function dn(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,o)}return n}function pn(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?dn(Object(n),!0).forEach(function(e){hn(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):dn(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function hn(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var fn=function(t){function e(e){var n=t.call(this,e)||this,o=e.name,i=e.type,r=e.data,a=void 0===r?{}:r,s=e.state,l=void 0===s?{}:s,c=e.nodes,u=void 0===c?[]:c;return n.name=o,n.data=a,n.state=l,n.type=i,n.nodes=u,n}return s(e,t),e.fromJSON=function(n){var o=n.name,i=n.type,r=n.data,a=void 0===r?{}:r,s=n.nodes,l=void 0===s?[]:s,c=n.state,u=void 0===c?{}:c;return new e(Object.assign(t.fromJSON.call(this,n),{name:o,type:i,data:a,state:u,nodes:l.map(function(t){return Fn(t)})}))},e.prototype.toJSON=function(e,n){var o=Object.assign(t.prototype.toJSON.call(this,e),{type:this.type,name:this.name,data:un(this.data),nodes:this.nodes.map(function(t){return t.toJSON(e)})});return n&&(o.state=un(this.state)),o},e.prototype.setBlockProp=function(t,e){return t?_t(this,function(n){n[t]=e}):this},e.prototype.split=function(t,n){var o=this.nodes.slice(0,t),i=this.nodes.slice(t);return o.length?i.length?[e.fromJSON(pn({},this.toJSON(),{nodes:o})),e.fromJSON(pn({},this.toJSON(),{id:n||wt(),nodes:i}))]:[e.fromJSON(this.toJSON()),null]:[null,e.fromJSON(pn({},this.toJSON(),{id:n||wt()}))]},e.prototype.merge=function(t){return t.type===this.type&&(this.nodes=this.nodes.concat(t.nodes),!0)},e}(Et),gn=function(t){function e(e){var n=t.call(this)||this,o=e.value,i=void 0===o?"":o,r=e.type;return n.type=r,n.value=i,n}return s(e,t),e.fromJSON=function(t){if("string"==typeof t)return new e({type:t,value:""});var n=t.value,o=void 0===n?"":n,i=t.type;return new e({type:i,value:o})},e.prototype.toJSON=function(){var t={type:this.type};return this.value&&Object.assign(t,{value:this.value}),t},e.prototype.copy=function(){return new e(this)},e.prototype.equals=function(t){return this.type===t.type&&this.value===t.value},e}(Ct);function mn(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,o)}return n}function yn(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?mn(Object(n),!0).forEach(function(e){vn(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):mn(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function vn(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var _n=function(t){function e(e){return t.call(this,yn({},e,{name:"",type:ft.Document}))||this}return s(e,t),e.fromJSON=function(n){var o=n.nodes,i=void 0===o?[]:o,r=new e(Object.assign(t.fromJSON.call(this,n),{nodes:i.map(function(t){return Fn(t)})}));return r.updateParent(),r},e.prototype.toJSON=function(e,n){var o=t.prototype.toJSON.call(this,e);return delete o.name,yn({},o,{nodes:this.nodes.map(function(t){return t.toJSON(e,n)})})},e.prototype.merge=function(t){throw Error("document cannot merge other node!")},e.prototype.split=function(t,e){throw Error("document cannot split!")},e}(fn);function bn(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,o)}return n}function Cn(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var kn=function(t){function e(e){var n=this;return(n=t.call(this,function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?bn(Object(n),!0).forEach(function(e){Cn(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):bn(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}({},JSON.parse(JSON.stringify(e)),{nodes:[]}))||this).props=e,n}return s(e,t),e.fromJSON=function(t){return new e(t)},e.prototype.toJSON=function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=un(this.props);return!t&&e.id&&delete e.id,e},e}(fn);function wn(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}var Sn=function(t){function e(e){var n=t.call(this)||this,o=e.text,i=void 0===o?"":o,r=e.marks,a=void 0===r?[]:r;return n.text=i,n.marks=a,n}return s(e,t),e.createEmptyLeaf=function(){return new e({text:""})},e.marksEqual=function(t,e){if(t.length!==e.length)return!1;for(var n=function(t){if(e.findIndex(function(e){return t.equals(e)})<0)return{value:!1}},o=0,i=t;o<i.length;o++){var r=i[o],a=n(r);if("object"==typeof a)return a.value}return!0},e.marksCopy=function(t){return t.map(function(t){return t.copy()})},e.marksIntersect=function(t,e){for(var n=[],o=function(t){var o=e.find(function(e){return t.equals(e)});o&&n.push(o)},i=0,r=t;i<r.length;i++){var a=r[i];o(a)}return n},e.marksUnion=function(t,e){for(var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=function(t){return function(t){if(Array.isArray(t))return wn(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return wn(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?wn(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(t),i=function(t){var e=o.findIndex(function(e){return n?e.type===t.type:e.equals(t)});e<0?o.push(t):n&&(o[e].value=t.value)},r=0,a=e;r<a.length;r++){var s=a[r];i(s)}return o},e.marksDiffer=function(t,e){for(var n=[],o=function(t){e.find(function(e){return t.equals(e)})||n.push(t)},i=0,r=t;i<r.length;i++){var a=r[i];o(a)}for(var s=function(e){t.find(function(t){return t.equals(e)})||n.push(e)},l=0,c=e;l<c.length;l++){var u=c[l];s(u)}return n},e.mergeLeaves=function(t){if(t.length<=1)return t;var e=!1,n=t.reduce(function(t,n){if(t.length>0){var o=t[t.length-1];if(o.shouldMerge(n))return e=!0,o.text+=n.text,t;if(""===o.text)return e=!0,t[t.length-1]=n,t;if(""===n.text)return e=!0,t}return t.push(n),t},[]);return e?n:t},e.splitLeaves=function(t,n){if(n<0)return[[],t];if(0===t.length)return[[],[]];var o,i,r=0,a=-1;return t.find(function(t){a++;var s=r,l=t.text;if((r+=l.length)<n)return!1;if(s>n)return!1;var c=n-s;return o=new e({marks:e.marksCopy(t.marks),text:l.slice(0,c)}),i=new e({marks:e.marksCopy(t.marks),text:l.slice(c)}),!0}),o?""===o.text?0===a?[[o],t]:[t.slice(0,a),t.slice(a)]:""===i.text?a===t.length-1?[t,[i]]:[t.slice(0,a+1),t.slice(a+1)]:[t.slice(0,a).concat([o]),[i].concat(t.slice(a+1))]:[t,[]]},e.fromJSON=function(t){var n=t.text,o=t.marks,i=void 0===o?[]:o;return new e({text:n,marks:i.map(function(t){return gn.fromJSON(t)})})},e.prototype.toJSON=function(){return{text:this.text,marks:this.marks.map(function(t){return t.toJSON()})}},e.prototype.shouldMerge=function(t){return e.marksEqual(this.marks,t.marks)},e.prototype.addMark=function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.marks.findIndex(function(e){return e.type===t.type});return n<0?this.marks.push(t):e&&(this.marks[n]=t),this},e.prototype.addMarks=function(t){var e=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];t.forEach(function(t){e.addMark(t,n)})},e.prototype.removeMark=function(t){var e=t instanceof gn?this.marks.findIndex(function(e){return e.equals(t)}):this.marks.findIndex(function(e){return e.type===t});if(!(e<0)){var n=this.marks[e];return this.marks.splice(e,1),n}},e.prototype.hasMark=function(t){return!!t&&this.marks.some(function(e){return e.equals(t)})},e.prototype.getMarkOfType=function(t){return this.marks.find(function(e){return e.type===t})},e.prototype.copy=function(){return e.fromJSON(this)},e}(Ct);function xn(t){return function(t){if(Array.isArray(t))return En(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return En(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?En(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function En(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}var In=function(t){function e(e){var n=this;(n=t.call(this,e)||this).type=ft.Text,n.nodes=[],n.leaves=[];var o=e.leaves,i=void 0===o?[]:o;return n.setLeaves(i),n}return s(e,t),e.fromJSON=function(n){var o=n.leaves,i=void 0===o?[]:o;return new e(Object.assign(t.fromJSON.call(this,n),{leaves:i.map(function(t){return Sn.fromJSON(t)})}))},e.prototype.toJSON=function(e){return Object.assign(t.prototype.toJSON.call(this,e),{type:this.type,leaves:this.leaves.map(function(t){return t.toJSON()})})},e.prototype.copy=function(){return e.fromJSON(this.toJSON())},e.prototype.getText=function(){return this.leaves.reduce(function(t,e){return t+e.text},"")},e.prototype.setLeaves=function(t){0!==(t=Sn.mergeLeaves(t)).length?this.leaves=t:this.leaves=[Sn.createEmptyLeaf()]},e.prototype.insertText=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(""!==this.getText()){if(0!==e.length){t=this.normalizeOffset(t);var o=this.searchLeafAtOffset(t),i=o.startOffset,r=o.leaf,a=o.index,s=t-i,l=r.text.slice(0,s),c=r.text.slice(s);if(Sn.marksEqual(n,r.marks))r.text=l+e+c;else{var u=this.leaves,d=[l?new Sn({text:l,marks:r.marks}):null,new Sn({text:e,marks:n}),c?new Sn({text:c,marks:r.marks}):null].filter(Boolean);u.splice.apply(u,[a,1].concat(xn(d))),this.setLeaves(u)}}}else this.setLeaves([new Sn({text:e,marks:n})])},e.prototype.removeText=function(t,e){if(!(e<=0||t>=this.getText().length||t<0)){if(1===e){var n=this.searchLeafAtOffset(t+1),o=n.leaf,i=n.startOffset,r=n.index,a=t-i;if(o){if(1===o.text.length&&1!==this.leaves.length)return this.leaves.splice(r,1),void this.setLeaves(this.leaves);var s=o.text.slice(0,a)+o.text.slice(a+e);return void this.leaves.splice(r,1,new Sn({text:s,marks:o.marks}))}}var l=Sn.splitLeaves(this.leaves,t),c=l[0],u=l[1],d=Sn.splitLeaves(u,e),p=(d[0],d[1]),h=Sn.mergeLeaves(c.concat(p));this.leaves=h}},e.prototype.addMark=function(t,e,n){var o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return this.addMarks(t,e,[n],o)},e.prototype.addMarks=function(t,e,n){var o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=this.getText();if(""===i&&0===e&&0===t)return 0===this.leaves.length?void(this.leaves=[new Sn({text:"",marks:n})]):void this.leaves[0].addMarks(n,o);if(!(""===i||0===e||t>=i.length||t<0)){var r=Sn.splitLeaves(this.leaves,t),a=r[0],s=r[1],l=Sn.splitLeaves(s,e),c=l[0],u=l[1];c.forEach(function(t){return t.addMarks(n,o)});var d=a.concat(c,u);this.setLeaves(d)}},e.prototype.removeMark=function(t,e,n){var o=this.getText();if(""!==o||0!==t||0!==e){if(!(0===this.leaves.length||0===e||t>=o.length||t<0)){var i=Sn.splitLeaves(this.leaves,t),r=i[0],a=i[1],s=Sn.splitLeaves(a,e),l=s[0],c=s[1];l.forEach(function(t){return t.removeMark(n)});var u=r.concat(l,c);this.setLeaves(u)}}else 0!==this.leaves.length&&this.leaves[0].removeMark(n)},e.prototype.mergeDecorations=function(t){var e=this;if(!t||!t.length)return this.leaves;var n=this.leaves.map(function(t){return t.copy()}),o=this.getText();return t.forEach(function(t){var i=t.getRange(),r=i.getStart(),a=i.getEnd(),s=t.getMark(),l=r.nodeId===e.id,c=a.nodeId===e.id;if(l&&c){var u=i.getStartOffset(),d=i.getEndOffset()-u;if(d<1)return;if(u>=o.length)return;if(0!==u||d<o.length){var p=Sn.splitLeaves(n,u),h=p[0],f=p[1],g=Sn.splitLeaves(f,d),m=g[0],y=g[1];return void(n=h.concat(m.map(function(t){return t.addMark(s)}),y).filter(function(t){return!!t.text}))}}n=n.map(function(t){return t.addMark(s)})}),Sn.mergeLeaves(n)},e.prototype.getAllMarksBetweenOffsets=function(t,e){return t=this.normalizeOffset(t),e=this.normalizeOffset(e),t<=0&&e>=this.getLength()?this.getAllMarks():t>e?[]:""===this.getText()?this.getActiveMarks():this.searchLeavesBetweenOffsets(t,e).reduce(function(t,e){return Sn.marksUnion(t,e.marks)},[])},e.prototype.getActiveMarksBetweenOffsets=function(t,e){return t=this.normalizeOffset(t),e=this.normalizeOffset(e),t<=0&&e>=this.getLength()?this.getActiveMarks():t>e?[]:""===this.getText()?this.getActiveMarks():this.searchLeavesBetweenOffsets(t,e).reduce(function(t,e){return e?t?Sn.marksIntersect(t,e.marks):xn(e.marks):[]},null)},e.prototype.split=function(t,n){var o=Sn.splitLeaves(this.leaves,t),i=o[0],r=o[1];return[new e({id:this.id,leaves:i}),new e({id:n||wt(),leaves:r})]},e.prototype.slice=function(t,n){var o=Sn.splitLeaves(this.leaves,t),i=(o[0],o[1]),r=Sn.splitLeaves(i,n-t),a=r[0];return r[1],new e({leaves:a})},e.prototype.merge=function(t){if(!t.isText())return!1;var e=this.leaves.concat(t.leaves);return this.setLeaves(e),!0},e.prototype.searchLeavesBetweenOffsets=function(t,e){if(t===e){var n=this.searchLeafAtOffset(t).leaf;return[n]}var o=this.searchLeafAtOffset(t),i=o.index,r=o.endOffset,a=this.searchLeafAtOffset(e),s=a.index,l=a.startOffset,c=i,u=s;return t===r&&c++,l===e&&u--,this.leaves.slice(c,u+1)},e.prototype.searchLeafAtOffset=function(t){var e=0,n=0,o=-1;return{leaf:this.leaves.find(function(i){return o++,(e=(n=e)+i.text.length)>=t}),endOffset:e,index:o,startOffset:n}},e.prototype.searchOffsetOfLeaf=function(t){var e=this.leaves.indexOf(t);return this.leaves.slice(0,e).reduce(function(t,e){return t+e.text.length},0)},e.prototype.getActiveMarks=function(){return 0===this.leaves.length?[]:0===this.leaves[0].marks.length?[]:this.leaves.reduce(function(t,e){return e?t?Sn.marksIntersect(t,e.marks):xn(e.marks):[]},null)},e.prototype.getAllMarks=function(){return 0===this.leaves.length?[]:1===this.leaves.length?xn(this.leaves[0].marks):this.leaves.reduce(function(t,e){return Sn.marksUnion(t,e.marks)},[])},e.prototype.normalizeOffset=function(t){return t=Math.max(t,0),t=Math.min(t,this.getLength())},e}(Et);!function(t){t.focusable="focused"}(ln||(ln={}));var Tn=function(){function t(){}return t.isFocusable=function(e){return An(e,t.focusable)},t.isAtomic=function(e){return An(e,t.atomic)},t.isDependency=function(e){return An(e,t.depend)},t.isDefaults=function(e){return An(e,t.defaults)},t.isUndraggable=function(e){return An(e,t.undraggable)},t.isUndroppable=function(e){return e.closest(function(e){return An(e,t.undroppable)})},t.isContainer=function(e){return An(e,t.container)},t}();Tn.focusable="focusable",Tn.atomic="atomic",Tn.defaults="defaults",Tn.undraggable="undraggable",Tn.undroppable="undroppable",Tn.depend="depend",Tn.container="container";var On,An=function(t,e){if(!t||!e)return!1;var n=ir.getComponent(t.name);return n&&n[e]};function Nn(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,o)}return n}function Dn(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}!function(t){t[t.LineStart=0]="LineStart",t[t.LineEnd=1]="LineEnd",t[t.LineCenter=2]="LineCenter"}(On||(On={}));var Bn=function(){function t(t){this.data={};var e=t.range,n=t.marks,o=t.data,i=t.position;this.range=e,this.marks=n||this.getActiveMarks(),this.position=i,o&&(this.data=o)}return t.emptySelection=function(){return new t({})},t.fromJSON=function(e){var n=e.range,o=e.marks,i=e.data;return new t(n?{range:sr.fromJSON(n),marks:o,data:i}:{})},t.prototype.toJSON=function(){return this.isEmpty()?{}:{range:this.range.toJSON(),marks:this.marks.map(function(t){return t.toJSON()}),data:un(this.data),position:this.position}},t.prototype.isEmpty=function(){return!this.range},t.prototype.isCollapsed=function(){return!this.isEmpty()&&this.range.isCollapsed()},t.prototype.setData=function(t,e){var n;this.data=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Nn(Object(n),!0).forEach(function(e){Dn(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Nn(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}({},this.data,((n={})[t]=e,n))},t.prototype.getData=function(t){return t?this.data[t]:this.data},t.prototype.removeData=function(t){this.getData(t)&&delete this.data[t]},t.prototype.getActiveMarks=function(){return this.isEmpty()?[]:this.range.getActiveMarks()},t.prototype.getAllMarks=function(){return this.isEmpty()?[]:this.range.getAllMarks()},t.prototype.getMarks=function(){return Sn.marksUnion(this.marks,this.getActiveMarks())},t.prototype.addMarks=function(t){this.marks=Sn.marksUnion(this.getMarks(),t,!0)},t.prototype.deleteMarks=function(t){var e=t.map(function(t){return gn.fromJSON(t)});this.marks=this.getMarks().filter(function(t){return!e.some(function(e){return e.type===t.type})})},t.prototype.copy=function(){var e;return new t({range:null===(e=this.range)||void 0===e?void 0:e.copy(),marks:this.marks.map(function(t){return t.copy()}),data:un(this.data),position:this.position})},t}();function Rn(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,o)}return n}function Ln(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var Pn=function(t){function e(e){var n=t.call(this)||this,o=e.document,i=e.readonly,r=void 0!==i&&i,a=e.selection,s=void 0===a?Bn.emptySelection():a,l=e.decorations,c=void 0===l?[]:l,u=e.data,d=void 0===u?{}:u;return n.document=o,n.selection=s,n.decorations=c,n.readonly=r,n.data=d,n}return s(e,t),e.fromJSON=function(t){return new e(t)},e.prototype.toJSON=function(){return{document:this.document.toJSON(),selection:this.selection.toJSON(),decorations:this.decorations.map(function(t){return t.toJSON()}),data:un(this.data)}},e.prototype.setProps=function(t){return new e(function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Rn(Object(n),!0).forEach(function(e){Ln(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Rn(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}({},this,{},t))},e.prototype.setBlockProp=function(t,e,n){var o=bt(this,function(o){var i=o.document.findNodeById(t);i&&!i.isText()&&(i[e]=n)});return o.document.updateParent(),o},e.prototype.insertNode=function(t,e,n){t.updateParent(null);var o=bt(this,function(o){var i=o.document.findNodeById(e);t&&i&&i.insert(t,n)});return o.document.updateParent(),o},e.prototype.insertText=function(t,e,n,o){var i=bt(this,function(i){var r=i.document.findNodeById(t);r&&r.isText()&&r.insertText(e,n,o)});return i.document.updateParent(),i},e.prototype.addMark=function(t,e,n,o){var i=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],r=bt(this,function(r){var a=r.document.findNodeById(t);a&&a.isText()&&a.addMark(e,n,o,i)});return r.document.updateParent(),r},e.prototype.removeNode=function(t,e){var n=bt(this,function(n){var o=n.document.findNodeById(t);o&&o.remove(e)});return n.document.updateParent(),n},e.prototype.removeText=function(t,e,n){var o=bt(this,function(o){var i=o.document.findNodeById(t);i&&i.isText()&&i.removeText(e,n)});return o.document.updateParent(),o},e.prototype.removeMark=function(t,e,n,o){var i=bt(this,function(i){var r=i.document.findNodeById(t);r&&r.isText()&&r.removeMark(e,n,o)});return i.document.updateParent(),i},e.prototype.splitNode=function(t,e,n){var o=bt(this,function(o){var i=o.document.findNodeById(t),r=o.document.findNodeById(i.parent.id);if(i&&r){var a=i.split(e,n),s=a[0],l=a[1];l&&(r.remove(i.index()),s?(r.insert(s,i.index()),r.insert(l,i.index()+1)):r.insert(l,i.index()))}});return o.document.updateParent(),o},e.prototype.mergeNode=function(t){var e=bt(this,function(e){var n=e.document.findNodeById(t),o=n.nextSibling(),i=e.document.findNodeById(n.parent.id);n&&o&&n.merge(o)&&i.remove(o.index())});return e.document.updateParent(),e},e.prototype.getFragmentByRange=function(t){if(!t)return[];var e=t.getStartNode(),n=t.getEndNode();if(t.isCollapsed())return e.isBlock()?[e.toJSON(!1)]:[];var o=this,i=Et.findCommonAncestor(e,n);(i=i.closest(function(t){return Tn.isContainer(t)}))||(i=o.document);for(var r=t.getEndOffset();n.id!==i.id;)o=o.splitNode(n.id,r),r=n.index()+1,n=n.parent;for(var a=t.getStartOffset(),s=!0;e.id!==i.id;)o=o.splitNode(e.id,a),Tn.isFocusable(e)&&Tn.isUndroppable(e)?(a=e.index(),s=!1):(a=e.index()+1,s=!0),e=e.parent;return i=o.document.findNodeById(i.id),this.document.updateParent(),i.nodes.slice(a,s?r+1:r).map(function(t){return t.isBlock()?t.toJSON(!1,!0):t.toJSON(!1)})},e}(Ct),Mn=Object.values(ft).filter(function(t){return t!==ft.Unknown}),Fn=function(t){if(function(t){if(t.type===ft.Block){var e=ir.getComponent(t.name);return!e||e.blockName===ft.Unknown}return!Mn.includes(t.type)}(t))return kn.fromJSON(t);switch(t.type){case ft.Document:return _n.fromJSON(t);case ft.Text:return In.fromJSON(t);default:return fn.fromJSON(t)}},Hn=function(){};function jn(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}var Vn=function(t){function e(){var e=this;return(e=t.apply(this,arguments)||this).commands=[],e}return s(e,t),e.prototype.execute=function(){},e.prototype.undo=function(){var t;(t=this.commands,function(t){if(Array.isArray(t))return jn(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return jn(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?jn(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()).reverse().forEach(function(t){t.undo()})},e.prototype.redo=function(){this.commands.forEach(function(t){t.redo()})},e.prototype.getSelectionBefore=function(){return this.selectionBefore},e.prototype.getSelectionAfter=function(){return this.selectionAfter},e.prototype.setSelectionBefore=function(t){this.selectionBefore=t},e.prototype.setSelectionAfter=function(t){this.selectionAfter=t},e.prototype.pushCommand=function(t){this.commands.push(t)},e.prototype.hasSubCommands=function(){return this.commands.length>0},e}(Hn),Un=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.setOperationClasses=function(t){e.operationClasses=t},e.prototype.execute=function(){return this.apply()},e.prototype.undo=function(){this.revert()},e.prototype.redo=function(){this.apply()},e.prototype.applyOperation=function(t,n){var o=e.operationClasses[t];ir.setValue(new o(n).apply(ir.getValue()))},e}(Hn);Un.operationClasses=[];var zn=Un,Gn=function(){function t(){this.commandStack=[]}return t.prototype.push=function(t){this.commandStack.push(t)},t.prototype.pop=function(){return this.commandStack.pop()},t.prototype.executing=function(){return this.commandStack.length>0},t.prototype.current=function(){return this.executing()?this.commandStack[this.commandStack.length-1]:null},t.prototype.root=function(){return this.executing()?this.commandStack[0]:null},t}();function Jn(t){var e=-1,n=null==t?0:t.length;for(this.__data__=new ne;++e<n;)this.add(t[e])}Gn=function(t,e,n,o){var i,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(r<3?i(a):r>3?i(e,n,a):i(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a}([O()],Gn),Jn.prototype.add=Jn.prototype.push=function(t){return this.__data__.set(t,"__lodash_hash_undefined__"),this},Jn.prototype.has=function(t){return this.__data__.has(t)};var Wn=Jn,$n=function(t,e){for(var n=-1,o=null==t?0:t.length;++n<o;)if(e(t[n],n,t))return!0;return!1},Kn=function(t,e){return t.has(e)},Yn=function(t,e,n,o,i,r){var a=1&n,s=t.length,l=e.length;if(s!=l&&!(a&&l>s))return!1;var c=r.get(t);if(c&&r.get(e))return c==e;var u=-1,d=!0,p=2&n?new Wn:void 0;for(r.set(t,e),r.set(e,t);++u<s;){var h=t[u],f=e[u];if(o)var g=a?o(f,h,u,e,t,r):o(h,f,u,t,e,r);if(void 0!==g){if(g)continue;d=!1;break}if(p){if(!$n(e,function(t,e){if(!Kn(p,e)&&(h===t||i(h,t,n,o,r)))return p.push(e)})){d=!1;break}}else if(h!==f&&!i(h,f,n,o,r)){d=!1;break}}return r.delete(t),r.delete(e),d},Xn=function(t){var e=-1,n=Array(t.size);return t.forEach(function(t,o){n[++e]=[o,t]}),n},qn=function(t){var e=-1,n=Array(t.size);return t.forEach(function(t){n[++e]=t}),n},Qn=We.a?We.a.prototype:void 0,Zn=Qn?Qn.valueOf:void 0,to=Object.prototype.hasOwnProperty,eo=n(111),no=Object.prototype.hasOwnProperty,oo=function(t,e,n,o,i,r){var a=Object(Ee.a)(t),s=Object(Ee.a)(e),l=a?"[object Array]":Ve(t),c=s?"[object Array]":Ve(e),u="[object Object]"==(l="[object Arguments]"==l?"[object Object]":l),d="[object Object]"==(c="[object Arguments]"==c?"[object Object]":c),p=l==c;if(p&&Object(Qe.a)(t)){if(!Object(Qe.a)(e))return!1;a=!0,u=!1}if(p&&!u)return r||(r=new ie),a||Object(eo.a)(t)?Yn(t,e,n,o,i,r):function(t,e,n,o,i,r,a){switch(n){case"[object DataView]":if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case"[object ArrayBuffer]":return!(t.byteLength!=e.byteLength||!r(new ze(t),new ze(e)));case"[object Boolean]":case"[object Date]":case"[object Number]":return It(+t,+e);case"[object Error]":return t.name==e.name&&t.message==e.message;case"[object RegExp]":case"[object String]":return t==e+"";case"[object Map]":var s=Xn;case"[object Set]":var l=1&o;if(s||(s=qn),t.size!=e.size&&!l)return!1;var c=a.get(t);if(c)return c==e;o|=2,a.set(t,e);var u=Yn(s(t),s(e),o,i,r,a);return a.delete(t),u;case"[object Symbol]":if(Zn)return Zn.call(t)==Zn.call(e)}return!1}(t,e,l,n,o,i,r);if(!(1&n)){var h=u&&no.call(t,"__wrapped__"),f=d&&no.call(e,"__wrapped__");if(h||f){var g=h?t.value():t,m=f?e.value():e;return r||(r=new ie),i(g,m,n,o,r)}}return!!p&&(r||(r=new ie),function(t,e,n,o,i,r){var a=1&n,s=Te(t),l=s.length;if(l!=Te(e).length&&!a)return!1;for(var c=l;c--;){var u=s[c];if(!(a?u in e:to.call(e,u)))return!1}var d=r.get(t);if(d&&r.get(e))return d==e;var p=!0;r.set(t,e),r.set(e,t);for(var h=a;++c<l;){var f=t[u=s[c]],g=e[u];if(o)var m=a?o(g,f,u,e,t,r):o(f,g,u,t,e,r);if(!(void 0===m?f===g||i(f,g,n,o,r):m)){p=!1;break}h||(h="constructor"==u)}if(p&&!h){var y=t.constructor,v=e.constructor;y==v||!("constructor"in t)||!("constructor"in e)||"function"==typeof y&&y instanceof y&&"function"==typeof v&&v instanceof v||(p=!1)}return r.delete(t),r.delete(e),p}(t,e,n,o,i,r))},io=function t(e,n,o,i,r){return e===n||(null==e||null==n||!Object(Ze.a)(e)&&!Object(Ze.a)(n)?e!=e&&n!=n:oo(e,n,o,i,t,r))},ro=function(t){return t==t&&!Object(Mt.a)(t)},ao=function(t,e){return function(n){return null!=n&&n[t]===e&&(void 0!==e||t in Object(n))}},so=function(t){var e=function(t){for(var e=Object(ue.a)(t),n=e.length;n--;){var o=e[n],i=t[o];e[n]=[o,i,ro(i)]}return e}(t);return 1==e.length&&e[0][2]?ao(e[0][0],e[0][1]):function(n){return n===t||function(t,e,n,o){var i=n.length,r=i,a=!o;if(null==t)return!r;for(t=Object(t);i--;){var s=n[i];if(a&&s[2]?s[1]!==t[s[0]]:!(s[0]in t))return!1}for(;++i<r;){var l=(s=n[i])[0],c=t[l],u=s[1];if(a&&s[2]){if(void 0===c&&!(l in t))return!1}else{var d=new ie;if(o)var p=o(c,u,l,t,e,d);if(!(void 0===p?io(u,c,3,o,d):p))return!1}}return!0}(n,t,e)}},lo=function(t){return"symbol"==typeof t||Object(Ze.a)(t)&&"[object Symbol]"==Object(Re.a)(t)},co=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,uo=/^\w*$/,po=function(t,e){if(Object(Ee.a)(t))return!1;var n=typeof t;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=t&&!lo(t))||uo.test(t)||!co.test(t)||null!=e&&t in Object(e)};function ho(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new TypeError("Expected a function");var n=function(){var o=arguments,i=e?e.apply(this,o):o[0],r=n.cache;if(r.has(i))return r.get(i);var a=t.apply(this,o);return n.cache=r.set(i,a)||r,a};return n.cache=new(ho.Cache||ne),n}ho.Cache=ne;var fo=ho,go=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,mo=/\\(\\)?/g,yo=function(t){var e=fo(function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(go,function(t,n,o,i){e.push(o?i.replace(mo,"$1"):n||t)}),e},function(t){return 500===n.size&&n.clear(),t}),n=e.cache;return e}(),vo=We.a?We.a.prototype:void 0,_o=vo?vo.toString:void 0,bo=function t(e){if("string"==typeof e)return e;if(Object(Ee.a)(e))return function(t,e){for(var n=-1,o=null==t?0:t.length,i=Array(o);++n<o;)i[n]=e(t[n],n,t);return i}(e,t)+"";if(lo(e))return _o?_o.call(e):"";var n=e+"";return"0"==n&&1/e==-1/0?"-0":n},Co=function(t){return null==t?"":bo(t)},ko=function(t,e){return Object(Ee.a)(t)?t:po(t,e)?[t]:yo(Co(t))},wo=function(t){if("string"==typeof t||lo(t))return t;var e=t+"";return"0"==e&&1/t==-1/0?"-0":e},So=function(t,e){for(var n=0,o=(e=ko(e,t)).length;null!=t&&n<o;)t=t[wo(e[n++])];return n&&n==o?t:void 0},xo=function(t,e){return null!=t&&e in Object(t)},Eo=n(110),Io=n(76),To=n(58),Oo=function(t,e){return null!=t&&function(t,e,n){for(var o=-1,i=(e=ko(e,t)).length,r=!1;++o<i;){var a=wo(e[o]);if(!(r=null!=t&&n(t,a)))break;t=t[a]}return r||++o!=i?r:!!(i=null==t?0:t.length)&&Object(To.a)(i)&&Object(Io.a)(a,i)&&(Object(Ee.a)(t)||Object(Eo.a)(t))}(t,e,xo)},Ao=function(t,e){return po(t)&&ro(e)?ao(wo(t),e):function(n){var o=function(t,e,n){var o=null==t?void 0:So(t,e);return void 0===o?n:o}(n,t);return void 0===o&&o===e?Oo(n,t):io(e,o,3)}},No=n(109),Do=function(t){return po(t)?function(t){return function(e){return null==e?void 0:e[t]}}(wo(t)):function(t){return function(e){return So(e,t)}}(t)},Bo=function(t,e,n){var o=-1,i=t.length;e<0&&(e=-e>i?0:i+e),(n=n>i?i:n)<0&&(n+=i),i=e>n?0:n-e>>>0,e>>>=0;for(var r=Array(i);++o<i;)r[o]=t[o+e];return r},Ro=function(t,e){return e=ko(e,t),null==(t=function(t,e){return e.length<2?t:So(t,Bo(e,0,-1))}(t,e))||delete t[wo(function(t){var e=null==t?0:t.length;return e?t[e-1]:void 0}(e))]},Lo=Array.prototype.splice,Po=function(t,e){var n=[];if(!t||!t.length)return n;var o=-1,i=[],r=t.length;for(e=function(t){return"function"==typeof t?t:null==t?No.a:"object"==typeof t?Object(Ee.a)(t)?Ao(t[0],t[1]):so(t):Do(t)}(e);++o<r;){var a=t[o];e(a,o,t)&&(n.push(a),i.push(o))}return function(t,e){for(var n=t?e.length:0,o=n-1;n--;){var i=e[n];if(n==o||i!==r){var r=i;Object(Io.a)(i)?Lo.call(t,i,1):Ro(t,i)}}}(t,i),n},Mo=function(){},Fo=function(t){function e(){var n=this;return(n=t.apply(this,arguments)||this).name=e.name,n.priority=1/0,n}return s(e,t),e.prototype.onLoadData=function(t,e){e instanceof _n||Go.error("data is not a BulbDocument");var n=Object.values(ft);return e.deepForEach(function(t){t.type||Go.error("node must have a type"),n.includes(t.type)||Go.warn("node type: `"+t.type+"` is not match with NodeTypes"),t.isBlock()&&(t.name||Go.error("block must have a name")),(t.hasText()||t.hasInline())&&t.hasBlock()&&Go.warn("node: `"+t.type+"` cannot has text or inline meanwhile node has block")}),t},e}(Mo),Ho=function(){function t(){this.listeners=[]}return t.prototype.on=function(t){this.listeners.push(t)},t.prototype.emit=function(t){this.listeners.forEach(function(e){e(t)})},t.prototype.off=function(t){var e=this.listeners.indexOf(t);e>=0&&this.listeners.splice(e,1)},t}(),jo="internal-plugin-notify",Vo=function(t){function e(){var e=this;return(e=t.apply(this,arguments)||this).name=jo,e.emitters=new Map,e}return s(e,t),e.prototype.on=function(t,e){var n=this.emitters.get(t);n||(n=new Ho,this.emitters.set(t,n)),n.on(e)},e.prototype.off=function(t,e){var n=this.emitters.get(t);n&&n.off(e)},e.prototype.emit=function(t,e){var n=this.emitters.get(t);n&&n.emit(e)},e}(Mo),Uo=function(){function t(){this.plugins=[],this.registerInternalPlugins()}return t.prototype.register=function(t){var e=this;[].concat(t).forEach(function(t){var n="function"==typeof t?new t:t;n.name||Go.warn("Plugin("+(null==t?void 0:t.name)+") must contains property `name`"),e.plugins.push(n)}),this.sortPluginsByPriority()},t.prototype.remove=function(t){return Po(this.plugins,function(e){return e.name===t})},t.prototype.get=function(t){return this.plugins.find(function(e){return e.name===t})},t.prototype.getHooks=function(t){return this.plugins.reduce(function(e,n){return n[t]&&e.push([n,n[t]]),e},[])},t.prototype.sortPluginsByPriority=function(){this.plugins.sort(function(t,e){return t.priority===1/0||e.priority===-1/0?-1:e.priority===1/0||t.priority===-1/0?1:Number(t.priority)-Number(e.priority)})},t.prototype.registerInternalPlugins=function(){this.register([Fo,Vo])},t}();function zo(t,e){var n,o=T.resolve(Uo).getHooks(t);return o&&(n=o.reduce(function(t,n){var o=n[0],i=n[1];return t=i.call(o,t,e)},"")),n}Uo=function(t,e,n,o){var i,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(r<3?i(a):r>3?i(e,n,a):i(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a}([A(),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",[])],Uo);var Go=function(){function t(){}return t.debug=function(e,n){zo(g.ON_LOG,t.makeObjectMessage(e,n))},t.log=function(e,n){zo(g.ON_LOG,t.makeObjectMessage(e,n))},t.warn=function(e,n){zo(g.ON_WARNING,t.makeObjectMessage(e,n))},t.error=function(e,n){zo(g.ON_ERROR,t.makeObjectMessage(e,n))},t.makeObjectMessage=function(t,e){return"string"==typeof t?{label:"",message:t,optionalOutputs:e}:t},t}(),Jo=function(){function t(){this.undoStack=[],this.redoStack=[]}return t.setEnable=function(t){this.enable=t},t.prototype.pushHistory=function(e){t.enable&&(this.undoStack.push(e),this.redoStack=[])},t.prototype.canUndo=function(){return this.undoStack.length>0},t.prototype.canRedo=function(){return this.redoStack.length>0},t.prototype.undo=function(){if(this.canUndo()){var t=this.undoStack.pop();return t.undo(),this.redoStack.push(t),t}},t.prototype.redo=function(){if(this.canRedo()){var t=this.redoStack.pop();return t.redo(),this.undoStack.push(t),t}},t.prototype.clear=function(){this.undoStack=[],this.redoStack=[]},t}();Jo.enable=!0,Jo=function(t,e,n,o){var i,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(r<3?i(a):r>3?i(e,n,a):i(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a}([O()],Jo);var Wo=new(function(){function t(){}return t.prototype.getPlatform=function(){return ir.platform},t.prototype.getPlugin=function(t){return ir.getPlugin(t)},t.prototype.registerPlugins=function(t){return ir.registerPlugins(t)},t.prototype.getComponent=function(t){return ir.getComponent(t)},t.prototype.removeComponent=function(t){return ir.removeComponent(t)},t.prototype.removePlugin=function(t){return ir.removePlugin(t)},t.prototype.removeCommand=function(t){return ir.removeCommand(t)},t.prototype.getComponents=function(){return ir.getComponents()},t.prototype.registerComponents=function(t){return ir.registerComponents(t)},t.prototype.executeCommand=function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),o=1;o<e;o++)n[o-1]=arguments[o];return ir.executeCommand.apply(ir,[t].concat(n))},t.prototype.registerCommand=function(t,e){return ir.registerCommand(t,e)},t.prototype.registerInternalCommands=function(t){return ir.registerInternalCommands(t)},t.prototype.overrideCommand=function(t,e){return ir.overrideCommand(t,e)},t.prototype.undo=function(){ir.undo()},t.prototype.redo=function(){ir.redo()},t.prototype.canUndo=function(){return ir.canUndo()},t.prototype.canRedo=function(){return ir.canRedo()},t.prototype.setDocument=function(t){ir.loadData(t)},t.prototype.setValueData=function(t){ir.setValueData(t)},t.prototype.getValue=function(){return ir.getValue()},t.prototype.getValueData=function(){return ir.getValueData()},t.prototype.getDocument=function(){return ir.getDocument()},t.prototype.getBulbSelection=function(){return ir.getBulbSelection()},t.prototype.getBulbRange=function(){return ir.getBulbRange()},t.prototype.setBulbSelection=function(t){ir.setBulbSelection(t)},t.prototype.setBulbSelectionFromRange=function(t){ir.setBulbSelectionFromRange(t)},t.prototype.on=function(t,e){ir.on(t,e)},t.prototype.off=function(t,e){ir.off(t,e)},t.prototype.emit=function(t,e){ir.emit(t,e)},t.prototype.setReadOnly=function(t){t&&ir.setBulbSelectionFromRange(null),ir.setReadOnly(t)},t.prototype.setDecorations=function(t){ir.setDecorations(t)},t.prototype.isComposing=function(){return ir.isComposing()},t.prototype.isSelecting=function(){return ir.isSelecting()},t.prototype.getCurrentEvent=function(){return ir.getCurrentEvent()},t.prototype.isReadOnly=function(){return ir.isReadonly()},t.prototype.reset=function(){return ir.reset()},t}());function $o(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}function Ko(t,e,n){return(Ko=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}()?Reflect.construct:function(t,e,n){var o=[null];o.push.apply(o,e);var i=new(Function.bind.apply(t,o));return n&&function(t,e){(Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}(i,n.prototype),i}).apply(null,arguments)}var Yo,Xo,qo=function(){function t(t,e){this.commandHistoryService=t,this.context=e,this.commands=new Map,this.isClass=function(t){return"function"==typeof t&&/^\s*class\s+/.test(t.toString())},this.reset()}return t.prototype.register=function(t){var e=this;[].concat(t).forEach(function(t){var n=e.isClass(t)?t.commandName:t.name;e.checkDuplicated(n),e.commands.set(n,t),e.injectCommand(n)})},t.prototype.registerCommandFn=function(t,e){!(arguments.length>2&&void 0!==arguments[2]&&arguments[2])&&this.checkDuplicated(t)||(this.commands.set(t,{name:t,fn:e}),this.injectCommand(t))},t.prototype.override=function(t,e){var n=this,o=this.get(t);this.registerCommandFn(t,function(){for(var t,i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];if(n.isClass(o)){var s=Ko(o,r);t=s.execute.bind(s)}else t=o.fn.bind(o);e.apply(void 0,[t].concat(r))},!0)},t.prototype.remove=function(t){if(this.get(t))return delete Wo[t],this.commands.delete(t)},t.prototype.get=function(t){return this.commands.get(t)},t.prototype.canUndo=function(){return ir.isComposing()||(this.previousCanUndo=this.commandHistoryService.canUndo()),this.previousCanUndo},t.prototype.canRedo=function(){return ir.isComposing()||(this.previousCanRedo=this.commandHistoryService.canRedo()),this.previousCanRedo},t.prototype.undo=function(){this.context.push(new Vn);var t=this.commandHistoryService.undo();t?(t instanceof Vn&&ir.setBulbSelection(t.getSelectionBefore()),this.context.pop(),ir.setValueData({canRedo:this.canRedo(),canUndo:this.canUndo()})):this.context.pop()},t.prototype.redo=function(){this.context.push(new Vn);var t=this.commandHistoryService.redo();t?(t instanceof Vn&&ir.setBulbSelection(t.getSelectionAfter()),this.context.pop(),ir.setValueData({canRedo:this.canRedo(),canUndo:this.canUndo()})):this.context.pop()},t.prototype.reset=function(){this.previousCanRedo=!1,this.previousCanUndo=!1,this.commandHistoryService.clear()},t.prototype.executeCommand=function(t,e){this.context.executing()||zo(g.ON_EXECUTE_COMMAND,{name:t,args:e});var n=this.createCommand(t,e);if(n instanceof zn){var o=this.context.root();o&&o instanceof Vn&&o.pushCommand(n)}if(this.context.push(n),n instanceof Vn){var i=ir.getBulbSelection();n.setSelectionBefore(i&&i.copy())}var r=n.execute();if(this.context.pop(),n instanceof Vn){var a=ir.getBulbSelection();n.setSelectionAfter(a&&a.copy())}return this.context.executing()||((n instanceof zn||n.hasSubCommands())&&this.commandHistoryService.pushHistory(n),ir.setValueData({canRedo:this.canRedo(),canUndo:this.canUndo()})),r},t.prototype.isExecuting=function(){return this.context.executing()},t.prototype.registerInternalCommands=function(t){this.register(t)},t.prototype.createCommand=function(t,e){var n=this.get(t);return this.isClass(n)?Ko(n,function(t){return function(t){if(Array.isArray(t))return $o(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return $o(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?$o(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(e)):this.createAnonymousCommand(n.fn,e)},t.prototype.checkDuplicated=function(t){if(this.get(t))return Go.error("You might register a duplicated command: "+t+"\nUse `editor.overrideCommand`, if you want to overload a command"),!0},t.prototype.createAnonymousCommand=function(t,e){return new(function(n){function o(){var t=this;return(t=n.apply(this,arguments)||this).args=e,t}return s(o,n),o.prototype.execute=function(){t.apply(this,e)},o}(Vn))},t.prototype.injectCommand=function(t){Wo[t]=function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return Wo.executeCommand.apply(ir,[t].concat(n)),Wo}},t}();qo=function(t,e,n,o){var i,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(r<3?i(a):r>3?i(e,n,a):i(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a}([A(),function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}("design:paramtypes",["function"==typeof(Yo=void 0!==Jo&&Jo)?Yo:Object,"function"==typeof(Xo=void 0!==Gn&&Gn)?Xo:Object])],qo);var Qo=function(){function t(){this.components=[]}return t.prototype.register=function(t){var e=this;zo(g.ON_REGISTER_COMPONENT,t),Array.isArray(t)||(t=[t]),t.forEach(function(t){e.components.push(t)})},t.prototype.remove=function(t){return Po(this.components,function(e){return e.blockName===t})},t.prototype.get=function(t){return this.components.find(function(e){return e.blockName===t})},t.prototype.getComponents=function(){return this.components},t}();Qo=function(t,e,n,o){var i,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(r<3?i(a):r>3?i(e,n,a):i(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a}([A()],Qo),Tn.undraggable,Tn.focusable,Tn.atomic,Tn.defaults;var Zo=function(){function t(){}return t.prototype.checkValid=function(t,e){return t instanceof e&&!t.isDefaultPrevented()&&this.handleTypes.indexOf(t.type)>=0},t.prototype.insertText=function(t,e,n){var o;n=n||(null===(o=ir.getBulbSelection())||void 0===o?void 0:o.getMarks()),Wo.insertTextByRange(t,e,n)},t.prototype.deleteBlock=function(t){Wo.deleteByRange(t)},t.prototype.deleteText=function(t,e){Wo.deleteByRange(t,e)},t.prototype.splitBlock=function(t){var e=t.getStartNode().parent;if(!ir.getComponent(e.name).atomic){if(e.isInline()&&t.getStartOffset()===e.getText().length){var n=e.nextSibling();t.setEnd(n.id,0),t.collapseToEnd()}Wo.splitBlock(t)}},t}();Zo.isComposing=!1,Zo.currentEvent=null;var ti,ei,ni=Zo,oi=function(){function t(e){t.create.apply(this,[e,this])}return t.create=function(t,e){var n=t.nativeEvent,o=t.range;return e.type=t.type||n.type,e.target=n.target,e.currentTarget=n.currentTarget,e.eventPhase=n.eventPhase,e.bubbles=n.bubbles,e.cancelable=n.cancelable,e.timeStamp=n.timeStamp,e.isTrusted=n.isTrusted,e.defaultPrevented=!1,e.nativeEvent=n,e.range=o,e},t.prototype.preventDefault=function(){var t;this.defaultPrevented=!0,null===(t=this.nativeEvent)||void 0===t||t.preventDefault()},t.prototype.stopPropagation=function(){var t,e;null===(t=this.nativeEvent)||void 0===t||null===(e=t.stopPropagation)||void 0===e||e.call(t)},t.prototype.isDefaultPrevented=function(){return this.defaultPrevented},t.prototype.getRange=function(){return this.range},t.prototype.getNativeEvent=function(){return this.nativeEvent},t}(),ii=function(t){function e(n){var o=this;return o=t.call(this,n)||this,e.create.apply(o,[n,o]),o}return s(e,t),e.create=function(t,e){oi.create.apply(e,[t,e]);var n=t.nativeEvent;return e.view=n.view,e.detail=n.detail,e},e}(oi),ri=function(t){function e(n){var o=this;return o=t.call(this,n)||this,e.create.apply(o,[n,o]),o}return s(e,t),e.create=function(t,e){ii.create.apply(e,[t,e]);var n=t.nativeEvent;return e.altKey=n.altKey,e.ctrlKey=n.ctrlKey,e.shiftKey=n.shiftKey,e.metaKey=n.metaKey,e},e.prototype.getModifierState=function(){return this.altKey||this.metaKey||this.shiftKey||this.ctrlKey},e}(ii),ai=function(t){function e(n){var o=this;return o=t.call(this,n)||this,e.create.apply(o,[n,o]),o}return s(e,t),e.create=function(t,e){return ri.create.apply(e,[t,e]),e.key=t.nativeEvent.key,e},e}(ri),si=function(t){function e(n){var o=this;return o=t.call(this,n)||this,e.create.apply(o,[n,o]),o}return s(e,t),e.create=function(t,e){ri.create.apply(e,[t,e]);var n=t.nativeEvent;return e.button=n.button,e.buttons=n.buttons,e.clientX=n.clientX,e.clientY=n.clientY,e.pageX=n.pageX,e.pageY=n.pageY,e},e}(ri),li=function(t){function e(n){var o=this;return o=t.call(this,n)||this,e.create.apply(o,[n,o]),o}return s(e,t),e.create=function(t,e){return oi.create.apply(e,[t,e]),e.clipboardData=t.clipboardData,e},e}(oi),ci=function(){function t(){this.dataMap=new Map}return t.prototype.setData=function(t,e){return this.dataMap.set(t,e)},t.prototype.getData=function(t){return this.dataMap.get(t)},t.prototype.clearData=function(t){return t?this.dataMap.delete(t):this.dataMap=new Map},t}(),ui=function(t){function e(n){var o=this;return o=t.call(this,n)||this,e.create.apply(o,[n,o]),o}return s(e,t),e.create=function(t,e){return si.create.apply(e,[t,e]),e.dataTransfer=new ci,e},e}(si),di=function(t){function e(n){var o=this;return o=t.call(this,n)||this,e.create.apply(o,[n,o]),o}return s(e,t),e.create=function(t,e){ii.create.apply(e,[t,e]);var n=t.nativeEvent;return e.data=n.data,e.isComposing=n.isComposing,e},e}(ii),pi=function(t){function e(n){var o=this;return o=t.call(this,n)||this,e.create.apply(o,[n,o]),o}return s(e,t),e.create=function(t,e){return oi.create.apply(e,[t,e]),e.data=t.nativeEvent.data,e},e}(oi);!function(t){t.Enter="Enter",t.Backspace="Backspace",t.Delete="Delete",t.Space=" ",t.Tab="Tab",t.Esc="Escape",t.Win="OS",t.Home="Home",t.End="End",t.ArrowUp="ArrowUp",t.ArrowDown="ArrowDown",t.ArrowLeft="ArrowLeft",t.ArrowRight="ArrowRight"}(ti||(ti={})),function(t){t.Click="click",t.DoubleClick="dblclick",t.BeforeInput="textInput",t.Input="input",t.CompositeStart="compositionstart",t.CompositeUpdate="compositionupdate",t.CompositeEnd="compositionend",t.Drag="drag",t.DragEnd="dragend",t.DragEnter="dragenter",t.DragExit="dragexit",t.DragLeave="dragleave",t.DragOver="dragover",t.DragStart="dragstart",t.Drop="drop",t.Scroll="scroll",t.Wheel="wheel",t.KeyDown="keydown",t.KeyPress="keypress",t.KeyUp="keyup",t.MouseDown="mousedown",t.MouseMove="mousemove",t.MouseOut="mouseout",t.MouseOver="mouseover",t.MouseUp="mouseup",t.TouchSancel="touchcancel",t.TouchStart="touchstart",t.TouchMove="touchmove",t.TouchEnd="touchend",t.Copy="copy",t.Cut="cut",t.Paste="paste"}(ei||(ei={}));var hi,fi=[ei.KeyDown,ei.KeyPress,ei.KeyUp],gi=[ei.MouseDown,ei.MouseMove,ei.MouseUp,ei.Click,ei.DoubleClick],mi=[ei.BeforeInput,ei.Input],yi=[ei.Copy,ei.Cut,ei.Paste],vi=[ei.CompositeStart,ei.CompositeUpdate,ei.CompositeEnd],_i=[ei.DragStart,ei.Drag,ei.DragOver,ei.Drop,ei.DragEnd];!function(t){t[t.MOUSE_LEFT=0]="MOUSE_LEFT",t[t.MOUSE_MIDDLE=1]="MOUSE_MIDDLE",t[t.MOUSE_RIGHT=2]="MOUSE_RIGHT"}(hi||(hi={}));var bi=function(t){function e(){var e=this;return(e=t.apply(this,arguments)||this).handleTypes=[ei.KeyDown,ei.KeyUp],e}return s(e,t),e.prototype.handleEvent=function(t){this.checkValid(t,ai)&&(ni.isComposing||(ir.getBulbRange().getStartNode().isText()?this.handleTextNode(t):this.handleNonTextNode(t)))},e.prototype.handleTextNode=function(t){var e=t.key,n=t.getRange();if(t.type===ei.KeyDown){switch(e){case ti.Backspace:this.deleteText(n,-1);break;case ti.Delete:this.deleteText(n,1);break;case ti.Enter:this.splitBlock(n);break;case ti.Space:this.insertText(n,e);break;case ti.Tab:this.insertText(n,"\t");break;default:return}t.preventDefault()}},e.prototype.handleNonTextNode=function(t){var e=t.key,n=t.getRange(),o=n.getStartNode(),i=ir.getBulbSelection().getData(o.id);if(i&&i[ln.focusable]&&t.type===ei.KeyDown)switch(e){case ti.Backspace:case ti.Delete:case ti.Enter:this.deleteBlock(n),t.preventDefault();break;default:t.getModifierState()||(this.insertText(n,e),t.preventDefault())}},e}(ni),Ci=new(function(){function t(){this.pool=new Map}return t.prototype.get=function(t,e){var n=this.pool.get(t);if(!n||!n.length){var o=new t(e);return this.pool.set(t,[o]),o}return t.create(e,n[0])},t}()),ki=new(function(){function t(){var t=this;this.onCompositeEvents=function(e){ir.getBulbRange()&&t.isEventInEditor(e)&&t.onControllerEvent(pi,e)},this.onKeyboardEvent=function(e){ir.getBulbRange()&&t.isEventInEditor(e)&&t.onControllerEvent(ai,e)},this.onInputEvent=function(e){ir.getBulbRange()&&t.isEventInEditor(e)&&t.onControllerEvent(di,e)},this.onClipboardEvent=function(e){ir.getBulbRange()&&t.isEventInEditor(e)&&t.onControllerEvent(li,e)},this.onMouseEvent=function(e){var n=ir.selectionAdapter.buildBulbRangeFromPoint(e.clientX,e.clientY);t.onControllerEvent(si,e,n)}}return t.prototype.addListenersTo=function(t,e){var n=function(e,n){e.forEach(function(e){t.addEventListener(e,n)})};this.editor=e,this.eventDelegate=t,n(fi,this.onKeyboardEvent),n(gi,this.onMouseEvent),n(mi,this.onInputEvent),n(yi,this.onClipboardEvent),n(vi,this.onCompositeEvents)},t.prototype.isEventInEditor=function(t){var e=t.target;return this.editor.contains(e)},t.prototype.onControllerEvent=function(t,e,n){if(!ir.isReadonly()){var o=this.buildEvent(t,e,n);ir.onEvent(o)}},t.prototype.buildEvent=function(t,e,n){return n||(n=ir.getBulbRange()),Ci.get(t,{range:n,nativeEvent:e})},t}()),wi=function(t,e){if(!Intl.v8BreakIterator)return e===t.length?{start:e-1,end:e}:{start:e,end:e+1};var n=Intl.v8BreakIterator(["zh"]);n.adoptText(t);for(var o=0,i=0,r=n.first();i<=e&&-1!==i;)o=i,i=r,r=n.next();return{start:o,end:i}},Si=function(t){if(!t)return null;t.nodeType===Node.TEXT_NODE&&(t=t.parentElement);var e=t.closest("*["+m+"]");return null==e?void 0:e.getAttribute(m)},xi=function(t,e){var n=function(t){var e={textNode:null,leafNode:null};for(t.getAttribute||(e.textNode=t.parentElement,e.leafNode=t);e.textNode;){if(e.textNode.getAttribute(m))return e;e.leafNode=e.textNode,e.textNode=e.textNode.parentElement}return e}(t),o=n.textNode,i=n.leafNode;return function(t,e,n){if(!t||!e)return n;var o=t.firstChild,i=" "===e.textContent&&1===n?0:n;if(o===e)return i;for(;o!==e;)i+=o.length||o.innerText.length,o=o.nextSibling;return i}(o,i,e)},Ei=function(t,e){var n,o=window.document;if(o.caretRangeFromPoint)n=o.caretRangeFromPoint(t,e);else if(o.caretPositionFromPoint){var i=o.caretPositionFromPoint(t,e);(n=o.createRange()).setStart(i.offsetNode,i.offset),n.setEnd(i.offsetNode,i.offset)}else if(o.body.createTextRange){n=o.body.createTextRange();try{n.moveToPoint(t,e)}catch(t){return null}}return n},Ii=function(t,e){var n=Ti(t);return Oi(n,e)},Ti=function(t){var e="["+m+"='"+t+"']";return window.document.querySelector(e)},Oi=function(t,e){if(!t)return null;var n={node:null,offset:0};return Array.from(t.childNodes).forEach(function(t){if(!n.node){var o=t.length||t.textContent.length;(e-=o)<=0&&(n.node=function(t){for(;t&&3!==t.nodeType;)t=t.firstChild;return t}(t),n.offset=e+o)}}),n.node||(n.node=t,n.offset=0),n},Ai=function(){function t(){this.bulbSelection=new Bn({})}return t.toNativeRange=function(t){if(!t)return null;var e=window.document.createRange(),n=t.getStartNode(),o=t.getEndNode();if(!n||!o)return null;if(n.isText()){var i=Ii(n.id,t.getStartOffset());if(!i)return null;e.setStart(i.node,i.offset)}else{var r=Ti(n.id);if(!r)return null;e.setStart(r,0)}if(o.isText()){var a=Ii(o.id,t.getEndOffset());if(!a)return null;e.setEnd(a.node,a.offset)}else{var s=Ti(o.id);if(!s)return null;e.setEnd(s,0)}return e},t.caretRangeFromPoint=function(t,e){return Ei(t,e)},t.prototype.setBulbSelection=function(t){this.bulbSelection=t},t.prototype.getBulbSelection=function(){return this.bulbSelection},t.prototype.buildBulbRangeFromPoint=function(t,e){var n=Ei(t,e);return n&&this.buildBulbRange(n)},t.prototype.buildBulbRange=function(t){var e=t.startContainer,n=t.startOffset,o=t.endContainer,i=t.endOffset,r=Si(e),a=Si(o),s=xi(e,n),l=xi(o,i);if(!r||!a)return null;var c=sr.fromJSON({anchor:{nodeId:r,offset:s},focus:{nodeId:a,offset:l}});return this.convertBulbRange(c)},t.prototype.convertBulbRange=function(t){var e,n,o=null===(e=t.getStartNode())||void 0===e?void 0:e.closest(function(t){return t.isInline()});if(o){var i=t.getAnchorOffset();0===i?t.moveToEndOfNode(o.preSibling()):i===o.getLength()&&t.moveToStartOfNode(o.nextSibling())}return(null===(n=t.getStartNode())||void 0===n?void 0:n.isBlock())&&t.setAnchorOffset(1).collapseToStart(),t},t}(),Ni=new Ai,Di=function(t){function e(){var e=this;return(e=t.apply(this,arguments)||this).handleTypes=gi,e}return s(e,t),e.prototype.handleEvent=function(t){if(this.checkValid(t,si)&&(t.type===ei.MouseDown&&ni.isComposing&&(ni.isComposing=!1),t.type===ei.MouseUp&&this.handleMouseUp(t),ki.isEventInEditor(t.getNativeEvent()))){var e=t.button;if(!(e===hi.MOUSE_RIGHT&&this.isMouseDownOnPreRange(t,t.getRange())||e!==hi.MOUSE_LEFT&&e!==hi.MOUSE_RIGHT))switch(t.preventDefault(),t.type){case ei.DoubleClick:this.handleDoubleClick(t);break;case ei.Click:3===t.detail&&this.handleTripleClick(t);break;case ei.MouseDown:this.handleMouseDown(t);break;case ei.MouseMove:this.handleMouseMove(t)}}},e.prototype.isStartToDrag=function(){return e.dragState.startToDrag},e.prototype.isDragging=function(){return e.dragState.isDragging},e.prototype.handleDoubleClick=function(t){var e=t.getRange(),n=e.getStartNode();if(n.isText()){var o=n.getText(),i=e.getStartOffset(),r=wi(o,i),a=r.start,s=r.end;e.setStartOffset(a).setEndOffset(s);var l=new Bn({range:e});ir.setBulbSelection(l)}},e.prototype.handleTripleClick=function(t){var e=t.getRange(),n=e.getStartNode();if(!n.isBlock()){var o=n.parent,i=o.nodes[0],r=o.nodes[o.nodes.length-1],a=r.isText()?r.getLength():1;e.moveStartTo(i,0).moveEndTo(r,a);var s=new Bn({range:e});ir.setBulbSelection(s)}},e.prototype.handleShiftSelecting=function(t){var n=Wo.getBulbRange(),o=n.getAnchor(),i=n.getFocus(),r=new sr({anchor:t.getRange().getAnchor(),focus:o}),a=new sr({anchor:t.getRange().getAnchor(),focus:i}),s=r.getText().length,l=a.getText().length;e.selectingState.anchor=s>=l?o:i},e.prototype.handleMouseDown=function(t){var n;e.dragState.startToDrag=!1,e.selectingState.isSelecting=!0,e.selectingState.anchor=null===(n=t.getRange())||void 0===n?void 0:n.getAnchor(),t.shiftKey&&this.handleShiftSelecting(t),this.setSelection(t)},e.prototype.handleMouseUp=function(t){!this.isDragging()&&this.isStartToDrag()||(e.selectingState.anchor=null),this.isDragging()?ir.onEvent(this.buildDragEvent(t,ei.Drop)):ki.isEventInEditor(t.getNativeEvent())&&ir.emit(h.SELECT),e.dragState.startToDrag=!1,e.dragState.isDragging=!1,e.dragState.dragMoveCount=0,e.selectingState.isSelecting=!1,this.setSelection(t)},e.prototype.handleMouseMove=function(t){var n;if(e.selectingState.isSelecting&&!(null===(n=t.getRange())||void 0===n?void 0:n.equals(ir.getBulbRange())))if(this.isStartToDrag()&&this.isDraggable()){if(e.dragState.dragMoveCount>1){var o=this.isDragging()?ei.DragOver:ei.DragStart;e.dragState.isDragging=!0,ir.onEvent(this.buildDragEvent(t,o))}e.dragState.dragMoveCount++}else this.setSelection(t)},e.prototype.setSelection=function(t){var n,o=null===(n=t.getRange())||void 0===n?void 0:n.getFocus(),i=e.selectingState.anchor;if(i&&o&&(i.equals(o)||!o.getNode().isBlock())){var r=new sr({anchor:i,focus:o}),a=r.getStartNode(),s=ir.getComponent(null==a?void 0:a.name);if(this.isMouseDownOnPreRange(t,r)&&!ir.getBulbRange().someNode(function(t){return Tn.isUndraggable(t)}))return e.dragState.startToDrag=!0;var l=s?this.handleFocusable(a,s,r):new Bn({range:r,position:this.getSelectionPosition(t)});l&&ir.setBulbSelection(l)}},e.prototype.getSelectionPosition=function(t){if(t.type===ei.MouseDown&&t.button===hi.MOUSE_LEFT){var e=Array.from(Ai.toNativeRange(t.getRange()).getClientRects());if(2===(null==e?void 0:e.length)){var n=t.pageX,o=e[0],i=e[1];if(o.width<=1&&i.width<=1&&o.right>i.left&&o.top<i.top)return Math.abs(o.right-n)>Math.abs(i.right-n)?On.LineStart:On.LineEnd}return On.LineCenter}},e.prototype.handleFocusable=function(t,e,n){var o;if(e.focusable){for(var i=new Bn({range:n});!t.isDocument();)i.setData(t.id,((o={})[ln.focusable]=!0,o)),t=t.parent;return i}},e.prototype.isMouseDownOnPreRange=function(t,e){var n;if(t.type===ei.MouseDown){var o=ir.getBulbRange();if((null==o||null===(n=o.getStartNode())||void 0===n?void 0:n.isBlock())&&o.equals(e))return!0;if(!o||o.isCollapsed())return!1;var i=e.getAnchor();return!(i.equals(o.getStart())||i.equals(o.getEnd()))&&e.getAnchor().isInRange(o)}},e.prototype.buildDragEvent=function(t,e){return new ui({type:e,nativeEvent:t.getNativeEvent(),range:t.getRange()})},e.prototype.isDraggable=function(){var t=ir.getBulbRange().getStartNode();return!Tn.isUndraggable(t)},e}(ni);Di.dragState={startToDrag:!1,dragMoveCount:0,isDragging:!1},Di.selectingState={isSelecting:!1,anchor:null};var Bi,Ri,Li=Di,Pi=function(t){function e(){var e=this;return(e=t.apply(this,arguments)||this).handleTypes=vi.concat(mi),e}return s(e,t),e.prototype.handleEvent=function(t){if(this.checkValid(t,pi)||this.checkValid(t,di)){var e=t.data;if(t.type===ei.CompositeStart)return ni.isComposing||(this.isFirstCompositeUpdateTrigger=!0),ni.isComposing=!0,void(this.inputtingMarks=ir.getBulbSelection().getMarks());if(ni.isComposing){if(t.type===ei.CompositeUpdate||t.type===ei.BeforeInput){if(this.currentUpdateText===e)return;this.isFirstCompositeUpdateTrigger||ir.undo(),this.currentUpdateText=e,this.isFirstCompositeUpdateTrigger=!1,this.insertText(ir.getBulbRange(),e,this.inputtingMarks),t.preventDefault()}return t.type===ei.CompositeEnd||t.type===ei.BeforeInput?(ni.isComposing=!1,this.inputtingMarks=[],t.preventDefault(),void ir.setValueData({canRedo:ir.canRedo(),canUndo:ir.canUndo()})):void 0}}},e}(ni),Mi=function(t){function e(){var e=this;return(e=t.apply(this,arguments)||this).handleTypes=[ei.BeforeInput],e}return s(e,t),e.prototype.handleEvent=function(t){if(this.checkValid(t,di)&&!ni.isComposing){var e=t.data,n=t.getRange();return t.type===ei.BeforeInput?(this.insertText(n,e),void t.preventDefault()):void 0}},e}(ni),Fi=function(t){function e(){var e=this;return(e=t.apply(this,arguments)||this).handleTypes=_i,e}return s(e,t),e.prototype.handleEvent=function(t){if(this.checkValid(t,ui)){var e=t.getRange(),n=ir.getBulbSelection(),o=ir.getBulbRange();if(t.type===ei.DragStart&&this.drawDragShadow(n,t),t.type===ei.DragOver&&this.drawDragShadow(n,t),t.type===ei.Drop){this.removeDragShadow();var i=e.getStart();if(i.isInRange(o)||Tn.isUndroppable(i.getNode()))return;Wo.drop({dragRange:o,dropRange:e})}}},e.prototype.drawDragShadow=function(t,e){ir.emit(h.DRAW_DRAG_SHADOW,{selection:t,event:e})},e.prototype.removeDragShadow=function(){ir.emit(h.DRAW_DRAG_SHADOW,{})},e}(ni),Hi=function(t){function e(){var e=this;return(e=t.apply(this,arguments)||this).handleTypes=yi,e}return s(e,t),e.prototype.handleEvent=function(t){if(this.checkValid(t,li)){t.preventDefault();var e=ir.getBulbRange(),n=this.getNativeClipboardData(t);if(t.type===ei.Copy&&this.setRangeContentsToClipboard(t),t.type===ei.Paste){var o=zo(g.ON_PARSE_CLIPBOARD_DATA,n);if(o)this.checkDataValid(o),this.insertNodes(o);else{var i=n.getData("__@@bulb@@__");this.pasteEditorData(i)}}t.type===ei.Cut&&(this.setRangeContentsToClipboard(t),this.deleteBlock(e))}},e.prototype.pasteEditorData=function(t){if(t){var e=JSON.parse(t);this.insertNodes(e)}},e.prototype.setRangeContentsToClipboard=function(t){var e=this.getNativeClipboardData(t);this.setPlainText(e);var n,o=ir.getBulbRange().cloneContents();o=zo(g.ON_COPY_CONTENT,o),zo(g.ON_SET_CLIPBOARD_DATA,{dataTransfer:e,jsonContent:o});try{n=JSON.stringify(o)}catch(t){throw new Error("result of `range.cloneContents()` cannot be stringify")}e.setData("__@@bulb@@__",n),zo(g.AFTER_SET_CLIPBOARD_DATA,e)},e.prototype.checkDataValid=function(t){},e.prototype.setPlainText=function(t){var e=Wo.getBulbRange();if(e){var n=e.cloneContents().map(Fn),o=n.every(function(t){return t.isText()||t.isInline()})?n.map(function(t){return t.getText()}).join(""):n.map(function(t){return t.getText()}).join("\n");t.setData("text/plain",o)}},e.prototype.insertNodes=function(t){var e=t.map(function(t){return Fn(t)});Wo.insertNodesAtRange(e,ir.getBulbRange())},e.prototype.getNativeClipboardData=function(t){return t.getNativeEvent().clipboardData},e}(ni);!function(t){t.SAFARI="safari",t.CHROME="chrome",t.FIREFOX="firefox",t.EDGE="edge",t.OPERA="opera",t.IE="ie"}(Bi||(Bi={})),function(t){t.ANDROID="android",t.IOS="ios",t.MAC_OS="macos",t.WINDOWS="windows",t.FIREFOX_OS="firefoxos"}(Ri||(Ri={}));var ji=[[Bi.EDGE,/Edge\/([0-9\._]+)/],[Bi.CHROME,/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],[Bi.FIREFOX,/Firefox\/([0-9\.]+)(?:\s|$)/],[Bi.OPERA,/Opera\/([0-9\.]+)(?:\s|$)/],[Bi.OPERA,/OPR\/([0-9\.]+)(:?\s|$)$/],[Bi.IE,/Trident\/7\.0.*rv\:([0-9\.]+)\).*Gecko$/],[Bi.IE,/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],[Bi.IE,/MSIE\s(7\.0)/],[Bi.SAFARI,/Version\/([0-9\._]+).*Safari/]],Vi=[[Ri.IOS,/os ([\.\_\d]+) like mac os/i],[Ri.MAC_OS,/mac os x/i],[Ri.ANDROID,/android/i],[Ri.FIREFOX_OS,/mozilla\/[a-z\.\_\d]+ \((?:mobile)|(?:tablet)/i],[Ri.WINDOWS,/windows\s*(?:nt)?\s*[\.\_\d]*/i]],Ui=new(function(){function t(){this.browser=this.getBrowserName(),this.os=this.getOSName()}return t.prototype.getBrowserName=function(){for(var t=0,e=ji;t<e.length;t++){var n=e[t],o=n[0],i=n[1];if(i.test(window.navigator.userAgent))return o}},t.prototype.getOSName=function(){for(var t=0,e=Vi;t<e.length;t++){var n=e[t],o=n[0],i=n[1];if(i.test(window.navigator.userAgent))return o}},t.prototype.isSafari=function(){return this.browser===Bi.SAFARI},t.prototype.isChrome=function(){return this.browser===Bi.CHROME},t.prototype.isAndroid=function(){return this.os===Ri.ANDROID},t.prototype.isIOS=function(){return this.os===Ri.IOS},t.prototype.isMac=function(){return this.os===Ri.MAC_OS},t.prototype.isWindows=function(){return this.os===Ri.WINDOWS},t}());function zi(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,o)}return n}function Gi(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var Ji=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=ir.getComponents(),n=e.find(function(t){return t.defaults});return new fn({name:n.blockName,type:ft.Block,id:wt(),nodes:[new In({id:wt(),leaves:[new Sn({text:t})]})]})},Wi=function(t){return t&&0!==Object.keys(t).length?t.nodes&&0!==t.nodes.length?t instanceof _n?t:_n.fromJSON(t):t instanceof _n?(t.nodes=[Ji()],t.updateParent(),t):_n.fromJSON(function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?zi(Object(n),!0).forEach(function(e){Gi(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):zi(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}({},t,{nodes:[Ji()]})):_n.fromJSON({nodes:[Ji()]})};function $i(t,e,n){var o=n.value;return n.value=function(){try{for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];o.apply(this,e)}catch(t){console.error(t),Wo.reset()}},n}function Ki(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,o)}return n}function Yi(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Ki(Object(n),!0).forEach(function(e){Xi(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ki(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function Xi(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var qi,Qi,Zi,tr,er=function(t,e,n,o){var i,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(r<3?i(a):r>3?i(e,n,a):i(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a},nr=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},or=function(){function t(t,e,n){this.componentsManager=t,this.pluginsManager=e,this.commandManager=n,this.platform=Ui,this.value=new Pn({}),this.selectionAdapter=Ni}return t.prototype.init=function(t,e,n){var o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this.eventHandlers=Object.values(p).map(function(t){return new t}),this.registerPlugins([].concat(t).filter(Boolean)),this.registerComponents(e),this.registerCommands(n),this.setReadOnly(o)},t.prototype.getPlugin=function(t){return this.pluginsManager.get(t)},t.prototype.registerPlugins=function(t){return zo(g.ON_REGISTER_PLUGIN,t),this.pluginsManager.register(t)},t.prototype.removePlugin=function(t){return this.pluginsManager.remove(t)},t.prototype.getComponent=function(t){return this.componentsManager.get(t)||t&&this.componentsManager.get(ft.Unknown)},t.prototype.getComponents=function(){return this.componentsManager.getComponents()},t.prototype.registerComponents=function(t){return this.componentsManager.register(t)},t.prototype.removeComponent=function(t){return this.componentsManager.remove(t)},t.prototype.executeCommand=function(t){if(!this.isReadonly()){for(var e=arguments.length,n=new Array(e>1?e-1:0),o=1;o<e;o++)n[o-1]=arguments[o];return this.commandManager.executeCommand(t,n)}},t.prototype.registerCommand=function(t,e){this.commandManager.registerCommandFn(t,e)},t.prototype.registerCommands=function(t){(null!=t||Array.isArray(t)&&t.length)&&this.commandManager.register(t)},t.prototype.registerInternalCommands=function(t){this.commandManager.registerInternalCommands(t)},t.prototype.overrideCommand=function(t,e){this.commandManager.override(t,e)},t.prototype.removeCommand=function(t){return this.commandManager.remove(t)},t.prototype.undo=function(){this.commandManager.undo()},t.prototype.redo=function(){this.commandManager.redo()},t.prototype.canUndo=function(){return this.commandManager.canUndo()},t.prototype.canRedo=function(){return this.commandManager.canRedo()},t.prototype.loadData=function(t){t=Wi(t),t=zo(g.ON_LOAD_DATA,t)||t,this.setValue(this.value.setProps({document:t}))},t.prototype.getValue=function(){return this.value},t.prototype.setValueData=function(t){!function(t){Go.warn("\n            Do not delete or add data on Value!\n            Used for modify Node.state"),Jo.setEnable(!1),t(),Jo.setEnable(!0)}(function(){var e=ir.getValue(),n=e.data;ir.setValue(e.setProps({data:Yi({},n,{},t)}))})},t.prototype.getValueData=function(){var t;return null===(t=ir.getValue())||void 0===t?void 0:t.data},t.prototype.setValue=function(t){this.value=new Pn(t),this.commandManager.isExecuting()||(this.value=zo(g.AFTER_SET_VALUE,this.value)||this.value,this.emit(h.VALUE_CHANGE,this.value))},t.prototype.getDocument=function(){return this.value.document},t.prototype.getBulbSelection=function(){return this.value?this.value.selection.copy():null},t.prototype.getBulbRange=function(){var t=this.getBulbSelection();return!t||t.isEmpty()?null:t.range.copy()},t.prototype.setBulbSelection=function(t){this.setValue(this.value.setProps({selection:t}))},t.prototype.setBulbSelectionFromRange=function(t){this.setBulbSelection(new Bn({range:t}))},t.prototype.onEvent=function(t){if(!(t instanceof oi))throw new Error("event MUST be a bulb event");ni.currentEvent=t,zo(g.ON_EVENT,t),this.emit(t.type,t),t.isDefaultPrevented()||this.eventHandlers.forEach(function(e){return e.handleEvent(t)}),zo(g.AFTER_EVENT,t),ni.currentEvent=null},t.prototype.on=function(t,e){this.getPlugin(jo).on(t,e)},t.prototype.off=function(t,e){this.getPlugin(jo).off(t,e)},t.prototype.emit=function(t,e){this.getPlugin(jo).emit(t,e)},t.prototype.generateNodeId=function(t){return zo(g.BEFORE_GEN_NODE_ID,t)||"bulb-node-"+t},t.prototype.setDecorations=function(t){ir.setValue(this.value.setProps({decorations:t}))},t.prototype.setReadOnly=function(t){this.value.readonly!==t&&this.setValue(this.value.setProps({readonly:t}))},t.prototype.isReadonly=function(){return this.value.readonly},t.prototype.isComposing=function(){return ni.isComposing},t.prototype.isSelecting=function(){return Li.selectingState.isSelecting},t.prototype.getCurrentEvent=function(){return ni.currentEvent},t.prototype.reset=function(){this.commandManager.reset(),this.setValue(new Pn({selection:Bn.emptySelection()}))},t}();er([$i,nr("design:type",Function),nr("design:paramtypes",[String,Object]),nr("design:returntype",Object)],or.prototype,"executeCommand",null),er([$i,nr("design:type",Function),nr("design:paramtypes",["function"==typeof(qi=void 0!==oi&&oi)?qi:Object]),nr("design:returntype",void 0)],or.prototype,"onEvent",null);var ir=new(or=er([function(t){var e=y(t);return function(n){function o(){for(var o=arguments.length,i=new Array(o),r=0;r<o;r++)i[r]=arguments[r];return n.apply(this,i.concat(e.slice(i.length).map(function(e,n){try{return b(e)?e.multiple?T.resolveAll(e.token):T.resolve(e.token):T.resolve(e)}catch(e){var o=n+i.length,r=t.toString().match(/constructor\(([\w, ]+)\)/)||[],a=r[1],s=void 0===a?null:a;throw"Cannot inject the dependency "+(s?s.split(",")[o]:"#"+o)+" of "+t.name+" constructor. "+e}})))||this}return s(o,n),o}(t)},nr("design:paramtypes",["function"==typeof(Qi=void 0!==Qo&&Qo)?Qi:Object,"function"==typeof(Zi=void 0!==Uo&&Uo)?Zi:Object,"function"==typeof(tr=void 0!==qo&&qo)?tr:Object])],or)),rr=function(){function t(t){var e=t.nodeId,n=t.offset,o=void 0===n?0:n;this.nodeId=e,this.offset=Math.max(o,0)}return t.fromJSON=function(e){var n=e.offset,o=void 0===n?0:n,i=e.nodeId;return new t({nodeId:i,offset:o})},t.prototype.toJSON=function(){return{nodeId:this.nodeId,offset:this.offset}},t.prototype.copy=function(){return new t(this)},t.prototype.equals=function(t){return this.nodeId===t.nodeId&&this.offset===t.offset},t.prototype.getNode=function(){return t=this.nodeId,null===(e=ir.getValue().document)||void 0===e?void 0:e.findNodeById(t);var t,e},t.prototype.isAfterPoint=function(t){var e=this.getNode();return t.nodeId===this.nodeId&&this.offset>t.offset||!!e&&e.isAfter(t.getNode())},t.prototype.isBeforePoint=function(t){var e=this.getNode();return t.nodeId===this.nodeId&&this.offset<t.offset||!!e&&e.isBefore(t.getNode())},t.prototype.isAtEndOfRange=function(t){return this.equals(t.getEnd())},t.prototype.isAtStartOfRange=function(t){return this.equals(t.getStart())},t.prototype.isBeforeRange=function(t){return this.isBeforePoint(t.getStart())},t.prototype.isAfterRange=function(t){return this.isAfterPoint(t.getEnd())},t.prototype.isInRange=function(t){return t&&(this.equals(t.getStart())||this.equals(t.getEnd())||this.isAfterPoint(t.getStart())&&this.isBeforePoint(t.getEnd()))},t.prototype.isAtEndOfNode=function(t){var e=t.getLastText();return!!e&&this.nodeId===e.id&&this.offset===e.getLength()},t.prototype.isAtStartOfNode=function(t){var e=t.getFirstText();return!!e&&this.nodeId===e.id&&0===this.offset},t.prototype.isInNode=function(t){return!(!t.isText()||t.id!==this.nodeId)||t.contains(this.getNode())},t.prototype.moveForward=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return t<=0||(this.offset=Math.min(this.offset+t,this.length())),this},t.prototype.moveBackward=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return t<=0||(this.offset=Math.max(this.offset-t,0)),this},t.prototype.moveTo=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.nodeId=t.id,this.offset=e<0?0:e>t.getLength()?t.getLength():e,this},t.prototype.moveToStartOfNode=function(t){var e=t.getFirstText();return e?this.moveTo(e):Tn.isFocusable(t)&&this.moveTo(t),this},t.prototype.moveToEndOfNode=function(t){var e=t.getLastText();return e?this.moveTo(e,e.getLength()):Tn.isFocusable(t)&&this.moveTo(t),this},t.prototype.length=function(){return this.getNode().getLength()},t}(),ar=function(t){return"number"==typeof t||Object(Ze.a)(t)&&"[object Number]"==Object(Re.a)(t)},sr=function(){function t(t){var e=t.anchor,n=t.focus;this.anchor=e,this.focus=n}return t.fromJSON=function(e){var n=e.anchor,o=void 0===n?{}:n,i=e.focus,r=void 0===i?{}:i;return new t({anchor:rr.fromJSON(o),focus:rr.fromJSON(r)})},t.prototype.toJSON=function(){return{anchor:this.anchor.toJSON(),focus:this.focus.toJSON()}},t.prototype.cloneContents=function(){return ir.getValue().getFragmentByRange(this)},t.prototype.copy=function(){return new t({anchor:this.anchor.copy(),focus:this.focus.copy()})},t.prototype.equals=function(t){return!!t&&this.anchor.equals(t.anchor)&&this.focus.equals(t.focus)},t.prototype.isCollapsed=function(){return this.anchor.equals(this.focus)},t.prototype.inSingleNode=function(){return this.anchor.nodeId===this.focus.nodeId},t.prototype.inSingleBlock=function(){var t=this.getStartBlock(),e=this.getEndBlock();return t&&e&&t.id===e.id},t.prototype.deepSomeNode=function(t){var e=!1;return this.deepForEachNode(function(n){e=e||t(n)}),e},t.prototype.someNode=function(t){var e=!1;return this.forEachNode(function(n){e=e||t(n)}),e},t.prototype.deepEveryNode=function(t){var e=!0;return this.deepForEachNode(function(n){t(n)||(e=!1)}),e},t.prototype.everyNode=function(t){var e=!0;return this.forEachNode(function(n){t(n)||(e=!1)}),e},t.prototype.isBackward=function(){return this.anchor.isAfterPoint(this.focus)},t.prototype.isStartNode=function(t){return!!t&&this.getStartNodeId()===t.id},t.prototype.isEndNode=function(t){return!!t&&this.getEndNodeId()===t.id},t.prototype.getAnchor=function(){return this.anchor},t.prototype.getFocus=function(){return this.focus},t.prototype.getStart=function(){return this.isBackward()?this.focus:this.anchor},t.prototype.getEnd=function(){return this.isBackward()?this.anchor:this.focus},t.prototype.getAnchorNode=function(){return this.anchor.getNode()},t.prototype.getFocusNode=function(){return this.focus.getNode()},t.prototype.getStartNode=function(){return this.getStart().getNode()},t.prototype.getStartBlock=function(){var t=this.getStartNode();return t.isText()?t.closest(function(t){return t.isBlock()}):t},t.prototype.getEndBlock=function(){var t=this.getEndNode();return t.isText()?t.closest(function(t){return t.isBlock()}):t},t.prototype.getCommonAncestor=function(){var t=this.getStartNode(),e=this.getEndNode();if(t&&e){var n=Et.findCommonAncestor(t,e);return n.isText()&&(n=n.closest(function(t){return t.isBlock()})),n}},t.prototype.getEndNode=function(){return this.getEnd().getNode()},t.prototype.getAnchorNodeId=function(){return this.getAnchor().nodeId},t.prototype.getFocusNodeId=function(){return this.getFocus().nodeId},t.prototype.getStartNodeId=function(){return this.getStart().nodeId},t.prototype.getEndNodeId=function(){return this.getEnd().nodeId},t.prototype.getAnchorOffset=function(){return this.anchor.offset},t.prototype.getFocusOffset=function(){return this.focus.offset},t.prototype.getStartOffset=function(){return this.getStart().offset},t.prototype.getEndOffset=function(){return this.getEnd().offset},t.prototype.setAnchorPoint=function(t){return t&&(this.anchor=t),this},t.prototype.setFocusPoint=function(t){return t&&(this.focus=t),this},t.prototype.setStartPoint=function(t){return this.isBackward()?this.setFocusPoint(t):this.setAnchorPoint(t),this},t.prototype.setEndPoint=function(t){return this.isBackward()?this.setAnchorPoint(t):this.setFocusPoint(t),this},t.prototype.setAnchor=function(t,e){return t&&ar(e)?this.setAnchorPoint(new rr({nodeId:t,offset:e})):this},t.prototype.setFocus=function(t,e){return t&&ar(e)?this.setFocusPoint(new rr({nodeId:t,offset:e})):this},t.prototype.setStart=function(t,e){return t&&ar(e)?this.setStartPoint(new rr({nodeId:t,offset:e})):this},t.prototype.setEnd=function(t,e){return t&&ar(e)?this.setEndPoint(new rr({nodeId:t,offset:e})):this},t.prototype.setPoints=function(t){return this.setAnchorPoint(t).setFocusPoint(t)},t.prototype.setAnchorNodeId=function(t){return t&&(this.anchor.nodeId=t),this},t.prototype.setFocusNodeId=function(t){return t&&(this.focus.nodeId=t),this},t.prototype.setStartNodeId=function(t){return this.isBackward()?this.setFocusNodeId(t):this.setAnchorNodeId(t)},t.prototype.setEndNodeId=function(t){return this.isBackward()?this.setAnchorNodeId(t):this.setFocusNodeId(t)},t.prototype.setAnchorOffset=function(t){return ar(t)&&(this.anchor.offset=Math.max(t,0)),this},t.prototype.setFocusOffset=function(t){return ar(t)&&(this.focus.offset=Math.max(t,0)),this},t.prototype.setStartOffset=function(t){return this.isBackward()?this.setFocusOffset(t):this.setAnchorOffset(t),this},t.prototype.setEndOffset=function(t){return this.isBackward()?this.setAnchorOffset(t):this.setFocusOffset(t),this},t.prototype.flip=function(){var t=this.getAnchor(),e=this.getFocus();return this.setAnchorPoint(e).setFocusPoint(t),this},t.prototype.collapseToEnd=function(){return this.setStartPoint(this.getEnd().copy())},t.prototype.collapseToStart=function(){return this.setEndPoint(this.getStart().copy())},t.prototype.move=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return 0===t?this:t>0?this.moveForward(t):this.moveBackward(-t)},t.prototype.moveForward=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return this.updatePoints(function(e){return e.moveForward(t)})},t.prototype.moveBackward=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return this.updatePoints(function(e){return e.moveBackward(t)})},t.prototype.moveEndBackward=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return this.getEnd().moveBackward(t),this},t.prototype.moveEndForward=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return this.getEnd().moveForward(t),this},t.prototype.moveEndTo=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return t&&this.getEnd().moveTo(t,e),this},t.prototype.moveEndToStartOfNode=function(t){return t&&this.getEnd().moveToStartOfNode(t),this},t.prototype.moveEndToEndOfNode=function(t){return t&&this.getEnd().moveToEndOfNode(t),this},t.prototype.moveStartBackward=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return this.getStart().moveBackward(t),this},t.prototype.moveStartForward=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return this.getStart().moveForward(t),this},t.prototype.moveStartTo=function(t,e){return t&&this.getStart().moveTo(t,e),this},t.prototype.moveStartToStartOfNode=function(t){return t&&this.getStart().moveToStartOfNode(t),this},t.prototype.moveStartToEndOfNode=function(t){return t&&this.getStart().moveToEndOfNode(t),this},t.prototype.moveTo=function(t,e){return t?this.updatePoints(function(n){return n.moveTo(t,e)}):this},t.prototype.moveToEndOfNode=function(t){return t?this.updatePoints(function(e){return e.moveToEndOfNode(t)}):this},t.prototype.moveToStartOfNode=function(t){return t?this.updatePoints(function(e){return e.moveToStartOfNode(t)}):this},t.prototype.moveToRangeOfNode=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;if(e.isBefore(t))return this;var n=null==t?void 0:t.getFirstText(),o=null==e?void 0:e.getLastText();return n&&o?(this.getStart().moveToStartOfNode(n),this.getEnd().moveToEndOfNode(o)):t&&e&&(this.getStart().moveToStartOfNode(t),this.getEnd().moveToEndOfNode(e)),this},t.prototype.forEachBlock=function(t){var e=this.getStartNode(),n=this.getEndNode(),o=e.parent,i=n.parent;if(this.inSingleNode()||e.parent===n.parent||o.isInline()&&o.parent===i||i.isInline()&&i.parent===o){var r=e.isBlock()?e:e.parent;t(r)}else{var a=Et.findCommonAncestor(e,n),s=a.deepIndexOf(e),l=a.deepIndexOf(n);a.nodes.slice(s,l+1).filter(function(t){return t.isBlock()||t.isInline()&&!Tn.isAtomic(t)}).forEach(function(e){return t(e)})}},t.prototype.forEachNode=function(t){if(this.inSingleNode())return t(this.anchor.getNode()),this;var e=this.getStartNode(),n=this.getEndNode(),o=Et.findCommonAncestor(e,n),i=o.deepIndexOf(e),r=o.deepIndexOf(n),a=o.nodes[i],s=o.nodes[r];return t(e),this.traverseStartNode(e,a,t),o.nodes.slice(i+1,r).forEach(function(e){return t(e)}),this.traverseEndNode(n,s,t),t(n),this},t.prototype.forEachText=function(t){this.forEachNode(function(e){return e.isText()&&t(e)})},t.prototype.deepForEachNode=function(t){this.forEachNode(function(e){return e.deepForEach(t)})},t.prototype.deepForEachText=function(t){this.deepForEachNode(function(e){return e.isText()&&t(e)})},t.prototype.getActiveMarks=function(){var t=this,e=null;return this.deepForEachText(function(n){var o=0,i=n.getLength();t.isStartNode(n)&&(o=t.getStartOffset()),t.isEndNode(n)&&(i=t.getEndOffset());var r=n.getActiveMarksBetweenOffsets(o,i);e=e?Sn.marksIntersect(e,r):r}),e||[]},t.prototype.getAllMarks=function(){var t=this,e=[];return this.deepForEachText(function(n){var o=0,i=n.getLength();t.isStartNode(n)&&(o=t.getStartOffset()),t.isEndNode(n)&&(i=t.getEndOffset()),e=Sn.marksUnion(e,n.getAllMarksBetweenOffsets(o,i))}),e},t.prototype.getText=function(){var t=this,e="";return this.deepForEachText(function(n){var o=0,i=n.getLength();t.isStartNode(n)&&(o=t.getStartOffset()),t.isEndNode(n)&&(i=t.getEndOffset()),e+=n.getText().substring(o,i)}),e},t.prototype.getCommonRange=function(e){var n=t.fromJSON({});return n.setAnchorPoint(this.getStart().isBeforeRange(e)?e.getStart():this.getStart()),n.setFocusPoint(this.getEnd().isAfterRange(e)?e.getEnd():this.getEnd()),n.isBackward()?null:n},t.prototype.traverseStartNode=function(t,e,n){if(t.parent&&e&&t.id!==e.id){var o=t.parent,i=t.index();o.nodes.slice(i+1,o.nodes.length).forEach(function(t){return n(t)}),this.traverseStartNode(o,e,n)}},t.prototype.traverseEndNode=function(t,e,n){if(t.parent&&e&&t.id!==e.id){var o=t.parent;this.traverseEndNode(o,e,n);var i=t.index();o.nodes.slice(0,i).forEach(function(t){return n(t)})}},t.prototype.updatePoints=function(t){return this.anchor=t(this.anchor),this.focus=t(this.focus),this},t}(),lr=function(t,e,n){var o,i;return n===f.FORWARD?o=t.getText().slice(e).split(cr).filter(function(t){return""!==t})[0]:n===f.BACKWARD&&(o=t.getText().slice(0,e).split(cr).filter(function(t){return""!==t}).slice(-1)[0]),i=o,cr.test(i)?o.length:1},cr=/([\uD800-\uDBFF][\uDC00-\uDFFF](?:[\u200D\uFE0F][\uD800-\uDBFF][\uDC00-\uDFFF]){2,}|\uD83D\uDC69(?:\u200D(?:(?:\uD83D\uDC69\u200D)?\uD83D\uDC67|(?:\uD83D\uDC69\u200D)?\uD83D\uDC66)|\uD83C[\uDFFB-\uDFFF])|\uD83D\uDC69\u200D(?:\uD83D\uDC69\u200D)?\uD83D\uDC66\u200D\uD83D\uDC66|\uD83D\uDC69\u200D(?:\uD83D\uDC69\u200D)?\uD83D\uDC67\u200D(?:\uD83D[\uDC66\uDC67])|\uD83C\uDFF3\uFE0F\u200D\uD83C\uDF08|(?:\uD83C[\uDFC3\uDFC4\uDFCA]|\uD83D[\uDC6E\uDC71\uDC73\uDC77\uDC81\uDC82\uDC86\uDC87\uDE45-\uDE47\uDE4B\uDE4D\uDE4E\uDEA3\uDEB4-\uDEB6]|\uD83E[\uDD26\uDD37-\uDD39\uDD3D\uDD3E\uDDD6-\uDDDD])(?:\uD83C[\uDFFB-\uDFFF])\u200D[\u2640\u2642]\uFE0F|\uD83D\uDC69(?:\uD83C[\uDFFB-\uDFFF])\u200D(?:\uD83C[\uDF3E\uDF73\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92])|(?:\uD83C[\uDFC3\uDFC4\uDFCA]|\uD83D[\uDC6E\uDC6F\uDC71\uDC73\uDC77\uDC81\uDC82\uDC86\uDC87\uDE45-\uDE47\uDE4B\uDE4D\uDE4E\uDEA3\uDEB4-\uDEB6]|\uD83E[\uDD26\uDD37-\uDD39\uDD3C-\uDD3E\uDDD6-\uDDDF])\u200D[\u2640\u2642]\uFE0F|\uD83C\uDDFD\uD83C\uDDF0|\uD83C\uDDF6\uD83C\uDDE6|\uD83C\uDDF4\uD83C\uDDF2|\uD83C\uDDE9(?:\uD83C[\uDDEA\uDDEC\uDDEF\uDDF0\uDDF2\uDDF4\uDDFF])|\uD83C\uDDF7(?:\uD83C[\uDDEA\uDDF4\uDDF8\uDDFA\uDDFC])|\uD83C\uDDE8(?:\uD83C[\uDDE6\uDDE8\uDDE9\uDDEB-\uDDEE\uDDF0-\uDDF5\uDDF7\uDDFA-\uDDFF])|(?:\u26F9|\uD83C[\uDFCB\uDFCC]|\uD83D\uDD75)(?:\uFE0F\u200D[\u2640\u2642]|(?:\uD83C[\uDFFB-\uDFFF])\u200D[\u2640\u2642])\uFE0F|(?:\uD83D\uDC41\uFE0F\u200D\uD83D\uDDE8|\uD83D\uDC69(?:\uD83C[\uDFFB-\uDFFF])\u200D[\u2695\u2696\u2708]|\uD83D\uDC69\u200D[\u2695\u2696\u2708]|\uD83D\uDC68(?:(?:\uD83C[\uDFFB-\uDFFF])\u200D[\u2695\u2696\u2708]|\u200D[\u2695\u2696\u2708]))\uFE0F|\uD83C\uDDF2(?:\uD83C[\uDDE6\uDDE8-\uDDED\uDDF0-\uDDFF])|\uD83D\uDC69\u200D(?:\uD83C[\uDF3E\uDF73\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\u2764\uFE0F\u200D(?:\uD83D\uDC8B\u200D(?:\uD83D[\uDC68\uDC69])|\uD83D[\uDC68\uDC69]))|\uD83C\uDDF1(?:\uD83C[\uDDE6-\uDDE8\uDDEE\uDDF0\uDDF7-\uDDFB\uDDFE])|\uD83C\uDDEF(?:\uD83C[\uDDEA\uDDF2\uDDF4\uDDF5])|\uD83C\uDDED(?:\uD83C[\uDDF0\uDDF2\uDDF3\uDDF7\uDDF9\uDDFA])|\uD83C\uDDEB(?:\uD83C[\uDDEE-\uDDF0\uDDF2\uDDF4\uDDF7])|[#\*0-9]\uFE0F\u20E3|\uD83C\uDDE7(?:\uD83C[\uDDE6\uDDE7\uDDE9-\uDDEF\uDDF1-\uDDF4\uDDF6-\uDDF9\uDDFB\uDDFC\uDDFE\uDDFF])|\uD83C\uDDE6(?:\uD83C[\uDDE8-\uDDEC\uDDEE\uDDF1\uDDF2\uDDF4\uDDF6-\uDDFA\uDDFC\uDDFD\uDDFF])|\uD83C\uDDFF(?:\uD83C[\uDDE6\uDDF2\uDDFC])|\uD83C\uDDF5(?:\uD83C[\uDDE6\uDDEA-\uDDED\uDDF0-\uDDF3\uDDF7-\uDDF9\uDDFC\uDDFE])|\uD83C\uDDFB(?:\uD83C[\uDDE6\uDDE8\uDDEA\uDDEC\uDDEE\uDDF3\uDDFA])|\uD83C\uDDF3(?:\uD83C[\uDDE6\uDDE8\uDDEA-\uDDEC\uDDEE\uDDF1\uDDF4\uDDF5\uDDF7\uDDFA\uDDFF])|\uD83C\uDFF4\uDB40\uDC67\uDB40\uDC62(?:\uDB40\uDC77\uDB40\uDC6C\uDB40\uDC73|\uDB40\uDC73\uDB40\uDC63\uDB40\uDC74|\uDB40\uDC65\uDB40\uDC6E\uDB40\uDC67)\uDB40\uDC7F|\uD83D\uDC68(?:\u200D(?:\u2764\uFE0F\u200D(?:\uD83D\uDC8B\u200D)?\uD83D\uDC68|(?:(?:\uD83D[\uDC68\uDC69])\u200D)?\uD83D\uDC66\u200D\uD83D\uDC66|(?:(?:\uD83D[\uDC68\uDC69])\u200D)?\uD83D\uDC67\u200D(?:\uD83D[\uDC66\uDC67])|\uD83C[\uDF3E\uDF73\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92])|(?:\uD83C[\uDFFB-\uDFFF])\u200D(?:\uD83C[\uDF3E\uDF73\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]))|\uD83C\uDDF8(?:\uD83C[\uDDE6-\uDDEA\uDDEC-\uDDF4\uDDF7-\uDDF9\uDDFB\uDDFD-\uDDFF])|\uD83C\uDDF0(?:\uD83C[\uDDEA\uDDEC-\uDDEE\uDDF2\uDDF3\uDDF5\uDDF7\uDDFC\uDDFE\uDDFF])|\uD83C\uDDFE(?:\uD83C[\uDDEA\uDDF9])|\uD83C\uDDEE(?:\uD83C[\uDDE8-\uDDEA\uDDF1-\uDDF4\uDDF6-\uDDF9])|\uD83C\uDDF9(?:\uD83C[\uDDE6\uDDE8\uDDE9\uDDEB-\uDDED\uDDEF-\uDDF4\uDDF7\uDDF9\uDDFB\uDDFC\uDDFF])|\uD83C\uDDEC(?:\uD83C[\uDDE6\uDDE7\uDDE9-\uDDEE\uDDF1-\uDDF3\uDDF5-\uDDFA\uDDFC\uDDFE])|\uD83C\uDDFA(?:\uD83C[\uDDE6\uDDEC\uDDF2\uDDF3\uDDF8\uDDFE\uDDFF])|\uD83C\uDDEA(?:\uD83C[\uDDE6\uDDE8\uDDEA\uDDEC\uDDED\uDDF7-\uDDFA])|\uD83C\uDDFC(?:\uD83C[\uDDEB\uDDF8])|(?:\u26F9|\uD83C[\uDFCB\uDFCC]|\uD83D\uDD75)(?:\uD83C[\uDFFB-\uDFFF])|(?:\uD83C[\uDFC3\uDFC4\uDFCA]|\uD83D[\uDC6E\uDC71\uDC73\uDC77\uDC81\uDC82\uDC86\uDC87\uDE45-\uDE47\uDE4B\uDE4D\uDE4E\uDEA3\uDEB4-\uDEB6]|\uD83E[\uDD26\uDD37-\uDD39\uDD3D\uDD3E\uDDD6-\uDDDD])(?:\uD83C[\uDFFB-\uDFFF])|(?:[\u261D\u270A-\u270D]|\uD83C[\uDF85\uDFC2\uDFC7]|\uD83D[\uDC42\uDC43\uDC46-\uDC50\uDC66\uDC67\uDC70\uDC72\uDC74-\uDC76\uDC78\uDC7C\uDC83\uDC85\uDCAA\uDD74\uDD7A\uDD90\uDD95\uDD96\uDE4C\uDE4F\uDEC0\uDECC]|\uD83E[\uDD18-\uDD1C\uDD1E\uDD1F\uDD30-\uDD36\uDDD1-\uDDD5])(?:\uD83C[\uDFFB-\uDFFF])|\uD83D\uDC68(?:\u200D(?:(?:(?:\uD83D[\uDC68\uDC69])\u200D)?\uD83D\uDC67|(?:(?:\uD83D[\uDC68\uDC69])\u200D)?\uD83D\uDC66)|\uD83C[\uDFFB-\uDFFF])|(?:[\u261D\u26F9\u270A-\u270D]|\uD83C[\uDF85\uDFC2-\uDFC4\uDFC7\uDFCA-\uDFCC]|\uD83D[\uDC42\uDC43\uDC46-\uDC50\uDC66-\uDC69\uDC6E\uDC70-\uDC78\uDC7C\uDC81-\uDC83\uDC85-\uDC87\uDCAA\uDD74\uDD75\uDD7A\uDD90\uDD95\uDD96\uDE45-\uDE47\uDE4B-\uDE4F\uDEA3\uDEB4-\uDEB6\uDEC0\uDECC]|\uD83E[\uDD18-\uDD1C\uDD1E\uDD1F\uDD26\uDD30-\uDD39\uDD3D\uDD3E\uDDD1-\uDDDD])(?:\uD83C[\uDFFB-\uDFFF])?|(?:[\u231A\u231B\u23E9-\u23EC\u23F0\u23F3\u25FD\u25FE\u2614\u2615\u2648-\u2653\u267F\u2693\u26A1\u26AA\u26AB\u26BD\u26BE\u26C4\u26C5\u26CE\u26D4\u26EA\u26F2\u26F3\u26F5\u26FA\u26FD\u2705\u270A\u270B\u2728\u274C\u274E\u2753-\u2755\u2757\u2795-\u2797\u27B0\u27BF\u2B1B\u2B1C\u2B50\u2B55]|\uD83C[\uDC04\uDCCF\uDD8E\uDD91-\uDD9A\uDDE6-\uDDFF\uDE01\uDE1A\uDE2F\uDE32-\uDE36\uDE38-\uDE3A\uDE50\uDE51\uDF00-\uDF20\uDF2D-\uDF35\uDF37-\uDF7C\uDF7E-\uDF93\uDFA0-\uDFCA\uDFCF-\uDFD3\uDFE0-\uDFF0\uDFF4\uDFF8-\uDFFF]|\uD83D[\uDC00-\uDC3E\uDC40\uDC42-\uDCFC\uDCFF-\uDD3D\uDD4B-\uDD4E\uDD50-\uDD67\uDD7A\uDD95\uDD96\uDDA4\uDDFB-\uDE4F\uDE80-\uDEC5\uDECC\uDED0-\uDED2\uDEEB\uDEEC\uDEF4-\uDEF8]|\uD83E[\uDD10-\uDD3A\uDD3C-\uDD3E\uDD40-\uDD45\uDD47-\uDD4C\uDD50-\uDD6B\uDD80-\uDD97\uDDC0\uDDD0-\uDDE6])|(?:[#\*0-9\xA9\xAE\u203C\u2049\u2122\u2139\u2194-\u2199\u21A9\u21AA\u231A\u231B\u2328\u23CF\u23E9-\u23F3\u23F8-\u23FA\u24C2\u25AA\u25AB\u25B6\u25C0\u25FB-\u25FE\u2600-\u2604\u260E\u2611\u2614\u2615\u2618\u261D\u2620\u2622\u2623\u2626\u262A\u262E\u262F\u2638-\u263A\u2640\u2642\u2648-\u2653\u2660\u2663\u2665\u2666\u2668\u267B\u267F\u2692-\u2697\u2699\u269B\u269C\u26A0\u26A1\u26AA\u26AB\u26B0\u26B1\u26BD\u26BE\u26C4\u26C5\u26C8\u26CE\u26CF\u26D1\u26D3\u26D4\u26E9\u26EA\u26F0-\u26F5\u26F7-\u26FA\u26FD\u2702\u2705\u2708-\u270D\u270F\u2712\u2714\u2716\u271D\u2721\u2728\u2733\u2734\u2744\u2747\u274C\u274E\u2753-\u2755\u2757\u2763\u2764\u2795-\u2797\u27A1\u27B0\u27BF\u2934\u2935\u2B05-\u2B07\u2B1B\u2B1C\u2B50\u2B55\u3030\u303D\u3297\u3299]|\uD83C[\uDC04\uDCCF\uDD70\uDD71\uDD7E\uDD7F\uDD8E\uDD91-\uDD9A\uDDE6-\uDDFF\uDE01\uDE02\uDE1A\uDE2F\uDE32-\uDE3A\uDE50\uDE51\uDF00-\uDF21\uDF24-\uDF93\uDF96\uDF97\uDF99-\uDF9B\uDF9E-\uDFF0\uDFF3-\uDFF5\uDFF7-\uDFFF]|\uD83D[\uDC00-\uDCFD\uDCFF-\uDD3D\uDD49-\uDD4E\uDD50-\uDD67\uDD6F\uDD70\uDD73-\uDD7A\uDD87\uDD8A-\uDD8D\uDD90\uDD95\uDD96\uDDA4\uDDA5\uDDA8\uDDB1\uDDB2\uDDBC\uDDC2-\uDDC4\uDDD1-\uDDD3\uDDDC-\uDDDE\uDDE1\uDDE3\uDDE8\uDDEF\uDDF3\uDDFA-\uDE4F\uDE80-\uDEC5\uDECB-\uDED2\uDEE0-\uDEE5\uDEE9\uDEEB\uDEEC\uDEF0\uDEF3-\uDEF8]|\uD83E[\uDD10-\uDD3A\uDD3C-\uDD3E\uDD40-\uDD45\uDD47-\uDD4C\uDD50-\uDD6B\uDD80-\uDD97\uDDC0\uDDD0-\uDDE6])\uFE0F)/,ur=function(t){return function(e){return function(n){return Object.defineProperty(n,t,{value:e,writable:!1}),n}}},dr=(ur(Tn.undraggable)(!0),ur(Tn.undroppable)(!0),ur(Tn.focusable)(!0),ur(Tn.atomic)(!0),ur(Tn.depend),ur(Tn.defaults)(!0));ur(Tn.container)(!0);var pr,hr=n(352);!function(t){t.note="note",t.head="head",t.body="body",t.fileId="file-id",t.fileVersion="file-version",t.para="para",t.todo="todo",t.list="list",t.listItem="list-item",t.catalogue="catalogue",t.heading="heading",t.quote="quote",t.attach="attach",t.image="image",t.table="table",t.code="code",t.layout="layout",t.hr="horizontal-line",t.coId="coId",t.id="id",t.blockStyles="styles",t.compat="compat",t.align="align",t.margin="margin",t.indent="indent",t.textIndent="text-indent",t.lineHeight="line-height",t.blockBackColor="back-color",t.padding="padding",t.float="float",t.text="text",t.inlineStyles="inline-styles",t.from="from",t.to="to",t.value="value",t.bold="bold",t.italic="italic",t.underline="underline",t.strike="strike",t.color="color",t.inlineBackColor="back-color",t.fontSize="font-size",t.fontFamily="font-family",t.imageSource="source",t.imageTitle="text",t.imageHeight="height",t.imageWidth="width",t.imageFloat="float",t.attachSource="source",t.attachResource="resource",t.attachName="filename",t.attachLength="filelength",t.catalogHref="href",t.catalogIndent="indent",t.catalogValue="value",t.catalogueWrap="catalogue-wrap",t.catalogueId="catalogue-id",t.hrType="type",t.hrColor="color",t.linkHref="href",t.tableContent="content",t.tableResources="resource-list",t.tableResource="resource-mono",t.tableResId="res-id",t.tableImageRes="image",t.tableImageResSource="source",t.tableImageResWidth="width",t.tableImageResHeight="height",t.tableAttachRes="attach",t.tableAttachResSource="source",t.tableAttachResResource="resource",t.tableAttachResName="filename",t.tableAttachResLength="filelength",t.checked="checked",t.language="language",t.theme="theme",t.level="level",t.header="header",t.footer="footer",t.headerContent="text",t.footerContent="text",t.headerStyle="styles",t.footerStyle="styles",t.listType="type",t.listId="list-id",t.unknown="unknown",t.unknownContent="content"}(pr||(pr={}));var fr=n(1),gr=n.n(fr);function mr(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,o)}return n}function yr(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?mr(Object(n),!0).forEach(function(e){vr(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):mr(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function vr(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}n(360);var _r=function(t){function e(e){var n=this;return(n=t.call(this,e)||this).isBlinkRestart=!1,n}return s(e,t),e.prototype.render=function(){var t=this.props,e=t.top,n=t.left,o=t.show,i=t.style,r=t.blink,a=void 0===r||r,s=yr({},i,{},br);o||(s=yr({},s,{},Cr)),this.isBlinkRestart=!this.isBlinkRestart;var l=a?this.isBlinkRestart?"caret blink-restart":"caret blink":"caret";return fr.createElement("div",{style:yr({},kr,{top:e,left:n})},fr.createElement("div",{className:l,style:s}))},e}(fr.Component),br={position:"absolute",width:0,fontSize:0,borderLeft:"1px solid"},Cr={opacity:0},kr={position:"absolute",zIndex:100},wr=function(){return document.querySelector(".bulb-scroll-container")};fr.PureComponent;var Sr=!1;function xr(t){Sr=t}function Er(t){if(null==t?void 0:t.isCollapsed()){var e=Ai.toNativeRange(t),n=Tr(e);if(n){var o=null==e?void 0:e.startContainer;return o?(o.nodeType===Node.TEXT_NODE&&(o=o.parentElement),{scrollEl:n,targetNode:o}):void 0}}}var Ir="bulb-scroll";fr.Component,ir.on(h.SELECTION_DID_UPDATE,function(){var t=ir.getBulbRange();if(!Sr){var e=Er(ir.getBulbRange())||{},n=e.targetNode,o=e.scrollEl;if(n&&o){var i=Ai.toNativeRange(t).getBoundingClientRect().left,r=o.getBoundingClientRect(),a=r.left,s=r.right;i<a&&(o.scrollLeft+=i-a-36),i+12>s&&(o.scrollLeft+=i-s+12)}}}),ir.registerPlugins(function(t){function e(){var e=this;return(e=t.apply(this,arguments)||this).name="PreventMouseDown",e}return s(e,t),e.prototype.onEvent=function(t,e){if(e.type!==ei.MouseDown)return xr(!1),t;var n=Er(e.getRange())||{},o=n.targetNode,i=n.scrollEl;if(!o||!i)return t;(function(t,e){var n=t.getBoundingClientRect().bottom;return e.pageY>n})(i.firstChild,e)&&(xr(!0),e.preventDefault(),e.stopPropagation())},e}(Mo));var Tr=function(t){var e,n=t;return t instanceof Range&&(n=t.startContainer.parentElement),null===(e=n)||void 0===e?void 0:e.closest("."+Ir)};fr.Component,fr.PureComponent,Object.prototype.hasOwnProperty,new Map,fr.Component,fr.Component;var Or,Ar=function(t,e){var n,o;if(e=null!==(n=e)&&void 0!==n?n:null===(o=document.querySelector(".caret"))||void 0===o?void 0:o.getBoundingClientRect(),2===(null==t?void 0:t.length)){var i,r,a=t[0],s=t[1];if(a.width<=1&&s.width<=1&&a.right>s.left&&a.top<s.top)return Math.abs(a.right-(null===(i=e)||void 0===i?void 0:i.right))>Math.abs(s.right-(null===(r=e)||void 0===r?void 0:r.right))?On.LineStart:On.LineEnd}return On.LineCenter};!function(t){t.RANGE="range",t.ELEMENT="element"}(Or||(Or={}));var Nr=[ti.ArrowUp,ti.ArrowDown,ti.ArrowLeft,ti.ArrowRight];new(function(){function t(){var t=this;this.handle=function(e){var n=e.getRange();t.shouldHandleArrow(e)&&(t.handleArrowMove(e,n),e.preventDefault())},this.handleArrowMove=function(e,n){var o=t.getDirection(e);t.caretBase=t.getCaretBase(n,o),e.shiftKey?t.moveWithSelection(n,e,o):t.move(n,e,o);var i=t.getCaretBase(n,o),r=i.x,a=i.y;t.caretBase.y=a,t.shouldHoldCaretX(e)||(t.caretBase.x=r),t.setBulbSelection(n)},this.moveWithSelection=function(e,n,o){var i=e.getAnchor().copy();t.move(e,n,o),e.setAnchorPoint(i)},this.move=function(e,n,o){var i=ir.platform;if(i.isWindows())switch(n.key){case ti.ArrowUp:case ti.ArrowDown:return n.ctrlKey?t.moveToBlockBoundary(e,n,o):t.moveVertical(e,n,o);case ti.ArrowLeft:case ti.ArrowRight:return t.moveHorizontal(e,n,o,n.ctrlKey)}if(i.isMac())switch(n.key){case ti.ArrowUp:case ti.ArrowDown:return n.ctrlKey?t.moveToDocBoundary(e,n,o):n.altKey?t.moveToBlockBoundary(e,n,o):t.moveVertical(e,n,o);case ti.ArrowLeft:case ti.ArrowRight:return n.ctrlKey?t.moveToRowBoundary():t.moveHorizontal(e,n,o,n.altKey)}},this.moveVertical=function(e,n,o){if(t.shouldCollapseRange(e,n))return t.collapseRange(e,o);for(var i,r=t.caretBase.x,a=t.caretBase.x,s=t.caretBase.y,l=t.getRectHeight(e);!t.shouldStopMoveCaret(i,r,s,e,o,l)&&(i=t.moveHorizontal(e,n,o,!1));){a=r;var c=t.getCaretBase(e,o),u=c.x,d=c.y;r=u,s=d}return i&&i.isText()&&Math.abs(r-t.caretBase.x)>Math.abs(a-t.caretBase.x)&&(o===f.FORWARD?e.moveBackward():e.moveForward()),i},this.moveHorizontal=function(e,n,o,i){if(t.shouldCollapseRange(e,n))return t.collapseRange(e,o);var r=e.getFocusNode(),a=t.isAtTextBoundary(e,o);return r.isText()&&!a?t.moveInSameText(r,i,e,o):t.moveFromTextBoundary(r,e,o)},this.moveToBlockBoundary=function(e,n,o){if(t.shouldCollapseRange(e,n))return t.collapseRange(e,o);var i=e.getFocusNode();return i.isBlock()||t.isAtBlockBoundary(e,o)?t.moveToAnotherBlockBoundary(i,e,o):t.moveToCurrentBlockBoundary(i,e,o)},this.moveToCurrentBlockBoundary=function(t,e,n){var o,i,r=t.parent;return n===f.FORWARD?(o=r.nodes[r.nodes.length-1],i=o.isText()?o.getLength():1):(o=r.nodes[0],i=0),e.moveTo(o,i),o},this.moveToAnotherBlockBoundary=function(e,n,o){var i=t.getNode(e,o);return i?(i.isText()?(t.moveToText(i,e,n,o),i=t.moveToCurrentBlockBoundary(i,n,o)):t.moveToBlock(i,n,o),i):null},this.moveToDocBoundary=function(e,n,o){if(t.shouldCollapseRange(e,n))return t.collapseRange(e,o);var i,r,a=ir.getDocument().nodes;if(o===f.FORWARD){for(;a.length;)i=a[a.length-1],a=i.nodes;for(;!t.canSetRange(i);)i=i.pre(gt.DepthFirst);r=i.isText()?i.getLength():1}else{for(i=a[0];!t.canSetRange(i);)i=i.next(gt.DepthFirst);r=0}e.moveTo(i,r)},this.moveToRowBoundary=function(){},this.moveInSameText=function(e,n,o,i){if(n)t.moveBySegment(e,o,i);else{var r=lr(e,o.getFocusOffset(),i);i===f.FORWARD?o.moveForward(r):i===f.BACKWARD&&o.moveBackward(r)}return e},this.moveFromTextBoundary=function(e,n,o){var i=t.getNode(e,o);return i?(i.isText()?t.moveToText(i,e,n,o):t.moveToBlock(i,n,o),i):null},this.moveBySegment=function(t,e,n){var o,i=t.getText(),r=e.getFocusOffset(),a=wi(i,r),s=a.start,l=a.end;n===f.FORWARD?o=l:r===(o=s)&&(o=wi(i,r-1).start),e.moveTo(t,o)},this.moveToText=function(t,e,n,o){if(n&&t){var i,r=e.parent.isInline()?e.parent.parent:e.parent,a=t.parent.isInline()?t.parent.parent:t.parent;if(o===f.FORWARD)i=e.isText()&&r===a?1:0;else{var s=t.getLength();i=e.isText()&&r===a?s-1:s}n.moveTo(t,i)}},this.moveToBlock=function(t,e,n){if(e&&t){var o=n===f.FORWARD?1:0;e.moveTo(t,o)}},this.isAtTextBoundary=function(t,e){var n=t.getFocus(),o=n.offset,i=n.getNode();if(i.isText()){var r=i.getLength();return e===f.FORWARD?o===r:0===o}},this.isAtBlockBoundary=function(t,e){var n=t.getFocus(),o=n.offset,i=n.getNode(),r=i.parent.nodes.indexOf(i),a=i.parent.nodes.length;if(i.isText()){var s=i.getLength();return e===f.FORWARD?r===a-1&&o===s:0===r&&0===o}if(i.isInline())return e===f.FORWARD?r===a:0===r},this.canSetRange=function(t){return!!t&&!(t.isText()&&0===t.getLength()&&t.closest(function(t){return t.isBlock()}).getLength()>0)&&(t.isText()||Tn.isFocusable(t)&&Tn.isAtomic(t))},this.shouldCollapseRange=function(t,e){return!t.isCollapsed()&&!e.shiftKey},this.shouldHoldCaretX=function(t){return!(t.ctrlKey||t.altKey||t.key===ti.ArrowLeft||t.key===ti.ArrowRight)},this.shouldStopMoveCaret=function(e,n,o,i,r,a){if(o<=0||o>=document.documentElement.offsetHeight)return!0;if(!e)return!1;if(e.isText()){var s=e.closest(function(t){return t.isBlock()}),l=s.getLength(),c=0;if(s.deepForEach(function(t){t.isText()&&(t.isBefore(e)?c+=t.getLength():t.id===e.id&&(c+=i.getFocusOffset()))}),r===f.FORWARD&&o>t.caretBase.y+a)return c>=l||n>=t.caretBase.x;var u=t.getRectHeight(i);if(r===f.BACKWARD&&o<t.caretBase.y-u)return c<=0||n<=t.caretBase.x}return Tn.isFocusable(e)&&Tn.isAtomic(e)},this.getDirection=function(t){switch(t.key){case ti.ArrowUp:case ti.ArrowLeft:return f.BACKWARD;case ti.ArrowDown:case ti.ArrowRight:return f.FORWARD}},this.getRects=function(t){var e=Ai.toNativeRange(t);if(!e)return null;var n=e.getClientRects(),o=Or.RANGE;n.length||(n=e.startContainer.getClientRects(),o=Or.ELEMENT);var i=Array.from(n),r=Ar(i);return r===On.LineEnd?i.pop():r===On.LineStart&&i.shift(),{value:i,type:o}},this.getRectHeight=function(e){return t.getRects(e).value[0].height},this.getCaretBase=function(e,n){var o,i,r=t.getRects(e);if(!r)return null;var a=r.value,s=r.type;return s===Or.ELEMENT?(o=n===f.BACKWARD?a[0].right:a[0].left,i=a[0].top):(o=e.isBackward()?a[0].left:a[a.length-1].right,i=e.isBackward()?a[0].top:a[a.length-1].top),{x:Math.floor(o+window.scrollX),y:Math.floor(i+window.scrollY)}},this.getNode=function(e,n){var o=e;do{if(!o)return null;o=n===f.FORWARD?o.next(gt.DepthFirst):o.pre(gt.DepthFirst)}while(!t.canSetRange(o));return o},this.setBulbSelection=function(t){var e,n=Array.from(Ai.toNativeRange(t).getClientRects()),o=new Bn({range:t,position:Ar(n)});if(t.isCollapsed()){var i=t.getStartNode();Tn.isFocusable(i)&&o.setData(i.id,((e={})[ln.focusable]=!0,e))}ir.setBulbSelection(o)},this.collapseRange=function(t,e){return e===f.FORWARD?(t.collapseToEnd(),t.getEndNode()):(t.collapseToStart(),t.getStartNode())}}return t.prototype.shouldHandleArrow=function(t){return t instanceof ai&&Nr.includes(t.key)},t}());var Dr,Br=function(){return Rt.a.Date.now()},Rr=/^\s+|\s+$/g,Lr=/^[-+]0x[0-9a-f]+$/i,Pr=/^0b[01]+$/i,Mr=/^0o[0-7]+$/i,Fr=parseInt,Hr=function(t){if("number"==typeof t)return t;if(lo(t))return NaN;if(Object(Mt.a)(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=Object(Mt.a)(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(Rr,"");var n=Pr.test(t);return n||Mr.test(t)?Fr(t.slice(2),n?2:8):Lr.test(t)?NaN:+t},jr=Math.max,Vr=Math.min,Ur=function(t,e,n){var o,i,r,a,s,l,c=0,u=!1,d=!1,p=!0;if("function"!=typeof t)throw new TypeError("Expected a function");function h(e){var n=o,r=i;return o=i=void 0,c=e,a=t.apply(r,n)}function f(t){var n=t-l;return void 0===l||n>=e||n<0||d&&t-c>=r}function g(){var t=Br();if(f(t))return m(t);s=setTimeout(g,function(t){var n=e-(t-l);return d?Vr(n,r-(t-c)):n}(t))}function m(t){return s=void 0,p&&o?h(t):(o=i=void 0,a)}function y(){var t=Br(),n=f(t);if(o=arguments,i=this,l=t,n){if(void 0===s)return function(t){return c=t,s=setTimeout(g,e),u?h(t):a}(l);if(d)return clearTimeout(s),s=setTimeout(g,e),h(l)}return void 0===s&&(s=setTimeout(g,e)),a}return e=Hr(e)||0,Object(Mt.a)(n)&&(u=!!n.leading,r=(d="maxWait"in n)?jr(Hr(n.maxWait)||0,e):r,p="trailing"in n?!!n.trailing:p),y.cancel=function(){void 0!==s&&clearTimeout(s),c=0,o=l=i=s=void 0},y.flush=function(){return void 0===s?a:m(Br())},y},zr=function(){function t(){}return t.scrollElBy=function(e,n){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:40,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.getScrollContainer();0===e&&0===n||(e+=e>0?o:-o,n+=n>0?o:-o,i.scrollLeft+=e,i.scrollTop+=n)},t.getScrollContainer=function(){return t.scrollView||(t.scrollView=wr()),t.scrollView},t.getScrollDistanceByCursorDistanceToBoundary=function(t){return Math.ceil(20/Math.max(Math.abs(t),2.5))},t}();function Gr(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,o)}return n}function Jr(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Wr(t){return function(t){if(Array.isArray(t))return $r(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return $r(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?$r(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function $r(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}zr.blockXAxisScrollingBySelecting=function(t,e,n){var o=!0,i=!0;if("function"!=typeof t)throw new TypeError("Expected a function");return Object(Mt.a)(n)&&(o="leading"in n?!!n.leading:o,i="trailing"in n?!!n.trailing:i),Ur(t,e,{leading:o,maxWait:e,trailing:i})}(function(t){if(Wo.isSelecting()&&t&&!t.isCollapsed()){var e=Ti(t.getFocusNode().id).closest("."+Ir),n=null==e?void 0:e.getBoundingClientRect(),o=(Wo.getCurrentEvent()||{}).pageX;if(n&&null!=o)if(t.isBackward()){var i=n.left-o;i<0&&-i<60&&zr.scrollElBy(-15,0,null,e)}else{var r=n.right-o;r>0&&r<60&&zr.scrollElBy(15,0,null,e)}}},150),zr.scrollPageYAxisBySelecting=function(){var t=Wo.getBulbRange();if(!Wo.isSelecting()||!t||t.isCollapsed())return zr.setY(null);var e=(document.documentElement||{}).offsetHeight,n=(Wo.getCurrentEvent()||{}).pageY,o=null!=n;if(!zr.stopped||o)if(o||(n=zr.mouseY),n>0&&(zr.stopped=n<zr.mouseY,zr.stopped))zr.mouseY=n;else{o&&zr.setY(n);var i=0;if(t.isBackward())Math.abs(n)<60&&(i=-zr.getScrollDistanceByCursorDistanceToBoundary(n),setTimeout(function(){zr.scrollPageYAxisBySelecting()},20));else{var r=e-n;r<60&&(i=zr.getScrollDistanceByCursorDistanceToBoundary(r),setTimeout(function(){zr.scrollPageYAxisBySelecting()},20))}zr.scrollElBy(scrollX,i,0)}},zr.setY=function(t){zr.mouseY=t},zr.scrollView=null,zr.mouseY=null,zr.stopped=!1,fr.PureComponent;var Kr=function(t){var e=wr(),n=null==e?void 0:e.getBoundingClientRect();return{top:Math.round(t.top-n.top+e.scrollTop),left:Math.round(t.left-n.left+e.scrollLeft),height:Math.round(t.height),width:Math.round(t.width),bottom:Math.round(t.bottom-n.top+e.scrollTop),right:Math.round(t.right-n.left+e.scrollLeft)}},Yr=function(t){if(!t||t.isEmpty())return[];var e=t.range.copy();e.isCollapsed()||0===e.getEndOffset()&&0===e.getEndNode().getLength()&&e.setEndOffset(1);var n=Ai.toNativeRange(e);if(!n)return[];var o=Array.from(n.getClientRects()),i=zo(g.BEFORE_CONVERT_RECTS)||[];i=Qr(o.concat(i).map(Kr));var r=function(t){var e=Array.from(t.commonAncestorContainer.childNodes);return(e=e.slice(e.findIndex(function(e){return e.contains(t.startContainer)}),e.findIndex(function(e){return e.contains(t.endContainer)})+1)).reduce(function(t,e){return e.querySelectorAll("."+Ir).forEach(function(e){var n=Kr(e.getBoundingClientRect());t.push(n)}),t},[])}(n),a=function(t){var e=Tr(t);return e&&Kr(e.getBoundingClientRect())}(n),s=a?[a].concat(Wr(r)):r;return i=qr(Qr(na(i,s))),zo(g.AFTER_CONVERT_RECTS,i)||i},Xr=function(t,e){return!(!t||!e)&&t.top<=e.top&&t.left<=e.left&&t.bottom>=e.bottom&&t.right>=e.right},qr=function(t){return t.reduce(function(t,e){return t.length?t.some(function(n,o){if((Zr(n,e)||Zr(e,n))&&ea(n,e)){var i=ta(n,e);return t[o]=i,!0}return!1})?t:[].concat(Wr(t),[e]):[e]},[])},Qr=function(t){return t.reduce(function(t,e){return t.length?t.some(function(n,o){return Xr(n,e)&&0!==e.width?(t[o]=e,!0):!(!Xr(e,n)||0===n.width)})?t:[].concat(Wr(t),[e]):[e]},[])},Zr=function(t,e){return!(!t||!e)&&t.bottom>=e.bottom&&t.top<=e.top},ta=function(t,e){var n=Math.max(t.right,e.right),o=Math.min(t.left,e.left);return{top:Math.min(t.top,e.top),height:Math.max(t.height,e.height),bottom:Math.max(t.bottom,e.bottom),left:o,right:n,width:n-o}},ea=function(t,e){return t.right>=e.left&&t.left<=e.right},na=function(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],o=Kr(null===(e=Dr=Dr||document.querySelector(".bulb-editor-inner"))||void 0===e?void 0:e.getBoundingClientRect());return t.map(function(t){var e=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Gr(Object(n),!0).forEach(function(e){Jr(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Gr(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}({},t);return n.forEach(function(t){Zr(t,e)&&(e.left=Math.max(t.left,e.left),e.right=Math.min(t.right,e.right),e.width=Math.max(e.right-e.left,0))}),function(t,e){return t.left>e.right&&(t.left=e.right),t.right>e.right&&(t.right=e.right),t.width=Math.max(t.right-t.left,0),t}(e,o)})};function oa(t){return function(t){if(Array.isArray(t))return ia(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return ia(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ia(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ia(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}fr.Component,n(363);var ra=function(t){function e(n){var o,i=this;return i=t.call(this,n)||this,o=i,i.selection=ir.getBulbSelection(),i.onDrawDragShadowListener=function(t){var e=t.selection,n=t.event;if(!e||!n)return o.removeGlobalCSS(),o.setState({show:!1});var i=n.clientX,r=n.clientY;e.range.equals(o.selection.range)||(o.selection=e,o.dropStartX=i,o.dropStartY=r);var a=Ai.toNativeRange(e.range),s=e.range.getStartNode().isBlock(),l=a.startContainer,c=s?[Kr(l.getBoundingClientRect())]:Yr(e),u=Math.max.apply(Math,oa(c.map(function(t){return t.right})))-Math.min.apply(Math,oa(c.map(function(t){return t.left}))),d=s?[l.cloneNode(!0)]:Array.from(a.cloneContents().childNodes),p=c.map(function(t,e){var n=d[e];if(n instanceof Text){var a=document.createElement("span");a.appendChild(n),n=a}if(n instanceof HTMLElement)return n.style.top=t.top+r-o.dropStartY+"px",n.style.left=t.left+i-o.dropStartX+"px",n.style.width=u+"px",n.outerHTML}).filter(Boolean),h=ir.selectionAdapter.buildBulbRangeFromPoint(n.clientX,n.clientY),f=Ai.toNativeRange(h);if(f){var g=Tn.isUndroppable(h.getStartNode())?{}:Kr(f.getBoundingClientRect());o.setState({show:!0,rectHTMLs:p,dragCaretX:g.left,dragCaretY:g.top,dragCaretHeight:g.height}),o.injectGlobalCSS(o.generateDisabledCursorCSS())}},i.removeGlobalCSS=function(){document.head.querySelectorAll("."+e.cursorClassName).forEach(function(t){return t.remove()})},i.injectGlobalCSS=function(t){if(!document.head.querySelectorAll("."+e.cursorClassName).length){var n=document.createElement("style");n.type="text/css",n.className=e.cursorClassName,n.appendChild(document.createTextNode(t)),document.head.appendChild(n)}},i.generateDisabledCursorCSS=function(){return e.getUndroppableComponents().map(function(t){return"[data-block-type='"+t+"'] {\n                                cursor: no-drop !important;\n                            }"}).join("\n")},i.state={show:!1},ir.on(h.DRAW_DRAG_SHADOW,i.onDrawDragShadowListener),i}return s(e,t),e.prototype.render=function(){var t=this.state,e=t.rectHTMLs,n=t.show,o=t.dragCaretX,i=t.dragCaretY,r=t.dragCaretHeight,a=e&&e.join("");return fr.createElement(fr.Fragment,null,fr.createElement("div",{className:"bulb-drag-shadow",style:{display:!n&&"none"},dangerouslySetInnerHTML:{__html:a}}),n&&fr.createElement(_r,{top:i,left:o,show:!(!n||!o),blink:!1,style:{color:"red",height:r}}))},e}(fr.Component);function aa(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,o)}return n}function sa(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?aa(Object(n),!0).forEach(function(e){la(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):aa(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function la(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}ra.cursorClassName="bulb-drag-shadow-cursor",ra.getUndroppableComponents=function(){return Wo.getComponents().filter(function(t){return t[Tn.undroppable]}).map(function(t){return t.blockName})},fr.Component;var ca=function(t){function e(e){return t.call(this,e)||this}return s(e,t),e.prototype.setData=function(t){Wo.setBlockProp(this.props.block.id,"data",sa({},this.props.block.data,{},t))},e.prototype.setBlockState=function(t){Wo.setBlockProp(this.props.block.id,"state",sa({},this.props.block.state,{},t))},e}(fr.Component),ua=n(354),da=n.n(ua),pa=function(t){var e={};return function(n){return void 0===e[n]&&(e[n]=t(n)),e[n]}},ha=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|download|draggable|encType|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|inert|itemProp|itemScope|itemType|itemID|itemRef|on|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,fa=pa(function(t){return ha.test(t)||111===t.charCodeAt(0)&&110===t.charCodeAt(1)&&t.charCodeAt(2)<91}),ga=n(349),ma=n.n(ga),ya=function(){function t(t){this.isSpeedy=void 0===t.speedy||t.speedy,this.tags=[],this.ctr=0,this.nonce=t.nonce,this.key=t.key,this.container=t.container,this.before=null}var e=t.prototype;return e.insert=function(t){if(this.ctr%(this.isSpeedy?65e3:1)==0){var e,n=function(t){var e=document.createElement("style");return e.setAttribute("data-emotion",t.key),void 0!==t.nonce&&e.setAttribute("nonce",t.nonce),e.appendChild(document.createTextNode("")),e}(this);e=0===this.tags.length?this.before:this.tags[this.tags.length-1].nextSibling,this.container.insertBefore(n,e),this.tags.push(n)}var o=this.tags[this.tags.length-1];if(this.isSpeedy){var i=function(t){if(t.sheet)return t.sheet;for(var e=0;e<document.styleSheets.length;e++)if(document.styleSheets[e].ownerNode===t)return document.styleSheets[e]}(o);try{var r=105===t.charCodeAt(1)&&64===t.charCodeAt(0);i.insertRule(t,r?0:i.cssRules.length)}catch(t){}}else o.appendChild(document.createTextNode(t));this.ctr++},e.flush=function(){this.tags.forEach(function(t){return t.parentNode.removeChild(t)}),this.tags=[],this.ctr=0},t}(),va=function(t){function e(t,e,o){var i=e.trim().split(f);e=i;var r=i.length,a=t.length;switch(a){case 0:case 1:var s=0;for(t=0===a?"":t[0]+" ";s<r;++s)e[s]=n(t,e[s],o).trim();break;default:var l=s=0;for(e=[];s<r;++s)for(var c=0;c<a;++c)e[l++]=n(t[c]+" ",i[s],o).trim()}return e}function n(t,e,n){var o=e.charCodeAt(0);switch(33>o&&(o=(e=e.trim()).charCodeAt(0)),o){case 38:return e.replace(g,"$1"+t.trim());case 58:return t.trim()+e.replace(g,"$1"+t.trim());default:if(0<1*n&&0<e.indexOf("\f"))return e.replace(g,(58===t.charCodeAt(0)?"":"$1")+t.trim())}return t+e}function o(t,e,n,r){var a=t+";",s=2*e+3*n+4*r;if(944===s){t=a.indexOf(":",9)+1;var l=a.substring(t,a.length-1).trim();return l=a.substring(0,t).trim()+l+";",1===O||2===O&&i(l,1)?"-webkit-"+l+l:l}if(0===O||2===O&&!i(a,1))return a;switch(s){case 1015:return 97===a.charCodeAt(10)?"-webkit-"+a+a:a;case 951:return 116===a.charCodeAt(3)?"-webkit-"+a+a:a;case 963:return 110===a.charCodeAt(5)?"-webkit-"+a+a:a;case 1009:if(100!==a.charCodeAt(4))break;case 969:case 942:return"-webkit-"+a+a;case 978:return"-webkit-"+a+"-moz-"+a+a;case 1019:case 983:return"-webkit-"+a+"-moz-"+a+"-ms-"+a+a;case 883:if(45===a.charCodeAt(8))return"-webkit-"+a+a;if(0<a.indexOf("image-set(",11))return a.replace(x,"$1-webkit-$2")+a;break;case 932:if(45===a.charCodeAt(4))switch(a.charCodeAt(5)){case 103:return"-webkit-box-"+a.replace("-grow","")+"-webkit-"+a+"-ms-"+a.replace("grow","positive")+a;case 115:return"-webkit-"+a+"-ms-"+a.replace("shrink","negative")+a;case 98:return"-webkit-"+a+"-ms-"+a.replace("basis","preferred-size")+a}return"-webkit-"+a+"-ms-"+a+a;case 964:return"-webkit-"+a+"-ms-flex-"+a+a;case 1023:if(99!==a.charCodeAt(8))break;return"-webkit-box-pack"+(l=a.substring(a.indexOf(":",15)).replace("flex-","").replace("space-between","justify"))+"-webkit-"+a+"-ms-flex-pack"+l+a;case 1005:return p.test(a)?a.replace(d,":-webkit-")+a.replace(d,":-moz-")+a:a;case 1e3:switch(e=(l=a.substring(13).trim()).indexOf("-")+1,l.charCodeAt(0)+l.charCodeAt(e)){case 226:l=a.replace(_,"tb");break;case 232:l=a.replace(_,"tb-rl");break;case 220:l=a.replace(_,"lr");break;default:return a}return"-webkit-"+a+"-ms-"+l+a;case 1017:if(-1===a.indexOf("sticky",9))break;case 975:switch(e=(a=t).length-10,s=(l=(33===a.charCodeAt(e)?a.substring(0,e):a).substring(t.indexOf(":",7)+1).trim()).charCodeAt(0)+(0|l.charCodeAt(7))){case 203:if(111>l.charCodeAt(8))break;case 115:a=a.replace(l,"-webkit-"+l)+";"+a;break;case 207:case 102:a=a.replace(l,"-webkit-"+(102<s?"inline-":"")+"box")+";"+a.replace(l,"-webkit-"+l)+";"+a.replace(l,"-ms-"+l+"box")+";"+a}return a+";";case 938:if(45===a.charCodeAt(5))switch(a.charCodeAt(6)){case 105:return l=a.replace("-items",""),"-webkit-"+a+"-webkit-box-"+l+"-ms-flex-"+l+a;case 115:return"-webkit-"+a+"-ms-flex-item-"+a.replace(k,"")+a;default:return"-webkit-"+a+"-ms-flex-line-pack"+a.replace("align-content","").replace(k,"")+a}break;case 973:case 989:if(45!==a.charCodeAt(3)||122===a.charCodeAt(4))break;case 931:case 953:if(!0===S.test(t))return 115===(l=t.substring(t.indexOf(":")+1)).charCodeAt(0)?o(t.replace("stretch","fill-available"),e,n,r).replace(":fill-available",":stretch"):a.replace(l,"-webkit-"+l)+a.replace(l,"-moz-"+l.replace("fill-",""))+a;break;case 962:if(a="-webkit-"+a+(102===a.charCodeAt(5)?"-ms-"+a:"")+a,211===n+r&&105===a.charCodeAt(13)&&0<a.indexOf("transform",10))return a.substring(0,a.indexOf(";",27)+1).replace(h,"$1-webkit-$2")+a}return a}function i(t,e){var n=t.indexOf(1===e?":":"{"),o=t.substring(0,3!==e?n:10);return n=t.substring(n+1,t.length-1),B(2!==e?o:o.replace(w,"$1"),n,e)}function r(t,e){var n=o(e,e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2));return n!==e+";"?n.replace(C," or ($1)").substring(4):"("+e+")"}function a(t,e,n,o,i,r,a,s,c,u){for(var d,p=0,h=e;p<D;++p)switch(d=N[p].call(l,t,h,n,o,i,r,a,s,c,u)){case void 0:case!1:case!0:case null:break;default:h=d}if(h!==e)return h}function s(t){return void 0!==(t=t.prefix)&&(B=null,t?"function"!=typeof t?O=1:(O=2,B=t):O=0),s}function l(t,n){var s=t;if(33>s.charCodeAt(0)&&(s=s.trim()),s=[s],0<D){var l=a(-1,n,s,s,I,E,0,0,0,0);void 0!==l&&"string"==typeof l&&(n=l)}var d=function t(n,s,l,d,p){for(var h,f,g,_,C,k=0,w=0,S=0,x=0,N=0,B=0,L=g=h=0,P=0,M=0,F=0,H=0,j=l.length,V=j-1,U="",z="",G="",J="";P<j;){if(f=l.charCodeAt(P),P===V&&0!==w+x+S+k&&(0!==w&&(f=47===w?10:47),x=S=k=0,j++,V++),0===w+x+S+k){if(P===V&&(0<M&&(U=U.replace(u,"")),0<U.trim().length)){switch(f){case 32:case 9:case 59:case 13:case 10:break;default:U+=l.charAt(P)}f=59}switch(f){case 123:for(h=(U=U.trim()).charCodeAt(0),g=1,H=++P;P<j;){switch(f=l.charCodeAt(P)){case 123:g++;break;case 125:g--;break;case 47:switch(f=l.charCodeAt(P+1)){case 42:case 47:t:{for(L=P+1;L<V;++L)switch(l.charCodeAt(L)){case 47:if(42===f&&42===l.charCodeAt(L-1)&&P+2!==L){P=L+1;break t}break;case 10:if(47===f){P=L+1;break t}}P=L}}break;case 91:f++;case 40:f++;case 34:case 39:for(;P++<V&&l.charCodeAt(P)!==f;);}if(0===g)break;P++}switch(g=l.substring(H,P),0===h&&(h=(U=U.replace(c,"").trim()).charCodeAt(0)),h){case 64:switch(0<M&&(U=U.replace(u,"")),f=U.charCodeAt(1)){case 100:case 109:case 115:case 45:M=s;break;default:M=A}if(H=(g=t(s,M,g,f,p+1)).length,0<D&&(C=a(3,g,M=e(A,U,F),s,I,E,H,f,p,d),U=M.join(""),void 0!==C&&0===(H=(g=C.trim()).length)&&(f=0,g="")),0<H)switch(f){case 115:U=U.replace(b,r);case 100:case 109:case 45:g=U+"{"+g+"}";break;case 107:g=(U=U.replace(m,"$1 $2"))+"{"+g+"}",g=1===O||2===O&&i("@"+g,3)?"@-webkit-"+g+"@"+g:"@"+g;break;default:g=U+g,112===d&&(z+=g,g="")}else g="";break;default:g=t(s,e(s,U,F),g,d,p+1)}G+=g,g=F=M=L=h=0,U="",f=l.charCodeAt(++P);break;case 125:case 59:if(1<(H=(U=(0<M?U.replace(u,""):U).trim()).length))switch(0===L&&(h=U.charCodeAt(0),45===h||96<h&&123>h)&&(H=(U=U.replace(" ",":")).length),0<D&&void 0!==(C=a(1,U,s,n,I,E,z.length,d,p,d))&&0===(H=(U=C.trim()).length)&&(U="\0\0"),h=U.charCodeAt(0),f=U.charCodeAt(1),h){case 0:break;case 64:if(105===f||99===f){J+=U+l.charAt(P);break}default:58!==U.charCodeAt(H-1)&&(z+=o(U,h,f,U.charCodeAt(2)))}F=M=L=h=0,U="",f=l.charCodeAt(++P)}}switch(f){case 13:case 10:47===w?w=0:0===1+h&&107!==d&&0<U.length&&(M=1,U+="\0"),0<D*R&&a(0,U,s,n,I,E,z.length,d,p,d),E=1,I++;break;case 59:case 125:if(0===w+x+S+k){E++;break}default:switch(E++,_=l.charAt(P),f){case 9:case 32:if(0===x+k+w)switch(N){case 44:case 58:case 9:case 32:_="";break;default:32!==f&&(_=" ")}break;case 0:_="\\0";break;case 12:_="\\f";break;case 11:_="\\v";break;case 38:0===x+w+k&&(M=F=1,_="\f"+_);break;case 108:if(0===x+w+k+T&&0<L)switch(P-L){case 2:112===N&&58===l.charCodeAt(P-3)&&(T=N);case 8:111===B&&(T=B)}break;case 58:0===x+w+k&&(L=P);break;case 44:0===w+S+x+k&&(M=1,_+="\r");break;case 34:case 39:0===w&&(x=x===f?0:0===x?f:x);break;case 91:0===x+w+S&&k++;break;case 93:0===x+w+S&&k--;break;case 41:0===x+w+k&&S--;break;case 40:if(0===x+w+k){if(0===h)switch(2*N+3*B){case 533:break;default:h=1}S++}break;case 64:0===w+S+x+k+L+g&&(g=1);break;case 42:case 47:if(!(0<x+k+S))switch(w){case 0:switch(2*f+3*l.charCodeAt(P+1)){case 235:w=47;break;case 220:H=P,w=42}break;case 42:47===f&&42===N&&H+2!==P&&(33===l.charCodeAt(H+2)&&(z+=l.substring(H,P+1)),_="",w=0)}}0===w&&(U+=_)}B=N,N=f,P++}if(0<(H=z.length)){if(M=s,0<D&&void 0!==(C=a(2,z,M,n,I,E,H,d,p,d))&&0===(z=C).length)return J+z+G;if(z=M.join(",")+"{"+z+"}",0!=O*T){switch(2!==O||i(z,2)||(T=0),T){case 111:z=z.replace(v,":-moz-$1")+z;break;case 112:z=z.replace(y,"::-webkit-input-$1")+z.replace(y,"::-moz-$1")+z.replace(y,":-ms-input-$1")+z}T=0}}return J+z+G}(A,s,n,0,0);return 0<D&&void 0!==(l=a(-2,d,s,s,I,E,d.length,0,0,0))&&(d=l),T=0,E=I=1,d}var c=/^\0+/g,u=/[\0\r\f]/g,d=/: */g,p=/zoo|gra/,h=/([,: ])(transform)/g,f=/,\r+?/g,g=/([\t\r\n ])*\f?&/g,m=/@(k\w+)\s*(\S*)\s*/,y=/::(place)/g,v=/:(read-only)/g,_=/[svh]\w+-[tblr]{2}/,b=/\(\s*(.*)\s*\)/g,C=/([\s\S]*?);/g,k=/-self|flex-/g,w=/[^]*?(:[rp][el]a[\w-]+)[^]*/,S=/stretch|:\s*\w+\-(?:conte|avail)/,x=/([^-])(image-set\()/,E=1,I=1,T=0,O=1,A=[],N=[],D=0,B=null,R=0;return l.use=function t(e){switch(e){case void 0:case null:D=N.length=0;break;default:if("function"==typeof e)N[D++]=e;else if("object"==typeof e)for(var n=0,o=e.length;n<o;++n)t(e[n]);else R=0|!!e}return t},l.set=s,void 0!==t&&s(t),l},_a=function(t){var e=new WeakMap;return function(n){if(e.has(n))return e.get(n);var o=t(n);return e.set(n,o),o}};function ba(t){t&&Ca.current.insert(t+"}")}var Ca={current:null},ka=function(t,e,n,o,i,r,a,s,l,c){switch(t){case 1:switch(e.charCodeAt(0)){case 64:return Ca.current.insert(e+";"),"";case 108:if(98===e.charCodeAt(2))return""}break;case 2:if(0===s)return e+"/*|*/";break;case 3:switch(s){case 102:case 112:return Ca.current.insert(n[0]+e),"";default:return e+(0===c?"/*|*/":"")}case-2:e.split("/*|*/}").forEach(ba)}},wa=function(t,e){if(1===t&&108===e.charCodeAt(0)&&98===e.charCodeAt(2))return""},Sa="undefined"!=typeof document,xa={},Ea=Sa?void 0:_a(function(){var t=_a(function(){return{}}),e={},n={};return function(o){return void 0===o||!0===o?e:!1===o?n:t(o)}}),Ia=function(t){void 0===t&&(t={});var e,n=t.key||"css";void 0!==t.prefix&&(e={prefix:t.prefix});var o,i,r=new va(e),a={};if(Sa){o=t.container||document.head;var s=document.querySelectorAll("style[data-emotion-"+n+"]");Array.prototype.forEach.call(s,function(t){t.getAttribute("data-emotion-"+n).split(" ").forEach(function(t){a[t]=!0}),t.parentNode!==o&&o.appendChild(t)})}if(Sa)r.use(t.stylisPlugins)(ka),i=function(t,e,n,o){var i=e.name;Ca.current=n,r(t,e.styles),o&&(c.inserted[i]=!0)};else{r.use(wa);var l=xa;(t.stylisPlugins||void 0!==t.prefix)&&(r.use(t.stylisPlugins),l=Ea(t.stylisPlugins||xa)(t.prefix)),i=function(t,e,n,o){var i=e.name,a=function(t,e){var n=e.name;return void 0===l[n]&&(l[n]=r(t,e.styles)),l[n]}(t,e);return void 0===c.compat?(o&&(c.inserted[i]=!0),a):o?void(c.inserted[i]=a):a}}var c={key:n,sheet:new ya({key:n,container:o,nonce:t.nonce,speedy:t.speedy}),nonce:t.nonce,inserted:a,registered:{},insert:i};return c},Ta="undefined"!=typeof document;function Oa(t,e,n){var o="";return n.split(" ").forEach(function(n){void 0!==t[n]?e.push(t[n]):o+=n+" "}),o}var Aa=function(t,e,n){var o=t.key+"-"+e.name;if((!1===n||!1===Ta&&void 0!==t.compat)&&void 0===t.registered[o]&&(t.registered[o]=e.styles),void 0===t.inserted[e.name]){var i="",r=e;do{var a=t.insert("."+o,r,t.sheet,!0);Ta||void 0===a||(i+=a),r=r.next}while(void 0!==r);if(!Ta&&0!==i.length)return i}},Na=function(t){for(var e,n=0,o=0,i=t.length;i>=4;++o,i-=4)e=1540483477*(65535&(e=255&t.charCodeAt(o)|(255&t.charCodeAt(++o))<<8|(255&t.charCodeAt(++o))<<16|(255&t.charCodeAt(++o))<<24))+(59797*(e>>>16)<<16),n=1540483477*(65535&(e^=e>>>24))+(59797*(e>>>16)<<16)^1540483477*(65535&n)+(59797*(n>>>16)<<16);switch(i){case 3:n^=(255&t.charCodeAt(o+2))<<16;case 2:n^=(255&t.charCodeAt(o+1))<<8;case 1:n=1540483477*(65535&(n^=255&t.charCodeAt(o)))+(59797*(n>>>16)<<16)}return(((n=1540483477*(65535&(n^=n>>>13))+(59797*(n>>>16)<<16))^n>>>15)>>>0).toString(36)},Da={animationIterationCount:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},Ba=/[A-Z]|^ms/g,Ra=/_EMO_([^_]+?)_([^]*?)_EMO_/g,La=function(t){return 45===t.charCodeAt(1)},Pa=function(t){return null!=t&&"boolean"!=typeof t},Ma=pa(function(t){return La(t)?t:t.replace(Ba,"-$&").toLowerCase()}),Fa=function(t,e){switch(t){case"animation":case"animationName":if("string"==typeof e)return e.replace(Ra,function(t,e,n){return ja={name:e,styles:n,next:ja},e})}return 1===Da[t]||La(t)||"number"!=typeof e||0===e?e:e+"px"};function Ha(t,e,n,o){if(null==n)return"";if(void 0!==n.__emotion_styles)return n;switch(typeof n){case"boolean":return"";case"object":if(1===n.anim)return ja={name:n.name,styles:n.styles,next:ja},n.name;if(void 0!==n.styles){var i=n.next;if(void 0!==i)for(;void 0!==i;)ja={name:i.name,styles:i.styles,next:ja},i=i.next;return n.styles+";"}return function(t,e,n){var o="";if(Array.isArray(n))for(var i=0;i<n.length;i++)o+=Ha(t,e,n[i],!1);else for(var r in n){var a=n[r];if("object"!=typeof a)null!=e&&void 0!==e[a]?o+=r+"{"+e[a]+"}":Pa(a)&&(o+=Ma(r)+":"+Fa(r,a)+";");else if(!Array.isArray(a)||"string"!=typeof a[0]||null!=e&&void 0!==e[a[0]]){var s=Ha(t,e,a,!1);switch(r){case"animation":case"animationName":o+=Ma(r)+":"+s+";";break;default:o+=r+"{"+s+"}"}}else for(var l=0;l<a.length;l++)Pa(a[l])&&(o+=Ma(r)+":"+Fa(r,a[l])+";")}return o}(t,e,n);case"function":if(void 0!==t){var r=ja,a=n(t);return ja=r,Ha(t,e,a,o)}}if(null==e)return n;var s=e[n];return void 0===s||o?n:s}var ja,Va=/label:\s*([^\s;\n{]+)\s*;/g,Ua=function(t,e,n){if(1===t.length&&"object"==typeof t[0]&&null!==t[0]&&void 0!==t[0].styles)return t[0];var o=!0,i="";ja=void 0;var r=t[0];null==r||void 0===r.raw?(o=!1,i+=Ha(n,e,r,!1)):i+=r[0];for(var a=1;a<t.length;a++)i+=Ha(n,e,t[a],46===i.charCodeAt(i.length-1)),o&&(i+=r[a]);Va.lastIndex=0;for(var s,l="";null!==(s=Va.exec(i));)l+="-"+s[1];return{name:Na(i)+l,styles:i,next:ja}},za=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return Ua(e)},Ga="undefined"!=typeof document,Ja=Object(fr.createContext)("undefined"!=typeof HTMLElement?Ia():null),Wa=Object(fr.createContext)({}),$a=(Ja.Provider,function(t){return Object(fr.forwardRef)(function(e,n){return Object(fr.createElement)(Ja.Consumer,null,function(o){return t(e,o,n)})})});if(!Ga){var Ka=function(t){function e(e,n,o){var i;return(i=t.call(this,e,n,o)||this).state={value:Ia()},i}return ma()(e,t),e.prototype.render=function(){return Object(fr.createElement)(Ja.Provider,this.state,this.props.children(this.state.value))},e}(fr.Component);$a=function(t){return function(e){return Object(fr.createElement)(Ja.Consumer,null,function(n){return null===n?Object(fr.createElement)(Ka,null,function(n){return t(e,n)}):t(e,n)})}}}Object.prototype.hasOwnProperty;var Ya=$a(function(t,e){var n=t.styles;if("function"==typeof n)return Object(fr.createElement)(Wa.Consumer,null,function(t){var o=Ua([n(t)]);return Object(fr.createElement)(Xa,{serialized:o,cache:e})});var o=Ua([n]);return Object(fr.createElement)(Xa,{serialized:o,cache:e})}),Xa=function(t){function e(e,n,o){return t.call(this,e,n,o)||this}ma()(e,t);var n=e.prototype;return n.componentDidMount=function(){this.sheet=new ya({key:this.props.cache.key+"-global",nonce:this.props.cache.sheet.nonce,container:this.props.cache.sheet.container});var t=document.querySelector("style[data-emotion-"+this.props.cache.key+'="'+this.props.serialized.name+'"]');null!==t&&this.sheet.tags.push(t),this.props.cache.sheet.tags.length&&(this.sheet.before=this.props.cache.sheet.tags[0]),this.insertStyles()},n.componentDidUpdate=function(t){t.serialized.name!==this.props.serialized.name&&this.insertStyles()},n.insertStyles=function(){if(void 0!==this.props.serialized.next&&Aa(this.props.cache,this.props.serialized.next,!0),this.sheet.tags.length){var t=this.sheet.tags[this.sheet.tags.length-1].nextElementSibling;this.sheet.before=t,this.sheet.flush()}this.props.cache.insert("",this.props.serialized,this.sheet,!1)},n.componentWillUnmount=function(){this.sheet.flush()},n.render=function(){if(!Ga){for(var t=this.props.serialized,e=t.name,n=t.styles,o=t.next;void 0!==o;)e+=" "+o.name,n+=o.styles,o=o.next;var i,r=!0===this.props.cache.compat,a=this.props.cache.insert("",{name:e,styles:n},this.sheet,r);if(!r)return Object(fr.createElement)("style",((i={})["data-emotion-"+this.props.cache.key]=e,i.dangerouslySetInnerHTML={__html:a},i.nonce=this.props.cache.sheet.nonce,i))}return null},e}(fr.Component);$a(function(t,e){return Object(fr.createElement)(Wa.Consumer,null,function(n){var o,i="",r="",a=function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];var a=Ua(n,e.registered);if(Ga)Aa(e,a,!1);else{var s=Aa(e,a,!1);void 0!==s&&(i+=s)}return Ga||(r+=" "+a.name),e.key+"-"+a.name},s={css:a,cx:function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return function(t,e,n){var o=[],i=Oa(t,o,n);return o.length<2?n:i+e(o)}(e.registered,a,function t(e){for(var n=e.length,o=0,i="";o<n;o++){var r=e[o];if(null!=r){var a=void 0;switch(typeof r){case"boolean":break;case"object":if(Array.isArray(r))a=t(r);else for(var s in a="",r)r[s]&&s&&(a&&(a+=" "),a+=s);break;default:a=r}a&&(i&&(i+=" "),i+=a)}}return i}(n))},theme:n},l=t.children(s);return Ga||0===i.length?l:Object(fr.createElement)(fr.Fragment,null,Object(fr.createElement)("style",((o={})["data-emotion-"+e.key]=r.substring(1),o.dangerouslySetInnerHTML={__html:i},o.nonce=e.sheet.nonce,o)),l)})});var qa=fa,Qa=function(t){return"theme"!==t&&"innerRef"!==t},Za=function(t){return"string"==typeof t&&t.charCodeAt(0)>96?qa:Qa};function ts(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,o)}return n}var es="undefined"!=typeof document,ns=function t(e,n){var o,i,r;void 0!==n&&(o=n.label,r=n.target,i=e.__emotion_forwardProp&&n.shouldForwardProp?function(t){return e.__emotion_forwardProp(t)&&n.shouldForwardProp(t)}:n.shouldForwardProp);var a=e.__emotion_real===e,s=a&&e.__emotion_base||e;"function"!=typeof i&&a&&(i=e.__emotion_forwardProp);var l=i||Za(s),c=!l("as");return function(){var u=arguments,d=a&&void 0!==e.__emotion_styles?e.__emotion_styles.slice(0):[];if(void 0!==o&&d.push("label:"+o+";"),null==u[0]||void 0===u[0].raw)d.push.apply(d,u);else{d.push(u[0][0]);for(var p=u.length,h=1;h<p;h++)d.push(u[h],u[0][h])}var f=$a(function(t,e,n){return Object(fr.createElement)(Wa.Consumer,null,function(o){var a=c&&t.as||s,u="",p=[],h=t;if(null==t.theme){for(var f in h={},t)h[f]=t[f];h.theme=o}"string"==typeof t.className?u=Oa(e.registered,p,t.className):null!=t.className&&(u=t.className+" ");var g=Ua(d.concat(p),e.registered,h),m=Aa(e,g,"string"==typeof a);u+=e.key+"-"+g.name,void 0!==r&&(u+=" "+r);var y=c&&void 0===i?Za(a):l,v={};for(var _ in t)c&&"as"===_||y(_)&&(v[_]=t[_]);v.className=u,v.ref=n||t.innerRef;var b=Object(fr.createElement)(a,v);if(!es&&void 0!==m){for(var C,k=g.name,w=g.next;void 0!==w;)k+=" "+w.name,w=w.next;return Object(fr.createElement)(fr.Fragment,null,Object(fr.createElement)("style",((C={})["data-emotion-"+e.key]=k,C.dangerouslySetInnerHTML={__html:m},C.nonce=e.sheet.nonce,C)),b)}return b})});return f.displayName=void 0!==o?o:"Styled("+("string"==typeof s?s:s.displayName||s.name||"Component")+")",f.defaultProps=e.defaultProps,f.__emotion_real=f,f.__emotion_base=s,f.__emotion_styles=d,f.__emotion_forwardProp=i,Object.defineProperty(f,"toString",{value:function(){return"."+r}}),f.withComponent=function(e,o){return t(e,void 0!==o?function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ts(n,!0).forEach(function(e){da()(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ts(n).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}({},n||{},{},o):n).apply(void 0,d)},f}}.bind();["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"].forEach(function(t){ns[t]=ns(t)});var os,is=ns;!function(t){t.OrderedList="ordered",t.UnorderedList="unordered"}(os||(os={}));var rs,as=["decimal","lower-alpha","lower-roman"],ss=["disc","circle","square"];function ls(){var t=function(t,e){return e||(e=t.slice(0)),t.raw=e,t}(["\n    display: flex;\n    & svg {\n        align-self: center;\n    }\n"]);return ls=function(){return t},t}function cs(){var t=function(t,e){return e||(e=t.slice(0)),t.raw=e,t}(["\n    ::after {\n        content: '","';\n        white-space: pre;\n        display: none;\n        position: absolute;\n        z-index: 1000;\n        color: #fff;\n        text-align: center;\n        border-radius: 2px;\n        padding: 3px 11px;\n        font-size: 12px;\n        line-height: 21px;\n        background: rgba(0, 0, 0, 0.7);\n        pointer-events: none;\n        ",";\n        ","\n    }\n\n    ::before {\n        content: '';\n        display: none;\n        position: absolute;\n        z-index: 2;\n        border-top: 8px solid rgba(0, 0, 0, 0.7);\n        border-left: 8px solid transparent;\n        width: 0;\n        height: 0;\n        ","\n        ","\n    }\n\n    &:hover {\n        cursor: ",";\n\n        ::after,\n        ::before {\n            display: ",";\n        }\n    }\n"]);return cs=function(){return t},t}function us(){var t=ms(["\n    position: relative;\n"]);return us=function(){return t},t}function ds(){var t=ms(["\n    width: 1px;\n    color: #ebebeb;\n    margin: 5px 6px 0 6px;\n    height: 15px;\n    line-height: 15px;\n    opacity: 1;\n"]);return ds=function(){return t},t}function ps(){var t=ms(["\n    color: #409fff;\n    cursor: default;\n    /* stylelint-disable-next-line no-descending-specificity */\n    path {\n        fill: #409fff;\n    }\n"]);return ps=function(){return t},t}function hs(){var t=ms(["\n    margin: 0 0 0 8px;\n    cursor: pointer;\n    width: 28px;\n    height: 27px;\n    line-height: 26px;\n    :hover {\n        color: #409fff;\n        path {\n            fill: #409fff;\n        }\n    }\n"]);return hs=function(){return t},t}function fs(){var t=ms(["\n    display: flex;\n    justify-content: space-between;\n    position: absolute;\n    margin: 0.3em 0;\n    padding: 8px 12px 8px 7px;\n    font-size: 14px;\n    font-weight: 400;\n    color: rgba(102, 102, 102, 1);\n    background-color: rgba(255, 255, 255, 1);\n    list-style: none;\n    border: none;\n    box-shadow: 0 3px 8px 0 rgba(0, 0, 0, 0.1);\n    border-radius: 2px;\n    z-index: 1;\n    box-sizing: border-box;\n    transition: left 0.5s, right 0.5s;\n"]);return fs=function(){return t},t}function gs(){var t=ms(["\n                ."," ."," {\n                    display: none;\n                }\n            "]);return gs=function(){return t},t}function ms(t,e){return e||(e=t.slice(0)),t.raw=e,t}!function(t){t.metaKey="Meta",t.shiftKey="Shift",t.ctrlKey="Control",t.altKey="Alt"}(rs||(rs={})),is.span(ls()),fr.Component,fr.memo(function(){return fr.createElement(Ya,{styles:za(gs(),"bulb-drag-shadow","hovering-menu-list")})}),is.ul(fs());var ys=is.li(hs()),vs=(is(ys)(ps()),is.div(ds()),is.div(us()));function _s(){var t=Es(["\n    right: -5px;\n    bottom: 0;\n    cursor: se-resize;\n"]);return _s=function(){return t},t}function bs(){var t=Es(["\n    left: -5px;\n    bottom: 0;\n    cursor: sw-resize;\n"]);return bs=function(){return t},t}function Cs(){var t=Es(["\n    top: -5px;\n    right: -5px;\n    cursor: ne-resize;\n"]);return Cs=function(){return t},t}function ks(){var t=Es(["\n    top: -5px;\n    left: -5px;\n    cursor: nw-resize;\n"]);return ks=function(){return t},t}function ws(){var t=Es(["\n    position: absolute;\n    width: 8px;\n    height: 8px;\n    border-radius: 2px;\n    background-color: #4285f4;\n    outline: 1px solid #fff;\n"]);return ws=function(){return t},t}function Ss(){var t=Es(["\n    position: relative;\n    width: ",";\n    max-height: ",";\n    overflow-y: hidden;\n    overflow-x: hidden;\n    height: auto;\n"]);return Ss=function(){return t},t}function xs(){var t=Es(["\n    position: relative;\n    display: inline-block;\n"]);return xs=function(){return t},t}function Es(t,e){return e||(e=t.slice(0)),t.raw=e,t}is(vs)(cs(),function(t){return t.popLabel},function(t){return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"bottom";switch(t){case"bottom":return"\n            top: calc(100% + 6px);\n        ";case"left":return"\n            right: calc(100% + 6px);\n            ";case"right":return"\n            left: calc(100% + 6px);\n        ";case"top":return"\n            bottom: calc(100% + 6px);\n            "}}(t.position)},function(t){return t.popStyle},function(t){return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"bottom";switch(t){case"bottom":return"\n            bottom: -10px;\n            left: 50%;\n            transform: translateX(-50%) rotate(-45deg);\n        ";case"left":return"\n            left: 0;\n            transform: translateX(-10px) rotate(45deg);\n            ";case"right":return"\n            right: 0;\n            transform: translateX(10px) rotate(-135deg);\n        ";case"top":return"\n            top: -10px;\n            left: 50%;\n            transform: translateX(-50%) rotate(135deg);\n            "}}(t.position)},function(t){return t.popStyle},function(t){return!t.disabled&&"pointer"},function(t){return t.popLabel?"block":"none"}),fr.Component;var Is=function(t){return t?"number"==typeof t?t+"px":t:null},Ts=(is.div(xs()),is.div(Ss(),function(t){var e=t.w;return Is(e)},function(t){var e=t.maxH;return Is(e)}),is.div(ws()));function Os(){var t=function(t,e){return e||(e=t.slice(0)),t.raw=e,t}(["\n    opacity: ",";\n    transition: opacity ","s;\n"]);return Os=function(){return t},t}function As(){var t=Ds(["\n    width: ","px;\n    position: absolute;\n    justify-content: flex-start;\n    z-index: 1001;\n    right: 9px;\n    top: 35px;\n    border: 1px solid rgba(0, 0, 0, 0.05);\n    box-shadow: 0 1px 16px rgba(90, 109, 122, 0.4);\n    flex-wrap: wrap;\n\n    &::before {\n        content: '';\n        width: 0;\n        height: 0;\n        position: absolute;\n        top: -12px;\n        right: ","px;\n        transition: right 0.5s;\n        border-bottom: 7px solid #fff;\n        border-left: 5px solid transparent;\n        border-right: 5px solid transparent;\n        border-top: 5px solid transparent;\n    }\n"]);return As=function(){return t},t}function Ns(){var t=Ds(["\n    padding: 10px;\n    background: white;\n    display: flex;\n    justify-content: center;\n    align-content: center;\n"]);return Ns=function(){return t},t}function Ds(t,e){return e||(e=t.slice(0)),t.raw=e,t}is(Ts)(ks()),is(Ts)(Cs()),is(Ts)(bs()),is(Ts)(_s()),is.div(Os(),function(t){var e=t.visible;return e?1:0},function(t){var e=t.time;return e});var Bs=is("div")(Ns()),Rs=is(Bs)(As(),function(t){return t.fixedWidth},function(t){return t.arrawRight||17});function Ls(){var t=Ms(["\n    padding: 4px;\n    position: relative;\n    border-radius: 5px;\n    width: ","px;\n    top: 0;\n"]);return Ls=function(){return t},t}function Ps(){var t=Ms(["\n    position: absolute;\n    border-radius: 2px;\n    display: ",";\n    top: ","px;\n    left: ","px;\n    width: ",";\n    height: ",";\n    transition: left 0.5s, top 0.5s;\n"]);return Ps=function(){return t},t}function Ms(t,e){return e||(e=t.slice(0)),t.raw=e,t}function Fs(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,o)}return n}function Hs(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}fr.Component,is.div(Ps(),function(t){var e=t.visible;return e?"block":"none"},function(t){var e=t.top;return e},function(t){var e=t.left;return e},function(t){var e=t.visible;return!e&&0},function(t){var e=t.visible;return!e&&0}),is(Rs)(Ls(),function(t){var e=t.width;return e});var js,Vs,Us=/\s\s*/;function zs(t){return"number"==typeof t&&!isNaN(t)}function Gs(t,e,n){e.trim().split(Us).forEach(function(e){t.addEventListener(e,n)})}function Js(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};e.trim().split(Us).forEach(function(e){t.removeEventListener(e,n)})}function Ws(t,e){var n=t.pageX,o=t.pageY,i={endX:n,endY:o};return e?i:function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Fs(Object(n),!0).forEach(function(e){Hs(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Fs(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}({startX:n,startY:o},i)}!function(t){t.POINTERDOWN="pointerdown",t.POINTERMOVE="pointermove",t.POINTERUP="pointerup pointercancel",t.MOUSEDOWN="mousedown"}(js||(js={})),function(t){t.Move="move",t.TopLeft="topLeft",t.Top="top",t.TopRight="topRight",t.Left="left",t.Right="right",t.BottomLeft="bottomLeft",t.Bottom="bottom",t.BottomRight="bottomRight"}(Vs||(Vs={}));var $s,Ks=n(355),Ys=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.prototype.addListener=function(e,n){return t.prototype.addListener.call(this,"web"+e,n),this},e.prototype.removeListener=function(e,n){return t.prototype.removeListener.call(this,"web"+e,n),this},e.prototype.removeAllListeners=function(e){return t.prototype.removeAllListeners.call(this,"web"+e),this},e.prototype.on=function(e,n){return t.prototype.on.call(this,"web"+e,n),this},e.prototype.off=function(e,n){return t.prototype.off.call(this,"web"+e,n),this},e.prototype.emit=function(e){for(var n=arguments.length,o=new Array(n>1?n-1:0),i=1;i<n;i++)o[i-1]=arguments[i];return t.prototype.emit.apply(this,["web"+e].concat(o))},e}(Ks.EventEmitter);!function(t){t.ImageLoaded="image-loaded",t.RequestLocalSrc="request-local-url"}($s||($s={}));var Xs=new Ys;function qs(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,o)}return n}function Qs(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?qs(Object(n),!0).forEach(function(e){Zs(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):qs(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function Zs(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var tl={cropBoxLeft:0,cropBoxTop:0,minLeft:0,minTop:0};function el(){var t=yl(["\n    bottom: -3px;\n    cursor: nwse-resize;\n    opacity: 1;\n    right: -3px;\n"]);return el=function(){return t},t}function nl(){var t=yl(["\n    bottom: -3px;\n    cursor: s-resize;\n    left: 50%;\n    margin-left: -3px;\n"]);return nl=function(){return t},t}function ol(){var t=yl(["\n    bottom: -3px;\n    cursor: ns-resize;\n    left: -3px;\n"]);return ol=function(){return t},t}function il(){var t=yl(["\n    cursor: ew-resize;\n    margin-top: -3px;\n    right: -3px;\n    top: 50%;\n"]);return il=function(){return t},t}function rl(){var t=yl(["\n    cursor: ew-resize;\n    left: -3px;\n    margin-top: -3px;\n    top: 50%;\n"]);return rl=function(){return t},t}function al(){var t=yl(["\n    cursor: nesw-resize;\n    right: -3px;\n    top: -3px;\n"]);return al=function(){return t},t}function sl(){var t=yl(["\n    cursor: ns-resize;\n    left: 50%;\n    margin-left: -3px;\n    top: -3px;\n"]);return sl=function(){return t},t}function ll(){var t=yl(["\n    cursor: nwse-resize;\n    left: -3px;\n    top: -3px;\n"]);return ll=function(){return t},t}function cl(){var t=yl(["\n    position: absolute;\n    background: #409fff;\n    top: ",";\n    right: ",";\n    bottom: ",";\n    left: ",";\n    width: ",";\n    height: ",";\n"]);return cl=function(){return t},t}function ul(){var t=yl(["\n    background-color: #fff;\n    left: 0;\n    top: 0;\n    height: 100%;\n    opacity: 0.1;\n    position: absolute;\n    width: 100%;\n"]);return ul=function(){return t},t}function dl(){var t=yl(["\n    display: block;\n    opacity: 0.75;\n    position: absolute;\n    width: 20px;\n    height: 20px;\n"]);return dl=function(){return t},t}function pl(){var t=yl(["\n    position: absolute;\n    bottom: 0;\n    left: 0;\n    right: 0;\n    top: 0;\n    cursor: move;\n    width: ",";\n    height: ",";\n    outline: 2px solid #409fff;\n    ",";\n"]);return pl=function(){return t},t}function hl(){var t=yl(["\n    display: block;\n    max-height: none !important;\n    max-width: none !important;\n    min-height: 0 !important;\n    min-width: 0 !important;\n    width: ",";\n    height: ",";\n    ",";\n"]);return hl=function(){return t},t}function fl(){var t=yl(["\n    display: block;\n    height: 100%;\n    overflow: hidden;\n    width: 100%;\n"]);return fl=function(){return t},t}function gl(){var t=yl(["\n    opacity: 0.7;\n"]);return gl=function(){return t},t}function ml(){var t=yl(["\n    touch-action: none;\n    user-select: none;\n    font-size: 0;\n    line-height: 0;\n    position: relative;\n    width: ",";\n    height: ",";\n    margin-left: ",";\n"]);return ml=function(){return t},t}function yl(t,e){return e||(e=t.slice(0)),t.raw=e,t}new(function(){function t(){var t=this;this.cropStart=function(e){var n=e.buttons,o=e.button;if("mousedown"!==e.type&&("pointerdown"!==e.type||"mouse"!==e.pointerType)||!(zs(n)&&1!==n||zs(o)&&0!==o||e.ctrlKey)){t.pointers[e.pointerId||0]=Ws(e);var i=e.target.getAttribute("data-type")||e.target.parentElement.getAttribute("data-type");Object.values(Vs).includes(i)&&(e.preventDefault(),t.action=i)}},this.cropMove=function(e){if(t.action){e.preventDefault();var n=t.pointers[e.pointerId||0];t.pointers[e.pointerId||0]=Qs({},n,{},Ws(e,!0)),t.handleAction()}},this.cropEnd=function(e){delete t.pointers[e.pointerId||0],t.action&&(e.preventDefault(),Object.keys(t.pointers).length||(t.action=""),t.cropEnded=!0)},this.cropImage=function(){var e=t.options.containerData,n=t.cropBoxData;e.width===n.width&&e.height===n.height||!t.cropEnded?t.options.cropImage(null):t.options.cropImage(n)},this.handleAction=function(){var e=t.options.containerData,n=t.cropBoxData,o=n.left,i=n.top,r=n.width,a=n.height,s=n.minWidth,l=(n.minHeight,o+r),c=i+a,u=0,d=0,p=e.width,h=e.height;u=n.minLeft,d=n.minTop;var f=t.pointers[Object.keys(t.pointers)[0]],g={x:f.endX-f.startX,y:f.endY-f.startY},m=function(t){switch(t){case Vs.Right:l+g.x>p&&(g.x=p-l);break;case Vs.Left:o+g.x<u&&(g.x=u-o);break;case Vs.Top:i+g.y<d&&(g.y=d-i);break;case Vs.Bottom:c+g.y>h&&(g.y=h-c)}},y=!0,v=t.action;switch(v){case Vs.Move:m(Vs.Right),m(Vs.Top),m(Vs.Left),m(Vs.Bottom),o+=g.x,i+=g.y;break;case Vs.Right:if(g.x>=0&&l>=p){y=!1;break}m(Vs.Right),(r+=g.x)<0&&(v=Vs.Left,o-=r=-r);break;case Vs.Top:if(g.y<=0&&i<=d){y=!1;break}m(Vs.Top),a-=g.y,i+=g.y,a<0&&(v=Vs.Bottom,i-=a=-a);break;case Vs.Left:if(g.x<=0&&o<=u){y=!1;break}m(Vs.Left),r-=g.x,o+=g.x,r<0&&(v=Vs.Right,o-=r=-r);break;case Vs.Bottom:if(g.y>=0&&c>=h){y=!1;break}m(Vs.Bottom),(a+=g.y)<0&&(v=Vs.Top,i-=a=-a);break;case Vs.TopRight:m(Vs.Top),m(Vs.Right),g.x>=0?l<p?r+=g.x:g.y<=0&&i<=d&&(y=!1):r+=g.x,g.y<=0?i>d&&(a-=g.y,i+=g.y):(a-=g.y,i+=g.y),r<0&&a<0?(v=Vs.BottomLeft,i-=a=-a,o-=r=-r):r<0?(v=Vs.TopLeft,o-=r=-r):a<0&&(v=Vs.BottomRight,i-=a=-a);break;case Vs.TopLeft:m(Vs.Top),m(Vs.Left),g.x<=0?o>u?(r-=g.x,o+=g.x):g.y<=0&&i<=d&&(y=!1):(r-=g.x,o+=g.x),g.y<=0?i>d&&(a-=g.y,i+=g.y):(a-=g.y,i+=g.y),r<0&&a<0?(v=Vs.BottomRight,i-=a=-a,o-=r=-r):r<0?(v=Vs.TopRight,o-=r=-r):a<0&&(v=Vs.BottomLeft,i-=a=-a);break;case Vs.BottomLeft:m(Vs.Bottom),m(Vs.Left),g.x<=0?o>u?(r-=g.x,o+=g.x):g.y>=0&&c>=h&&(y=!1):(r-=g.x,o+=g.x),g.y>=0?c<h&&(a+=g.y):a+=g.y,r<0&&a<0?(v=Vs.TopRight,i-=a=-a,o-=r=-r):r<0?(v=Vs.BottomRight,o-=r=-r):a<0&&(v=Vs.TopRight,i-=a=-a);break;case Vs.BottomRight:m(Vs.Bottom),m(Vs.Right),g.x>=0?l<p?r+=g.x:g.y>=0&&c>=h&&(y=!1):r+=g.x,g.y>=0?c<h&&(a+=g.y):a+=g.y,r<0&&a<0?(v=Vs.TopRight,i-=a=-a,o-=r=-r):r<0?(v=Vs.BottomLeft,o-=r=-r):a<0&&(v=Vs.TopRight,i-=a=-a)}y&&(n.width=r<s?s:r,n.height=a,n.top=i,n.left=o,t.action=v,Xs.emit("change_cropper_style",{cropBoxWidth:n.width,cropBoxHeight:n.height,cropBoxTranslateY:n.top,cropBoxTranslateX:n.left})),Object.keys(t.pointers).forEach(function(e){var n=t.pointers[e];n.startX=n.endX,n.startY=n.endY})},this.cropEnded=!1,this.pointers={}}return t.prototype.addListeners=function(t,e){this.element=t,this.options=Qs({},tl,{},e),this.cropBoxData=e.cropBoxData,Gs(this.element,js.POINTERDOWN,this.cropStart),Gs(this.element.ownerDocument,js.POINTERMOVE,this.cropMove),Gs(this.element.ownerDocument,js.POINTERUP,this.cropEnd),Gs(this.element.ownerDocument,js.MOUSEDOWN,this.cropImage)},t.prototype.removeListeners=function(){Js(this.element,js.POINTERDOWN,this.cropStart),Js(this.element.ownerDocument,js.POINTERMOVE,this.cropMove),Js(this.element.ownerDocument,js.POINTERUP,this.cropEnd),Js(this.element.ownerDocument,js.MOUSEDOWN,this.cropImage)},t}()),gr.a.Component,is.div(ml(),function(t){return t.width+"px"},function(t){return t.height+"px"},function(t){return t.offsetLeft+"px"}),is.div(gl()),is.span(fl()),is.img(hl(),function(t){return t.width+"px !important"},function(t){return t.height+"px !important"},function(t){return t.transform}),is.div(pl(),function(t){return t.width+"px"},function(t){return t.height+"px"},function(t){return t.transform});var vl,_l=is.span(dl()),bl=(is.span(ul()),is.div(cl(),function(t){return t.top+"px"},function(t){return t.right+"px"},function(t){return t.bottom+"px"},function(t){return t.left+"px"},function(t){return t.width+"px"},function(t){return t.height+"px"}),is(_l)(ll()),is(_l)(sl()),is(_l)(al()),is(_l)(rl()),is(_l)(il()),is(_l)(ol()),is(_l)(nl()),is(_l)(el()),function(t){var e=(t+"").split(".")[1];return e?e.length:0}),Cl=function(t){return function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;"string"==typeof e&&(e=parseFloat(e));var o=bl(e);if(o&&o<=n)return e;var i=Math.pow(10,n);return t(e*i)/i}};function kl(t,e,n,o,i,r,a){try{var s=t[r](a),l=s.value}catch(t){return void n(t)}s.done?e(l):Promise.resolve(l).then(o,i)}Cl(Math.round),Cl(Math.ceil),Cl(Math.floor),function(t){t.ShowSideCatalog="show-side-catalog",t.ContentChange="content-change",t.TitleChange="title-change",t.Translate="translate",t.Comment="comment",t.Ready="ready",t.InsertAttachment="insert-attachment",t.InsertImage="insert-image",t.InsertScreenshot="insert-screenshot",t.PreviewImage="preview-image",t.SaveImage="save-image",t.DownloadOriginFile="download-file",t.EditorClick="editor-click",t.ImageLoaded="image-loaded",t.ChangeBGImageFailed="background-failed-update",t.ChangeBGImage="background-changed",t.OpenLink="open-link",t.SetClipboard="clipboard-set",t.WordCount="show-note-char-num",t.FindText="find-text",t.ImageOCR="image-orc",t.GetVersion="get-version",t.IsVIPUser="is-vip-user",t.RotateImage="rotate-image",t.ChangeZoomByEditor="change-zoom-by-editor",t.GetClipboardData="get-clipboard-data",t.OnDrop="on-drop",t.GetTemplateEntity="get-template-entity",t.ScrollInContentLoading="scroll-in-content-loading",t.DataCommandSuccess="data-command-success",t.CollabSessionChange="collab-session-change",t.SessionBuilt="session-built",t.SessionClosed="session-closed",t.SessionInitialized="session-initialized",t.UserActionFailed="user-action-Failed",t.StartSync="start-sync",t.ShowShareNote="show-share-note",t.Export2PDF="export-to-pdf",t.Export2Word="export-to-word",t.ExitFullScreen="exit-full-screen",t.ExitPresentation="exit-presentation",t.CloneAttachmentAsync="clone-attachment-async",t.SaveImageToNote="save-image-to-note",t.IsImageSavedToNote="is-image-saved-to-note",t.ShowInsertLinkDialogAsync="show-insert-link-dialog-async",t.GetCefFocus="get-cef-focus",t.ReloadEditor="reload-editor",t.SnapScreen="snap-screen",t.TrackBehavior="track-behavior",t.NoteEditorActionCollection="note-editor-action-collection",t.SaveAsAttachment="save-as-attachment",t.IsNoteLinkInClipboard="is-note-link-in-clipboard",t.PasteNoteLink="paste-note-link",t.PasteAsText="paste-as-text",t.Paste="paste",t.ClipboardAvailable="clipboard-available",t.Log="log",t.RequestRotateImg="request-rotate-img"}(vl||(vl={}));var wl,Sl=[ei.Copy,ei.Cut,ei.Paste,ei.DoubleClick,ei.DragStart,ei.Drop],xl=Object.values(vl);new(function(t){function e(){var e,n=this;return n=t.call(this)||this,e=n,n.recordBehavior=function(t,n){e.record(e.createBehavior(t,n))},n.getTargets=function(t){if(t){if(t.isCollapsed())return[t.getStartNode().parent.name];var e=[];return t.forEachBlock(function(t){e.push(t.name)}),e}},n.initListeners(),n}return s(e,t),e.prototype.createBehavior=function(t,e){return{time:Date.now(),action:t,payload:e}},e.prototype.send=function(){return(t=function(){return l(this,function(t){return[2]})},function(){var e=this,n=arguments;return new Promise(function(o,i){var r=t.apply(e,n);function a(t){kl(r,o,i,a,s,"next",t)}function s(t){kl(r,o,i,a,s,"throw",t)}a(void 0)})})();var t},e.prototype.initListeners=function(){var t=this;ir.on(h.SELECT,function(){var e=ir.getBulbRange();e&&e.isCollapsed()||t.recordBehavior(h.SELECT,{targets:t.getTargets(e)})}),Sl.forEach(function(e){return ir.on(e,function(e){var n={targets:t.getTargets(e.getRange())};t.recordBehavior(e.type,n)})}),xl.filter(function(t){return t!==vl.TrackBehavior}).forEach(function(e){return Xs.on(e,function(){t.recordBehavior(e)})})},e}(function(){var t=this;this.storage=[],this.record=function(e){Xs.emit(vl.TrackBehavior,e),t.storage.push(e)},this.getLatest=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=t.storage;return n.slice(n.length-e,n.length)},this.clear=function(){t.storage.length=0}})),function(t){t.SelectAll="右键全选",t.WordCount="右键统计字数",t.Float="浮动",t.SaveAsImage="图片保存",t.MoveBlockUp="段落上移",t.MoveBlockDown="段落下移",t.ToolbarClick="工具栏点击"}(wl||(wl={}));var El,Il={FangSong_GB2312:"FangSong_GB2312, FangSong, STFangsong",KaiTi_GB2312:"KaiTi_GB2312, KaiTi, STKaiti",SimHei:"SimHei, STHeiti",SimSun:"SimSun, STSong",Arial:"Arial","Arial Black":"Arial Black","Times New Roman":"Times New Roman","Courier New":"Courier New",Tahoma:"Tahoma",Verdana:"Verdana",NSimSun:"NSimSun"};!function(t){t.Italic="italic",t.Bold="bold",t.Underline="underline",t.Delete="delete",t.FontSize="fontSize",t.FontFamily="fontFamily",t.Color="color",t.BackgroundColor="backgroundColor"}(El||(El={})),Object.values(El);var Tl=function(t){return"number"==typeof t?t:parseFloat(t)},Ol=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:" ",n=!e;return t.reduce(function(t,e){switch(e.type){case El.Bold:t.fontWeight="bold";break;case El.Italic:t.fontStyle="italic";break;case El.Delete:n||(t.textDecoration="line-through");break;case El.FontFamily:t.fontFamily=Il[e.value]||e.value;break;default:if(e.type===El.BackgroundColor&&n)break;t[e.type]=e.value}return t},{})},Al={fontFamily:"-apple-system, BlinkMacSystemFont, PingFang SC, Helvetica, Tahoma, Arial, Hiragino Sans GB, Microsoft YaHei, 微软雅黑, SimSun, 宋体, Heiti, 黑体, sans-serif",fontSize:14,color:"#393939",fontWeight:"normal",fontStyle:"normal",textDecoration:"none"},Nl=function(t){return function(e){return null==t?void 0:t[e]}}({"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","Ç":"C","ç":"c","Ð":"D","ð":"d","È":"E","É":"E","Ê":"E","Ë":"E","è":"e","é":"e","ê":"e","ë":"e","Ì":"I","Í":"I","Î":"I","Ï":"I","ì":"i","í":"i","î":"i","ï":"i","Ñ":"N","ñ":"n","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","Ù":"U","Ú":"U","Û":"U","Ü":"U","ù":"u","ú":"u","û":"u","ü":"u","Ý":"Y","ý":"y","ÿ":"y","Æ":"Ae","æ":"ae","Þ":"Th","þ":"th","ß":"ss","Ā":"A","Ă":"A","Ą":"A","ā":"a","ă":"a","ą":"a","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","ć":"c","ĉ":"c","ċ":"c","č":"c","Ď":"D","Đ":"D","ď":"d","đ":"d","Ē":"E","Ĕ":"E","Ė":"E","Ę":"E","Ě":"E","ē":"e","ĕ":"e","ė":"e","ę":"e","ě":"e","Ĝ":"G","Ğ":"G","Ġ":"G","Ģ":"G","ĝ":"g","ğ":"g","ġ":"g","ģ":"g","Ĥ":"H","Ħ":"H","ĥ":"h","ħ":"h","Ĩ":"I","Ī":"I","Ĭ":"I","Į":"I","İ":"I","ĩ":"i","ī":"i","ĭ":"i","į":"i","ı":"i","Ĵ":"J","ĵ":"j","Ķ":"K","ķ":"k","ĸ":"k","Ĺ":"L","Ļ":"L","Ľ":"L","Ŀ":"L","Ł":"L","ĺ":"l","ļ":"l","ľ":"l","ŀ":"l","ł":"l","Ń":"N","Ņ":"N","Ň":"N","Ŋ":"N","ń":"n","ņ":"n","ň":"n","ŋ":"n","Ō":"O","Ŏ":"O","Ő":"O","ō":"o","ŏ":"o","ő":"o","Ŕ":"R","Ŗ":"R","Ř":"R","ŕ":"r","ŗ":"r","ř":"r","Ś":"S","Ŝ":"S","Ş":"S","Š":"S","ś":"s","ŝ":"s","ş":"s","š":"s","Ţ":"T","Ť":"T","Ŧ":"T","ţ":"t","ť":"t","ŧ":"t","Ũ":"U","Ū":"U","Ŭ":"U","Ů":"U","Ű":"U","Ų":"U","ũ":"u","ū":"u","ŭ":"u","ů":"u","ű":"u","ų":"u","Ŵ":"W","ŵ":"w","Ŷ":"Y","ŷ":"y","Ÿ":"Y","Ź":"Z","Ż":"Z","Ž":"Z","ź":"z","ż":"z","ž":"z","Ĳ":"IJ","ĳ":"ij","Œ":"Oe","œ":"oe","ŉ":"'n","ſ":"s"}),Dl=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Bl=RegExp("[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]","g"),Rl=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Ll=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Pl="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Ml="["+Pl+"]",Fl="\\d+",Hl="[a-z\\xdf-\\xf6\\xf8-\\xff]",jl="[^\\ud800-\\udfff"+Pl+Fl+"\\u2700-\\u27bfa-z\\xdf-\\xf6\\xf8-\\xffA-Z\\xc0-\\xd6\\xd8-\\xde]",Vl="(?:\\ud83c[\\udde6-\\uddff]){2}",Ul="[\\ud800-\\udbff][\\udc00-\\udfff]",zl="[A-Z\\xc0-\\xd6\\xd8-\\xde]",Gl="(?:"+Hl+"|"+jl+")",Jl="(?:"+zl+"|"+jl+")",Wl="(?:[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]|\\ud83c[\\udffb-\\udfff])?",$l="[\\ufe0e\\ufe0f]?"+Wl+"(?:\\u200d(?:"+["[^\\ud800-\\udfff]",Vl,Ul].join("|")+")[\\ufe0e\\ufe0f]?"+Wl+")*",Kl="(?:"+["[\\u2700-\\u27bf]",Vl,Ul].join("|")+")"+$l,Yl=RegExp([zl+"?"+Hl+"+(?:['’](?:d|ll|m|re|s|t|ve))?(?="+[Ml,zl,"$"].join("|")+")",Jl+"+(?:['’](?:D|LL|M|RE|S|T|VE))?(?="+[Ml,zl+Gl,"$"].join("|")+")",zl+"?"+Gl+"+(?:['’](?:d|ll|m|re|s|t|ve))?",zl+"+(?:['’](?:D|LL|M|RE|S|T|VE))?","\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Fl,Kl].join("|"),"g"),Xl=function(t,e,n){return t=Co(t),void 0===(e=n?void 0:e)?function(t){return Ll.test(t)}(t)?function(t){return t.match(Yl)||[]}(t):function(t){return t.match(Rl)||[]}(t):t.match(e)||[]},ql=RegExp("['’]","g"),Ql=function(t){return function(e){return function(t,e,n,o){var i=-1,r=null==t?0:t.length;for(o&&r&&(n=t[++i]);++i<r;)n=e(n,t[i],i,t);return n}(Xl(function(t){return(t=Co(t))&&t.replace(Dl,Nl).replace(Bl,"")}(e).replace(ql,"")),t,"")}},Zl=Ql(function(t,e,n){return t+(n?"-":"")+e.toLowerCase()});function tc(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,o)}return n}function ec(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var nc,oc=function(t){var e=t.marks,n=t.children,o=t.text,i=void 0===o?" ":o,r=t.defaultStyle,a=void 0===r?{}:r,s=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?tc(Object(n),!0).forEach(function(e){ec(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):tc(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}({},a,{},Ol(e,i));!function(t){t.paddingTop="1px",t.paddingBottom="1px"}(s),function(t){return t.find(function(t){return t.type===El.Underline})}(e)&&function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Al.color,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Al.fontSize,o=Tl(t.fontSize||n),i=1*o/Tl(Al.fontSize),r=t.color||e;t.borderBottom=i+"px solid "+r}(s);var l=e.map(function(t){return Zl(t.type)}).join(" ");return fr.createElement("span",{style:s,className:""+l},n)};function ic(){var t=lc(["\n    margin-left: ",";\n"]);return ic=function(){return t},t}function rc(){var t=lc(["\n    list-style: inside;\n    white-space: inherit;\n    list-style-type: ",";\n    margin: 0;\n    padding: 0;\n"]);return rc=function(){return t},t}function ac(){var t=lc(["\n    list-style: inside;\n    white-space: inherit;\n    list-style-type: ",";\n    margin: 0;\n    padding: 0;\n"]);return ac=function(){return t},t}function sc(){var t=lc(["\n    text-align: left;\n    white-space: inherit;\n    line-height: 1.5;\n    word-break: break-word;\n    font-size: 14px;\n    margin-left: ",";\n"]);return sc=function(){return t},t}function lc(t,e){return e||(e=t.slice(0)),t.raw=e,t}function cc(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,o)}return n}function uc(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}(function(){function t(){}return t.set=function(t,e){var n;null===(n=this.store)||void 0===n||n.setItem(t,e)},t.get=function(t){var e;return null===(e=this.store)||void 0===e?void 0:e.getItem(t)},t}()).store=localStorage,function(t){t[t.GlobalMessage=0]="GlobalMessage",t[t.WordCount=1]="WordCount",t[t.SelectAll=2]="SelectAll",t[t.MoveBlock=3]="MoveBlock",t[t.InsertTime=4]="InsertTime",t[t.DeleteSelection=5]="DeleteSelection",t[t.Underline=6]="Underline",t[t.Strike=7]="Strike",t[t.Italic=8]="Italic",t[t.FontSize=9]="FontSize",t[t.FontFamily=10]="FontFamily",t[t.FontColor=11]="FontColor",t[t.Bold=12]="Bold",t[t.BackColor=13]="BackColor",t[t.Presentation=14]="Presentation",t[t.Pagination=15]="Pagination",t[t.RemoveFormat=16]="RemoveFormat",t[t.FormatPainter=17]="FormatPainter",t[t.FindText=18]="FindText",t[t.FileVersion=19]="FileVersion",t[t.ErrorRecord=20]="ErrorRecord",t[t.Undo=21]="Undo",t[t.Redo=22]="Redo",t[t.Collaboration=23]="Collaboration",t[t.PasteAsPlain=24]="PasteAsPlain",t[t.Paste=25]="Paste",t[t.Drop=26]="Drop",t[t.Cut=27]="Cut",t[t.Copy=28]="Copy",t[t.TextIndent=29]="TextIndent",t[t.RenderBlockStyle=30]="RenderBlockStyle",t[t.LineHeight=31]="LineHeight",t[t.IncreaseIndent=32]="IncreaseIndent",t[t.DecreaseIndent=33]="DecreaseIndent",t[t.Align=34]="Align",t[t.FloatBlockArrowMove=35]="FloatBlockArrowMove",t[t.BackgroundImage=36]="BackgroundImage",t[t.IndentSlot=37]="IndentSlot",t[t.BlockSlot=38]="BlockSlot",t[t.Comment=39]="Comment",t[t.Translate=40]="Translate",t[t.SideCatalog=41]="SideCatalog",t[t.Title=42]="Title",t[t.Compare=43]="Compare",t[t.Paragraph=44]="Paragraph",t[t.Heading=45]="Heading",t[t.Todo=46]="Todo",t[t.Quote=47]="Quote",t[t.List=48]="List",t[t.Unknown=49]="Unknown",t[t.Image=50]="Image",t[t.Attachment=51]="Attachment",t[t.Catalog=52]="Catalog",t[t.HR=53]="HR",t[t.Link=54]="Link",t[t.Code=55]="Code",t[t.Table=56]="Table",t[t.Handwriting=57]="Handwriting",t[t.Layout=58]="Layout"}(nc||(nc={}));var dc=[El.Delete,El.Underline,El.BackgroundColor],pc=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.prototype.render=function(t){var e=t.children,n=t.attributes,o=this.props.block,i=o.data,r=i.listLevel,a=i.listType,s=o.state.index||1,l=a===os.OrderedList?gc:fc,c=(a===os.OrderedList?as:ss)[(r-1)%3],u=o.getFirstText().getActiveMarksBetweenOffsets(0,0).filter(function(t){return!dc.includes(t.type)});return n.style=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?cc(Object(n),!0).forEach(function(e){uc(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):cc(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}({},n.style,{},Ol(u)),fr.createElement(l,{styleType:c,start:s},fr.createElement(hc,Object.assign({level:r},n),fr.createElement(mc,{listType:a},e)))},e.prototype.renderMark=function(t){var e=t.marks,n=t.children;return oc({marks:e,children:n,defaultStyle:Al})},e}(ca);pc.blockName="list-item";var hc=is.li(sc(),function(t){return 28*(t.level-1)+"px"}),fc=is.ul(ac(),function(t){return t.styleType}),gc=is.ol(rc(),function(t){return t.styleType}),mc=is.span(ic(),function(t){return t.listType===os.UnorderedList?"-5px":"0px"}),yc=function(){function t(t,e){this.id=t,this.type=e,this.listItemIds=[]}return t.prototype.forEach=function(t){this.listItemIds.forEach(t)},t.prototype.addListItem=function(t){this.listItemIds.push(t)},t}();new(function(){function t(){}return t.prototype.setIndex=function(t){var e,n=this;this.indexCounters={};var o={};return null==t||null===(e=t.document)||void 0===e||e.deepForEach(function(t){if(t.isBlock()&&t.name===pc.blockName){var e=t,i=e.data,r=i.listLevel,a=i.listId,s=(i.listType,un(e.state));s.index=n.increaseIndexCounter(a,r),o[e.id]=s,n.indexCounters[a].fill(0,r)}}),Object.entries(o).reduce(function(t,e){var n=e[0],o=e[1];return t.setBlockProp(n,"state",o)},t)},t.prototype.cacheLists=function(t){var e,n=this;this.cachedLists={},null==t||null===(e=t.document)||void 0===e||e.deepForEach(function(t){if(t.isBlock()&&t.name===pc.blockName){var e=t;n.cacheListItem(e)}})},t.prototype.forEach=function(t,e){var n=this.cachedLists[t];n&&n.forEach(e)},t.prototype.getStyleType=function(t){var e=t.data,n=e.listType,o=e.listLevel;return(n===os.OrderedList?as:ss)[(o-1)%3]},t.prototype.reset=function(){this.indexCounters={},this.cachedLists={}},t.prototype.increaseIndexCounter=function(t,e){var n=this.indexCounters[t];return n||(n=new Array(9).fill(0),this.indexCounters[t]=n),++n[e-1]},t.prototype.cacheListItem=function(t){var e=t.data,n=e.listId,o=e.listType,i=this.cachedLists[n];i||(i=new yc(n,o),this.cachedLists[n]=i),i.addListItem(t.id)},t.prototype.predictListId=function(t,e){var n;if(!(isNaN(t)||t<2))return Object.entries(this.indexCounters).forEach(function(o){var i=o[0],r=o[1];r[e-1]===t-1&&(n=i)}),n},t.prototype.getListType=function(t){var e;return null===(e=this.cachedLists[t])||void 0===e?void 0:e.type},t}());var vc,_c,bc,Cc,kc,wc,Sc,xc,Ec=new(function(){function t(){var t=window.document.implementation;this.currentXML=t.createDocument("http://note.youdao.com",pr.note,null)}return t.prototype.isXML=function(t){var e;try{e=this.parseXML(t)}catch(t){return!1}if(!e)return!1;var n=this.getChildByTagName(e,pr.note);if(!n)return!1;var o=n.getAttribute("schema-version");return"http://note.youdao.com"===n.getAttribute("xmlns")&&null!=o},t.prototype.setXML=function(t){this.currentXML=t},t.prototype.getXML=function(){return this.currentXML},t.prototype.setBulbDocument=function(t){this.bulbDocument=t},t.prototype.getBulbDocument=function(){return this.bulbDocument},t.prototype.setLists=function(t){var e=Ec.getChildren(t,function(t){return t.nodeName===pr.list})||[];this.lists=e.map(function(t){var e=t.getAttribute(pr.id),n=t.getAttribute(pr.listType);return new yc(e,n===os.OrderedList?os.OrderedList:os.UnorderedList)})},t.prototype.getLists=function(){return this.lists},t.prototype.appendElToHeader=function(t){if(this.currentXML){var e=this.currentXML.documentElement;this.getChildByTagName(e,pr.head).appendChild(t)}},t.prototype.createElement=function(t){if(this.currentXML)return this.currentXML.createElement(t)},t.prototype.createTextNode=function(t){if(this.currentXML)return this.currentXML.createTextNode(t)},t.prototype.create=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=this.createElement(t);return n.appendChild(this.createTextNode(e.toString())),n},t.prototype.getChildByTagName=function(t,e){return this.filterChildren(t,function(t){return t.nodeName===e})},t.prototype.getChildTextByTagName=function(t,e){var n=this.getChildByTagName(t,e);return this.getTextContent(n)},t.prototype.getChildren=function(t,e){if(!t)return[];for(var n=t.childNodes[0],o=[];n;)e&&!e(n)||o.push(n),n=n.nextSibling;return o},t.prototype.getElementChildren=function(t){return this.getChildren(t,function(t){return 1===t.nodeType})},t.prototype.getTextContent=function(t){return t?t.textContent:""},t.prototype.filterChildren=function(t,e){if(t)for(var n=t.childNodes[0];n;){if(!e||e(n))return n;n=n.nextSibling}},t.prototype.append=function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),o=1;o<e;o++)n[o-1]=arguments[o];n.forEach(function(e){return t.appendChild(e)})},t.prototype.parseXML=function(t){try{if(window.DOMParser)return(new window.DOMParser).parseFromString(t,"text/xml");if(window.ActiveXObject){var e=new window.ActiveXObject("Microsoft.XMLDOM");return e.async=!1,e.loadXML(t),e}}catch(t){console.error("parse xml error")}},t.prototype.stringify=function(t){var e=new XMLSerializer,n="";try{n=e.serializeToString(t)}catch(t){return n}return n.startsWith("<?xml")||(n='<?xml version="1.0"?>'+n),n},t.prototype.hasListInHeader=function(t){if(!this.currentXML)return!1;var e=this.currentXML.documentElement,n=this.getChildByTagName(e,pr.head);return this.filterChildren(n,function(e){return e.nodeName===pr.list&&e.getAttribute(pr.id)===t})},t}());!function(t){t[t.Left=0]="Left",t[t.Middle=1]="Middle",t[t.Right=2]="Right",t[t.Back=3]="Back",t[t.Forward=4]="Forward"}(vc||(vc={})),function(t){t[t.GlobalMessage=0]="GlobalMessage",t[t.WordCount=1]="WordCount",t[t.SelectAll=2]="SelectAll",t[t.MoveBlock=3]="MoveBlock",t[t.InsertTime=4]="InsertTime",t[t.DeleteSelection=5]="DeleteSelection",t[t.Underline=6]="Underline",t[t.Strike=7]="Strike",t[t.Italic=8]="Italic",t[t.FontSize=9]="FontSize",t[t.FontFamily=10]="FontFamily",t[t.FontColor=11]="FontColor",t[t.Bold=12]="Bold",t[t.BackColor=13]="BackColor",t[t.Presentation=14]="Presentation",t[t.Pagination=15]="Pagination",t[t.RemoveFormat=16]="RemoveFormat",t[t.FormatPainter=17]="FormatPainter",t[t.FindText=18]="FindText",t[t.FileVersion=19]="FileVersion",t[t.ErrorRecord=20]="ErrorRecord",t[t.Undo=21]="Undo",t[t.Redo=22]="Redo",t[t.Collaboration=23]="Collaboration",t[t.PasteAsPlain=24]="PasteAsPlain",t[t.Paste=25]="Paste",t[t.Drop=26]="Drop",t[t.Cut=27]="Cut",t[t.Copy=28]="Copy",t[t.TextIndent=29]="TextIndent",t[t.RenderBlockStyle=30]="RenderBlockStyle",t[t.LineHeight=31]="LineHeight",t[t.IncreaseIndent=32]="IncreaseIndent",t[t.DecreaseIndent=33]="DecreaseIndent",t[t.Align=34]="Align",t[t.BackgroundImage=35]="BackgroundImage",t[t.Paragraph=36]="Paragraph",t[t.Heading=37]="Heading",t[t.Todo=38]="Todo",t[t.Quote=39]="Quote",t[t.List=40]="List",t[t.Unknown=41]="Unknown",t[t.Image=42]="Image",t[t.Attachment=43]="Attachment",t[t.Catalog=44]="Catalog",t[t.HR=45]="HR",t[t.Link=46]="Link",t[t.Code=47]="Code",t[t.Table=48]="Table",t[t.Handwriting=49]="Handwriting",t[t.Layout=50]="Layout"}(_c||(_c={})),function(t){t.Block="block",t.RichText="richText",t.BlockStyle="blockStyle",t.CommandHistory="commandHistory",t.Formats="formats",t.Clipboard="clipboard",t.DEFAULT="default"}(bc||(bc={})),function(t){t.Block="Block",t.Indent="Indent"}(Cc||(Cc={})),function(t){t.Splitter="ToolbarSplitter",t.Slot="ToolbarSlot",t.Attachment="ToolbarAttachment",t.Catalog="ToolbarCatalogue",t.Code="ToolbarCode",t.CodeTheme="ToolbarCodeTheme",t.CodeLanguage="ToolbarCodeLanguage",t.Heading="ToolbarHeading",t.Hr="ToolbarHr",t.Image="ToolbarImg",t.Link="ToolbarLink",t.OrderedList="ToolbarOrderedList",t.UnorderedList="ToolbarUnorderedList",t.Quote="ToolbarQuote",t.Table="ToolbarTable",t.TableOperate="ToolbarTableOperate",t.TableMergeCell="ToolbarTableMergeCell",t.TableCellWrap="ToolbarTableCellWrap",t.TableCellAlign="ToolbarTableCellAlign",t.TableBackColor="ToolbarTableBackColor",t.Todo="ToolbarTodo",t.Layout="ToolbarLayout",t.Screenshot="ToolbarScreenshot",t.Align="ToolbarAlign",t.Indent="ToolbarIndent",t.Outdent="ToolbarOutDent",t.LineHeight="ToolbarLineHeight",t.BackColor="ToolbarBackColor",t.Bold="ToolbarBold",t.DeleteLine="ToolbarDeleteLine",t.FontColor="ToolbarFontColor",t.FontFamily="ToolbarFontFamily",t.FontSize="ToolbarFontSize",t.Italic="ToolbarItalic",t.Underline="ToolbarUnderline",t.Undo="ToolbarUndo",t.Redo="ToolbarRedo",t.FormatPainter="ToolbarFormatPainter",t.RemoveFormat="ToolbarRemoveFormat",t.Pagination="ToolbarPagination",t.BackgroundImage="ToolbarSetBackgroundImage",t.Translate="ToolbarTranslate",t.Comment="ToolbarComment"}(kc||(kc={})),function(t){t.Split="ContextMenuSplit",t.Undo="ContextMenuUndo",t.Redo="ContextMenuRedo",t.Copy="ContextMenuCopy",t.Cut="ContextMenuCut",t.Paste="ContextMenuPaste",t.PasteAsPlain="ContextMenuPasteAsPlain",t.Delete="ContextMenuDelete",t.SelectAll="ContextMenuSelectAll",t.WordCount="ContextMenuWordCount",t.ImageTitle="ContextMenuImageTitle",t.ImageClearStretch="ContextMenuImageClearStretch",t.ImageStretch="ContextMenuImageStretch",t.ImageLeftRotation="ContextMenuImageLeftRotation",t.ImageRightRotation="ContextMenuImageRightRotation",t.ImageOCR="ContextMenuImageOCR",t.SaveAsImage="ContextMenuSaveAsImage",t.RemoveFormat="ContextMenuRemoveFormat",t.InsertRowAbove="ContextMenuInsertRowAbove",t.InsertRowBelow="ContextMenuInsertRowBelow",t.DeleteRow="ContextMenuDeleteRow",t.InsertColumnLeft="ContextMenuInsertColumnLeft",t.InsertColumnRight="ContextMenuInsertColumnRight",t.InsertDownRow="ContextMenuTableInsertDownRow",t.DeleteColumn="ContextMenuDeleteColumn",t.DeleteTable="ContextMenuDeleteTable",t.DeleteCode="DeleteCode",t.SelectCode="SelectCode",t.FloatLeft="ContextMenuFloatLeft",t.FloatRight="ContextMenuFloatRight",t.ClearFloat="ContextMenuClearFloat",t.SaveAs="ContextMenuSaveAs",t.ShareLink="ContextMenuShareLink",t.InsertTime="ContextMenuInsertTime",t.SaveAsAttachment="ContextMenuSaveAsAttachment",t.PasteNoteLink="ContextMenuPasteNoteLink"}(wc||(wc={})),function(t){t.Delete="delete",t.MoveUp="moveUp",t.MoveDown="moveDown"}(Sc||(Sc={})),function(t){t.Normal="normal",t.Paging="paging",t.Reading="reading"}(xc||(xc={}));var Ic={Paragraph:"paragraph",Heading:"heading",Todo:"todo",Quote:"quote",ListItem:"list-item",Unknown:"unknown",Image:"image",Attachment:"attachment",Catalog:"catalog",CatalogItem:"catalog-item",HR:"hr",Emoji:"emoji",Link:"link",Code:"code",CodeLine:"code-line",Table:"table",TableRow:"table-row",TableCell:"table-cell",Handwriting:"handwriting",Layout:"layout"},Tc={serialize:function(t){var e=Ec.createElement(pr.attach),n=t.data,o=n.resourceId;return Ec.append(e,Qu(t)),o&&Ec.append(e,Ec.create(pr.id,o)),Ec.append(e,Ec.create(pr.attachSource,n.source)),Ec.append(e,Ec.create(pr.attachResource,n.resource)),Ec.append(e,Ec.create(pr.attachName,n.fileName)),Ec.append(e,Ec.create(pr.attachLength,n.fileLength)),Ec.append(e,Zu(t)),e},deserialize:function(t){var e=ed(t)||wt(),n=Ic.Attachment,o=ft.Block,i=Ec.getChildByTagName(t,pr.blockStyles),r=Ec.getChildTextByTagName(t,pr.id),a={resource:Ec.getChildTextByTagName(t,pr.attachResource),source:Ec.getChildTextByTagName(t,pr.attachSource),fileLength:Ec.getChildTextByTagName(t,pr.attachLength),fileName:Ec.getChildTextByTagName(t,pr.attachName),style:nd(i)};return r&&Object.assign(a,{resourceId:r}),new fn({id:e,name:n,type:o,data:a})}},Oc=function(t){return t&&t.isInline()&&t.name===Ic.Link};function Ac(t){return function(t){if(Array.isArray(t))return Nc(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return Nc(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Nc(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Nc(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}var Dc,Bc,Rc={bold:pr.bold,italic:pr.italic,underline:pr.underline,delete:pr.strike,color:pr.color,backgroundColor:pr.inlineBackColor,fontFamily:pr.fontFamily,fontSize:pr.fontSize,href:pr.linkHref},Lc=function(t,e){var n=e.getText();return Ec.create(t,n)},Pc=function(t){var e=Ec.createElement(pr.inlineStyles);return Hc(t).forEach(function(t){var n=Rc[t.type]||t.type;Ec.append(e,Mc(n,t.value,t.from,t.to))}),e},Mc=function(t,e,n,o){var i=Ec.createElement(t);return Ec.append(i,Ec.create(pr.from,n)),Ec.append(i,Ec.create(pr.to,o)),Ec.append(i,Ec.create(pr.value,Fc(t,e))),i},Fc=function(t,e){return t===pr.fontSize&&"string"==typeof e&&e.endsWith("px")&&(e=e.slice(0,e.length-2)),e||(e="true"),e},Hc=function(t){var e=0,n=[];return t.forEach(function(t){Oc(t)&&(t.nodes[0].addMarks(0,t.getText().length,[new gn({type:pr.color,value:"#003884"}),new gn({type:pr.linkHref,value:t.data.href})],!1),t=t.nodes[0]),t.isText()&&t.leaves.forEach(function(t){if(""!==t.text){var o=e+Ac(t.text).length;t.marks.forEach(function(t){jc(n,{type:t.type,from:e,to:o,value:t.value})}),e=o}})}),n},jc=function(t,e){t.find(function(t){return t.type===e.type&&t.value===e.value&&!(t.from>e.to||t.to<e.from)&&(t.from=Math.min(t.from,e.from),t.to=Math.max(t.to,e.to),!0)})||t.push(e)},Vc=((o={})[pr.bold]="bold",o[pr.italic]="italic",o[pr.underline]="underline",o[pr.strike]="delete",o[pr.color]="color",o[pr.inlineBackColor]="backgroundColor",o[pr.fontFamily]="fontFamily",o[pr.fontSize]="fontSize",o[pr.linkHref]="href",o),Uc=function(t){var e=Ec.getChildByTagName(t,pr.text),n=Ec.getTextContent(e),o=Ec.getChildByTagName(t,pr.inlineStyles),i=Gc(o);return zc(n,i)},zc=function(t,e){var n=Xc(t,e);return Jc(n)},Gc=function(t){var e=[];return Ec.getElementChildren(t).forEach(function(t){var n=Vc[t.nodeName],o=Ec.getChildTextByTagName(t,pr.value),i=parseInt(Ec.getChildTextByTagName(t,pr.from),10),r=parseInt(Ec.getChildTextByTagName(t,pr.to),10);o="true"===(o=isNaN(o)?o:parseInt(o,10))?"":o,e.push({from:i,to:r,type:n,value:o})}),e},Jc=function(t){var e=[],n=[],o=function(t){if(t){var o=Yc(e,t.value);if(n.length){var i=n[n.length-1];Oc(i)&&n.push($c(i))}else n.push(Wc(o));n.push(o)}else n.push(new In({leaves:e}))};if(t.forEach(function(t){if(e.length){var n=t.getMarkOfType("href"),i=e[0].getMarkOfType("href");!n&&!i||n&&i&&n.value===i.value?e.push(t):(o(i),e=[t])}else e.push(t)}),e.length){var i=e[0].getMarkOfType("href");o(i);var r=n[n.length-1];Oc(r)&&n.push($c(r))}return n},Wc=function(t){return Kc(t.nodes[0].leaves[0].marks.filter(function(t){return t.type!==pr.underline&&t.type!==pr.color}))},$c=function(t){var e=t.nodes[0];return Kc(e.leaves[e.leaves.length-1].marks.filter(function(t){return t.type!==pr.underline&&t.type!==pr.color}))},Kc=function(t){return new In({leaves:[new Sn({text:"",marks:t})]})},Yc=function(t,e){return new fn({type:ft.Inline,name:Ic.Link,data:{href:e},nodes:[new In({leaves:t.map(function(t){return t.removeMark("href"),t.removeMark(new gn({type:"color",value:"#003884"})),t})})]})},Xc=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=[];e.forEach(function(t){var e=new gn(t);n.push({from:t.from,mark:e}),n.push({to:t.to,mark:e})}),n.sort(function(t,e){return(t.hasOwnProperty("from")?t.from:t.to)-(e.hasOwnProperty("from")?e.from:e.to)});var o=[],i=[],r=0,a="";return n.forEach(function(e){var n=e.hasOwnProperty("from"),s=n?e.from:e.to;a=Ac(t).slice(r,s).join(""),o.push(new Sn({text:a,marks:a?i.map(function(t){return t.copy()}):[]})),n?i.push(e.mark):i.splice(i.indexOf(e.mark),1),r=s}),a=Ac(t).slice(r).join(""),o.push(new Sn({text:a,marks:a?i.map(function(t){return t.copy()}):[]})),Sn.mergeLeaves(o)},qc=function(t){var e=ed(t),n=Ic.CatalogItem,o=ft.Block,i=Uc(t),r=Ec.getChildByTagName(t,pr.blockStyles),a=nd(r),s=Ec.getChildByTagName(t,pr.catalogHref),l={style:nd(r)};return s&&(!a.indent||parseInt(a.indent,10)/28+1)&&(l.targetId=Ec.getChildTextByTagName(s,pr.catalogValue)),new fn({id:e,name:n,type:o,data:l,nodes:i})};!function(t){t.Backspace="{backspace}",t.Delete="{del}",t.ArrowDown="{downarrow}",t.ArrowLeft="{leftarrow}",t.ArrowRight="{rightarrow}",t.ArrowTop="{toparrow}",t.Tab="{tab}",t.End="{end}",t.Enter="{enter}",t.Esc="{esc}",t.Home="{home}",t.Insert="{insert}",t.PageUp="{pageup}",t.PageDown="{pagedown}",t.Alt="{alt}",t.Ctrl="{ctrl}",t.Meta="{meta}",t.Shift="{shift}"}(Dc||(Dc={})),function(t){t.Redo="redo",t.Undo="undo",t.RemoveFormat="remove_format",t.FormatPainter="format_painter",t.Align="align",t.Outdent="outdent",t.Indent="indent",t.Catalog="catalog",t.LineHeight="lineHeight",t.Bold="bold",t.Delete="delete",t.FontFamily="font-family",t.FontSize="font-size",t.Italic="italic",t.Underline="underline",t.Image="image",t.Code="code",t.CodeLine="code-line",t.Quote="quote",t.Todo="todo",t.Attachment="attachment",t.Link="link",t.Table="table",t.Hr="hr",t.Heading="heading",t.Paragraph="paragraph",t.Dropdown="dropdown",t.CodeLanguage="code-language",t.CodeTheme="code-theme",t.OL="ordered-list",t.UL="unordered-list",t.TextBackColor="text_background",t.FontColor="text_color"}(Bc||(Bc={}));var Qc={serialize:function(t){var e=[],n=t.id;t.nodes.forEach(function(n){var o=function(t){var e=Ec.createElement(pr.catalogue),n=Ec.createElement(pr.catalogHref),o=t.data;Ec.append(e,Lc(pr.text,t));var i=Zu(t);return Ec.append(e,Pc(t)),Ec.append(e,i),Ec.append(e,Qu(t)),o.targetId&&(Ec.append(n,Ec.create(pr.value,o.targetId)),Ec.append(e,n)),o.level&&o.level>1&&Ec.append(i,Ec.create(pr.catalogIndent,o.level-1)),e}(n);o.setAttribute(pr.catalogueId,t.id),o.setAttribute(pr.compat,"true"),e.push(o)});var o=Ec.createElement(pr.catalogueWrap);return o.setAttribute(pr.id,n),Ec.appendElToHeader(o),e},deserialize:function(t){var e=t.getAttribute(pr.catalogueId),n=Ec.getBulbDocument().findNodeById(e);if(n)return n.insert(qc(t),n.nodes.length),null;var o=Ic.Catalog,i=ft.Block,r=[qc(t)];return new fn({id:e,name:o,type:i,nodes:r})}},Zc={serialize:function(t){var e=Ec.createElement(pr.hr);return Ec.append(e,Qu(t)),Ec.append(e,Zu(t)),e},deserialize:function(t){var e=ed(t),n=Ic.HR,o=ft.Block,i=Ec.getChildByTagName(t,pr.blockStyles),r=nd(i);return new fn({id:e,name:n,type:o,data:{style:r}})}},tu=function(t){return t?isNaN(Number(t))?t:parseInt(t,10):null},eu={serialize:function(t){var e=Ec.createElement(pr.image),n=t.data,o=n.url,i=n.resourceId;Ec.append(e,Qu(t)),i&&Ec.append(e,Ec.create(pr.id,i)),Ec.append(e,Ec.create(pr.imageSource,o)),Ec.append(e,Lc(pr.imageTitle,t));var r=Zu(t);return n.width&&Ec.append(r,Ec.create(pr.imageWidth,n.width)),n.height&&Ec.append(r,Ec.create(pr.imageHeight,n.height)),Ec.append(e,r),e},deserialize:function(t){var e=ed(t)||wt(),n=Ic.Image,o=ft.Block,i=Ec.getChildByTagName(t,pr.blockStyles),r=Ec.getChildTextByTagName(i,pr.imageWidth),a=Ec.getChildTextByTagName(i,pr.imageHeight),s=Ec.getChildTextByTagName(t,pr.id),l=tu(r),c=tu(a),u={url:Ec.getChildTextByTagName(t,pr.imageSource),style:nd(i)};l&&Object.assign(u,{width:l}),c&&Object.assign(u,{height:c}),s&&Object.assign(u,{resourceId:s});var d=[],p=Ec.getChildByTagName(t,pr.imageTitle);return Ec.getTextContent(p)&&(d=d.concat(function(t){var e=Ec.getTextContent(t);return zc(e,[{from:0,to:e.length,type:"title",value:""}])}(p))),new fn({id:e,name:n,type:o,data:u,nodes:d})}},nu={serialize:function(t){var e=Ec.createElement(pr.para);return Ec.append(e,Qu(t)),Ec.append(e,Lc(pr.text,t)),Ec.append(e,Pc(t)),Ec.append(e,Zu(t)),e},deserialize:function(t){var e=ed(t),n=Ic.Paragraph,o=ft.Block,i=Uc(t),r={style:nd(Ec.getChildByTagName(t,pr.blockStyles))};return new fn({id:e,name:n,type:o,data:r,nodes:i})}};function ou(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}var iu,ru={serialize:function(t){var e=Ec.createElement(pr.code),n=t.data,o=function(t){return t.map(function(t){return t.getText()}).join("\n")+"\n"}(t.nodes);Ec.append(e,Ec.create(pr.text,o)),Ec.append(e,Qu(t));var i=Ec.createElement(pr.inlineStyles),r=0;return t.nodes.map(function(t){!function(t,e,n){Hc(t).forEach(function(t){var o=t.from,i=t.to,r=t.value,a=t.type,s=Rc[a]||a;Ec.append(n,Mc(s,r,o+e,i+e))})}(t,r,i),r+=function(t){return function(t){if(Array.isArray(t))return ou(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return ou(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ou(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(t.getText()).length+1}),Ec.append(e,i),Ec.append(e,Zu(t)),Ec.append(e,Ec.create(pr.language,n.language)),Ec.append(e,Ec.create(pr.theme,n.theme)),e},deserialize:function(t){var e=ed(t),n=Ic.Code,o=ft.Block,i={style:nd(Ec.getChildByTagName(t,pr.blockStyles)),language:Ec.getChildTextByTagName(t,pr.language),theme:Ec.getChildTextByTagName(t,pr.theme)},r=Ec.getChildTextByTagName(t,pr.text),a=Ec.getChildByTagName(t,pr.inlineStyles),s=Gc(a),l=function(t,e){var n=t.split("\n"),o=n.length,i=0;return n.slice(0,o-1||1).map(function(t){var n=function(t,e,n){return t.filter(function(t){return!(t.from>=e+n||t.to<e)}).map(function(t){return{from:Math.max(t.from-e,0),to:Math.min(t.to-e,n),type:t.type,value:t.value}})}(e,i,t.length);return i+=t.length+1,new fn({name:Ic.CodeLine,type:ft.Block,nodes:[new In({leaves:Xc(t,n)})]})})}(r,s);return new fn({id:e,name:n,type:o,data:i,nodes:l})}};!function(t){t.Title="title",t.SubTitle="subtitle",t.H1="h1",t.H2="h2",t.H3="h3",t.H4="h4"}(iu||(iu={}));var au=[gn.fromJSON({type:"bold"})],su=((r={})[iu.Title]=[].concat(au,[gn.fromJSON({type:"fontSize",value:32})]),r[iu.SubTitle]=[].concat(au,[gn.fromJSON({type:"fontSize",value:18}),gn.fromJSON({type:"color",value:"#595959"})]),r[iu.H1]=[].concat(au,[gn.fromJSON({type:"fontSize",value:20})]),r[iu.H2]=[].concat(au,[gn.fromJSON({type:"fontSize",value:18})]),r[iu.H3]=[].concat(au,[gn.fromJSON({type:"fontSize",value:16})]),r[iu.H4]=[].concat(au,[gn.fromJSON({type:"fontSize",value:14})]),r),lu=function(t){return un(su[t])};function cu(){var t=function(t,e){return e||(e=t.slice(0)),t.raw=e,t}(["\n    white-space: pre-wrap;\n    line-height: 1.5;\n    word-break: break-word;\n"]);return cu=function(){return t},t}function uu(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,o)}return n}function du(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.prototype.render=function(t){var e=t.children,n=t.attributes,o=this.props.block.data.level,i=Ol(lu(o));return n.style=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?uu(Object(n),!0).forEach(function(e){du(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):uu(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}({},i,{},n.style),fr.createElement(pu,Object.assign({"data-heading-level":o},n),e)},e.prototype.renderMark=function(t){var e=t.marks,n=t.children,o=this.props.block.data.level,i=lu(o);return oc({marks:Sn.marksUnion(i,e),children:n})},e}(ca)).blockName="heading";var pu=is.div(cu());function hu(t){return function(t){if(Array.isArray(t))return fu(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return fu(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?fu(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function fu(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}var gu=((a={})[iu.Title]=[].concat(hu(au),[gn.fromJSON({type:"fontSize",value:32})]),a[iu.SubTitle]=[].concat(hu(au),[gn.fromJSON({type:"fontSize",value:18}),gn.fromJSON({type:"color",value:"#595959"})]),a[iu.H1]=[].concat(hu(au),[gn.fromJSON({type:"fontSize",value:28})]),a[iu.H2]=[].concat(hu(au),[gn.fromJSON({type:"fontSize",value:20})]),a[iu.H3]=[].concat(hu(au),[gn.fromJSON({type:"fontSize",value:16})]),a[iu.H4]=[].concat(hu(au),[gn.fromJSON({type:"fontSize",value:14})]),a),mu=function(t){return un(gu[t])},yu=((c={})[iu.Title]="a",c[iu.SubTitle]="b",c[iu.H1]="1",c[iu.H2]="2",c[iu.H3]="3",c[iu.H4]="4",c),vu=Object(hr.a)(yu),_u={serialize:function(t){var e,n,o=Ec.createElement(pr.heading),i=t.data.level,r=yu[i];return e=t.nodes,n=mu(i),e.forEach(function(t){t.isText()&&t.leaves.forEach(function(t){n.forEach(function(e){if(!t.marks.find(function(t){return t.type===e.type})){if("fontSize"===e.type&&14===e.value)return;t.addMark(e)}})})}),o.setAttribute(pr.compat,"true"),o.setAttribute(pr.level,r),Ec.append(o,Qu(t)),Ec.append(o,Lc(pr.text,t)),Ec.append(o,Pc(t)),Ec.append(o,Zu(t)),o},deserialize:function(t){var e=ed(t),n=Ic.Heading,o=ft.Block,i=Uc(t),r=vu[t.getAttribute(pr.level)]||iu.H4,a={level:r};!function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];t.forEach(function(t){t.isText()&&t.leaves.forEach(function(t){var n=[];t.marks.forEach(function(t){e.find(function(e){return t.equals(e)})&&n.push(t)}),n.forEach(function(e){t.removeMark(e.type)})})})}(i,mu(r));var s=Ec.getChildByTagName(t,pr.blockStyles);return s&&(a.style=nd(s)),new fn({id:e,name:n,type:o,data:a,nodes:i})}},bu=[],Cu={serialize:function(t){var e=[];return t.forEach(function(t){if(t.isBlock()){var n=Ec.createElement(pr.quote);Ec.append(n,Qu(t)),Ec.append(n,Lc(pr.text,t)),Ec.append(n,Pc(t)),Ec.append(n,Zu(t)),e.push(n)}}),e},deserialize:function(t){if(t.nodeName===pr.quote){var e=t.previousElementSibling,n=t.nextElementSibling;return e&&e.nodeName===pr.quote||(bu=[]),bu.push(t),n&&n.nodeName===pr.quote?void 0:function(t){if(t.length){var e=t.map(function(t){var e=ed(t),n=Ic.Paragraph,o=ft.Block,i=Uc(t),r={style:nd(Ec.getChildByTagName(t,pr.blockStyles))};return new fn({id:e,name:n,type:o,data:r,nodes:i})}),n=wt(),o=Ic.Quote,i=ft.Block;return new fn({id:n,name:o,type:i,nodes:e})}}(bu)}}},ku={serialize:function(t){var e=Ec.createElement(pr.todo),n=t.data;return Ec.append(e,Qu(t)),Ec.append(e,Lc(pr.text,t)),Ec.append(e,Pc(t)),Ec.append(e,Zu(t)),Ec.append(e,Ec.create(pr.checked,n.checked)),e},deserialize:function(t){var e,n=ed(t),o=Ic.Todo,i=ft.Block,r=Ec.getChildByTagName(t,pr.blockStyles),a=Uc(t),s={checked:(e=Ec.getChildTextByTagName(t,pr.checked),"true"===e),style:nd(r)};return new fn({id:n,name:o,type:i,data:s,nodes:a})}};function wu(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}var Su,xu,Eu,Iu,Tu=function(){function t(t){var e=this;this.rectUnion=function(t,e){if(t&&e)return{startCellIndex:Math.min(t.startCellIndex,e.startCellIndex),startRowIndex:Math.min(t.startRowIndex,e.startRowIndex),endCellIndex:Math.max(t.endCellIndex,e.endCellIndex),endRowIndex:Math.max(t.endRowIndex,e.endRowIndex)}},this.rectContains=function(t,e){return!(!t||!e)&&t.startCellIndex<=e.startCellIndex&&t.startRowIndex<=e.startRowIndex&&t.endCellIndex>=e.endCellIndex&&t.endRowIndex>=e.endRowIndex},this.calculateRect=function(t,n){var o=e.cellIdToRect.get(t&&t.id);if(e.rectContains(e.selectionRect,o)){if(n)return;e.selectionRect=e.rectUnion(e.startRect,o)}else e.selectionRect=e.rectUnion(e.selectionRect,o);e.getSelectedCells().filter(function(e){return e.id!==t.id}).forEach(function(t){return e.calculateRect(t,!0)})},this.getSelectedCells=function(){var t=Object.values(e.cellMatrix);if(e.selectionRect){var n=e.selectionRect,o=n.startRowIndex,i=n.endRowIndex,r=n.startCellIndex,a=n.endCellIndex,s=t.slice(o,i+1).reduce(function(t,e){var n=Object.values(e);return t.concat(n.slice(r,a+1))},[]);return function(t){return function(t){if(Array.isArray(t))return wu(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return wu(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?wu(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(new Set(s))}return[]},this.init(t)}return t.prototype.getTable=function(){return this.table},t.prototype.setTable=function(t){this.table=t},t.prototype.getCellByPosition=function(t,e){return this.cellMatrix[t][e]},t.prototype.getSelectionRect=function(){return this.selectionRect},t.prototype.getRectByCell=function(t){return this.cellIdToRect.get(t.id)},t.prototype.getTableSpan=function(){return{rowSpan:Object.keys(this.cellMatrix).length,colSpan:Object.keys(this.cellMatrix[0]).length}},t.prototype.resetSelectionRect=function(){this.selectionRect=this.startRect=null},t.prototype.initSelectionRect=function(t){this.selectionRect=this.startRect=this.cellIdToRect.get(t&&t.id)},t.prototype.init=function(t){this.table=t,this.initRects()},t.prototype.initRects=function(){var t=this;this.cellIdToRect=new Map,this.cellMatrix={},this.table.forEach(function(e){var n=0;e.forEach(function(o){for(var i=o.data.colSpan||1,r=o.data.rowSpan||1,a=o.index()+n,s=0,l=0;l<r;l++)for(var c=0;c<i;c++)s+=t.updateCell(e.index()+l,a+c+s,o,0);t.cellIdToRect.set(o.id,{startCellIndex:a+s,endCellIndex:a+i-1+s,startRowIndex:e.index(),endRowIndex:e.index()+r-1}),n+=i-1+s})})},t.prototype.updateCell=function(t,e,n,o){var i=o||0;return this.cellMatrix[t]||(this.cellMatrix[t]={}),this.cellMatrix[t][e]?this.updateCell(t,e+1,n,++i):(this.cellMatrix[t][e]=n,i)},t}();function Ou(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,o)}return n}function Au(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Nu(t){return function(t){if(Array.isArray(t))return Du(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return Du(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Du(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Du(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}!function(t){t.TABLE="table",t.TABLE_CELL="table-cell",t.TABLE_ROW="table-row"}(Su||(Su={})),function(t){t.VERTICAL="VERTICAL",t.HORIZONTAL="HORIZONTAL"}(xu||(xu={})),function(t){t.ON_TABLE_EVENT="ON_TABLE_EVENT",t.ON_LEAVE_TABLE="ON_LEAVE_TABLE",t.ON_ENTER_TABLE="ON_ENTER_TABLE",t.ON_SELECT_ALL="ON_SELECT_ALL"}(Eu||(Eu={})),function(t){t[t.DELETE_TABLE=0]="DELETE_TABLE",t[t.DELETE_ROW=1]="DELETE_ROW",t[t.DELETE_COL=2]="DELETE_COL"}(Iu||(Iu={}));var Bu={backgroundColor:"backColor"},Ru={backColor:"backgroundColor"},Lu=function(){var t=Ic.Paragraph,e=ft.Block;return new fn({name:t,type:e,nodes:[new In({leaves:[new Sn({text:""})]})]})},Pu=function(t,e){var n=function(t){var e=t.mergeWidth,n=t.mergeHeight,o=["value","inlineStyles","mergeWidth","mergeHeight","resource","mergePointDX","mergePointDY"],i=Object.keys(t).filter(function(t){return!o.includes(t)}).reduce(function(e,n){return"wrap"===n&&!1===t[n]?e.whiteSpace="nowrap":e[Ru[n]||n]=t[n],e},{}),r={};return Object.keys(i).length&&(r.style=i),e>1&&(r.colSpan=e),n>1&&(r.rowSpan=n),r}(t),o=new fn({name:Ic.TableCell,type:ft.Block,data:n,nodes:[]});if(t.resource){var i;(i=o.nodes).push.apply(i,Nu(function(t,e){var n=[],o=Ec.getElementChildren(e).find(function(e){return t.resource===Ec.getChildTextByTagName(e,pr.tableResId)}),i=Ec.getChildByTagName(o,pr.image)||Ec.getChildByTagName(o,pr.attach);Ec.append(i,Ec.create(pr.coId,t.resource));var r=Xu[i.nodeName](i);return n.push(Lu()),n.push(r),n.push(Lu()),n}(t,e)))}else{var r,a=function(t){return(t.value&&t.value.split(/\r?\n/)||[""]).map(function(e){var n=Ic.Paragraph,o=ft.Block,i=function(t){return Object.keys(t).reduce(function(e,n){return t[n].forEach(function(t){e.push({from:t.from,to:t.to,type:Vc[n],value:!0===t.value?"":t.value})}),e},[])}(t.inlineStyles||{}),r=zc(e||"",i);return new fn({name:n,type:o,nodes:r})})}(t);(r=o.nodes).push.apply(r,Nu(a))}return o},Mu={serialize:function(t){var e=Ec.createElement(pr.table),n=Ec.createElement(pr.tableResources),o=function(t,e){var n=t.data,o=n.colsWidth,i=n.rowsHeight,r=Nu(Array(i.length)).map(function(){return Nu(Array(o.length)).map(function(){return{}})}),a=new Tu(t);return t.nodes.forEach(function(t){t.nodes.forEach(function(t){var n=a.getRectByCell(t),s=n.startRowIndex,l=n.startCellIndex;s<i.length&&l<o.length&&function(t,e,n,o,i){var r=t.find(function(t){return[Ic.Image,Ic.Attachment].includes(t.name)});r&&function(t,e){var n=Ec.createElement(pr.tableResource),o=Ec.create(pr.tableResId,t.id);Ec.append(e,n),Ec.append(n,o),t.name===Ic.Image?Ec.append(n,eu.serialize(t)):t.name===Ic.Attachment&&Ec.append(n,Tc.serialize(t))}(r,i);var a=t.data,s=a.rowSpan,l=void 0===s?1:s,c=a.colSpan,u=void 0===c?1:c,d=a.style,p=function(t){return t.nodes.reduce(function(t,e,n){var o=e.getText();return t+=n>0?"\n"+o:o},"")}(t),h=u,f=l,g=function(t){var e={},n=0;return t.nodes.forEach(function(t){Hc(t).forEach(function(t){var o=t.from,i=t.to,r=t.value,a=t.type,s=Rc[a]||a;e[s]||(e[s]=[]),e[s].push({from:o+n,to:i+n,value:""===r||r})}),n+=1+Nu(t.getText()).length}),e}(t);d&&Object.keys(d).forEach(function(t){(function(t){return"textAlign"===t&&"left"===d[t]||"verticalAlign"===t&&"middle"===d[t]})(t)||("nowrap"!==d[t]?e[n][o][Bu[t]||t]=d[t]:e[n][o].wrap=!1)}),(h>1||f>1)&&(e[n][o]=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Ou(Object(n),!0).forEach(function(e){Au(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ou(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}({},e[n][o],{mergeHeight:f,mergeWidth:h})),r?e[n][o]={value:"",resource:r.id}:((p.length||Object.keys(e[n][o]).length)&&(e[n][o].value=p),Object.keys(g).length&&(e[n][o].inlineStyles=g));for(var m=0;m<l;m++)for(var y=0;y<u;y++)if(0!==m||0!==y){var v=n+m,_=o+y;v<e.length&&_<e[v].length&&(e[v][_].mergePointDX=y,e[v][_].mergePointDY=m,e[v][_].value="")}}(t,r,s,l,e)})}),{cells:r.reduce(function(t,e){return t.push.apply(t,Nu(e)),t},[]),heights:i.map(function(t){return t||40}),widths:o.map(function(t){return t||100})}}(t,n);return Ec.append(e,Qu(t)),Ec.append(e,n),Ec.append(e,Ec.create(pr.tableContent,JSON.stringify(o))),Ec.append(e,Zu(t)),e},deserialize:function(t){var e,n,o=ed(t),i=Ic.Table,r=ft.Block,a=JSON.parse(Ec.getChildTextByTagName(t,pr.tableContent).replace(/\n/g,"\\n")),s=a.widths,l=a.heights,c=a.cells,u={colsWidth:null==s?void 0:s.map(function(t){return t||100}),rowsHeight:null==l?void 0:l.map(function(t){return t||40}),style:nd(Ec.getChildByTagName(t,pr.blockStyles))||{}},d=new fn({id:o,name:i,type:r,data:u,nodes:[]}),p=(n=l.length,Array(n).fill(null).map(function(t){return new fn({name:Ic.TableRow,type:ft.Block,nodes:[]})}));return c.forEach(function(e,n){var o=Math.floor(n/s.length);if(!e.mergePointDX&&!e.mergePointDY){var i=Ec.getChildByTagName(t,pr.tableResources),r=Pu(e,i);p[o].nodes.push(r)}}),(e=d.nodes).push.apply(e,Nu(p)),d}},Fu={serialize:function(t){var e=Ec.createElement(pr.listItem);Ec.append(e,Lc(pr.text,t)),Ec.append(e,Pc(t)),Ec.append(e,Qu(t)),Ec.append(e,Zu(t));var n=t.data,o=n.listLevel,i=n.listId,r=n.listType;return e.setAttribute(pr.level,""+o),e.setAttribute(pr.listId,i),Ec.hasListInHeader(i)||function(t,e){var n=Ec.createElement(pr.list);n.setAttribute(pr.id,t),n.setAttribute(pr.listType,e),Ec.appendElToHeader(n)}(i,r),e},deserialize:function(t){var e=t.getAttribute(pr.listId),n=parseInt(t.getAttribute(pr.level),10),o=Ec.getLists().find(function(t){return t.id===e}),i=o?o.type:os.UnorderedList,r=ed(t),a={listId:e,listLevel:n,listType:i,style:nd(Ec.getChildByTagName(t,pr.blockStyles))};return new fn({id:r,name:Ic.ListItem,type:ft.Block,data:a,nodes:Uc(t)})}},Hu=["padding","backgroundColor"],ju=[Ic.Catalog,Ic.Quote,Ic.TableCell,Ic.TableRow],Vu=function(t){var e=t&&t.data&&t.data.style;if(e)return Hu.reduce(function(t,n){return e[n]&&(t[n]=e[n]),t},{})},Uu=function(t){t.deepForEach(function(t){if(t.isBlock()){var e=t.data.style;Hu.forEach(function(t){e&&e.hasOwnProperty(t)&&e[t]&&delete e[t]})}})},zu=function(t){return t.reduce(function(t,e){var n=function(t){if(function(t){return t&&t.isBlock()&&ju.indexOf(t.name)>=0}(t)){var e=t.nodes[0];return n(e)}return Vu(t)},o=n(e),i=t.length,r=i&&t[i-1];return i&&function(t,e){var n=Vu(t);if(n&&e)return t.name===pr.layout&&function(t,e){return io(t,e)}(n,e)}(r,o)?(Uu(e),r.nodes.push(e)):t.push(o&&Object.keys(o).length?function(t,e){var n=wt(),o=Ic.Layout,i=ft.Block;return Uu(t),new fn({id:n,data:{style:e},name:o,type:i,nodes:[t]})}(e,o):e),t},[])};function Gu(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}function Ju(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,o)}return n}function Wu(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var $u={serialize:function(t){var e=[],n=t.data;return t.deepForEach(function(t){(function(t){return t.isBlock()&&ju.indexOf(t.name)<=-1})(t)&&function(t,e){t.data.style=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Ju(Object(n),!0).forEach(function(e){Wu(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ju(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}({},t.data.style,{},e.style)}(t,n)}),t.nodes.forEach(function(t){var n=od.serialize(t);n instanceof Array?e.push.apply(e,function(t){return function(t){if(Array.isArray(t))return Gu(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return Gu(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Gu(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(n)):e.push(n)}),e}},Ku={serialize:function(t){var e=function(){var e=Ec.createElement(pr.unknown);return Ec.append(e,Qu(t)),Ec.append(e,Ec.create(pr.unknownContent,JSON.stringify(t.toJSON()))),e},n=t.data.xml;if(n)try{return Ec.parseXML(n).childNodes[0]}catch(t){return e()}return e()},deserialize:function(t){var e=Ec.getChildTextByTagName(t,pr.unknownContent);if(e)return kn.fromJSON(JSON.parse(e));var n,o={xml:(n=t.outerHTML,n.replace(/(\r\n|\n|\r)/g,"").replace(/>\s*</g,"><").replace(/\s+xmlns=".*"/g,""))};return new kn({type:ft.Unknown,name:ft.Unknown,data:o})}},Yu=((u={})[Ic.Attachment]=Tc.serialize,u[Ic.Catalog]=Qc.serialize,u[Ic.HR]=Zc.serialize,u[Ic.Paragraph]=nu.serialize,u[Ic.Image]=eu.serialize,u[Ic.Code]=ru.serialize,u[Ic.Heading]=_u.serialize,u[Ic.Quote]=Cu.serialize,u[Ic.Todo]=ku.serialize,u[Ic.Table]=Mu.serialize,u[Ic.ListItem]=Fu.serialize,u[Ic.Unknown]=Ku.serialize,u[Ic.Layout]=$u.serialize,u),Xu=((d={})[pr.attach]=Tc.deserialize,d[pr.catalogue]=Qc.deserialize,d[pr.hr]=Zc.deserialize,d[pr.para]=nu.deserialize,d[pr.image]=eu.deserialize,d[pr.code]=ru.deserialize,d[pr.heading]=_u.deserialize,d[pr.quote]=Cu.deserialize,d[pr.todo]=ku.deserialize,d[pr.table]=Mu.deserialize,d[pr.listItem]=Fu.deserialize,d[pr.unknown]=Ku.deserialize,d[pr.layout]=$u.deserialize,d),qu={textAlign:pr.align,indent:pr.indent,textIndent:pr.textIndent,lineHeight:pr.lineHeight,backgroundColor:pr.blockBackColor,padding:pr.padding,float:pr.float,color:pr.color,margin:pr.margin},Qu=function(t){return Ec.create(pr.coId,t.id)},Zu=function(t){var e=Ec.createElement(pr.blockStyles),n=t.data.style;return n&&Object.keys(n).forEach(function(t){var o=n[t],i=qu[t];i!==pr.indent&&i!==pr.textIndent||(o/=28),Ec.append(e,Ec.create(i,o))}),e},td=Object(hr.a)(qu),ed=function(t){return Ec.getChildTextByTagName(t,pr.coId)},nd=function(t){var e={};return(Ec.getElementChildren(t)||[]).forEach(function(t){var n=td[t.nodeName];if(n){var o=Ec.getTextContent(t);switch(n){case"indent":case"textIndent":o=28*parseInt(o,10);break;case"lineHeight":o=parseFloat(o)}e[n]=o}}),e},od={serialize:function(t){return Yu[t.name]?Yu[t.name](t):Yu[pr.unknown](t)},deserialize:function(t){return Xu[t.nodeName]?Xu[t.nodeName](t):Xu[pr.unknown](t)}},id=function(t){var e={};if(t){var n=Ec.getChildByTagName(t,pr.header),o=Ec.getChildByTagName(t,pr.footer);(n||o)&&(rd(e,n,"header"),rd(e,o,"footer"))}return e},rd=function(t,e,n){var o="header"===n?pr.headerStyle:pr.footerStyle,i="header"===n?pr.headerContent:pr.footerContent,r="header"===n?"headerStyle":"footerStyle",a=e&&Ec.getChildByTagName(e,o),s=a&&Ec.getChildTextByTagName(a,pr.align),l=Ec.getChildTextByTagName(e,i)||"";t[n]=[{page:1,text:l}],t[r]={textAlign:s||"center"}},ad=function(t,e){var n=e[t][0].text,o=Ec.createElement(t);if(Ec.append(o,Ec.create(pr.text,n)),e&&t===pr.header){var i=Ec.createElement(pr.headerStyle),r=e.headerStyle||{textAlign:"center"};Ec.append(i,Ec.create(pr.align,r.textAlign)),o.appendChild(i)}if(e&&t===pr.footer){var a=Ec.createElement(pr.footerStyle),s=e.footerStyle||{textAlign:"center"};Ec.append(a,Ec.create(pr.align,s.textAlign)),o.appendChild(a)}return o.setAttribute("compat","true"),o};function sd(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}var ld=function(t){var e=window.document.implementation;Ec.setXML(e.createDocument("http://note.youdao.com",pr.note,null));var n=Ec.getXML().documentElement;n.setAttribute("schema-version","1.0.3");var o=t.data.fileVersion;o&&n.setAttribute(pr.fileVersion,o.toString());var i=t.data.templateId;i&&n.setAttribute(pr.fileId,i.toString());var r=Ec.createElement(pr.head);(function(t,e){var n=t.data;n&&n.header&&e.appendChild(ad(pr.header,n)),n&&n.footer&&e.appendChild(ad(pr.footer,n))})(t,r),Ec.append(n,r);var a=Ec.createElement(pr.body);return Ec.append(n,a),t.nodes.forEach(function(t){var e=od.serialize(t);e&&Ec.append.apply(Ec,[a].concat(function(t){return function(t){if(Array.isArray(t))return sd(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return sd(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?sd(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}([].concat(e))))}),Ec.getXML()},cd=n(77),ud={svg:!0,video:!0,style:!0},dd=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]"),pd=function(t){return dd.test(t)},hd="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",fd="[^\\ud800-\\udfff]",gd="(?:\\ud83c[\\udde6-\\uddff]){2}",md="[\\ud800-\\udbff][\\udc00-\\udfff]",yd="(?:"+hd+"|\\ud83c[\\udffb-\\udfff])?",vd="[\\ufe0e\\ufe0f]?"+yd+"(?:\\u200d(?:"+[fd,gd,md].join("|")+")[\\ufe0e\\ufe0f]?"+yd+")*",_d="(?:"+[fd+hd+"?",hd,gd,md,"[\\ud800-\\udfff]"].join("|")+")",bd=RegExp("\\ud83c[\\udffb-\\udfff](?=\\ud83c[\\udffb-\\udfff])|"+_d+vd,"g"),Cd=function(t){return pd(t)?function(t){return t.match(bd)||[]}(t):function(t){return t.split("")}(t)},kd=function(t){t=Co(t);var e=pd(t)?Cd(t):void 0,n=e?e[0]:t.charAt(0),o=e?function(t,e,n){var o=t.length;return n=void 0===n?o:n,!e&&n>=o?t:Bo(t,e,n)}(e,1).join(""):t.slice(1);return n.toUpperCase()+o},wd=Ql(function(t,e,n){return e=e.toLowerCase(),t+(n?function(t){return kd(Co(t).toLowerCase())}(e):e)}),Sd=function(){function t(){}return t.purifyHTMLDocument=function(t){return Object.keys(ud).forEach(function(e){Array.from(t.querySelectorAll(e)).forEach(function(t){t.remove()})}),t},t.createHTMLDocument=function(t){var e;if(document.implementation&&document.implementation.createHTMLDocument&&(e=document.implementation.createHTMLDocument("title")),window.DOMParser){var n=new window.DOMParser;try{e=n.parseFromString("","text/html")}catch(t){return null}}if(e)return e.body.innerHTML=t,e},t.deepForEachNode=function(e,n){e.hasChildNodes()&&(t.getChildNodes(e).forEach(n),t.getChildNodes(e).forEach(function(e){t.deepForEachNode(e,n)}))},t.getStyle=function(t){return Array.from(t.style).reduce(function(e,n){return e[wd(n)]=t.style[n],e},{})},t.getChildNodes=function(t){return Array.from(t.childNodes)},t.getByTag=function(t,e){return Array.from(t.getElementsByTagName(e))},t.getAttr=function(t,e){var n=t.attributes&&t.attributes[e];return n&&n.textContent},t.convertBlockStyleValue=function(e){return Object.entries(e).forEach(function(n){var o=n[0],i=n[1];i?e[o]=t.convertNumberValue(i)||i:delete e[o]}),e},t.escapeHTML=function(t){return t.replace(/</g,"&lt;").replace(/>/g,"&gt;")},t.convertNumberValue=function(t){if(t=(t=(""+t).replace(/(\d+)(?:em|rem)/g,function(t,e){return 14*parseInt(e,10)+"px"})).replace("px",""),!isNaN(Number(t)))return Number(t)},t.purifyHTML=function(e){var n=/<html[\S\s]*<\/html>/i;return n.test(e)&&(e=e.match(n)[0]),t.removals.forEach(function(t){e=e.replace(t,"")}),e},t}();Sd.removals=[/<!--[\w\W]*?-->/g,/&quot;/g];var xd=function(){};xd.blockName="paragraph",xd=function(t,e,n,o){var i,r=arguments.length,a=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(r<3?i(a):r>3?i(e,n,a):i(e,n))||a);return r>3&&a&&Object.defineProperty(e,n,a),a}([dr],xd),ir.registerComponents([xd]),ir.getComponent=function(t){return Object.values(Ic).includes(t)},ir.registerPlugins(function(t){function e(){var e,n=this;return n=t.apply(this,arguments)||this,e=n,n.name="bulb-plugin-ynote-guid",n.beforeGenerateNodeId=function(t,n){return String.fromCharCode.apply(e,e.randomCharCodes(4))+"-"+Date.now().toString()},n.randomCharCodes=function(t){for(var n=[];n.length<t;)n.push(e.randomCharCode());return n},n.randomCharCode=function(){var t=Math.floor(62*Math.random());return t<10?t+48:t<36?t-10+65:t-36+97},n}return s(e,t),e}(Mo));var Ed={serialize:function(t){t instanceof _n&&(t=t.toJSON());var e=Wi(t);return function(t){return Ec.stringify(t)}(ld(e))},deserialize:function(t){return function(t){var e=Ec.getChildByTagName(t,pr.note),n=Ec.getChildByTagName(e,pr.body),o=Ec.getChildByTagName(e,pr.head),i=new _n({nodes:[],data:id(o)}),r=e.getAttribute(pr.fileVersion);r&&(i.data.fileVersion=r);var a=e.getAttribute(pr.fileId);return a&&(i.data.templateId=a),Ec.setBulbDocument(i),Ec.setLists(o),Ec.getElementChildren(n).forEach(function(t){var e=od.deserialize(t);e&&i.nodes.push(e)}),i.nodes=zu(i.nodes),i.updateParent(),i}(function(t){return Ec.parseXML(t)}(t))}},Id={xml2json:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=Ed.deserialize(t),o=n.toJSON();return e&&(o=cd.a.compress(o)),JSON.stringify(o)},json2xml:function(t){var e;try{e=JSON.parse(t)}catch(t){console.warn("parsing data error")}return Ed.serialize(cd.a.decompress(e))}},Td={isXML:function(t){return Ec.isXML(t)},isJSON:function(t){return function(t){try{JSON.parse(t)}catch(t){return!1}return!0}(t)},getActualContent:function(t){var e=Nd(t);if(e)return{type:"json",content:e};var n=Od(t);if(n)return{type:n.isXml?"xml":"json",content:n.content};var o=Ad(t);return o?{type:o.isHtml?"html":"json",content:o.content}:{type:"html",content:t}}},Od=function(t){try{var e=Ec.parseXML(t);if(!e)return;var n=e.getElementsByTagName("note");if(0===n.length)return;var o=n[0],i=o.getAttribute("schema-version");if("http://note.youdao.com"!==o.getAttribute("xmlns")||null==i)return;var r=e.getElementsByTagName("body");if(r.length<1)return{isXml:!0,content:t};var a=r[0];if(1!==a.children.length)return{isXml:!0,content:t};var s=a.children[0];if("para"!==s.tagName)return{isXml:!0,content:t};var l=s.getElementsByTagName("text");if(l.length<1)return{isXml:!0,content:t};var c=l[0].innerHTML;return c.startsWith('{"2":"1",')&&Td.isJSON(c)?{isXml:!1,content:c}:{isXml:!0,content:t}}catch(t){return}},Ad=function(t){try{var e=Sd.createHTMLDocument(t);if(!e)return{isHtml:!0,content:t};var n=e.getElementsByTagName("div");if(1!==n.length)return{isHtml:!0,content:t};if("paragraph"!==n[0].getAttribute("yne-bulb-block"))return{isHtml:!0,content:t};var o=n[0].innerHTML.trim();return o.startsWith('{"2":"1",')&&Td.isJSON(o)?{isHtml:!1,content:o}:{isHtml:!0,content:t}}catch(t){return}},Nd=function(t){try{var e;try{e=JSON.parse(t)}catch(o){var n=t.replace(/&quot;/g,'"').replace(/&#39;/g,"'").replace(/&lt;/g,"<").replace(/&gt;/g,">");if(n===t)return;e=JSON.parse(n),t=n}var o=_n.fromJSON(cd.a.decompress(e));if(!o)return;if(1!==o.nodes.length)return t;var i=o.nodes[0];if(!i.isBlock()||i.name!==Ic.Paragraph)return t;var r=i.getText();return r.startsWith('{"2":"1",')&&JSON.parse(r)?r:t}catch(t){return}}}])}.apply(e,[n,e]))||(t.exports=r)}).call(this,n(67),n(850))},function(t,e){var n,o,i=t.exports={};function r(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(t){if(n===setTimeout)return setTimeout(t,0);if((n===r||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:r}catch(t){n=r}try{o="function"==typeof clearTimeout?clearTimeout:a}catch(t){o=a}}();var l,c=[],u=!1,d=-1;function p(){u&&l&&(u=!1,l.length?c=l.concat(c):d=-1,c.length&&h())}function h(){if(!u){var t=s(p);u=!0;for(var e=c.length;e;){for(l=c,c=[];++d<e;)l&&l[d].run();d=-1,e=c.length}l=null,u=!1,function(t){if(o===clearTimeout)return clearTimeout(t);if((o===a||!o)&&clearTimeout)return o=clearTimeout,clearTimeout(t);try{o(t)}catch(e){try{return o.call(null,t)}catch(e){return o.call(this,t)}}}(t)}}function f(t,e){this.fun=t,this.array=e}function g(){}i.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];c.push(new f(t,e)),1!==c.length||u||s(h)},f.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=g,i.addListener=g,i.once=g,i.off=g,i.removeListener=g,i.removeAllListeners=g,i.emit=g,i.prependListener=g,i.prependOnceListener=g,i.listeners=function(t){return[]},i.binding=function(t){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(t){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(t,e,n){"use strict";var o,i="object"==typeof Reflect?Reflect:null,r=i&&"function"==typeof i.apply?i.apply:function(t,e,n){return Function.prototype.apply.call(t,e,n)};o=i&&"function"==typeof i.ownKeys?i.ownKeys:Object.getOwnPropertySymbols?function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:function(t){return Object.getOwnPropertyNames(t)};var a=Number.isNaN||function(t){return t!=t};function s(){s.init.call(this)}t.exports=s,s.EventEmitter=s,s.prototype._events=void 0,s.prototype._eventsCount=0,s.prototype._maxListeners=void 0;var l=10;function c(t){return void 0===t._maxListeners?s.defaultMaxListeners:t._maxListeners}function u(t,e,n,o){var i,r,a,s;if("function"!=typeof n)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof n);if(void 0===(r=t._events)?(r=t._events=Object.create(null),t._eventsCount=0):(void 0!==r.newListener&&(t.emit("newListener",e,n.listener?n.listener:n),r=t._events),a=r[e]),void 0===a)a=r[e]=n,++t._eventsCount;else if("function"==typeof a?a=r[e]=o?[n,a]:[a,n]:o?a.unshift(n):a.push(n),(i=c(t))>0&&a.length>i&&!a.warned){a.warned=!0;var l=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");l.name="MaxListenersExceededWarning",l.emitter=t,l.type=e,l.count=a.length,s=l,console&&console.warn&&console.warn(s)}return t}function d(t,e,n){var o={fired:!1,wrapFn:void 0,target:t,type:e,listener:n},i=function(){for(var t=[],e=0;e<arguments.length;e++)t.push(arguments[e]);this.fired||(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,r(this.listener,this.target,t))}.bind(o);return i.listener=n,o.wrapFn=i,i}function p(t,e,n){var o=t._events;if(void 0===o)return[];var i=o[e];return void 0===i?[]:"function"==typeof i?n?[i.listener||i]:[i]:n?function(t){for(var e=new Array(t.length),n=0;n<e.length;++n)e[n]=t[n].listener||t[n];return e}(i):f(i,i.length)}function h(t){var e=this._events;if(void 0!==e){var n=e[t];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function f(t,e){for(var n=new Array(e),o=0;o<e;++o)n[o]=t[o];return n}Object.defineProperty(s,"defaultMaxListeners",{enumerable:!0,get:function(){return l},set:function(t){if("number"!=typeof t||t<0||a(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");l=t}}),s.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},s.prototype.setMaxListeners=function(t){if("number"!=typeof t||t<0||a(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this},s.prototype.getMaxListeners=function(){return c(this)},s.prototype.emit=function(t){for(var e=[],n=1;n<arguments.length;n++)e.push(arguments[n]);var o="error"===t,i=this._events;if(void 0!==i)o=o&&void 0===i.error;else if(!o)return!1;if(o){var a;if(e.length>0&&(a=e[0]),a instanceof Error)throw a;var s=new Error("Unhandled error."+(a?" ("+a.message+")":""));throw s.context=a,s}var l=i[t];if(void 0===l)return!1;if("function"==typeof l)r(l,this,e);else{var c=l.length,u=f(l,c);for(n=0;n<c;++n)r(u[n],this,e)}return!0},s.prototype.addListener=function(t,e){return u(this,t,e,!1)},s.prototype.on=s.prototype.addListener,s.prototype.prependListener=function(t,e){return u(this,t,e,!0)},s.prototype.once=function(t,e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e);return this.on(t,d(this,t,e)),this},s.prototype.prependOnceListener=function(t,e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e);return this.prependListener(t,d(this,t,e)),this},s.prototype.removeListener=function(t,e){var n,o,i,r,a;if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e);if(void 0===(o=this._events))return this;if(void 0===(n=o[t]))return this;if(n===e||n.listener===e)0==--this._eventsCount?this._events=Object.create(null):(delete o[t],o.removeListener&&this.emit("removeListener",t,n.listener||e));else if("function"!=typeof n){for(i=-1,r=n.length-1;r>=0;r--)if(n[r]===e||n[r].listener===e){a=n[r].listener,i=r;break}if(i<0)return this;0===i?n.shift():function(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}(n,i),1===n.length&&(o[t]=n[0]),void 0!==o.removeListener&&this.emit("removeListener",t,a||e)}return this},s.prototype.off=s.prototype.removeListener,s.prototype.removeAllListeners=function(t){var e,n,o;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[t]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[t]),this;if(0===arguments.length){var i,r=Object.keys(n);for(o=0;o<r.length;++o)"removeListener"!==(i=r[o])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(e=n[t]))this.removeListener(t,e);else if(void 0!==e)for(o=e.length-1;o>=0;o--)this.removeListener(t,e[o]);return this},s.prototype.listeners=function(t){return p(this,t,!0)},s.prototype.rawListeners=function(t){return p(this,t,!1)},s.listenerCount=function(t,e){return"function"==typeof t.listenerCount?t.listenerCount(e):h.call(t,e)},s.prototype.listenerCount=h,s.prototype.eventNames=function(){return this._eventsCount>0?o(this._events):[]}},function(t,e,n){var o,i;void 0===(i=function(e,r){"use strict";o=[n,r,n(0),n(853)],void 0===(i=function(t,e,n,o){return n.union(["require-innerlink","find"],o)}.apply(r,o))||(t.exports=i)}.apply(e,o=[n,e]))||(t.exports=i)},function(t,e,n){var o;void 0===(o=function(e,i){"use strict";void 0===(o=function(t,e){return["content-change","insert-photo","insert-link","insert-attachment","replace-image","replace-attachment","open-link","download-attachment","get-entity","replace-img-url","get-exif-data","download-image","preview-image","context-menu","show-words","save-content","blob-paste","upload-image","clipboard-error","mac-preview","background-failed-update","background-changed","is-vip-user","table-click","image-ocr","collabsession-change","datacommand-success","session-built","session-closed","session-initialized","useraction-failed","user-action-collection","view-mode-change","note-version-change"]}.apply(i,[n,i]))||(t.exports=o)}.apply(e,[n,e]))||(t.exports=o)},function(t,e){},,,,,,,,,,function(t,e){}])});